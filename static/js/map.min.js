!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],e):e(t.L)}(this,function(G){"use strict";var e=(G=G&&G.hasOwnProperty("default")?G.default:G).Marker.prototype.onAdd,n=G.Marker.prototype.onRemove;G.Marker.mergeOptions({bounceOnAdd:!1,bounceOnAddOptions:{duration:1e3,height:-1},bounceOnAddCallback:function(){}}),G.Marker.include({_toPoint:function(t){return this._map.latLngToContainerPoint(t)},_toLatLng:function(t){return this._map.containerPointToLatLng(t)},_motionStep:function(t,e){var n=this,i=(new Date-e.start)/e.duration;1<i&&(i=1);var r=n._easeOutBounce(i);e.step(r),1!==i?G.Util.requestAnimFrame(function(t){n._motionStep(t,e)}):e.end()},_bounceMotion:function(e,n){var i=G.latLng(this._origLatlng),r=this._dropPoint.y,o=this._dropPoint.x,s=this._point.y-r,a=this;a._bLock||(a._bLock=!0,G.Util.requestAnimFrame(function(t){a._motionStep(t,{delay:10,duration:e||1e3,start:new Date,step:function(t){a._dropPoint.y=r+s*t-(a._map.project(a._map.getCenter()).y-a._origMapCenter.y),a._dropPoint.x=o-(a._map.project(a._map.getCenter()).x-a._origMapCenter.x),a.setLatLng(a._toLatLng(a._dropPoint))},end:function(){a._bLock=!1,a.setLatLng(i),"function"==typeof n&&n()}})}))},_easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounce:function(t,e){this._origLatlng=this.getLatLng(),this._bounce(t,e)},_bounce:function(t,e){"function"==typeof t&&(e=t,t=null),"number"==typeof(t=t||{duration:1e3,height:-1})&&(t.duration=arguments[0],t.height=arguments[1]),this._origMapCenter=this._map.project(this._map.getCenter()),this._dropPoint=this._getDropPoint(t.height),this._bounceMotion(t.duration,e)},_getDropPoint:function(t){this._point=this._toPoint(this._origLatlng);var e=void 0;return e=void 0===t||t<0?this._toPoint(this._map.getBounds()._northEast).y:this._point.y-t,new G.Point(this._point.x,e)},onAdd:function(t){this._map=t,this._origLatlng=this._latlng,!0===this.options.bounceOnAdd&&(void 0!==this.options.bounceOnAddDuration&&(this.options.bounceOnAddOptions.duration=this.options.bounceOnAddDuration),void 0!==this.options.bounceOnAddHeight&&(this.options.bounceOnAddOptions.height=this.options.bounceOnAddHeight),this._dropPoint=this._getDropPoint(this.options.bounceOnAddOptions.height),this.setLatLng(this._toLatLng(this._dropPoint))),e.call(this,t),!0===this.options.bounceOnAdd&&this._bounce(this.options.bounceOnAddOptions,this.options.bounceOnAddCallback)},onRemove:function(t){clearInterval(this._intervalId),n.call(this,t)}}),G.Map.mergeOptions({contextmenuItems:[]}),G.Map.ContextMenu=G.Handler.extend({_touchstart:G.Browser.msPointer?"MSPointerDown":G.Browser.pointer?"pointerdown":"touchstart",statics:{BASE_CLS:"leaflet-contextmenu"},initialize:function(t){G.Handler.prototype.initialize.call(this,t),this._items=[],this._visible=!1;var e=this._container=G.DomUtil.create("div",G.Map.ContextMenu.BASE_CLS,t._container);e.style.zIndex=1e4,e.style.position="absolute",t.options.contextmenuWidth&&(e.style.width=t.options.contextmenuWidth+"px"),this._createItems(),G.DomEvent.on(e,"click",G.DomEvent.stop).on(e,"mousedown",G.DomEvent.stop).on(e,"dblclick",G.DomEvent.stop).on(e,"contextmenu",G.DomEvent.stop)},addHooks:function(){var t=this._map.getContainer();G.DomEvent.on(t,"mouseleave",this._hide,this).on(document,"keydown",this._onKeyDown,this),G.Browser.touch&&G.DomEvent.on(document,this._touchstart,this._hide,this),this._map.on({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},removeHooks:function(){var t=this._map.getContainer();G.DomEvent.off(t,"mouseleave",this._hide,this).off(document,"keydown",this._onKeyDown,this),G.Browser.touch&&G.DomEvent.off(document,this._touchstart,this._hide,this),this._map.off({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},showAt:function(t,e){t instanceof G.LatLng&&(t=this._map.latLngToContainerPoint(t)),this._showAtPoint(t,e)},hide:function(){this._hide()},addItem:function(t){return this.insertItem(t)},insertItem:function(t,e){e=void 0!==e?e:this._items.length;var n=this._createItem(this._container,t,e);return this._items.push(n),this._sizeChanged=!0,this._map.fire("contextmenu.additem",{contextmenu:this,el:n.el,index:e}),n.el},removeItem:function(t){var e=this._container;return isNaN(t)||(t=e.children[t]),t?(this._removeItem(G.Util.stamp(t)),this._sizeChanged=!0,this._map.fire("contextmenu.removeitem",{contextmenu:this,el:t}),t):null},removeAllItems:function(){for(var t=this._container.children,e=void 0;t.length;)e=t[0],this._removeItem(G.Util.stamp(e));return t},hideAllItems:function(){var t,e=void 0;for(e=0,t=this._items.length;e<t;e++)this._items[e].el.style.display="none"},showAllItems:function(){var t,e=void 0;for(e=0,t=this._items.length;e<t;e++)this._items[e].el.style.display=""},setDisabled:function(t,e){var n=this._container,i=G.Map.ContextMenu.BASE_CLS+"-item";isNaN(t)||(t=n.children[t]),t&&G.DomUtil.hasClass(t,i)&&(e?(G.DomUtil.addClass(t,i+"-disabled"),this._map.fire("contextmenu.disableitem",{contextmenu:this,el:t})):(G.DomUtil.removeClass(t,i+"-disabled"),this._map.fire("contextmenu.enableitem",{contextmenu:this,el:t})))},isVisible:function(){return this._visible},_createItems:function(){var t,e=this._map.options.contextmenuItems,n=void 0;for(n=0,t=e.length;n<t;n++)this._items.push(this._createItem(this._container,e[n]))},_createItem:function(t,e,n){if(e.separator||"-"===e)return this._createSeparator(t,n);var i=G.Map.ContextMenu.BASE_CLS+"-item",r=e.disabled?i+" "+i+"-disabled":i,o=this._insertElementAt("a",r,t,n),s=this._createEventHandler(o,e.callback,e.context,e.hideOnSelect),a=this._getIcon(e),u=this._getIconCls(e),l="";return a?l='<img class="'+G.Map.ContextMenu.BASE_CLS+'-icon" src="'+a+'"/>':u&&(l='<span class="'+G.Map.ContextMenu.BASE_CLS+"-icon "+u+'"></span>'),o.innerHTML=l+e.text,o.href="#",G.DomEvent.on(o,"mouseover",this._onItemMouseOver,this).on(o,"mouseout",this._onItemMouseOut,this).on(o,"mousedown",G.DomEvent.stopPropagation).on(o,"click",s),G.Browser.touch&&G.DomEvent.on(o,this._touchstart,G.DomEvent.stopPropagation),G.Browser.pointer||G.DomEvent.on(o,"click",this._onItemMouseOut,this),{id:G.Util.stamp(o),el:o,callback:s}},_removeItem:function(t){var e,n=void 0,i=void 0,r=void 0,o=void 0;for(r=0,e=this._items.length;r<e;r++)if((n=this._items[r]).id===t)return i=n.el,(o=n.callback)&&(G.DomEvent.off(i,"mouseover",this._onItemMouseOver,this).off(i,"mouseover",this._onItemMouseOut,this).off(i,"mousedown",G.DomEvent.stopPropagation).off(i,"click",o),G.Browser.touch&&G.DomEvent.off(i,this._touchstart,G.DomEvent.stopPropagation),G.Browser.pointer||G.DomEvent.on(i,"click",this._onItemMouseOut,this)),this._container.removeChild(i),this._items.splice(r,1),n;return null},_createSeparator:function(t,e){var n=this._insertElementAt("div",G.Map.ContextMenu.BASE_CLS+"-separator",t,e);return{id:G.Util.stamp(n),el:n}},_createEventHandler:function(e,n,i,r){var o=this,s=this._map,a=G.Map.ContextMenu.BASE_CLS+"-item-disabled";r=void 0===r||r;return function(t){G.DomUtil.hasClass(e,a)||(r&&o._hide(),n&&(console.log(o),n.call(i||s,o._showLocation)),o._map.fire("contextmenu.select",{contextmenu:o,el:e}))}},_insertElementAt:function(t,e,n,i){var r=void 0,o=document.createElement(t);return o.className=e,void 0!==i&&(r=n.children[i]),r?n.insertBefore(o,r):n.appendChild(o),o},_show:function(t){this._showAtPoint(t.containerPoint,t)},_showAtPoint:function(t,e){if(this._items.length){var n=this._map,i=n.containerPointToLayerPoint(t),r=n.layerPointToLatLng(i),o=G.extend(e||{},{contextmenu:this});this._showLocation={latlng:r,layerPoint:i,containerPoint:t},e&&e.relatedTarget&&(this._showLocation.relatedTarget=e.relatedTarget),this._setPosition(t),this._visible||(this._container.style.display="block",this._visible=!0),this._map.fire("contextmenu.show",o)}},_hide:function(){this._visible&&(this._visible=!1,this._container.style.display="none",this._map.fire("contextmenu.hide",{contextmenu:this}))},_getIcon:function(t){return G.Browser.retina&&t.retinaIcon||t.icon},_getIconCls:function(t){return G.Browser.retina&&t.retinaIconCls||t.iconCls},_setPosition:function(t){var e=this._map.getSize(),n=this._container,i=this._getElementSize(n),r=void 0;this._map.options.contextmenuAnchor&&(r=G.point(this._map.options.contextmenuAnchor),t=t.add(r)),(n._leaflet_pos=t).x+i.x>e.x?(n.style.left="auto",n.style.right=Math.min(Math.max(e.x-t.x,0),e.x-i.x-1)+"px"):(n.style.left=Math.max(t.x,0)+"px",n.style.right="auto"),t.y+i.y>e.y?(n.style.top="auto",n.style.bottom=Math.min(Math.max(e.y-t.y,0),e.y-i.y-1)+"px"):(n.style.top=Math.max(t.y,0)+"px",n.style.bottom="auto")},_getElementSize:function(t){var e=this._size,n=t.style.display;return e&&!this._sizeChanged||(e={},t.style.left="-999999px",t.style.right="auto",t.style.display="block",e.x=t.offsetWidth,e.y=t.offsetHeight,t.style.left="auto",t.style.display=n,this._sizeChanged=!1),e},_onKeyDown:function(t){27===t.keyCode&&this._hide()},_onItemMouseOver:function(t){G.DomUtil.addClass(t.target||t.srcElement,"over")},_onItemMouseOut:function(t){G.DomUtil.removeClass(t.target||t.srcElement,"over")}}),G.Map.addInitHook("addHandler","contextmenu",G.Map.ContextMenu),G.Map.mergeOptions({zoomControl:!1,attributionControl:!1}),G.Map.include({getPopup:function(){return this._popup},getScale:function(){var t=this.getBounds(),e=this.getSize(),n=111*((t.getNorthEast().lng-t.getSouthWest().lng)/e.x)*1e3*100*G.Util.getDPI()/2.54;return Math.round(n)}}),G.Icon.Default.mergeOptions({iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==",iconRetinaUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAYAAAAWy4frAAAPiElEQVR42t1bCVCU5xkmbabtZJJOO+l0mhgT0yQe0WXZgz2570NB8I6J6UzaTBoORRFEruVGDhWUPRAQRFFREDnVxCtEBRb24DBNE3Waaatpkmluo4m+fd9v999olGVBDu3OPLj+//s+7/W93/f9//6/EwA4/T9g3AlFOUeeUGR2uMqzOyJk2R2x0qyOAmnmkS3SrCPrZJlHlsqzjypcs49OX1Jf//P7KhD885A0u10my2ovQscvybI6wEF8ivI7pFntAV6qkw9PWSBK1bEnZRltm2WZ7R8h4FbI0VG33GPgXXgCAra+A4EIn8KT4JH/FigoiJ/IIz6TZbVVKLLan5u0QESqlkckWW3p0sy2bxDAgZwO13TDytoB+NPe9+zild2DEFGuB7/NpzDodriF55o0o7XIRXXoNxMaiCSj9VU09C8EENxyj0C4thterh2EV+veuwOr6s7Dy3ssoO93k3llzxBE6PTgkXcMOF7EJ9KMtqjR9JFDQnNV9b+QqlqqEECQZ7TBgu1nYdXuIXgVneSwYtcgRFb1Q1iFGULLzRCsM90GOrZghxkiKvthec0grLpFlxCu6cKh1w6cHUSbctPhx8YlEElu4+NSVfNpBBACtpyGlbsGmBOElRhMBDofgk4GobOjQXC5CRZiUC/VDtn4qLrBJZ3A2cNg+nE4P31PgSDBbImq5UNJejMQFqi7cCicZ3iZBTAAQVoTBI4DKKCVGBDHH6nrBRlWxWr7sljVIhlTIDLVoRkS1eH/SNIPgzyzFRZV9NnG++LqQcyoGQLQgfFEIFYpcueAzc6SSiMOtTYgH9CXr+WpTbxRBeKlqn9UktZkRoACZ5PlO81YgfMM4RX9EKAxTSjCdvTjELPYW17dD8rsdiBfEBclSY2POxQIHnlIknroEAJk6U2wpMLISF/aNQShWAV/tWlSEIK2VqBNsr200gRyGmLokyS18cTdFtA7AnFNbcxAACGMrQtDLAjqBT+1cVJBNsk2+bBQ1wOcX5K0xs12A8GyzXRNafgeAYFb3mEkrBI4I/mWGUeNQI1lyp2PoO9j4aDKcH4Ebe0E8g3xgyylcc6wgbimNjSSoFtWK1sTqLRh2BM+SOgIfDGLJL8IG3ZZjUX/ViyvGYLFOwdZn/ljYI7yzsee4TjcsV/IR3FqQ+tdAxEnNSjFyQeBEK7pgRVodEnVIPhsNzqEYK0ZluFsRnq3YjH22KJyA6z4yTmSpZ5zlH8RTvWkt1CrB85PYUqjzx2BuG6sPyfeeAA8sjtwphhiCFSbwXub0S7ISPiOAZvO4h048xSfBM+cDpDieCZOggSz6JHdBv5FJ3CN6LPJR1QMgO9204h2aALgdDxzjlp4kw8YaHKyBSJJPigWb6wHQiRmbxkKL0QDXkhgD94YxGKsGskTQkvfxVnlIHBcBNfkegziwB3HAnHDuGynRXcp/utXZhrRHiWM5CPLjbdwHVDYAhFt3J8rTtoPbpktSDrE4INZ8iw12kUYEpPs4kozeOW0A3EQIovbYcfxITj798vwxbfX4Or1H8B46ROo7fwbvKY9bpNzy2hmiSOOyMrBEe2RT5x/7tjHxCFK2l/4YyBJ+95HQABmibKzEJvRs9RgF4FqE5MleGS3AumLN+6D4lYjfIeOD/e5eROg7sz7oEg7wHRk6Y3Yi/2MJwT7bCS75BvJBuGsSvqID1ggaHyeaAMeQERgyajBg3BG8SgxDAsvJFxUOcBkg7d0Ml3XjfuhCyvg6Ofix1+Al6qB6fpueotxsckFh5A92+QbydHw4vymGJxEG+rWiRL3goJWcSwvwbPECO5bDcMiRGNmchS4a1I9kP62DhOM9tPad4npEhaUdTPOsPJ+u7bJN85PpaqJ6YoT6xKcRIl1pQjwxIukxXhyIY57N1Swh7DyASbrm38MSHdRUStc+/4GjOUTV32acbhlNjNO6pWR7FPTk6xX3lGmK0ys0zrhn0Zhwh7wK3ibnVyg6we3LQa7WFQxyGSpiqRbe/o8jPXTe+EK4xDjECHOxdYRYc8++UhyfgXHma5w/Z5mJ+H63T3ChN3Y6O/guMcxj8NGicLDgYyQ3CKcnsUbMBuoa7j48ZgD+erqdczqbsYTpulj3LSu2POBfCQ58pn0EH1OwoTafwvX1+JV2VmIxEwHlJlBsdkwLHy2mZjcgjI9kJ4Ynbh6/Xu4l09YfhPjCsSJg7hpIbbng/92M5Mjn0kPcdlJGF/7JQJCSrsgAseeHzoqL+4bFnSe5EJKzgHpeaTsg3v9rCrtYFz+hScZdzAGYs8HX84H9Jn0KAYnQfyuIQT4Y5mo0akiMhQeDh44tEguXGcE0iP845MvxxzEjRs3QZ5Ux3hCtnUxbqq6PR/8cRdAcuSz1YfzGEhNm2BdDfjkvw0LcTYKokCK+oaFAolIjiDFBYl02/oujDmQC1c+ZxzC+BoIp2t35HXHPrDnA/lIcuQz6SKOOAnWVqsRbHscjidDNf0gRWF7CNX2M1l3VTOQbmpd55gDqT01xDhkmBTiJMhGsB+isdrPbGe6wrU15RjIzkQEyHB3GqYbYCAiSeHwCMBmI7mAYiwt6grX7QT9h5dHHcQ/P/sKlEm7GYd37lHGGaLut2tbirD5iT6TriCuKsVJsLrCwyWuih2Yj/unMC2VFlfsgr5hodxsZHIEZVoTkP787APw7TXHZy/ac/25rJ3pSpP24tRrZnyeW012bbtZbS9AefKZ+b6mMtjJS6V6GP/zOR3wK+pkQn7bzHbJCCRDsqFlBpz+djHCV7a2wMUr/x0xiM++ugprq45bnFhbhdNoF+MKLOt32C75SvqIb7xUO3/Fdr/8uMqDLmsqwU3VipH2QzA2k3hTr11ICnqZHMn7F+HCFIfZQQ5JfDVUvW1mzv708/V316FV/wF4Je9hsgSv3GOMYz71Jg6bkezS0CN5N1WLhSOussW2jResrnzNZXUFm5PnW0nl2CciVLQHebHBJh9U0g1S3GYQD4eQjH2QWH0C0utw15DXAEIybD0nxoUsYPMZmz4N59HYE+K0SzyC2Mo3bIHw4zTT+Kt33ESAX/FZCMWovUtMIMzvHRFKJA9G+VAGvJ7IPsKGC3HdDYI4qnwzhJQZmQ5l2AODcMSWb6mJ6fgWn+H4bsxbWzX9tmt2l9Xl7fzYcpwJGhl5MI5XESoL8kaGKB9XWww8xOoYIXBrD3hvOgnK9BbEYdypHsctSBcGYLbJ+FMvbupz2AanJ01uAPLVJab88B03H1xidKH8WB0TCCq1KNEM4YgRDm7FRlys+m8L6G6gJLmPkpuqxhJU0st8JF8FMeV+dwTipFL9zDlGewmB1wYdzJh/qRlccntHDcqevBCv6NBZ3xIz+CGP5xYTKIoMIMZzo+UTIAK3WRKgULUB+egcrTs/7A06XpQ20Tlai+O4mm0DKLuSAgPwkWgqIcOkkC+BOBRdVlcC+ciL0kUNG4jodd3vnKM13yHAK/8UBG6nTBrBOUc/pfDBRZJ88cg9DuQbL1rzxdw3yx61exPbOUazi4Rd8VqYMhBIwyunF5yz9VMCUV6vxQ+ECJcH8s05SlMy4t145xi1jAkjfIu7GIESxzYPSacC1Gfkg3fhGbD6ddMlVvuCQz/0oHAfKclSmiAAK0JN75zdC/Oy9JMKanKyTxBvOGAJJEbd4fAvVrxo9UukxMfZwbu4hwWiKDLCXCSfTNAUTba9Cs5x1SD4OBwIm4qjNQOkKE1uBH+aQkssVZmbqZ8UCLAvyS5BnLDf2hvaE6P+MZQfpYngsuBd2A1+W7EqBUZ4MUM/KXAvMjGbHvm23gCXaI1yTD9Po7KezWBJB8EXp0ACD0s+J6NnQkGzJGdPlFDHBdI+5t/Z+dGaQC4bHpvOgg+uznJcIGereiYUykIjs+WW22mrBi9WLbqnJx9wlugkIlHifvBGcgLNKLPQ4ESA+pCzI4jfwy2Ajff8CAduWzy4rLjnnWEGqFdmpfdMCKgaZEOZc5qrxg3nWM28cXmohhetPcqqsn4veG02MczDmWVmWs+4wjmr18YvWFfLBVI3bk8HubxZ5spVRZHTyQzJsSovoPHxhAKrQdyKrFNcED/wo8pnjuvzWrgHayJyIY5bz2ITw1ycJp9P7R4X8LDCHK/L2l0sEH60tmrcHzzjRet4tM9hVck+xQzKNxnGLRDqO+KUZZ7gqnHdZY1mxoQ8QUfjlYwI1taCBy5YBKrKcynd9wTqNwufEfhrqq17Ko16wh4FpPFK45ZtKDNOgnshZjDfAH9M7r4nyPONjEua/hZXjav8NzTTJvThTF6UppJtF+JqwA2NE15U6eFZdGgsmJvRyziUeBXIX7PT2huazRP+lKkgavszeM18jW0oVcfBrYCqYoRnN3aPGlw1iMM17ai1Gtqvnd/Q/H5SnvvF7f12ljkcz0psUmWBpSoz0LnRgKpBugq6L8CuxSkQde6kPcAsWqN7Ao1+yzaUacdAsckI0jwDPJPU5TBmbOxi/UW64pQOrjc+5/1V/dtJfRIbrw0KWFVWV+Hw6GNDZE6aHp7e0OUQ5qTrmY48rw/4sRWW3ojSpk36I+Wzo7Y/7hyl+ZJtXVI7WJ+45hrgacz29A32QTISrCDpiJLbuWp8Oiuh8jGYiof8eTHqDEtVKkCGmZVZqzI9scsuSIZkZXTfKnYHt8NNmLK3FaQxpb9GJz5jVcHMclWhrD+VeHfQsJLkWqohTGrlqnFZ9LrukSl97YIXpU5kVcHMSvDKTppnhNmY8WkJXXcFnSMZSY6e3cO1ruKxU/7+CGUSnbnCti4bWjHbOAvlGOApdPrJ9beDjtE5khFsaOaq8dHzMaW/vC/e6KGMWm4flYMku4cNnVmpPej8udtA1aBzrll47RGjs/aG+vX75tUkyihl1lKVZnDFrIuy+2AaOv9EvAX0nY7ROZeEJq4aF+g3zPvqHStejOYvlvGuA1FmNxtCM1P18AcMgjALv9MxYWaX9WcBktWuuu9eFqPM4mbvAzbEEg5h9tHpLIOtP+g7HeMnNHLVeG/JkvF7YWxc33jDqqy0ZhoEKovzM1P0DPSdjtFvG5ZVXLP0vn19z3KrVTvIHF3fYHHeCvruHN/AbdNN3PO69+17iLgzjrRux8El/SwIMg0M9P3HG9HqsPv+hUrrJXEvczj+AAbRx+AcX88F0v1AvBnKAnlTG8Rln5/6LuLHW5/zorT+D0wg1qq8y5xfu88CSyCnH5h3dW/ZGXve8uOMZRWP0no8cIFY7+YfswURrT36QL09ffsMppHYegW/P7CBWHvlMOGBe5/9jtdjY7R8wkTb+R9meZA6n2oJWAAAAABJRU5ErkJggg==",shadowUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII="}),G.Icon.Default.include({_getIconUrl:function(t){return G.Icon.prototype._getIconUrl.call(this,t)}}),G.Control.Attribution.mergeOptions({prefix:"超擎地图"}),G.extend(G.Util,{clone:function(t){if(!t)return null;var e=JSON.stringify(t);return JSON.parse(e)},sortObject:function(t,r,o){t&&0!==t.length&&t.sort(function(t,e){var n=t[r],i=e[r];return o?n-i:i-n})},getAngle:function(t,e,n,i){var r=Math.abs(t-n),o=Math.abs(e-i),s=o/Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),a=Math.acos(s),u=Math.floor(180/(Math.PI/a));return t<n&&e<i&&(u=180-u),n===t&&e<i&&(u=180),t<n&&i===e&&(u=90),n<t&&e<i&&(u=180+u),n<t&&i===e&&(u=270),n<t&&i<e&&(u=360-u),u},getDPI:function(){var t=void 0;if(window&&void 0!==window.screen.deviceXDPI)t=window.screen.deviceXDPI;else{var e=document.createElement("DIV");e.style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden",document.body.appendChild(e),t=parseInt(e.offsetWidth),e.parentNode.removeChild(e)}return t}}),G.GridLayer.include({_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(this.options.noWrap&&(t.x<0||t.x>n.max.x))return!1;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return G.latLngBounds(this.options.bounds).overlaps(i)}}),G.Mixin.ContextMenu={bindContextMenu:function(t){return G.setOptions(this,t),this._initContextMenu(),this},unbindContextMenu:function(){return this.off("contextmenu",this._showContextMenu,this),this},addContextMenuItem:function(t){this.options.contextmenuItems.push(t)},removeContextMenuItemWithIndex:function(t){for(var e=[],n=0;n<this.options.contextmenuItems.length;n++)this.options.contextmenuItems[n].index==t&&e.push(n);for(var i=e.pop();void 0!==i;)this.options.contextmenuItems.splice(i,1),i=e.pop()},replaceContextMenuItem:function(t){this.removeContextMenuItemWithIndex(t.index),this.addContextMenuItem(t)},_initContextMenu:function(){this._items=[],this.on("contextmenu",this._showContextMenu,this)},_showContextMenu:function(t){var e=void 0,n=void 0,i=void 0,r=void 0,o=void 0;if(this._map.contextmenu){for(n=G.extend({relatedTarget:this},t),i=this._map.mouseEventToContainerPoint(t.originalEvent),this.options.contextmenuInheritItems||this._map.contextmenu.hideAllItems(),r=0,o=this.options.contextmenuItems.length;r<o;r++)e=this.options.contextmenuItems[r],this._items.push(this._map.contextmenu.insertItem(e,e.index));this._map.once("contextmenu.hide",this._hideContextMenu,this),this._map.contextmenu.showAt(i,n)}},_hideContextMenu:function(){var t,e=void 0;for(e=0,t=this._items.length;e<t;e++)this._map.contextmenu.removeItem(this._items[e]);this._items.length=0,this.options.contextmenuInheritItems||this._map.contextmenu.showAllItems()}};var t,i=[G.Marker,G.Path],r={contextmenu:!1,contextmenuItems:[],contextmenuInheritItems:!0},o=void 0,s=void 0;for(s=0,t=i.length;s<t;s++)(o=i[s]).prototype.options?o.mergeOptions(r):o.prototype.options=r,o.addInitHook(function(){this.options.contextmenu&&this._initContextMenu()}),o.include(G.Mixin.ContextMenu);var a=G.Marker.prototype._initIcon,u=G.Marker.prototype._setPos,l="msTransform"===G.DomUtil.TRANSFORM;G.Marker.addInitHook(function(){var t=this.options.icon&&this.options.icon.options&&this.options.icon.options.iconAnchor;t&&(t=t[0]+"px "+t[1]+"px"),this.options.rotationOrigin=this.options.rotationOrigin||t||"center bottom",this.options.rotationAngle=this.options.rotationAngle||0,this.on("drag",function(t){t.target._applyRotation()})}),G.Marker.include({_initIcon:function(){a.call(this)},_setPos:function(t){u.call(this,t),this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[G.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,l?this._icon.style[G.DomUtil.TRANSFORM]="rotate("+this.options.rotationAngle+"deg)":this._icon.style[G.DomUtil.TRANSFORM]+=" rotateZ("+this.options.rotationAngle+"deg)")},setRotationAngle:function(t){return this.options.rotationAngle=t,this.update(),this},setRotationOrigin:function(t){return this.options.rotationOrigin=t,this.update(),this}});var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),p=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},f=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},d=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},y=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},b=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)};!function(n){var i={};function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=n,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,r=(i=n(3))&&i.__esModule?i:{default:i},o=L.Class.extend({includes:[r.default],options:{snappable:!0,snapDistance:20,cursorMarker:!0,finishOnDoubleClick:!1,finishOn:null,allowSelfIntersection:!0,templineStyle:{},hintlineStyle:{dashArray:"5,5"},markerStyle:{draggable:!0}},initialize:function(t){var e=this;this._map=t,this.shapes=["Marker","Line","Poly","Rectangle","Circle","Cut"],this.shapes.forEach(function(t){e[t]=new L.PM.Draw[t](e._map)})},setPathOptions:function(t){this.options.pathOptions=t},getShapes:function(){return this.shapes},enable:function(t,e){if(!t)throw new Error("Error: Please pass a shape as a parameter. Possible shapes are: ".concat(this.getShapes().join(",")));this.disable(),this[t].enable(e)},disable:function(){var e=this;this.shapes.forEach(function(t){e[t].disable()})},addControls:function(){var e=this;this.shapes.forEach(function(t){e[t].addButton()})}});e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n(3)),r=o(n(27));function o(t){return t&&t.__esModule?t:{default:t}}var s=L.Class.extend({includes:[r.default,i.default],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,draggable:!0},isPolygon:function(){return this._layer instanceof L.Polygon}});e.default=s},function(t,e,n){function i(t,e,n){if(!a(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!s(t))throw new Error("bbox must only contain numbers")})}(i),r&&function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(void 0===t?"undefined":g(t)))throw new Error("id must be a number or a string")}(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function r(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!s(t[0])||!s(t[1]))throw new Error("coordinates must contain numbers");return i({type:"Point",coordinates:t},e,n)}function o(t,e,n){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!s(t[0][1])||!s(t[0][1]))throw new Error("coordinates must contain numbers");return i({type:"LineString",coordinates:t},e,n)}function s(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function a(t){return!!t&&t.constructor===Object}n.d(e,"a",function(){return i}),n.d(e,"e",function(){return r}),n.d(e,"d",function(){return o}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return a})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={_initSnappableMarkers:function(){this.options.snapDistance=this.options.snapDistance||30,this.isPolygon()?this._markers.map(this._assignEvents,this):this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_assignEvents:function(t){var e=this;t.forEach(function(t){t.off("drag",e._handleSnapping,e),t.on("drag",e._handleSnapping,e),t.off("dragend",e._cleanupSnapping,e),t.on("dragend",e._cleanupSnapping,e)})},_unsnap:function(){delete this._snapLatLng},_cleanupSnapping:function(){delete this._snapList,this._map.off("pm:remove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(function(t){t.remove()})},_handleSnapLayerRemoval:function(t){var e=t.layer,n=this._snapList.findIndex(function(t){return t._leaflet_id===e._leaflet_id});this._snapList.splice(n,1)},_handleSnapping:function(t){if(t.originalEvent.altKey)return!1;if(void 0===this._snapList&&this._createSnapList(t),this._snapList.length<=0)return!1;var e,n=t.target,i=this._calcClosestLayer(n.getLatLng(),this._snapList);e=i.layer instanceof L.Marker||i.layer instanceof L.CircleMarker?i.latlng:this._checkPrioritiySnapping(i);var r=this.options.snapDistance,o={marker:n,snapLatLng:e,segment:i.segment,layer:this._layer,layerInteractedWith:i.layer};if(i.distance<r){n.setLatLng(e),n._snapped=!0;var s=this._snapLatLng||{},a=e||{};s.lat===a.lat&&s.lng===a.lng||(this._snapLatLng=e,n.fire("pm:snap",o),this._layer.fire("pm:snap",o))}else this._snapLatLng&&(this._unsnap(o),n._snapped=!1,o.marker.fire("pm:unsnap",o),this._layer.fire("pm:unsnap",o));return!0},_checkPrioritiySnapping:function(t){var e,n=this._map,i=t.segment[0],r=t.segment[1],o=t.latlng,s=this._getDistance(n,i,o),a=this._getDistance(n,r,o),u=s<a?i:r;return e=(s<a?s:a)<this.options.snapDistance?u:o,Object.assign({},e)},_createSnapList:function(){var n=this,i=[],r=[],o=this._map;o.eachLayer(function(t){if(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.CircleMarker){i.push(t),o.off("pm:remove",n._handleSnapLayerRemoval,n),o.on("pm:remove",n._handleSnapLayerRemoval,n);var e=L.polyline([],{color:"red",pmIgnore:!0});r.push(e)}}),i=(i=(i=i.filter(function(t){return n._layer!==t})).filter(function(t){return t._latlng||t._latlngs&&0<t._latlngs.length})).filter(function(t){return!t._pmTempLayer}),this._otherSnapLayers?this._snapList=i.concat(this._otherSnapLayers):this._snapList=i,this.debugIndicatorLines=r},_calcClosestLayer:function(i,t){var r=this,o={};return t.forEach(function(t,e){var n=r._calcLayerDistances(i,t);r.debugIndicatorLines[e].setLatLngs([i,n.latlng]),(void 0===o.distance||n.distance<o.distance)&&((o=n).layer=t)}),o},_calcLayerDistances:function(t,e){var s,a,u,l=this,h=this._map,c=e instanceof L.Polygon,n=!(e instanceof L.Polygon)&&e instanceof L.Polyline,i=e instanceof L.Marker||e instanceof L.CircleMarker,p=t;if(c)s=e.getLatLngs()[0];else if(n)s=e.getLatLngs();else if(i)return s=e.getLatLng(),{latlng:Object.assign({},s),distance:this._getDistance(h,s,p)};s.forEach(function(t,e){var n,i=t;n=c?e+1===s.length?0:e+1:e+1===s.length?void 0:e+1;var r=s[n];if(r){var o=l._getDistanceToSegment(h,p,i,r);(void 0===u||o<u)&&(u=o,a=[i,r])}return!0});var r=this._getClosestPointOnSegment(h,t,a[0],a[1]);return{latlng:Object.assign({},r),segment:a,distance:u}},_getClosestPointOnSegment:function(t,e,n,i){var r=t.getMaxZoom();r===1/0&&(r=t.getZoom());var o=t.project(e,r),s=t.project(n,r),a=t.project(i,r),u=L.LineUtil.closestPointOnSegment(o,s,a);return t.unproject(u,r)},_getDistanceToSegment:function(t,e,n,i){var r=t.latLngToLayerPoint(e),o=t.latLngToLayerPoint(n),s=t.latLngToLayerPoint(i);return L.LineUtil.pointToSegmentDistance(r,o,s)},_getDistance:function(t,e,n){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(n))}};e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var v=n(2);e.default=function(t){var e,n,m={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach(function(_){e.forEach(function(t){for(var e=0;e<_.length-1;e++)for(var n=e;n<t.length-1;n++){if(_===t){if(1===Math.abs(e-n))continue;if(0===e&&n===_.length-2&&_[e][0]===_[_.length-1][0]&&_[e][1]===_[_.length-1][1])continue}var i=(r=_[e][0],o=_[e][1],s=_[e+1][0],a=_[e+1][1],u=t[n][0],l=t[n][1],h=t[n+1][0],y=g=d=f=void 0,y={x:null,y:null,onLine1:!1,onLine2:!1},0==(p=((c=t[n+1][1])-l)*(s-r)-(h-u)*(a-o))?null!==y.x&&null!==y.y&&y:(g=(s-r)*(f=o-l)-(a-o)*(d=r-u),f=((h-u)*f-(c-l)*d)/p,d=g/p,y.x=r+f*(s-r),y.y=o+f*(a-o),0<=f&&f<=1&&(y.onLine1=!0),0<=d&&d<=1&&(y.onLine2=!0),!(!y.onLine1||!y.onLine2)&&[y.x,y.y]));i&&m.features.push(Object(v.e)([i[0],i[1]]))}var r,o,s,a,u,l,h,c,p,f,d,g,y})}),m}},function(t,o,e){function a(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function i(t,e,n){return void 0===n&&(n={}),a({type:"Point",coordinates:t},e,n)}function r(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return a({type:"Polygon",coordinates:t},e,n)}function s(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:t},e,n)}function u(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function l(t,e,n){return void 0===n&&(n={}),a({type:"MultiLineString",coordinates:t},e,n)}function h(t,e,n){return void 0===n&&(n={}),a({type:"MultiPoint",coordinates:t},e,n)}function c(t,e,n){return void 0===n&&(n={}),a({type:"MultiPolygon",coordinates:t},e,n)}function p(t,e){void 0===e&&(e="kilometers");var n=o.factors[e];if(!n)throw new Error(e+" units is invalid");return t*n}function f(t,e){void 0===e&&(e="kilometers");var n=o.factors[e];if(!n)throw new Error(e+" units is invalid");return t/n}function n(t){return t%(2*Math.PI)*180/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(o,"__esModule",{value:!0}),o.earthRadius=6371008.8,o.factors={centimeters:100*o.earthRadius,centimetres:100*o.earthRadius,degrees:o.earthRadius/111325,feet:3.28084*o.earthRadius,inches:39.37*o.earthRadius,kilometers:o.earthRadius/1e3,kilometres:o.earthRadius/1e3,meters:o.earthRadius,metres:o.earthRadius,miles:o.earthRadius/1609.344,millimeters:1e3*o.earthRadius,millimetres:1e3*o.earthRadius,nauticalmiles:o.earthRadius/1852,radians:1,yards:o.earthRadius/1.0936},o.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/o.earthRadius,yards:1/1.0936},o.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},o.feature=a,o.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return i(e).geometry;case"LineString":return s(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return h(e).geometry;case"MultiLineString":return l(e).geometry;case"MultiPolygon":return c(e).geometry;default:throw new Error(t+" is invalid")}},o.point=i,o.points=function(t,e,n){return void 0===n&&(n={}),u(t.map(function(t){return i(t,e)}),n)},o.polygon=r,o.polygons=function(t,e,n){return void 0===n&&(n={}),u(t.map(function(t){return r(t,e)}),n)},o.lineString=s,o.lineStrings=function(t,e,n){return void 0===n&&(n={}),u(t.map(function(t){return s(t,e)}),n)},o.featureCollection=u,o.multiLineString=l,o.multiPoint=h,o.multiPolygon=c,o.geometryCollection=function(t,e,n){return void 0===n&&(n={}),a({type:"GeometryCollection",geometries:t},e,n)},o.round=function(t,e){if(void 0===e&&(e=0),e&&!(0<=e))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},o.radiansToLength=p,o.lengthToRadians=f,o.lengthToDegrees=function(t,e){return n(f(t,e))},o.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},o.radiansToDegrees=n,o.degreesToRadians=function(t){return t%360*Math.PI/180},o.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(0<=t))throw new Error("length must be a positive number");return p(f(t,e),n)},o.convertArea=function(t,e,n){if(void 0===e&&(e="meters"),void 0===n&&(n="kilometers"),!(0<=t))throw new Error("area must be a positive number");var i=o.areaFactors[e];if(!i)throw new Error("invalid original units");var r=o.areaFactors[n];if(!r)throw new Error("invalid final units");return t/i*r},o.isNumber=d,o.isObject=function(t){return!!t&&t.constructor===Object},o.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!d(t))throw new Error("bbox must only contain numbers")})},o.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(void 0===t?"undefined":g(t)))throw new Error("id must be a number or a string")},o.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},o.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},o.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},o.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},o.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},o.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},o.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},function(t,e,n){n.d(e,"b",function(){return r}),n.d(e,"a",function(){return o});var h=n(2);function i(t,e){var n,i,r,o,s,a,u,l,h,c,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:d?t.geometry:t,l=f?t.features[n].properties:d?t.properties:{},h=f?t.features[n].bbox:d?t.bbox:void 0,c=f?t.features[n].id:d?t.id:void 0,s=(u=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=u?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,p,l,h,c))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],p,l,h,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,l,h,c))return!1;p++}}function r(t,o,s){var a=s;return i(t,function(t,e,n,i,r){a=0===e&&void 0===s?t:o(a,t,e,n,i,r)}),a}function o(t,l){i(t,function(t,e,n,i,r){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==l(Object(h.a)(t,n,{bbox:i,id:r}),e,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var a=0;a<t.coordinates.length;a++){var u={type:o,coordinates:t.coordinates[a]};if(!1===l(Object(h.a)(u,n),e,a))return!1}})}},function(t,e,n){t.exports=n(8)},function(t,e,n){n(9);var i=n(10),r=u(n(11)),o=u(n(12)),s=u(n(0));n(14),n(15),n(16),n(17),n(18),n(19);var a=u(n(1));function u(t){return t&&t.__esModule?t:{default:t}}n(28),n(29),n(30),n(31),n(32),n(33),n(34),n(35),L.PM=L.PM||{Map:r.default,Toolbar:o.default,Draw:s.default,Edit:a.default,version:i.version,initialize:function(){this.addInitHooks()},addInitHooks:function(){L.Map.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Map(this))}),L.LayerGroup.addInitHook(function(){this.pm=new L.PM.Edit.LayerGroup(this)}),L.Marker.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Marker(this))}),L.Polyline.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}),L.Polygon.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Poly(this))}),L.Rectangle.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}),L.Circle.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))})}},L.PM.initialize()},function(t,e,n){Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),n=e.length>>>0,i=arguments[1],r=0;r<n;r++)if(t.call(i,e[r],r,e))return r;return-1},Array.prototype.find=Array.prototype.find||function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),n=e.length>>>0,i=arguments[1],r=0;r<n;r++){var o=e[r];if(t.call(i,o,r,e))return o}},"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var n=arguments[e];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})},function(t,e){t.exports={name:"leaflet.pm",version:"0.24.0",description:"A Leaflet Plugin For Editing Geometry Layers in Leaflet 1.0",keywords:["leaflet","polygon management","geometry editing","map data","map overlay","polygon","geojson","leaflet-draw","data-field-geojson","ui-leaflet-draw"],files:["dist"],main:"dist/leaflet.pm.min.js",dependencies:{"@turf/difference":"^5.1.5","@turf/intersect":"^6.1.2","@turf/kinks":"^5.1.5"},devDependencies:{"@babel/core":"^7.0.0-beta.40","@babel/preset-env":"^7.0.0-beta.40","babel-loader":"^8.0.0-beta.0","css-loader":"^0.28.0",eslint:"^4.18.2","eslint-config-airbnb-base":"^12.1.0","eslint-plugin-import":"^2.9.0","extract-text-webpack-plugin":"^3.0.2","file-loader":"^0.11.1",leaflet:"^1.3.1","style-loader":"^0.19.0",tape:"^4.9.0","tape-run":"^3.0.4","uglifyjs-webpack-plugin":"^1.1.0","url-loader":"^0.6.2",webpack:"^3.11.0"},peerDependencies:{leaflet:"^1.2.0"},scripts:{start:"npm run dev",dev:"./node_modules/.bin/webpack --config=webpack.dev.js",test:"browserify ./spec/test.spec.js | tape-run",build:"./node_modules/.bin/webpack --config=webpack.build.js",prepare:"npm run build"},repository:{type:"git",url:"git+https://github.com/codeofsumit/leaflet.pm.git"},author:{name:"Sumit Kumar",email:"sk@outlook.com",url:"http://twitter.com/TweetsOfSumit"},license:"MIT",bugs:{url:"https://github.com/codeofsumit/leaflet.pm/issues"},homepage:"https://leafletpm.now.sh"}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=L.Class.extend({initialize:function(t){var e=this;this.map=t,this.Draw=new L.PM.Draw(t),this.Toolbar=new L.PM.Toolbar(t),this.map.on("layerremove",function(t){t.layer.pm&&!t.layer._pmTempLayer&&e.map.fire("pm:remove",t)}),this._globalRemovalMode=!1},addControls:function(t){this.Toolbar.addControls(t)},removeControls:function(){this.Toolbar.removeControls()},toggleControls:function(){this.Toolbar.toggleControls()},controlsVisible:function(){return this.Toolbar.isVisible},enableDraw:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Poly",e=1<arguments.length?arguments[1]:void 0;this.Draw.enable(t,e)},disableDraw:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Poly";this.Draw.disable(t)},setPathOptions:function(t){this.Draw.setPathOptions(t)},removeLayer:function(t){var e=t.target;e._layers||e.pm&&e.pm.dragging()||t.target.remove()},toggleGlobalRemovalMode:function(){var e=this;this.globalRemovalEnabled()?(this._globalRemovalMode=!1,this.map.eachLayer(function(t){t.off("click",e.removeLayer)})):(this._globalRemovalMode=!0,this.map.eachLayer(function(t){t.pm&&t.on("click",e.removeLayer)})),this.Toolbar.toggleButton("deleteLayer",this._globalRemovalMode)},globalRemovalEnabled:function(){return this._globalRemovalMode},globalEditEnabled:function(){return this._globalEditMode},enableGlobalEditMode:function(e){var n=[];this.map.eachLayer(function(t){(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle)&&n.push(t)}),n=(n=n.filter(function(t){return!!t.pm})).filter(function(t){return!t._pmTempLayer}),this._globalEditMode=!0,n.forEach(function(t){t.pm.enable(e)}),this.Toolbar.toggleButton("editPolygon",this._globalEditMode),this._fireEditModeEvent(!0)},disableGlobalEditMode:function(){var e=[];this.map.eachLayer(function(t){(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle)&&e.push(t)}),e=(e=e.filter(function(t){return!!t.pm})).filter(function(t){return!t._pmTempLayer}),this._globalEditMode=!1,e.forEach(function(t){t.pm.disable()}),this.Toolbar.toggleButton("editPolygon",this._globalEditMode),this._fireEditModeEvent(!1)},_fireEditModeEvent:function(t){this.map.fire("pm:globaleditmodetoggled",{enabled:t,map:this.map})},toggleGlobalEditMode:function(t){this.globalEditEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(t)}});e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,r=(i=n(13))&&i.__esModule?i:{default:i};L.Control.PMButton=r.default;var o=L.Class.extend({options:{drawMarker:!0,drawPolygon:!0,drawPolyline:!0,drawCircle:!0,drawRectangle:!0,editMode:!0,cutPolygon:!0,dragPolygon:!1,removalMode:!0,position:"topleft"},initialize:function(t){this.map=t,this.buttons={},this.isVisible=!1,this.container=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-bar leaflet-control"),this._defineButtons()},getButtons:function(){return this.buttons},addControls:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options;void 0!==t.editPolygon&&(t.editMode=t.editPolygon),void 0!==t.deleteLayer&&(t.removalMode=t.deleteLayer),L.Util.setOptions(this,t),this._showHideButtons(),this.isVisible=!0},removeControls:function(){var t=this.getButtons();for(var e in t)t[e].remove();this.isVisible=!1},toggleControls:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options;this.isVisible?this.removeControls():this.addControls(t)},_addButton:function(t,e){return this.buttons[t]=e,this.options[t]=this.options[t]||!1,this.buttons[t]},triggerClickOnToggledButtons:function(t){for(var e in this.buttons)this.buttons[e]!==t&&this.buttons[e].toggled()&&this.buttons[e]._triggerClick()},toggleButton:function(t,e){return"editPolygon"===t&&(t="editMode"),"deleteLayer"===t&&(t="removalMode"),this.triggerClickOnToggledButtons(this.buttons[t]),this.buttons[t].toggle(e)},_defineButtons:function(){var t=this,e={className:" leaflet-pm-icon-delete",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},n={className:"leaflet-pm-icon-polygon",onClick:function(){},afterClick:function(){t.map.pm.Draw.Poly.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},i={className:"leaflet-pm-icon-cut",onClick:function(){},afterClick:function(){t.map.pm.Draw.Cut.toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},r={className:"leaflet-pm-icon-marker",onClick:function(){},afterClick:function(){t.map.pm.Draw.Marker.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},o={className:"leaflet-pm-icon-polyline",onClick:function(){},afterClick:function(){t.map.pm.Draw.Line.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},s={className:"leaflet-pm-icon-circle",onClick:function(){},afterClick:function(){t.map.pm.Draw.Circle.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},a={className:"leaflet-pm-icon-rectangle",onClick:function(){},afterClick:function(){t.map.pm.Draw.Rectangle.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},u={className:"leaflet-pm-icon-edit",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},l={className:"leaflet-pm-icon-drag",onClick:function(){},afterClick:function(){},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position};this._addButton("drawMarker",new L.Control.PMButton(r)),this._addButton("drawPolyline",new L.Control.PMButton(o)),this._addButton("drawRectangle",new L.Control.PMButton(a)),this._addButton("drawPolygon",new L.Control.PMButton(n)),this._addButton("drawCircle",new L.Control.PMButton(s)),this._addButton("cutPolygon",new L.Control.PMButton(i)),this._addButton("editMode",new L.Control.PMButton(u)),this._addButton("dragPolygon",new L.Control.PMButton(l)),this._addButton("removalMode",new L.Control.PMButton(e))},_showHideButtons:function(){this.removeControls();var t=this.getButtons();for(var e in t)this.options[e]&&(t[e].setPosition(this.options.position),t[e].addTo(this.map))}});e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=L.Control.extend({options:{position:"topleft"},initialize:function(t){this._button=L.Util.setOptions(this,t)},onAdd:function(t){return this._map=t,this._container=this._map.pm.Toolbar.container,this.buttonsDomNode=this._makeButton(this._button),this._container.appendChild(this.buttonsDomNode),this._container},onRemove:function(){return this.buttonsDomNode.remove(),this._container},getText:function(){return this._button.text},getIconUrl:function(){return this._button.iconUrl},destroy:function(){this._button={},this._update()},toggle:function(t){return this._button.toggleStatus="boolean"==typeof t?t:!this._button.toggleStatus,this._applyStyleClasses(),this._button.toggleStatus},toggled:function(){return this._button.toggleStatus},onCreate:function(){this.toggle(!1)},_triggerClick:function(t){this._button.onClick(t),this._clicked(t),this._button.afterClick(t)},_makeButton:function(t){var e=this,n=L.DomUtil.create("a","leaflet-buttons-control-button",this._container);t.toggleStatus&&L.DomUtil.addClass(n,"active");var i=L.DomUtil.create("div","control-icon",n);return t.iconUrl&&i.setAttribute("src",t.iconUrl),t.className&&L.DomUtil.addClass(i,t.className),L.DomEvent.addListener(n,"click",function(){e._button.disableOtherButtons&&e._map.pm.Toolbar.triggerClickOnToggledButtons(e)}),L.DomEvent.addListener(n,"click",this._triggerClick,this),L.DomEvent.disableClickPropagation(n),n},_applyStyleClasses:function(){this._container&&(this._button.toggleStatus?L.DomUtil.addClass(this.buttonsDomNode,"active"):L.DomUtil.removeClass(this.buttonsDomNode,"active"))},_clicked:function(){this._button.doToggle&&this.toggle()}});e.default=i},function(t,e,n){var i,r=(i=n(0))&&i.__esModule?i:{default:i};r.default.Marker=r.default.extend({initialize:function(t){this._map=t,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable:function(t){L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker([0,0],this.options.markerStyle),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.eachLayer(function(t){t instanceof L.Marker&&t.pm&&t.pm.enable()})},disable:function(){this._enabled&&(this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(function(t){t instanceof L.Marker&&t.pm&&!t._pmTempLayer&&t.pm.disable()}),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this._enabled=!1)},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_createMarker:function(t){if(t.latlng){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),n=new L.Marker(e,this.options.markerStyle);n.addTo(this._map),n.pm.enable(),this.disable(),this._map.fire("pm:create",{shape:this._shape,marker:n,layer:n}),this._cleanupSnapping()}},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}}})},function(t,e,n){var i=o(n(4)),r=o(n(0));function o(t){return t&&t.__esModule?t:{default:t}}r.default.Line=r.default.extend({initialize:function(t){this._map=t,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable:function(t){L.Util.setOptions(this,t),this.options.finishOnDoubleClick&&!this.options.finishOn&&(this.options.finishOn="dblclick"),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],this.options.templineStyle),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this._map._container.style.cursor="crosshair",this._map.on("click",this._createVertex,this),this.options.finishOn&&this._map.on(this.options.finishOn,this._finishShape,this),"dblclick"===this.options.finishOn&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[]},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="default",this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},hasSelfIntersection:function(){return 0<(0,i.default)(this._layer.toGeoJSON()).features.length},_syncHintLine:function(){var t=this._layer.getLatLngs();if(0<t.length){var e=t[t.length-1];this._hintline.setLatLngs([e,this._hintMarker.getLatLng()])}},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this.options.allowSelfIntersection||this._handleSelfIntersection()},_handleSelfIntersection:function(){var t=L.polyline(this._layer.getLatLngs());t.addLatLng(this._hintMarker.getLatLng());var e=(0,i.default)(t.toGeoJSON());this._doesSelfIntersect=0<e.features.length,this._doesSelfIntersect?this._hintline.setStyle({color:"red"}):this._hintline.setStyle(this.options.hintlineStyle)},_createVertex:function(t){if(this.options.allowSelfIntersection||!this._doesSelfIntersect){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();if(e.equals(this._layer.getLatLngs()[0]))this._finishShape(t);else{var n=0===this._layer.getLatLngs().length;this._layer.addLatLng(e);var i=this._createMarker(e,n);this._hintline.setLatLngs([e,e]),this._layer.fire("pm:vertexadded",{shape:this._shape,workingLayer:this._layer,marker:i,latlng:e})}}},_finishShape:function(){if(this.options.allowSelfIntersection||!this._doesSelfIntersect){var t=this._layer.getLatLngs(),e=L.polyline(t,this.options.pathOptions).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:e}),this.options.snappable&&this._cleanupSnapping()}},_createMarker:function(t){var e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return e._pmTempLayer=!0,this._layerGroup.addLayer(e),e.on("click",this._finishShape,this),e}})},function(t,e,n){var i,r=(i=n(0))&&i.__esModule?i:{default:i};r.default.Poly=r.default.Line.extend({initialize:function(t){this._map=t,this._shape="Poly",this.toolbarButtonName="drawPolygon"},_finishShape:function(t){if(this.options.allowSelfIntersection||!this._doesSelfIntersect){var e=this._layer.getLatLngs();t&&"dblclick"===t.type&&e.splice(e.length-1,1);var n=L.polygon(e,this.options.pathOptions).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:n}),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex}},_createMarker:function(t,e){var n=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return n._pmTempLayer=!0,this._layerGroup.addLayer(n),e&&(n.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(n)-1,this.options.snappable&&this._cleanupSnapping()),n}})},function(t,e,n){var i,r=(i=n(0))&&i.__esModule?i:{default:i};r.default.Rectangle=r.default.extend({initialize:function(t){this._map=t,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable:function(t){if(L.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._layer._pmTempLayer=!0,this._startMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!0,zIndexOffset:100,opacity:this.options.cursorMarker?1:0}),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker){L.DomUtil.addClass(this._hintMarker._icon,"visible"),this._styleMarkers=[];for(var e=0;e<2;e+=1){var n=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!0,zIndexOffset:100});n._pmTempLayer=!0,this._layerGroup.addLayer(n),this._styleMarkers.push(n)}}this._map._container.style.cursor="crosshair",this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[]},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="default",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_placeStartingMarkers:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(e),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(function(t){L.DomUtil.addClass(t._icon,"visible"),t.setLatLng(e)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._setRectangleOrigin()},_setRectangleOrigin:function(){var t=this._startMarker.getLatLng();t&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([t,t]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_syncRectangleSize:function(){var n=this,t=this._startMarker.getLatLng(),e=this._hintMarker.getLatLng();if(this._layer.setBounds([t,e]),this.options.cursorMarker&&this._styleMarkers){var i=[];this._findCorners().forEach(function(t){t.equals(n._startMarker.getLatLng())||t.equals(n._hintMarker.getLatLng())||i.push(t)}),i.forEach(function(t,e){n._styleMarkers[e].setLatLng(t)})}},_finishShape:function(){var t=this._startMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=L.rectangle([t,e],this.options.pathOptions).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:n})},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}})},function(t,e,n){var i,r=(i=n(0))&&i.__esModule?i:{default:i};r.default.Circle=r.default.extend({initialize:function(t){this._map=t,this._shape="Circle",this.toolbarButtonName="drawCircle"},enable:function(t){L.Util.setOptions(this,t),this.options.radius=0,this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.circle([0,0],this.options.templineStyle),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._centerMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._centerMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._centerMarker),this._hintMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this._hintline=L.polyline([],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map._container.style.cursor="crosshair",this._map.on("click",this._placeCenterMarker,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[]},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="default",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine:function(){var t=this._centerMarker.getLatLng();this._hintline.setLatLngs([t,this._hintMarker.getLatLng()])},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=t.distanceTo(e);this._layer.setRadius(n)},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_placeCenterMarker:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._layer.fire("pm:centerplaced",{shape:this._shape,workingLayer:this._layer,latlng:t}))},_finishShape:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=t.distanceTo(e),i=L.circle(t,{radius:n}).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:i})},_createMarker:function(t){var e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return e._pmTempLayer=!0,this._layerGroup.addLayer(e),e}})},function(t,e,n){var s=r(n(20)),a=r(n(23)),i=r(n(0));function r(t){return t&&t.__esModule?t:{default:t}}i.default.Cut=i.default.Poly.extend({initialize:function(t){this._map=t,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_cut:function(i){var r=this,e=this._map._layers,o=[];Object.keys(e).map(function(t){return e[t]}).filter(function(t){return t.pm}).filter(function(t){return t instanceof L.Polygon}).filter(function(t){return t!==i}).filter(function(t){try{return!!(0,s.default)(i.toGeoJSON(),t.toGeoJSON())}catch(t){return console.error("You cant cut polygons with self-intersections"),!1}}).forEach(function(n){var t=(0,a.default)(n.toGeoJSON(),i.toGeoJSON());if("MultiPolygon"===t.geometry.type)t.geometry.coordinates.reduce(function(t,e){return t.push({type:"Polygon",coordinates:e}),t},[]).forEach(function(t){var e=L.geoJSON(t,n.options);o.push(e),e.addTo(r._map),e.pm.enable(r.options),e.pm.disable()});else{var e=L.geoJSON(t,n.options).addTo(r._map);o.push(e),e.addTo(r._map),e.pm.enable(r.options),e.pm.disable()}n.fire("pm:cut",{shape:r._shape,layer:n,resultingLayers:o}),r._map.fire("pm:cut",{shape:r._shape,cuttedLayer:n,resultingLayers:o}),n._pmTempLayer=!0,i._pmTempLayer=!0,n.remove(),i.remove()})},_finishShape:function(){var t=this._layer.getLatLngs(),e=L.polygon(t,this.options.pathOptions);this._cut(e),this.disable(),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex}})},function(t,e,n){var i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var g=n(5),y=n(21),_=i(n(22));e.default=function t(e,n,i){void 0===i&&(i={});var r=y.getGeom(e),o=y.getGeom(n);if("Polygon"===r.type&&"Polygon"===o.type){var s=_.intersection(r.coordinates,o.coordinates);if(null===s||0===s.length)return null;if(1!==s.length)return g.multiPolygon(s,i.properties);var a=s[0][0][0],u=s[0][0][s[0][0].length-1];return a[0]===u[0]&&a[1]===u[1]?g.polygon(s[0],i.properties):null}if("MultiPolygon"===r.type){for(var l=[],h=0,c=r.coordinates;h<c.length;h++){var p=c[h],f=t(y.getGeom(g.polygon(p)),o);if(f){var d=y.getGeom(f);if("Polygon"===d.type)l.push(d.coordinates);else{if("MultiPolygon"!==d.type)throw new Error("intersection is invalid");l=l.concat(d.coordinates)}}}return 0===l.length?null:1===l.length?g.polygon(l[0],i.properties):g.multiPolygon(l,i.properties)}if("MultiPolygon"===o.type)return t(o,r);throw new Error("poly1 and poly2 must be either polygons or multiPolygons")}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.getCoord=function(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&2<=t.length&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(1<e.length&&Object(i.isNumber)(e[0])&&Object(i.isNumber)(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0;i<t.features.length;i++){var r=t.features[i];if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}},e.getGeom=function(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")},e.getGeomType=function(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")},e.getType=function(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")};var i=n(5);n.n(i)},function(t,e,n){var i;i=function(){return function r(o,s,a){function u(e,t){if(!s[e]){if(!o[e]){if(l)return l(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[e]={exports:{}};o[e][0].call(i.exports,function(t){return u(o[e][1][t]||t)},i,i.exports,r,o,s,a)}return s[e].exports}for(var l=!1,t=0;t<a.length;t++)u(a[t]);return u}({1:[function(t,e,n){var i=t("./src/index"),r={union:i.union,diff:i.diff,xor:i.xor,intersection:i.intersection};r.default=r,e.exports=r},{"./src/index":12}],2:[function(t,e,n){var i;i=function(){function r(t){return t?1+Math.max(r(t.left),r(t.right)):0}function n(t,e){return e<t?1:t<e?-1:0}function h(t){var e=t.right;return t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent,e.parent&&(e.parent.left===t?e.parent.left=e:e.parent.right=e),((t.parent=e).left=t).balanceFactor+=1,e.balanceFactor<0&&(t.balanceFactor-=e.balanceFactor),e.balanceFactor+=1,0<t.balanceFactor&&(e.balanceFactor+=t.balanceFactor),e}function c(t){var e=t.left;return t.left=e.right,t.left&&(t.left.parent=t),e.parent=t.parent,e.parent&&(e.parent.left===t?e.parent.left=e:e.parent.right=e),((t.parent=e).right=t).balanceFactor-=1,0<e.balanceFactor&&(t.balanceFactor-=e.balanceFactor),e.balanceFactor-=1,t.balanceFactor<0&&(e.balanceFactor+=t.balanceFactor),e}var t=function(t,e){void 0===e&&(e=!1),this._comparator=t||n,this._root=null,this._size=0,this._noDuplicates=!!e},e={size:{}};return t.prototype.destroy=function(){return this._root=null,this},e.size.get=function(){return this._size},t.prototype.contains=function(t){if(this._root)for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},t.prototype.next=function(t){var e=t;if(e)if(e.right)for(e=e.right;e&&e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)e=(t=e).parent;return e},t.prototype.prev=function(t){var e=t;if(e)if(e.left)for(e=e.left;e&&e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)e=(t=e).parent;return e},t.prototype.forEach=function(t){for(var e=this._root,n=[],i=!1,r=0;!i;)e?(n.push(e),e=e.left):0<n.length?(t(e=n.pop(),r++),e=e.right):i=!0;return this},t.prototype.keys=function(){for(var t=this._root,e=[],n=[],i=!1;!i;)t?(e.push(t),t=t.left):0<e.length?(t=e.pop(),n.push(t.key),t=t.right):i=!0;return n},t.prototype.values=function(){for(var t=this._root,e=[],n=[],i=!1;!i;)t?(e.push(t),t=t.left):0<e.length?(t=e.pop(),n.push(t.data),t=t.right):i=!0;return n},t.prototype.at=function(t){for(var e=this._root,n=[],i=!1,r=0;!i;)if(e)n.push(e),e=e.left;else if(0<n.length){if(e=n.pop(),r===t)return e;r++,e=e.right}else i=!0;return null},t.prototype.minNode=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t},t.prototype.min=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t.key},t.prototype.max=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t.key},t.prototype.isEmpty=function(){return!this._root},t.prototype.pop=function(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e},t.prototype.find=function(t){for(var e,n=this._root,i=this._comparator;n;){if(0===(e=i(t,n.key)))return n;n=e<0?n.left:n.right}return null},t.prototype.insert=function(t,e){if(!this._root)return this._root={parent:null,left:null,right:null,balanceFactor:0,key:t,data:e},this._size++,this._root;var n=this._comparator,i=this._root,r=null,o=0;if(this._noDuplicates)for(;i;){if(0===(o=n(t,(r=i).key)))return null;i=o<0?i.left:i.right}else for(;i;)i=(o=n(t,(r=i).key))<=0?i.left:i.right;var s,a={left:null,right:null,balanceFactor:0,parent:r,key:t,data:e};for(o<=0?r.left=a:r.right=a;r&&((o=n(r.key,t))<0?r.balanceFactor-=1:r.balanceFactor+=1,0!==r.balanceFactor);){if(r.balanceFactor<-1){1===r.right.balanceFactor&&c(r.right),s=h(r),r===this._root&&(this._root=s);break}if(1<r.balanceFactor){-1===r.left.balanceFactor&&h(r.left),s=c(r),r===this._root&&(this._root=s);break}r=r.parent}return this._size++,a},t.prototype.remove=function(t){if(!this._root)return null;for(var e=this._root,n=this._comparator,i=0;e&&0!==(i=n(t,e.key));)e=i<0?e.left:e.right;if(!e)return null;var r,o,s=e.key;if(e.left){for(r=e.left;r.left||r.right;){for(;r.right;)r=r.right;e.key=r.key,e.data=r.data,r.left&&(r=(e=r).left)}e.key=r.key,e.data=r.data,e=r}if(e.right){for(o=e.right;o.left||o.right;){for(;o.left;)o=o.left;e.key=o.key,e.data=o.data,o.right&&(o=(e=o).right)}e.key=o.key,e.data=o.data,e=o}for(var a,u=e.parent,l=e;u&&(u.left===l?u.balanceFactor-=1:u.balanceFactor+=1,u.balanceFactor<-1?(1===u.right.balanceFactor&&c(u.right),a=h(u),u===this._root&&(this._root=a),u=a):1<u.balanceFactor&&(-1===u.left.balanceFactor&&h(u.left),a=c(u),u===this._root&&(this._root=a),u=a),-1!==u.balanceFactor&&1!==u.balanceFactor);)u=(l=u).parent;return e.parent&&(e.parent.left===e?e.parent.left=null:e.parent.right=null),e===this._root&&(this._root=null),this._size--,s},t.prototype.load=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=[]),Array.isArray(t))for(var n=0,i=t.length;n<i;n++)this.insert(t[n],e[n]);return this},t.prototype.isBalanced=function(){return function t(e){if(null===e)return!0;var n=r(e.left),i=r(e.right);return!!(Math.abs(n-i)<=1&&t(e.left)&&t(e.right))}(this._root)},t.prototype.toString=function(t){return function(t,e){void 0===e&&(e=function(t){return t.key});var n=[];return function t(e,n,i,r,o){if(e){r(n+(i?"└── ":"├── ")+o(e)+"\n");var s=n+(i?"    ":"│   ");e.left&&t(e.left,s,!1,r,o),e.right&&t(e.right,s,!0,r,o)}}(t,"",!0,function(t){return n.push(t)},e),n.join("")}(this._root,t)},Object.defineProperties(t.prototype,e),t},"object"==(void 0===n?"undefined":g(n))&&void 0!==e?e.exports=i():this.avl=i()},{}],3:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||r,0<this.length)for(var n=(this.length>>1)-1;0<=n;n--)this._down(n)}function r(t,e){return t<e?-1:e<t?1:0}e.exports=i,(e.exports.default=i).prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,i=e[t];0<t;){var r=t-1>>1,o=e[r];if(0<=n(i,o))break;e[t]=o,t=r}e[t]=i},_down:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&n(e[s],a)<0&&(a=e[o=s]),0<=n(a,r))break;e[t]=a,t=o}e[t]=r}}},{}],4:[function(t,e,n){var a=t("./signed_area");e.exports=function(t,e){var n,i,r,o=t.point,s=e.point;return o[0]>s[0]?1:o[0]<s[0]?-1:o[1]!==s[1]?o[1]>s[1]?1:-1:(i=e,r=o,(n=t).left!==i.left?n.left?1:-1:0!==a(r,n.otherEvent.point,i.otherEvent.point)?n.isBelow(i.otherEvent.point)?-1:1:!n.isSubject&&i.isSubject?1:-1)}},{"./signed_area":16}],5:[function(t,e,n){var r=t("./signed_area"),o=t("./compare_events"),s=t("./equals");e.exports=function(t,e){if(t===e)return 0;if(0!==r(t.point,t.otherEvent.point,e.point)||0!==r(t.point,t.otherEvent.point,e.otherEvent.point))return s(t.point,e.point)?t.isBelow(e.otherEvent.point)?-1:1:t.point[0]===e.point[0]?t.point[1]<e.point[1]?-1:1:1===o(t,e)?e.isAbove(t.point)?-1:1:t.isBelow(e.point)?-1:1;if(t.isSubject!==e.isSubject)return t.isSubject?-1:1;var n=t.point,i=e.point;return n[0]===i[0]&&n[1]===i[1]?(n=t.otherEvent.point,i=e.otherEvent.point,n[0]===i[0]&&n[1]===i[1]?0:t.contourId>e.contourId?1:-1):1===o(t,e)?1:-1}},{"./compare_events":4,"./equals":10,"./signed_area":16}],6:[function(t,e,n){var i=t("./edge_type"),r=t("./operation"),o=r.INTERSECTION,s=r.UNION,a=r.DIFFERENCE,u=r.XOR;function l(t,e){switch(t.type){case i.NORMAL:switch(e){case o:return!t.otherInOut;case s:return t.otherInOut;case a:return t.isSubject&&t.otherInOut||!t.isSubject&&!t.otherInOut;case u:return!0}break;case i.SAME_TRANSITION:return e===o||e===s;case i.DIFFERENT_TRANSITION:return e===a;case i.NON_CONTRIBUTING:return!1}return!1}e.exports=function(t,e,n){null===e?(t.inOut=!1,t.otherInOut=!0):(t.isSubject===e.isSubject?(t.inOut=!e.inOut,t.otherInOut=e.otherInOut):(t.inOut=!e.otherInOut,t.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(t.prevInResult=!l(e,n)||e.isVertical()?e.prevInResult:e)),t.inResult=l(t,n)}},{"./edge_type":9,"./operation":13}],7:[function(t,e,n){var p=t("./compare_events"),f=t("./operation");function d(t,e,n,i){var r=t+1,o=e.length;if(o-1<r)return t-1;for(var s=e[t].point,a=e[r].point;r<o&&a[0]===s[0]&&a[1]===s[1];){if(!n[r])return r;a=e[++r].point}for(r=t-1;n[r]&&i<=r;)r--;return r}e.exports=function(t,e){var n,i,r,o=function(t){var e,n,i,r,o=[];for(n=0,i=t.length;n<i;n++)((e=t[n]).left&&e.inResult||!e.left&&e.otherEvent.inResult)&&o.push(e);for(var s=!1;!s;)for(s=!0,n=0,i=o.length;n<i;n++)n+1<i&&1===p(o[n],o[n+1])&&(r=o[n],o[n]=o[n+1],o[n+1]=r,s=!1);for(n=0,i=o.length;n<i;n++)(e=o[n]).pos=n,e.left||(r=e.pos,e.pos=e.otherEvent.pos,e.otherEvent.pos=r);return o}(t),s={},a=[];for(n=0,i=o.length;n<i;n++)if(!s[n]){var u=[[]];o[n].isExteriorRing?e===f.DIFFERENCE&&!o[n].isSubject&&1<a.length?a[a.length-1].push(u[0]):a.push(u):e!==f.DIFFERENCE||o[n].isSubject||0!==a.length?0===a.length?a.push([[u]]):a[a.length-1].push(u[0]):a.push(u);var l=a.length-1,h=n,c=o[n].point;for(u[0].push(c);n<=h;)r=o[h],s[h]=!0,r.left?(r.resultInOut=!1,r.contourId=l):(r.otherEvent.resultInOut=!0,r.otherEvent.contourId=l),s[h=r.pos]=!0,u[0].push(o[h].point),h=d(h,o,s,n);r=o[h=-1===h?n:h],s[h]=s[r.pos]=!0,r.otherEvent.resultInOut=!0,r.otherEvent.contourId=l}return a}},{"./compare_events":4,"./operation":13}],8:[function(t,e,n){var o=t("./sweep_event"),s=t("./equals"),a=t("./compare_events");e.exports=function(t,e,n){var i=new o(e,!1,t,t.isSubject),r=new o(e,!0,t.otherEvent,t.isSubject);return s(t.point,t.otherEvent.point)&&console.warn("what is that, a collapsed segment?",t),i.contourId=r.contourId=t.contourId,0<a(r,t.otherEvent)&&(t.otherEvent.left=!0,r.left=!1),t.otherEvent.otherEvent=r,t.otherEvent=i,n.push(r),n.push(i),n}},{"./compare_events":4,"./equals":10,"./sweep_event":18}],9:[function(t,e,n){e.exports={NORMAL:0,NON_CONTRIBUTING:1,SAME_TRANSITION:2,DIFFERENT_TRANSITION:3}},{}],10:[function(t,e,n){e.exports=function(t,e){return t[0]===e[0]&&t[1]===e[1]}},{}],11:[function(t,e,n){var p=t("tinyqueue"),d=t("./sweep_event"),g=t("./compare_events"),f=t("./operation"),y=Math.max,_=Math.min,m=0;function v(t,e,n,i,r,o){var s,a,u,l,h,c;for(s=0,a=t.length-1;s<a;s++)if(u=t[s],l=t[s+1],h=new d(u,!1,void 0,e),c=new d(l,!1,h,e),h.otherEvent=c,u[0]!==l[0]||u[1]!==l[1]){h.contourId=c.contourId=n,o||(h.isExteriorRing=!1,c.isExteriorRing=!1),0<g(h,c)?c.left=!0:h.left=!0;var p=u[0],f=u[1];r[0]=_(r[0],p),r[1]=_(r[1],f),r[2]=y(r[2],p),r[3]=y(r[3],f),i.push(h),i.push(c)}}e.exports=function(t,e,n,i,r){var o,s,a,u,l,h,c=new p(null,g);for(a=0,u=t.length;a<u;a++)for(l=0,h=(o=t[a]).length;l<h;l++)(s=0===l)&&m++,v(o[l],!0,m,c,n,s);for(a=0,u=e.length;a<u;a++)for(l=0,h=(o=e[a]).length;l<h;l++)s=0===l,r===f.DIFFERENCE&&(s=!1),s&&m++,v(o[l],!1,m,c,i,s);return c}},{"./compare_events":4,"./operation":13,"./sweep_event":18,tinyqueue:3}],12:[function(t,e,n){var y=t("./subdivide_segments"),_=t("./connect_edges"),m=t("./fill_queue"),v=t("./operation"),b=[];function i(t,e,n){"number"==typeof t[0][0][0]&&(t=[t]),"number"==typeof e[0][0][0]&&(e=[e]);var i,r,o,s,a=(r=e,o=n,s=null,(i=t).length*r.length==0&&(o===v.INTERSECTION?s=b:o===v.DIFFERENCE?s=i:o!==v.UNION&&o!==v.XOR||(s=0===i.length?r:i)),s);if(a)return a===b?null:a;var u,l,h,c,p=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],d=m(t,e,p,f,n);if(u=t,l=e,h=n,c=null,(f[2]<p[0]||p[2]<f[0]||f[3]<p[1]||p[3]<f[1])&&(h===v.INTERSECTION?c=b:h===v.DIFFERENCE?c=u:h!==v.UNION&&h!==v.XOR||(c=u.concat(l))),a=c)return a===b?null:a;var g=y(d,t,e,p,f,n);return _(g,n)}i.union=function(t,e){return i(t,e,v.UNION)},i.diff=function(t,e){return i(t,e,v.DIFFERENCE)},i.xor=function(t,e){return i(t,e,v.XOR)},i.intersection=function(t,e){return i(t,e,v.INTERSECTION)},i.operations=v,e.exports=i,e.exports.default=i},{"./connect_edges":7,"./fill_queue":11,"./operation":13,"./subdivide_segments":17}],13:[function(t,e,n){e.exports={INTERSECTION:0,UNION:1,DIFFERENCE:2,XOR:3}},{}],14:[function(t,e,n){var u=t("./divide_segment"),l=t("./segment_intersection"),h=t("./equals"),c=t("./compare_events"),p=t("./edge_type");e.exports=function(t,e,n){var i=l(t.point,t.otherEvent.point,e.point,e.otherEvent.point),r=i?i.length:0;if(0===r)return 0;if(1===r&&(h(t.point,e.point)||h(t.otherEvent.point,e.otherEvent.point)))return 0;if(2===r&&t.isSubject===e.isSubject)return 0;if(1===r)return h(t.point,i[0])||h(t.otherEvent.point,i[0])||u(t,i[0],n),h(e.point,i[0])||h(e.otherEvent.point,i[0])||u(e,i[0],n),1;var o=[],s=!1,a=!1;return h(t.point,e.point)?s=!0:1===c(t,e)?o.push(e,t):o.push(t,e),h(t.otherEvent.point,e.otherEvent.point)?a=!0:1===c(t.otherEvent,e.otherEvent)?o.push(e.otherEvent,t.otherEvent):o.push(t.otherEvent,e.otherEvent),s&&a||s?(e.type=p.NON_CONTRIBUTING,t.type=e.inOut===t.inOut?p.SAME_TRANSITION:p.DIFFERENT_TRANSITION,s&&!a&&u(o[1].otherEvent,o[0].point,n),2):(a?u(o[0],o[1].point,n):o[0]!==o[3].otherEvent?(u(o[0],o[1].point,n),u(o[1],o[2].point,n)):(u(o[0],o[1].point,n),u(o[3].otherEvent,o[2].point,n)),3)}},{"./compare_events":4,"./divide_segment":8,"./edge_type":9,"./equals":10,"./segment_intersection":15}],15:[function(t,e,n){function v(t,e){return t[0]*e[1]-t[1]*e[0]}function b(t,e){return t[0]*e[0]+t[1]*e[1]}e.exports=function(t,e,n,i,r){var o=[e[0]-t[0],e[1]-t[1]],s=[i[0]-n[0],i[1]-n[1]];function a(t,e,n){return[t[0]+e*n[0],t[1]+e*n[1]]}var u=[n[0]-t[0],n[1]-t[1]],l=v(o,s),h=l*l,c=b(o,o);if(h>1e-9*c*b(s,s)){var p=v(u,s)/l;if(p<0||1<p)return null;var f=v(u,o)/l;return f<0||1<f?null:r?null:[a(t,p,o)]}var d=b(u,u);if((h=(l=v(u,o))*l)>1e-9*c*d)return null;var g=b(o,u)/c,y=g+b(o,s)/c,_=Math.min(g,y),m=Math.max(g,y);return _<=1&&0<=m?1===_?r?null:[a(t,0<_?_:0,o)]:0===m?r?null:[a(t,m<1?m:1,o)]:r&&0===_&&1===m?null:[a(t,0<_?_:0,o),a(t,m<1?m:1,o)]:null}},{}],16:[function(t,e,n){e.exports=function(t,e,n){return(t[0]-n[0])*(e[1]-n[1])-(e[0]-n[0])*(t[1]-n[1])}},{}],17:[function(t,e,n){var m=t("avl"),v=t("./compute_fields"),b=t("./possible_intersection"),x=t("./compare_segments"),E=t("./operation");e.exports=function(t,e,n,i,r,o){for(var s,a,u,l=new m(x),h=[],c=Math.min(i[2],r[2]),p=E.INTERSECTION,f=E.DIFFERENCE;t.length;){var d=t.pop();if(h.push(d),o===p&&d.point[0]>c||o===f&&d.point[0]>i[2])break;if(d.left){a=s=l.insert(d),s=s!==(u=l.minNode())?l.prev(s):null,a=l.next(a);var g,y=s?s.key:null;if(v(d,y,o),a&&2===b(d,a.key,t)&&(v(d,y,o),v(d,a.key,o)),s&&2===b(s.key,d,t)){var _=s;g=(_=_!==u?l.prev(_):null)?_.key:null,v(y,g,o),v(d,y,o)}}else d=d.otherEvent,a=s=l.find(d),s&&a&&(s=s!==u?l.prev(s):null,a=l.next(a),l.remove(d),a&&s&&b(s.key,a.key,t))}return h}},{"./compare_segments":5,"./compute_fields":6,"./operation":13,"./possible_intersection":14,avl:2}],18:[function(t,e,n){var o=t("./edge_type");function i(t,e,n,i,r){this.left=e,this.point=t,this.otherEvent=n,this.isSubject=i,this.type=r||o.NORMAL,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.inResult=!1,this.resultInOut=!1,this.isExteriorRing=!0}i.prototype={isBelow:function(t){var e=this.point,n=this.otherEvent.point;return this.left?0<(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1]):0<(n[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(n[1]-t[1])},isAbove:function(t){return!this.isBelow(t)},isVertical:function(){return this.point[0]===this.otherEvent.point[0]},clone:function(){var t=new i(this.point,this.left,this.otherEvent,this.isSubject,this.type);return t.inResult=this.inResult,t.prevInResult=this.prevInResult,t.isExteriorRing=this.isExteriorRing,t.inOut=this.inOut,t.otherInOut=this.otherInOut,t}},e.exports=i},{"./edge_type":9}]},{},[1])(1)},t.exports=i()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var h=n(24),i=(n.n(h),n(25)),c=n(2),p=n(26),r=n(6);function f(t){switch(t.type){case"Polygon":return 1<Object(i.a)(t)?t:null;case"MultiPolygon":var e=[];if(Object(r.a)(t,function(t){1<Object(i.a)(t)&&e.push(t.geometry.coordinates)}),e.length)return{type:"MultiPolygon",coordinates:e}}}e.default=function(t,e){var n=Object(p.a)(t),i=Object(p.a)(e),r=t.properties||{};if(n=f(n),i=f(i),!n)return null;if(!i)return Object(c.a)(n,r);var o=new h.GeoJSONReader,s=o.read(n),a=o.read(i),u=h.OverlayOp.difference(s,a);if(u.isEmpty())return null;var l=(new h.GeoJSONWriter).write(u);return Object(c.a)(l,r)}},function(t,e,n){!function(t){function e(){}function n(t){this.message=t||""}function i(t){this.message=t||""}function r(t){this.message=t||""}function o(){}function s(t){return null===t?kt:t.color}function a(t){return null===t?null:t.parent}function u(t,e){null!==t&&(t.color=e)}function l(t){return null===t?null:t.left}function h(t){return null===t?null:t.right}function c(){this.root_=null,this.size_=0}function p(){}function f(){this.array_=[],arguments[0]instanceof bt&&this.addAll(arguments[0])}function d(){}function g(t){this.message=t||""}function y(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=1 in arguments&&parseInt(Number(arguments[1]),10)||0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)e[i]=t,++i;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var _=function(){};_.prototype.interfaces_=function(){return[]},_.prototype.getClass=function(){return _},_.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var m=function(e){function t(t){e.call(this,t),this.name="IllegalArgumentException",this.message=t,this.stack=(new e).stack}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Error),v=function(){},b={MAX_VALUE:{configurable:!0}};v.isNaN=function(t){return Number.isNaN(t)},v.doubleToLongBits=function(t){return t},v.longBitsToDouble=function(t){return t},v.isInfinite=function(t){return!Number.isFinite(t)},b.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(v,b);var x=function(){},E=function(){},w=function(){},I=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},L={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};I.prototype.setOrdinate=function(t,e){switch(t){case I.X:this.x=e;break;case I.Y:this.y=e;break;case I.Z:this.z=e;break;default:throw new m("Invalid ordinate index: "+t)}},I.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!_.equalsWithTolerance(this.x,e.x,n)&&!!_.equalsWithTolerance(this.y,e.y,n)}},I.prototype.getOrdinate=function(t){switch(t){case I.X:return this.x;case I.Y:return this.y;case I.Z:return this.z}throw new m("Invalid ordinate index: "+t)},I.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||v.isNaN(this.z))&&v.isNaN(t.z)},I.prototype.equals=function(t){return t instanceof I&&this.equals2D(t)},I.prototype.equalInZ=function(t,e){return _.equalsWithTolerance(this.z,t.z,e)},I.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},I.prototype.clone=function(){},I.prototype.copy=function(){return new I(this)},I.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},I.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},I.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},I.prototype.hashCode=function(){var t=17;return 37*(t=37*t+I.hashCode(this.x))+I.hashCode(this.y)},I.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},I.prototype.interfaces_=function(){return[x,E,e]},I.prototype.getClass=function(){return I},I.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=v.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},L.DimensionalComparator.get=function(){return S},L.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},L.NULL_ORDINATE.get=function(){return v.NaN},L.X.get=function(){return 0},L.Y.get=function(){return 1},L.Z.get=function(){return 2},Object.defineProperties(I,L);var S=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=t;if(2!==e&&3!==e)throw new m("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};S.prototype.compare=function(t,e){var n=t,i=e,r=S.compare(n.x,i.x);if(0!==r)return r;var o=S.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:S.compare(n.z,i.z)},S.prototype.interfaces_=function(){return[w]},S.prototype.getClass=function(){return S},S.compare=function(t,e){return t<e?-1:e<t?1:v.isNaN(t)?v.isNaN(e)?0:-1:v.isNaN(e)?1:0};var M=function(){};M.prototype.create=function(){},M.prototype.interfaces_=function(){return[]},M.prototype.getClass=function(){return M};var C=function(){},P={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};C.prototype.interfaces_=function(){return[]},C.prototype.getClass=function(){return C},C.toLocationSymbol=function(t){switch(t){case C.EXTERIOR:return"e";case C.BOUNDARY:return"b";case C.INTERIOR:return"i";case C.NONE:return"-"}throw new m("Unknown location value: "+t)},P.INTERIOR.get=function(){return 0},P.BOUNDARY.get=function(){return 1},P.EXTERIOR.get=function(){return 2},P.NONE.get=function(){return-1},Object.defineProperties(C,P);var N=function(t,e){return t.interfaces_&&-1<t.interfaces_().indexOf(e)},O=function(){},T={LOG_10:{configurable:!0}};O.prototype.interfaces_=function(){return[]},O.prototype.getClass=function(){return O},O.log10=function(t){var e=Math.log(t);return v.isInfinite(e)?e:v.isNaN(e)?e:e/O.LOG_10},O.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},O.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:n<t?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return i<r?r:o<i?o:i}},O.wrap=function(t,e){return t<0?e- -t%e:t%e},O.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=t;return i<e&&(i=e),i<n&&(i=n),i}if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],u=r;return u<o&&(u=o),u<s&&(u=s),u<a&&(u=a),u}},O.average=function(t,e){return(t+e)/2},T.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(O,T);var R=function(t){this.str=t};R.prototype.append=function(t){this.str+=t},R.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},R.prototype.toString=function(t){return this.str};var k=function(t){this.value=t};k.prototype.intValue=function(){return this.value},k.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},k.isNaN=function(t){return Number.isNaN(t)};var D=function(){};D.isWhitespace=function(t){return t<=32&&0<=t||127===t},D.toUpperCase=function(t){return t.toUpperCase()};var A=function t(){if(this._hi=0,(this._lo=0)===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var i=arguments[0];t.call(this,t.parse(i))}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.init(r,o)}},F={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};A.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},A.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=A.magnitude(n._hi),r=A.TEN.pow(i);(n=n.divide(r)).gt(A.TEN)?(n=n.divide(A.TEN),i+=1):n.lt(A.ONE)&&(n=n.multiply(A.TEN),i-=1);for(var o=i+1,s=new R,a=A.MAX_PRINT_DIGITS-1,u=0;u<=a;u++){t&&u===o&&s.append(".");var l=Math.trunc(n._hi);if(l<0)break;var h=!1,c=0;c=9<l?(h=!0,"9"):"0"+l,s.append(c),n=n.subtract(A.valueOf(l)).multiply(A.TEN),h&&n.selfAdd(A.TEN);var p=!0,f=A.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-u&&(p=!1),!p)break}return e[0]=i,s.toString()},A.prototype.sqr=function(){return this.multiply(this)},A.prototype.doubleValue=function(){return this._hi+this._lo},A.prototype.subtract=function(){if(arguments[0]instanceof A){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},A.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},A.prototype.isZero=function(){return 0===this._hi&&0===this._lo},A.prototype.selfSubtract=function(){if(arguments[0]instanceof A){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},A.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},A.prototype.min=function(t){return this.le(t)?this:t},A.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof A){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n,i,r,o,s=arguments[0],a=arguments[1],u=null,l=null,h=null,c=null;return r=this._hi/s,c=(u=(h=A.SPLIT*r)-(u=h-r))*(l=(c=A.SPLIT*s)-(l=c-s))-(o=r*s)+u*(i=s-l)+(n=r-u)*l+n*i,c=r+(h=(this._hi-o-c+this._lo-r*a)/s),this._hi=c,this._lo=r-c+h,this}},A.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},A.prototype.divide=function(){if(arguments[0]instanceof A){var t,e,n,i,r=arguments[0],o=null,s=null,a=null,u=null;return t=(n=this._hi/r._hi)-(o=(a=A.SPLIT*n)-(o=a-n)),u=o*(s=(u=A.SPLIT*r._hi)-(s=u-r._hi))-(i=n*r._hi)+o*(e=r._hi-s)+t*s+t*e,a=(this._hi-i-u+this._lo-n*r._lo)/r._hi,new A(u=n+a,n-u+a)}if("number"==typeof arguments[0]){var l=arguments[0];return v.isNaN(l)?A.createNaN():A.copy(this).selfDivide(l,0)}},A.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},A.prototype.pow=function(t){if(0===t)return A.valueOf(1);var e=new A(this),n=A.valueOf(1),i=Math.abs(t);if(1<i)for(;0<i;)i%2==1&&n.selfMultiply(e),0<(i/=2)&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},A.prototype.ceil=function(){if(this.isNaN())return A.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new A(t,e)},A.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},A.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},A.prototype.setValue=function(){if(arguments[0]instanceof A){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},A.prototype.max=function(t){return this.ge(t)?this:t},A.prototype.sqrt=function(){if(this.isZero())return A.valueOf(0);if(this.isNegative())return A.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=A.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},A.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof A){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e,n,i,r,o,s=arguments[0],a=null;return a=(i=this._hi+s)-(r=i-this._hi),n=(o=(a=s-r+(this._hi-a))+this._lo)+(i-(e=i+o)),this._hi=e+n,this._lo=n+(e-this._hi),this}}else if(2===arguments.length){var u,l,h,c,p=arguments[0],f=arguments[1],d=null,g=null,y=null;h=this._hi+p,l=this._lo+f,g=h-(y=h-this._hi),d=l-(c=l-this._lo);var _=(u=h+(y=(g=p-y+(this._hi-g))+l))+(y=(d=f-c+(this._lo-d))+(y+(h-u))),m=y+(u-_);return this._hi=_,this._lo=m,this}},A.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof A){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n,i,r=arguments[0],o=arguments[1],s=null,a=null,u=null,l=null;s=(u=A.SPLIT*this._hi)-this._hi,l=A.SPLIT*r,s=u-s,n=this._hi-s,a=l-r;var h=(u=this._hi*r)+(l=s*(a=l-a)-u+s*(i=r-a)+n*a+n*i+(this._hi*o+this._lo*r)),c=l+(s=u-h);return this._hi=h,this._lo=c,this}},A.prototype.selfSqr=function(){return this.selfMultiply(this)},A.prototype.floor=function(){if(this.isNaN())return A.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new A(t,e)},A.prototype.negate=function(){return this.isNaN()?this:new A(-this._hi,-this._lo)},A.prototype.clone=function(){},A.prototype.multiply=function(){if(arguments[0]instanceof A){var t=arguments[0];return t.isNaN()?A.createNaN():A.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return v.isNaN(e)?A.createNaN():A.copy(this).selfMultiply(e,0)}},A.prototype.isNaN=function(){return v.isNaN(this._hi)},A.prototype.intValue=function(){return Math.trunc(this._hi)},A.prototype.toString=function(){var t=A.magnitude(this._hi);return-3<=t&&t<=20?this.toStandardNotation():this.toSciNotation()},A.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+A.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+A.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},A.prototype.reciprocal=function(){var t,e,n,i,r=null,o=null,s=null,a=null;t=(n=1/this._hi)-(r=(s=A.SPLIT*n)-(r=s-n)),o=(a=A.SPLIT*this._hi)-this._hi;var u=n+(s=(1-(i=n*this._hi)-(a=r*(o=a-o)-i+r*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new A(u,n-u+s)},A.prototype.toSciNotation=function(){if(this.isZero())return A.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=A.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";1<n.length&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},A.prototype.abs=function(){return this.isNaN()?A.NaN:this.isNegative()?this.negate():new A(this)},A.prototype.isPositive=function(){return(0<this._hi||0===this._hi)&&0<this._lo},A.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},A.prototype.add=function(){if(arguments[0]instanceof A){var t=arguments[0];return A.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return A.copy(this).selfAdd(e)}},A.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof A){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}},A.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},A.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},A.prototype.trunc=function(){return this.isNaN()?A.NaN:this.isPositive()?this.floor():this.ceil()},A.prototype.signum=function(){return 0<this._hi?1:this._hi<0?-1:0<this._lo?1:this._lo<0?-1:0},A.prototype.interfaces_=function(){return[e,x,E]},A.prototype.getClass=function(){return A},A.sqr=function(t){return A.valueOf(t).selfMultiply(t)},A.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return A.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new A(e)}},A.sqrt=function(t){return A.valueOf(t).sqrt()},A.parse=function(t){for(var e=0,n=t.length;D.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new A,s=0,a=0,u=0;!(n<=e);){var l=t.charAt(e);if(e++,D.isDigit(l)){var h=l-"0";o.selfMultiply(A.TEN),o.selfAdd(h),s++}else{if("."!==l){if("e"!==l&&"E"!==l)throw new Error("Unexpected character '"+l+"' at position "+e+" in string "+t);var c=t.substring(e);try{u=k.parseInt(c)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+c+" in string "+t):e}break}a=s}}var p=o,f=s-a-u;if(0===f)p=o;else if(0<f){var d=A.TEN.pow(f);p=o.divide(d)}else if(f<0){var g=A.TEN.pow(-f);p=o.multiply(g)}return i?p.negate():p},A.createNaN=function(){return new A(v.NaN,v.NaN)},A.copy=function(t){return new A(t)},A.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},A.stringOfChar=function(t,e){for(var n=new R,i=0;i<e;i++)n.append(t);return n.toString()},F.PI.get=function(){return new A(3.141592653589793,12246467991473532e-32)},F.TWO_PI.get=function(){return new A(6.283185307179586,24492935982947064e-32)},F.PI_2.get=function(){return new A(1.5707963267948966,6123233995736766e-32)},F.E.get=function(){return new A(2.718281828459045,14456468917292502e-32)},F.NaN.get=function(){return new A(v.NaN,v.NaN)},F.EPS.get=function(){return 123259516440783e-46},F.SPLIT.get=function(){return 134217729},F.MAX_PRINT_DIGITS.get=function(){return 32},F.TEN.get=function(){return A.valueOf(10)},F.ONE.get=function(){return A.valueOf(1)},F.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},F.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(A,F);var G=function(){},B={DP_SAFE_EPSILON:{configurable:!0}};G.prototype.interfaces_=function(){return[]},G.prototype.getClass=function(){return G},G.orientationIndex=function(t,e,n){var i=G.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=A.valueOf(e.x).selfAdd(-t.x),o=A.valueOf(e.y).selfAdd(-t.y),s=A.valueOf(n.x).selfAdd(-e.x),a=A.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},G.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},G.intersection=function(t,e,n,i){var r=A.valueOf(i.y).selfSubtract(n.y).selfMultiply(A.valueOf(e.x).selfSubtract(t.x)),o=A.valueOf(i.x).selfSubtract(n.x).selfMultiply(A.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=A.valueOf(i.x).selfSubtract(n.x).selfMultiply(A.valueOf(t.y).selfSubtract(n.y)),u=A.valueOf(i.y).selfSubtract(n.y).selfMultiply(A.valueOf(t.x).selfSubtract(n.x)),l=a.subtract(u).selfDivide(s).doubleValue(),h=A.valueOf(t.x).selfAdd(A.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),c=A.valueOf(e.x).selfSubtract(t.x).selfMultiply(A.valueOf(t.y).selfSubtract(n.y)),p=A.valueOf(e.y).selfSubtract(t.y).selfMultiply(A.valueOf(t.x).selfSubtract(n.x)),f=c.subtract(p).selfDivide(s).doubleValue(),d=A.valueOf(n.y).selfAdd(A.valueOf(i.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new I(h,d)},G.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(0<r){if(o<=0)return G.signum(s);i=r+o}else{if(!(r<0))return G.signum(s);if(0<=o)return G.signum(s);i=-r-o}var a=G.DP_SAFE_EPSILON*i;return a<=s||a<=-s?G.signum(s):2},G.signum=function(t){return 0<t?1:t<0?-1:0},B.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(G,B);var U=function(){},q={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};q.X.get=function(){return 0},q.Y.get=function(){return 1},q.Z.get=function(){return 2},q.M.get=function(){return 3},U.prototype.setOrdinate=function(t,e,n){},U.prototype.size=function(){},U.prototype.getOrdinate=function(t,e){},U.prototype.getCoordinate=function(){},U.prototype.getCoordinateCopy=function(t){},U.prototype.getDimension=function(){},U.prototype.getX=function(t){},U.prototype.clone=function(){},U.prototype.expandEnvelope=function(t){},U.prototype.copy=function(){},U.prototype.getY=function(t){},U.prototype.toCoordinateArray=function(){},U.prototype.interfaces_=function(){return[E]},U.prototype.getClass=function(){return U},Object.defineProperties(U,q);var j=function(){},z=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(j),V=function(){};V.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;s<e+r;s++)n[i+o]=t[s],o++},V.getProperty=function(t){return{"line.separator":"\n"}[t]};var Y=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.x=n,this.y=i,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof I&&arguments[1]instanceof I){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var u=arguments[0],l=arguments[1],h=arguments[2];this.x=u,this.y=l,this.w=h}else if(4===arguments.length){var c=arguments[0],p=arguments[1],f=arguments[2],d=arguments[3],g=c.y-p.y,y=p.x-c.x,_=c.x*p.y-p.x*c.y,m=f.y-d.y,v=d.x-f.x,b=f.x*d.y-d.x*f.y;this.x=y*b-v*_,this.y=m*_-g*b,this.w=g*v-m*y}};Y.prototype.getY=function(){var t=this.y/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new z;return t},Y.prototype.getX=function(){var t=this.x/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new z;return t},Y.prototype.getCoordinate=function(){var t=new I;return t.x=this.getX(),t.y=this.getY(),t},Y.prototype.interfaces_=function(){return[]},Y.prototype.getClass=function(){return Y},Y.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,u=i.x-n.x,l=n.x*i.y-i.x*n.y,h=r*u-a*o,c=(o*l-u*s)/h,p=(a*s-r*l)/h;if(v.isNaN(c)||v.isInfinite(c)||v.isNaN(p)||v.isInfinite(p))throw new z;return new I(c,p)};var H=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof I){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],u=arguments[3];this.init(o,s,a,u)}},X={serialVersionUID:{configurable:!0}};H.prototype.getArea=function(){return this.getWidth()*this.getHeight()},H.prototype.equals=function(t){if(!(t instanceof H))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},H.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new H;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new H(e,i,n,r)},H.prototype.isNull=function(){return this._maxx<this._minx},H.prototype.getMaxX=function(){return this._maxx},H.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof I){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof H){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy}},H.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof H){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof I){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||i>this._maxy||i<this._miny)}},H.prototype.getMinY=function(){return this._miny},H.prototype.getMinX=function(){return this._minx},H.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof I){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof H){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}},H.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},H.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},H.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},H.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},H.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},H.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},H.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},H.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return e<t?t:e},H.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},H.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof H){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof I){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},H.prototype.centre=function(){return this.isNull()?null:new I((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},H.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof I){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof H){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._maxx=r<o?(this._minx=r,o):(this._minx=o,r),this._maxy=s<a?(this._miny=s,a):(this._miny=a,s)}},H.prototype.getMaxY=function(){return this._maxy},H.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},H.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+I.hashCode(this._minx))+I.hashCode(this._maxx))+I.hashCode(this._miny))+I.hashCode(this._maxy)},H.prototype.interfaces_=function(){return[x,e]},H.prototype.getClass=function(){return H},H.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),u=Math.max(o.x,s.x),l=Math.min(i.x,r.x),h=Math.max(i.x,r.x);return!(u<l||h<a||(a=Math.min(o.y,s.y),u=Math.max(o.y,s.y),l=Math.min(i.y,r.y),h=Math.max(i.y,r.y),u<l||h<a))}},X.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(H,X);var W={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},J=function(t){this.geometryFactory=t||new _e};J.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=W.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=W.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],Z[n]&&(e=Z[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},J.prototype.write=function(t){return this.extractGeometry(t)},J.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!K[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+K[e].apply(this,[t])+")"};var K={coordinate:function(t){return t.x+" "+t.y},point:function(t){return K.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+K.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(K.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(K.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+K.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+K.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+K.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+K.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},Z={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(W.spaces);return this.geometryFactory.createPoint(new I(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(W.trimParens,"$1"),i.push(Z.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(W.spaces),i.push(new I(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(W.spaces),i.push(new I(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(W.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(W.trimParens,"$1"),i.push(Z.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split(W.parenComma),s=[],a=0,u=o.length;a<u;++a)e=o[a].replace(W.trimParens,"$1"),n=Z.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(W.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(W.trimParens,"$1"),i.push(Z.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}},Q=function(t){this.parser=new J(t)};Q.prototype.write=function(t){return this.parser.write(t)},Q.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var $=function(e){function t(t){e.call(this,t),this.name="RuntimeException",this.message=t,this.stack=(new e).stack}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Error),tt=function(e){function t(){if(e.call(this),0===arguments.length)e.call(this);else if(1===arguments.length){var t=arguments[0];e.call(this,t)}}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}($),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t,e;if(1===arguments.length)t=arguments[0],et.isTrue(t,null);else if(2===arguments.length&&(t=arguments[0],e=arguments[1],!t))throw null===e?new tt:new tt(e)},et.equals=function(){var t,e,n;if(2===arguments.length)t=arguments[0],e=arguments[1],et.equals(t,e,null);else if(3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],!e.equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var nt=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new I,this._intPt[1]=new I,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},it={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};nt.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},nt.prototype.getTopologySummary=function(){var t=new R;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},nt.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},nt.prototype.getIntersectionNum=function(){return this._result},nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},nt.prototype.setPrecisionModel=function(t){this._precisionModel=t},nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},nt.prototype.getIntersection=function(t){return this._intPt[t]},nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},nt.prototype.hasIntersection=function(){return this._result!==nt.NO_INTERSECTION},nt.prototype.getEdgeDistance=function(t,e){return nt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},nt.prototype.isCollinear=function(){return this._result===nt.COLLINEAR_INTERSECTION},nt.prototype.toString=function(){return Q.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Q.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},nt.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},nt.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},nt.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r<i?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=r<i?s:a)||t.equals(e)||(o=Math.max(s,a))}return et.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},nt.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return et.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},it.DONT_INTERSECT.get=function(){return 0},it.DO_INTERSECT.get=function(){return 1},it.COLLINEAR.get=function(){return 2},it.NO_INTERSECTION.get=function(){return 0},it.POINT_INTERSECTION.get=function(){return 1},it.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(nt,it);var rt=function(u){function s(){u.apply(this,arguments)}return u&&(s.__proto__=u),((s.prototype=Object.create(u&&u.prototype)).constructor=s).prototype.isInSegmentEnvelopes=function(t){var e=new H(this._inputLines[0][0],this._inputLines[0][1]),n=new H(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},s.prototype.computeIntersection=function(){if(3!==arguments.length)return u.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2];if(this._isProper=!1,H.intersects(e,n,t)&&0===at.orientationIndex(e,n,t)&&0===at.orientationIndex(n,e,t))return this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this._result=u.POINT_INTERSECTION,null;this._result=u.NO_INTERSECTION},s.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},s.prototype.safeHCoordinateIntersection=function(e,n,i,r){var o=null;try{o=Y.intersection(e,n,i,r)}catch(t){if(!(t instanceof z))throw t;o=s.nearestEndpoint(e,n,i,r)}return o},s.prototype.intersection=function(t,e,n,i){var r=this.intersectionWithNormalization(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new I(s.nearestEndpoint(t,e,n,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(r),r},s.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},s.prototype.checkDD=function(t,e,n,i,r){var o=G.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);V.out.println("DD in env = "+s+"  --------------------- "+o),1e-4<r.distance(o)&&V.out.println("Distance = "+r.distance(o))},s.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new I(t),o=new I(e),s=new I(n),a=new I(i),u=new I;this.normalizeToEnvCentre(r,o,s,a,u);var l=this.safeHCoordinateIntersection(r,o,s,a);return l.x+=u.x,l.y+=u.y,l},s.prototype.computeCollinearIntersection=function(t,e,n,i){var r=H.intersects(t,e,n),o=H.intersects(t,e,i),s=H.intersects(n,i,t),a=H.intersects(n,i,e);return r&&o?(this._intPt[0]=n,this._intPt[1]=i,u.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=t,this._intPt[1]=e,u.COLLINEAR_INTERSECTION):r&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||o||a?u.COLLINEAR_INTERSECTION:u.POINT_INTERSECTION):r&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||o||s?u.COLLINEAR_INTERSECTION:u.POINT_INTERSECTION):o&&s?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||r||a?u.COLLINEAR_INTERSECTION:u.POINT_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||r||s?u.COLLINEAR_INTERSECTION:u.POINT_INTERSECTION):u.NO_INTERSECTION},s.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,h=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,p=n.y>i.y?n.y:i.y,f=((l<o?o:l)+(a<c?a:c))/2,d=((h<s?s:h)+(u<p?u:p))/2;r.x=f,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},s.prototype.computeIntersect=function(t,e,n,i){if(this._isProper=!1,!H.intersects(t,e,n,i))return u.NO_INTERSECTION;var r=at.orientationIndex(t,e,n),o=at.orientationIndex(t,e,i);if(0<r&&0<o||r<0&&o<0)return u.NO_INTERSECTION;var s=at.orientationIndex(n,i,t),a=at.orientationIndex(n,i,e);return 0<s&&0<a||s<0&&a<0?u.NO_INTERSECTION:0===r&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this._intPt[0]=e:0===r?this._intPt[0]=new I(n):0===o?this._intPt[0]=new I(i):0===s?this._intPt[0]=new I(t):0===a&&(this._intPt[0]=new I(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,i)),u.POINT_INTERSECTION)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.nearestEndpoint=function(t,e,n,i){var r=t,o=at.distancePointLine(t,n,i),s=at.distancePointLine(e,n,i);return s<o&&(o=s,r=e),(s=at.distancePointLine(n,t,e))<o&&(o=s,r=n),(s=at.distancePointLine(i,t,e))<o&&(o=s,r=i),r},s}(nt),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return ot.signOfDet2x2(i,r,o,s)},ot.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:0<e?0<n?-r:r:0<n?r:-r;if(0===e||0===n)return 0<i?0<t?r:-r:0<t?-r:r;if(0<e?0<i?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):i=e<=-i?(r=-r,n=-n,-i):(o=t,t=-n,n=o,o=e,e=-i,o):0<i?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):i=i<=e?(t=-t,e=-e,n=-n,-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,o),0<t){if(!(0<n))return r;if(!(t<=n))return r}else{if(0<n)return-r;if(!(n<=t))return-r;r=-r,t=-t,n=-n}for(;;){if(n-=(s=Math.floor(n/t))*t,(i-=s*e)<0)return-r;if(e<i)return r;if(n+n<t){if(e<i+i)return r}else{if(i+i<e)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if(t-=(s=Math.floor(t/n))*n,(e-=s*i)<0)return r;if(i<e)return-r;if(t+t<n){if(i<e+e)return-r}else{if(e+e<i)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var st=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};st.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return i<n&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,u=ot.signOfDet2x2(r,o,s,a);if(0===u)return this._isPointOnSegment=!0,null;a<o&&(u=-u),0<u&&this._crossingCount++}},st.prototype.isPointInPolygon=function(){return this.getLocation()!==C.EXTERIOR},st.prototype.getLocation=function(){return this._isPointOnSegment?C.BOUNDARY:this._crossingCount%2==1?C.INTERIOR:C.EXTERIOR},st.prototype.isOnSegment=function(){return this._isPointOnSegment},st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.locatePointInRing=function(){if(arguments[0]instanceof I&&N(arguments[1],U)){for(var t=arguments[0],e=arguments[1],n=new st(t),i=new I,r=new I,o=1;o<e.size();o++)if(e.getCoordinate(o,i),e.getCoordinate(o-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof I&&arguments[1]instanceof Array){for(var s=arguments[0],a=arguments[1],u=new st(s),l=1;l<a.length;l++){var h=a[l],c=a[l-1];if(u.countSegment(h,c),u.isOnSegment())return u.getLocation()}return u.getLocation()}};var at=function(){},ut={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,n){return G.orientationIndex(t,e,n)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(N(arguments[0],U)){var s=arguments[0],a=s.size();if(a<3)return 0;var u=new I,l=new I,h=new I;s.getCoordinate(0,l),s.getCoordinate(1,h);var c=l.x;h.x-=c;for(var p=0,f=1;f<a-1;f++)u.y=l.y,l.x=h.x,l.y=h.y,s.getCoordinate(f+1,h),h.x-=c,p+=l.x*(u.y-h.y);return p/2}},at.distanceLineLine=function(t,e,n,i){if(t.equals(e))return at.distancePointLine(t,n,i);if(n.equals(i))return at.distancePointLine(i,t,e);var r=!1;if(H.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,u=s/o;(u<0||1<u||a<0||1<a)&&(r=!0)}}else r=!0;return r?O.min(at.distancePointLine(t,n,i),at.distancePointLine(e,n,i),at.distancePointLine(n,t,e),at.distancePointLine(i,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==C.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new I;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;s<e;s++){t.getCoordinate(s,i);var a=i.x,u=i.y,l=a-r,h=u-o;n+=Math.sqrt(l*l+h*h),r=a,o=u}return n},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new m("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}for(var s=i;(s-=1)<0&&(s=e),t[s].equals2D(n)&&s!==i;);for(var a=i;t[a=(a+1)%e].equals2D(n)&&a!==i;);var u=t[s],l=t[a];if(u.equals2D(n)||l.equals2D(n)||u.equals2D(l))return!1;var h=at.computeOrientation(u,n,l);return 0===h?u.x>l.x:0<h},at.locatePointInRing=function(t,e){return st.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},at.computeOrientation=function(t,e,n){return at.orientationIndex(t,e,n)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new m("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var r=at.distancePointLine(t,e[i],e[i+1]);r<n&&(n=r)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var u=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),l=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/u;if(l<=0)return o.distance(s);if(1<=l)return o.distance(a);var h=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/u;return Math.abs(h)*Math.sqrt(u)}},at.isOnLine=function(t,e){for(var n=new rt,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},ut.CLOCKWISE.get=function(){return-1},ut.RIGHT.get=function(){return at.CLOCKWISE},ut.COUNTERCLOCKWISE.get=function(){return 1},ut.LEFT.get=function(){return at.COUNTERCLOCKWISE},ut.COLLINEAR.get=function(){return 0},ut.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,ut);var lt=function(){};lt.prototype.filter=function(t){},lt.prototype.interfaces_=function(){return[]},lt.prototype.getClass=function(){return lt};var ht=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ct={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ht.prototype.isGeometryCollection=function(){return this.getSortIndex()===ht.SORTINDEX_GEOMETRYCOLLECTION},ht.prototype.getFactory=function(){return this._factory},ht.prototype.getGeometryN=function(t){return this},ht.prototype.getArea=function(){return 0},ht.prototype.isRectangle=function(){return!1},ht.prototype.equals=function(){if(arguments[0]instanceof ht){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ht))return!1;var n=e;return this.equalsExact(n)}},ht.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ht.prototype.geometryChanged=function(){this.apply(ht.geometryChangedFilter)},ht.prototype.geometryChangedAction=function(){this._envelope=null},ht.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ht.prototype.getLength=function(){return 0},ht.prototype.getNumGeometries=function(){return 1},ht.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}},ht.prototype.getUserData=function(){return this._userData},ht.prototype.getSRID=function(){return this._SRID},ht.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ht.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ht.SORTINDEX_GEOMETRYCOLLECTION)throw new m("This method does not support GeometryCollection arguments")},ht.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},ht.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ht.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ht.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new H(this._envelope)},ht.prototype.setSRID=function(t){this._SRID=t},ht.prototype.setUserData=function(t){this._userData=t},ht.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},ht.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ht.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ht.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ht.SORTINDEX_MULTIPOINT||this.getSortIndex()===ht.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ht.SORTINDEX_MULTIPOLYGON},ht.prototype.interfaces_=function(){return[E,x,e]},ht.prototype.getClass=function(){return ht},ht.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ht.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ct.serialVersionUID.get=function(){return 0x799ea46522854c00},ct.SORTINDEX_POINT.get=function(){return 0},ct.SORTINDEX_MULTIPOINT.get=function(){return 1},ct.SORTINDEX_LINESTRING.get=function(){return 2},ct.SORTINDEX_LINEARRING.get=function(){return 3},ct.SORTINDEX_MULTILINESTRING.get=function(){return 4},ct.SORTINDEX_POLYGON.get=function(){return 5},ct.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ct.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ct.geometryChangedFilter.get=function(){return pt},Object.defineProperties(ht,ct);var pt=function(){};pt.interfaces_=function(){return[lt]},pt.filter=function(t){t.geometryChangedAction()};var ft=function(){};ft.prototype.filter=function(t){},ft.prototype.interfaces_=function(){return[]},ft.prototype.getClass=function(){return ft};var dt=function(){},gt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};dt.prototype.isInBoundary=function(t){},dt.prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt},gt.Mod2BoundaryNodeRule.get=function(){return yt},gt.EndPointBoundaryNodeRule.get=function(){return _t},gt.MultiValentEndPointBoundaryNodeRule.get=function(){return mt},gt.MonoValentEndPointBoundaryNodeRule.get=function(){return vt},gt.MOD2_BOUNDARY_RULE.get=function(){return new yt},gt.ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},gt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new mt},gt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new vt},gt.OGC_SFS_BOUNDARY_RULE.get=function(){return dt.MOD2_BOUNDARY_RULE},Object.defineProperties(dt,gt);var yt=function(){};yt.prototype.isInBoundary=function(t){return t%2==1},yt.prototype.interfaces_=function(){return[dt]},yt.prototype.getClass=function(){return yt};var _t=function(){};_t.prototype.isInBoundary=function(t){return 0<t},_t.prototype.interfaces_=function(){return[dt]},_t.prototype.getClass=function(){return _t};var mt=function(){};mt.prototype.isInBoundary=function(t){return 1<t},mt.prototype.interfaces_=function(){return[dt]},mt.prototype.getClass=function(){return mt};var vt=function(){};vt.prototype.isInBoundary=function(t){return 1===t},vt.prototype.interfaces_=function(){return[dt]},vt.prototype.getClass=function(){return vt};var bt=function(){};bt.prototype.add=function(){},bt.prototype.addAll=function(){},bt.prototype.isEmpty=function(){},bt.prototype.iterator=function(){},bt.prototype.size=function(){},bt.prototype.toArray=function(){},bt.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var xt=function(){};xt.prototype.hasNext=function(){},xt.prototype.next=function(){},xt.prototype.remove=function(){};var Et=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(bt);(i.prototype=new Error).name="NoSuchElementException";var wt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof bt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,bt]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(t,arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new It(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(Et),It=function(e){function t(t){e.call(this),this.arrayList_=t,this.position_=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.next=function(){if(this.position_===this.arrayList_.size())throw new i;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}(xt),Lt=function(v){function t(){if(v.call(this),0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}v&&(t.__proto__=v),(t.prototype=Object.create(v&&v.prototype)).constructor=t;var e={coordArrayType:{configurable:!0}};return e.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(t){return this.get(t)},t.prototype.addAll=function(){if(2!==arguments.length)return v.prototype.addAll.apply(this,arguments);for(var t=arguments[0],e=arguments[1],n=!1,i=t.iterator();i.hasNext();)this.add(i.next(),e),n=!0;return n},t.prototype.clone=function(){for(var t=v.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){if(1===arguments.length){var t=arguments[0];v.prototype.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}if(arguments[0]instanceof I&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1]&&1<=this.size()&&this.get(this.size()-1).equals2D(i))return null;v.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var r=arguments[0],o=arguments[1];return this.add(r,o),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var s=arguments[0],a=arguments[1];if(arguments[2])for(var u=0;u<s.length;u++)this.add(s[u],a);else for(var l=s.length-1;0<=l;l--)this.add(s[l],a);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof I){var h=arguments[0],c=arguments[1];if(!arguments[2]){var p=this.size();if(0<p){if(0<h&&this.get(h-1).equals2D(c))return null;if(h<p&&this.get(h).equals2D(c))return null}}v.prototype.add.call(this,h,c)}}else if(4===arguments.length){var f=arguments[0],d=arguments[1],g=arguments[2],y=arguments[3],_=1;y<g&&(_=-1);for(var m=g;m!==y;m+=_)this.add(f[m],d);return!0}},t.prototype.closeRing=function(){0<this.size()&&this.add(new I(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,e),t}(wt),St=function(){},Mt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Mt.ForwardComparator.get=function(){return Ct},Mt.BidirectionalComparator.get=function(){return Pt},Mt.coordArrayType.get=function(){return new Array(0).fill(null)},St.prototype.interfaces_=function(){return[]},St.prototype.getClass=function(){return St},St.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},St.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(St.indexOf(i,e)<0)return i}return null},St.scroll=function(t,e){var n=St.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);V.arraycopy(t,n,i,0,t.length-n),V.arraycopy(t,0,i,t.length-n,n),V.arraycopy(i,0,t,0,t.length)},St.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var s=0;s<i.length;s++)if(0!==o.compare(i[s],r[s]))return!1;return!0}},St.intersection=function(t,e){for(var n=new Lt,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},St.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},St.removeRepeatedPoints=function(t){return St.hasRepeatedPoints(t)?new Lt(t,!1).toCoordinateArray():t},St.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},St.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},St.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new I(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],u=0;u<a;u++)o[s+u]=new I(i[r+u])},St.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},St.envelope=function(t){for(var e=new H,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},St.toCoordinateArray=function(t){return t.toArray(St.coordArrayType)},St.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},St.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},St.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},St.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},St.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||0<e.compareTo(t[n]))&&(e=t[n]);return e},St.extract=function(t,e,n){e=O.clamp(e,0,t.length);var i=(n=O.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;s<=n;s++)r[o++]=t[s];return r},Object.defineProperties(St,Mt);var Ct=function(){};Ct.prototype.compare=function(t,e){return St.compare(t,e)},Ct.prototype.interfaces_=function(){return[w]},Ct.prototype.getClass=function(){return Ct};var Pt=function(){};Pt.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=St.compare(n,i);return St.isEqualReversed(n,i)?0:r},Pt.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=St.increasingDirection(n),o=St.increasingDirection(i),s=0<r?0:n.length-1,a=0<o?0:n.length-1,u=0;u<n.length;u++){var l=n[s].compareTo(i[a]);if(0!==l)return l;s+=r,a+=o}return 0},Pt.prototype.interfaces_=function(){return[w]},Pt.prototype.getClass=function(){return Pt};var Nt=function(){};Nt.prototype.get=function(){},Nt.prototype.put=function(){},Nt.prototype.size=function(){},Nt.prototype.values=function(){},Nt.prototype.entrySet=function(){};var Ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Nt);(r.prototype=new Error).name="OperationNotSupported",(o.prototype=new bt).contains=function(){};var Tt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof bt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Rt(this)},e}(o),Rt=function(e){function t(t){e.call(this),this.hashSet_=t,this.position_=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.next=function(){if(this.position_===this.hashSet_.size())throw new i;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new r},t}(xt),kt=0;(c.prototype=new Ot).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(0<n))return e.value;e=e.right}}return null},c.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:kt,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(0<i)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:kt,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},c.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===l(a(a(t)))){var e=h(a(a(t)));1===s(e)?(u(a(t),kt),u(e,kt),u(a(a(t)),1),t=a(a(t))):(t===h(a(t))&&(t=a(t),this.rotateLeft(t)),u(a(t),kt),u(a(a(t)),1),this.rotateRight(a(a(t))))}else{var n=l(a(a(t)));1===s(n)?(u(a(t),kt),u(n,kt),u(a(a(t)),1),t=a(a(t))):(t===l(a(t))&&(t=a(t),this.rotateRight(t)),u(a(t),kt),u(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=kt},c.prototype.values=function(){var t=new wt,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=c.successor(e));)t.add(e.value);return t},c.prototype.entrySet=function(){var t=new Tt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=c.successor(e));)t.add(e);return t},c.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,(e.left=t).parent=e}},c.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,(e.right=t).parent=e}},c.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},c.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)n=(i=n).parent;return n},c.prototype.size=function(){return this.size_};var Dt=function(){};Dt.prototype.interfaces_=function(){return[]},Dt.prototype.getClass=function(){return Dt},p.prototype=new o,(f.prototype=new p).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},f.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},f.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},f.prototype.remove=function(t){throw new r},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},f.prototype.iterator=function(){return new At(this)};var At=function(t){this.treeSet_=t,this.position_=0};At.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new i;return this.treeSet_.array_[this.position_++]},At.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},At.prototype.remove=function(){throw new r};var Ft=function(){};Ft.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},Ft.asList=function(t){for(var e=new wt,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};var Gt=function(){},Bt={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Bt.P.get=function(){return 0},Bt.L.get=function(){return 1},Bt.A.get=function(){return 2},Bt.FALSE.get=function(){return-1},Bt.TRUE.get=function(){return-2},Bt.DONTCARE.get=function(){return-3},Bt.SYM_FALSE.get=function(){return"F"},Bt.SYM_TRUE.get=function(){return"T"},Bt.SYM_DONTCARE.get=function(){return"*"},Bt.SYM_P.get=function(){return"0"},Bt.SYM_L.get=function(){return"1"},Bt.SYM_A.get=function(){return"2"},Gt.prototype.interfaces_=function(){return[]},Gt.prototype.getClass=function(){return Gt},Gt.toDimensionSymbol=function(t){switch(t){case Gt.FALSE:return Gt.SYM_FALSE;case Gt.TRUE:return Gt.SYM_TRUE;case Gt.DONTCARE:return Gt.SYM_DONTCARE;case Gt.P:return Gt.SYM_P;case Gt.L:return Gt.SYM_L;case Gt.A:return Gt.SYM_A}throw new m("Unknown dimension value: "+t)},Gt.toDimensionValue=function(t){switch(D.toUpperCase(t)){case Gt.SYM_FALSE:return Gt.FALSE;case Gt.SYM_TRUE:return Gt.TRUE;case Gt.SYM_DONTCARE:return Gt.DONTCARE;case Gt.SYM_P:return Gt.P;case Gt.SYM_L:return Gt.L;case Gt.SYM_A:return Gt.A}throw new m("Unknown dimension symbol: "+t)},Object.defineProperties(Gt,Bt);var Ut=function(){};Ut.prototype.filter=function(t){},Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut};var qt=function(){};qt.prototype.filter=function(t,e){},qt.prototype.isDone=function(){},qt.prototype.isGeometryChanged=function(){},qt.prototype.interfaces_=function(){return[]},qt.prototype.getClass=function(){return qt};var jt=function(r){function n(t,e){if(r.call(this,e),this._geometries=t||[],r.hasNullElements(this._geometries))throw new m("geometries must not contain null elements")}r&&(n.__proto__=r);var t={serialVersionUID:{configurable:!0}};return((n.prototype=Object.create(r&&r.prototype)).constructor=n).prototype.computeEnvelopeInternal=function(){for(var t=new H,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},n.prototype.getGeometryN=function(t){return this._geometries[t]},n.prototype.getSortIndex=function(){return r.SORTINDEX_GEOMETRYCOLLECTION},n.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},n.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},n.prototype.equalsExact=function(){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._geometries.length!==n._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!this._geometries[i].equalsExact(n._geometries[i],e))return!1;return!0},n.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Ft.sort(this._geometries)},n.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},n.prototype.getBoundaryDimension=function(){for(var t=Gt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},n.prototype.getDimension=function(){for(var t=Gt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},n.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},n.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},n.prototype.getNumGeometries=function(){return this._geometries.length},n.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},n.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new f(Ft.asList(this._geometries)),n=new f(Ft.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o=i,s=this.getNumGeometries(),a=o.getNumGeometries(),u=0;u<s&&u<a;){var l=this.getGeometryN(u),h=o.getGeometryN(u),c=l.compareToSameClass(h,r);if(0!==c)return c;u++}return u<s?1:u<a?-1:0}},n.prototype.apply=function(){if(N(arguments[0],ft))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(N(arguments[0],qt)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(N(arguments[0],Ut)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(N(arguments[0],lt)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},n.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},n.prototype.clone=function(){var t=r.prototype.clone.call(this);t._geometries=new Array(this._geometries.length).fill(null);for(var e=0;e<this._geometries.length;e++)t._geometries[e]=this._geometries[e].clone();return t},n.prototype.getGeometryType=function(){return"GeometryCollection"},n.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)},n.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},t.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(n,t),n}(ht),zt=function(n){function i(){n.apply(this,arguments)}n&&(i.__proto__=n);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getSortIndex=function(){return ht.SORTINDEX_MULTILINESTRING},i.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&n.prototype.equalsExact.call(this,t,e)},i.prototype.getBoundaryDimension=function(){return this.isClosed()?Gt.FALSE:0},i.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},i.prototype.getDimension=function(){return 1},i.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},i.prototype.getBoundary=function(){return new Vt(this).getBoundary()},i.prototype.getGeometryType=function(){return"MultiLineString"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.interfaces_=function(){return[Dt]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(i,t),i}(jt),Vt=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=dt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}};Vt.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Vt.prototype.getBoundary=function(){return this._geom instanceof Jt?this.boundaryLineString(this._geom):this._geom instanceof zt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Vt.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Vt.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Vt.prototype.computeBoundaryCoordinates=function(t){var e=new wt;this._endpointMap=new c;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return St.toCoordinateArray(e)},Vt.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Yt,this._endpointMap.put(t,e)),e.count++},Vt.prototype.interfaces_=function(){return[]},Vt.prototype.getClass=function(){return Vt},Vt.getBoundary=function(){if(1===arguments.length){var t=arguments[0];return new Vt(t).getBoundary()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new Vt(e,n).getBoundary()}};var Yt=function(){this.count=null};Yt.prototype.interfaces_=function(){return[]},Yt.prototype.getClass=function(){return Yt};var Ht=function(){},Xt={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Ht.prototype.interfaces_=function(){return[]},Ht.prototype.getClass=function(){return Ht},Ht.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},Ht.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",s=new function(){}(new function(){}(Ht.getStackTrace(i))),a=0;a<r;a++)try{o+=s.readLine()+Ht.NEWLINE}catch(t){if(!(t instanceof d))throw t;et.shouldNeverReachHere()}return o}},Ht.split=function(t,e){for(var n=e.length,i=new wt,r=""+t,o=r.indexOf(e);0<=o;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}0<r.length&&i.add(r);for(var a=new Array(i.size()).fill(null),u=0;u<a.length;u++)a[u]=i.get(u);return a},Ht.toString=function(){if(1===arguments.length){var t=arguments[0];return Ht.SIMPLE_ORDINATE_FORMAT.format(t)}},Ht.spaces=function(t){return Ht.chars(" ",t)},Xt.NEWLINE.get=function(){return V.getProperty("line.separator")},Xt.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Ht,Xt);var Wt=function(){};Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt},Wt.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},Wt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,U.X)===t.getOrdinate(e-1,U.X)&&t.getOrdinate(0,U.Y)===t.getOrdinate(e-1,U.Y)},Wt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||v.isNaN(s)&&v.isNaN(a)))return!1}return!0},Wt.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(Wt.copy(e,0,i,0,r),0<r)for(var o=r;o<n;o++)Wt.copy(e,r-1,i,o,1);return i},Wt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)Wt.swap(t,i,e-i)},Wt.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},Wt.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)Wt.copyCoord(t,e+o,n,i+o)},Wt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new R;i.append("(");for(var r=0;r<e;r++){0<r&&i.append(" ");for(var o=0;o<n;o++)0<o&&i.append(","),i.append(Ht.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},Wt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Wt.createClosedRing(t,e,4):e.getOrdinate(0,U.X)===e.getOrdinate(n-1,U.X)&&e.getOrdinate(0,U.Y)===e.getOrdinate(n-1,U.Y)?e:Wt.createClosedRing(t,e,n+1)},Wt.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();Wt.copy(e,0,i,0,r);for(var o=r;o<n;o++)Wt.copy(e,0,i,o,1);return i};var Jt=function(r){function e(t,e){r.call(this,e),this._points=null,this.init(t)}r&&(e.__proto__=r);var t={serialVersionUID:{configurable:!0}};return((e.prototype=Object.create(r&&r.prototype)).constructor=e).prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new H:this._points.expandEnvelope(new H)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return r.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._points.size()!==n._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!this.equal(this._points.getCoordinate(i),n._points.getCoordinate(i),e))return!1;return!0},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return 0<this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))&&Wt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Gt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Wt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(N(arguments[0],ft))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(N(arguments[0],qt)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else N(arguments[0],Ut)?arguments[0].filter(this):N(arguments[0],lt)&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Vt(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var t=r.prototype.clone.call(this);return t._points=this._points.clone(),t},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new m("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,t),e}(ht),Kt=function(){};Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt};var Zt=function(n){function t(t,e){n.call(this,e),this._coordinates=t||null,this.init(this._coordinates)}n&&(t.__proto__=n);var e={serialVersionUID:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new H;var t=new H;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},t.prototype.getSortIndex=function(){return n.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return Gt.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},t.prototype.apply=function(){if(N(arguments[0],ft)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(N(arguments[0],qt)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else N(arguments[0],Ut)?arguments[0].filter(this):N(arguments[0],lt)&&arguments[0].filter(this)},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var t=n.prototype.clone.call(this);return t._coordinates=this._coordinates.clone(),t},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return 0===this._coordinates.size()},t.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[Kt]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(t,e),t}(ht),Qt=function(){};Qt.prototype.interfaces_=function(){return[]},Qt.prototype.getClass=function(){return Qt};var $t=function(s){function i(t,e,n){if(s.call(this,n),this._shell=null,(this._holes=null)===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),s.hasNullElements(e))throw new m("holes must not contain null elements");if(t.isEmpty()&&s.hasNonEmptyElements(e))throw new m("shell is empty but holes are not");this._shell=t,this._holes=e}s&&(i.__proto__=s);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(s&&s.prototype)).constructor=i).prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},i.prototype.getSortIndex=function(){return s.SORTINDEX_POLYGON},i.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},i.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},i.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var u=t.getX(a),l=t.getY(a);if(u!==o==(l!==s))return!1;o=u,s=l}return!0},i.prototype.equalsExact=function(){if(2!==arguments.length)return s.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,i=this._shell,r=n._shell;if(!i.equalsExact(r,e))return!1;if(this._holes.length!==n._holes.length)return!1;for(var o=0;o<this._holes.length;o++)if(!this._holes[o].equalsExact(n._holes[o],e))return!1;return!0},i.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);Ft.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);V.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=St.minCoordinate(e.getCoordinates());St.scroll(i,r),V.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],at.isCCW(e.getCoordinates())===n&&St.reverse(e.getCoordinates())}},i.prototype.getCoordinate=function(){return this._shell.getCoordinate()},i.prototype.getNumInteriorRing=function(){return this._holes.length},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},i.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},i.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},i.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},i.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],o=i,s=this._shell,a=o._shell,u=s.compareToSameClass(a,r);if(0!==u)return u;for(var l=this.getNumInteriorRing(),h=o.getNumInteriorRing(),c=0;c<l&&c<h;){var p=this.getInteriorRingN(c),f=o.getInteriorRingN(c),d=p.compareToSameClass(f,r);if(0!==d)return d;c++}return c<l?1:c<h?-1:0}},i.prototype.apply=function(t){if(N(t,ft)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(N(t,qt)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(N(t,Ut))t.filter(this);else if(N(t,lt)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},i.prototype.clone=function(){var t=s.prototype.clone.call(this);t._shell=this._shell.clone(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].clone();return t},i.prototype.getGeometryType=function(){return"Polygon"},i.prototype.copy=function(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),n=0;n<e.length;n++)e[n]=this._holes[n].copy();return new i(t,e,this._factory)},i.prototype.getExteriorRing=function(){return this._shell},i.prototype.isEmpty=function(){return this._shell.isEmpty()},i.prototype.getInteriorRingN=function(t){return this._holes[t]},i.prototype.interfaces_=function(){return[Qt]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(i,t),i}(ht),te=function(n){function i(){n.apply(this,arguments)}n&&(i.__proto__=n);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getSortIndex=function(){return ht.SORTINDEX_MULTIPOINT},i.prototype.isValid=function(){return!0},i.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&n.prototype.equalsExact.call(this,t,e)},i.prototype.getCoordinate=function(){if(1!==arguments.length)return n.prototype.getCoordinate.apply(this,arguments);var t=arguments[0];return this._geometries[t].getCoordinate()},i.prototype.getBoundaryDimension=function(){return Gt.FALSE},i.prototype.getDimension=function(){return 0},i.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},i.prototype.getGeometryType=function(){return"MultiPoint"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.interfaces_=function(){return[Kt]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(i,t),i}(jt),ee=function(n){function t(t,e){t instanceof I&&e instanceof _e&&(t=e.getCoordinateSequenceFactory().create(t)),n.call(this,t,e),this.validateConstruction()}n&&(t.__proto__=n);var e={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.getSortIndex=function(){return ht.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return Gt.FALSE},t.prototype.isClosed=function(){return!!this.isEmpty()||n.prototype.isClosed.call(this)},t.prototype.reverse=function(){var t=this._points.copy();return Wt.reverse(t),this.getFactory().createLinearRing(t)},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!n.prototype.isClosed.call(this))throw new m("Points of LinearRing do not form a closed linestring");if(1<=this.getCoordinateSequence().size()&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new m("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.MINIMUM_VALID_SIZE.get=function(){return 4},e.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,e),t}(Jt),ne=function(n){function i(){n.apply(this,arguments)}n&&(i.__proto__=n);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getSortIndex=function(){return ht.SORTINDEX_MULTIPOLYGON},i.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&n.prototype.equalsExact.call(this,t,e)},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new wt,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},i.prototype.getGeometryType=function(){return"MultiPolygon"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.interfaces_=function(){return[Qt]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(i,t),i}(jt),ie=function(t){this._factory=t||null,this._isUserDataCopied=!1},re={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ie.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},ie.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},ie.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof jt?this.editGeometryCollection(t,e):t instanceof $t?this.editPolygon(t,e):t instanceof Zt?e.edit(t,this._factory):t instanceof Jt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},ie.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new wt,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===te?this._factory.createMultiPoint(i.toArray([])):n.getClass()===zt?this._factory.createMultiLineString(i.toArray([])):n.getClass()===ne?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},ie.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new wt,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(i,r.toArray([]))},ie.prototype.interfaces_=function(){return[]},ie.prototype.getClass=function(){return ie},ie.GeometryEditorOperation=function(){},re.NoOpGeometryOperation.get=function(){return oe},re.CoordinateOperation.get=function(){return se},re.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(ie,re);var oe=function(){};oe.prototype.edit=function(t,e){return t},oe.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var se=function(){};se.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ee?e.createLinearRing(n):t instanceof Jt?e.createLineString(n):t instanceof Zt?0<n.length?e.createPoint(n[0]):e.createPoint():t},se.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Jt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Zt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var ue=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new I}else if(N(arguments[0],U)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var i=0;i<this._coordinates.length;i++)this._coordinates[i]=n.getCoordinateCopy(i)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this._coordinates=r,this._dimension=o,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var u=0;u<s;u++)this._coordinates[u]=new I}},le={serialVersionUID:{configurable:!0}};ue.prototype.setOrdinate=function(t,e,n){switch(e){case U.X:this._coordinates[t].x=n;break;case U.Y:this._coordinates[t].y=n;break;case U.Z:this._coordinates[t].z=n;break;default:throw new m("invalid ordinateIndex")}},ue.prototype.size=function(){return this._coordinates.length},ue.prototype.getOrdinate=function(t,e){switch(e){case U.X:return this._coordinates[t].x;case U.Y:return this._coordinates[t].y;case U.Z:return this._coordinates[t].z}return v.NaN},ue.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},ue.prototype.getCoordinateCopy=function(t){return new I(this._coordinates[t])},ue.prototype.getDimension=function(){return this._dimension},ue.prototype.getX=function(t){return this._coordinates[t].x},ue.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new ue(t,this._dimension)},ue.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},ue.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new ue(t,this._dimension)},ue.prototype.toString=function(){if(0<this._coordinates.length){var t=new R(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},ue.prototype.getY=function(t){return this._coordinates[t].y},ue.prototype.toCoordinateArray=function(){return this._coordinates},ue.prototype.interfaces_=function(){return[U,e]},ue.prototype.getClass=function(){return ue},le.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(ue,le);var he=function(){},ce={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};he.prototype.readResolve=function(){return he.instance()},he.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new ue(t)}if(N(arguments[0],U)){var e=arguments[0];return new ue(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return 3<i&&(i=3),i<2?new ue(n):new ue(n,i)}},he.prototype.interfaces_=function(){return[M,e]},he.prototype.getClass=function(){return he},he.instance=function(){return he.instanceObject},ce.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},ce.instanceObject.get=function(){return new he},Object.defineProperties(he,ce);var pe=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new wt,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var e=new Tt;return this.map_.entries().forEach(function(t){return e.add(t)}),e},e.prototype.size=function(){return this.map_.size()},e}(Nt),fe=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof ge){var e=arguments[0];(this._modelType=e)===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}},de={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};fe.prototype.equals=function(t){if(!(t instanceof fe))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},fe.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new k(n).compareTo(new k(i))},fe.prototype.getScale=function(){return this._scale},fe.prototype.isFloating=function(){return this._modelType===fe.FLOATING||this._modelType===fe.FLOATING_SINGLE},fe.prototype.getType=function(){return this._modelType},fe.prototype.toString=function(){var t="UNKNOWN";return this._modelType===fe.FLOATING?t="Floating":this._modelType===fe.FLOATING_SINGLE?t="Floating-Single":this._modelType===fe.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},fe.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return v.isNaN(t)?t:this._modelType===fe.FLOATING_SINGLE?t:this._modelType===fe.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof I){var e=arguments[0];if(this._modelType===fe.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},fe.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===fe.FLOATING?t=16:this._modelType===fe.FLOATING_SINGLE?t=6:this._modelType===fe.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},fe.prototype.setScale=function(t){this._scale=Math.abs(t)},fe.prototype.interfaces_=function(){return[e,x]},fe.prototype.getClass=function(){return fe},fe.mostPrecise=function(t,e){return 0<=t.compareTo(e)?t:e},de.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},de.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(fe,de);var ge=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},ye={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};ge.prototype.readResolve=function(){return ge.nameToTypeMap.get(this._name)},ge.prototype.toString=function(){return this._name},ge.prototype.interfaces_=function(){return[e]},ge.prototype.getClass=function(){return ge},ye.serialVersionUID.get=function(){return-552860263173159e4},ye.nameToTypeMap.get=function(){return new pe},Object.defineProperties(ge,ye),fe.Type=ge,fe.FIXED=new ge("FIXED"),fe.FLOATING=new ge("FLOATING"),fe.FLOATING_SINGLE=new ge("FLOATING SINGLE");var _e=function t(){this._precisionModel=new fe,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?N(arguments[0],M)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof fe&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},me={serialVersionUID:{configurable:!0}};_e.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new I(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new I(t.getMinX(),t.getMinY()),new I(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new I(t.getMinX(),t.getMinY()),new I(t.getMinX(),t.getMaxY()),new I(t.getMaxX(),t.getMaxY()),new I(t.getMaxX(),t.getMinY()),new I(t.getMinX(),t.getMinY())]),null)},_e.prototype.createLineString=function(t){return t?t instanceof Array?new Jt(this.getCoordinateSequenceFactory().create(t),this):N(t,U)?new Jt(t,this):void 0:new Jt(this.getCoordinateSequenceFactory().create([]),this)},_e.prototype.createMultiLineString=function(){if(0===arguments.length)return new zt(null,this);if(1===arguments.length){var t=arguments[0];return new zt(t,this)}},_e.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(_e.toGeometryArray(t));var a=t.iterator().next();if(1<t.size()){if(a instanceof $t)return this.createMultiPolygon(_e.toPolygonArray(t));if(a instanceof Jt)return this.createMultiLineString(_e.toLineStringArray(t));if(a instanceof Zt)return this.createMultiPoint(_e.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},_e.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},_e.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof I){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(N(arguments[0],U)){var e=arguments[0];return new Zt(e,this)}}},_e.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},_e.prototype.createPolygon=function(){if(0===arguments.length)return new $t(null,null,this);if(1===arguments.length){if(N(arguments[0],U)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return new $t(i,r,this)}},_e.prototype.getSRID=function(){return this._SRID},_e.prototype.createGeometryCollection=function(){if(0===arguments.length)return new jt(null,this);if(1===arguments.length){var t=arguments[0];return new jt(t,this)}},_e.prototype.createGeometry=function(t){return new ie(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},_e.prototype.getPrecisionModel=function(){return this._precisionModel},_e.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(N(arguments[0],U)){var e=arguments[0];return new ee(e,this)}}},_e.prototype.createMultiPolygon=function(){if(0===arguments.length)return new ne(null,this);if(1===arguments.length){var t=arguments[0];return new ne(t,this)}},_e.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new te(t,this)}if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(N(arguments[0],U)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var i=new Array(n.size()).fill(null),r=0;r<n.size();r++){var o=this.getCoordinateSequenceFactory().create(1,n.getDimension());Wt.copy(n,r,o,0,1),i[r]=this.createPoint(o)}return this.createMultiPoint(i)}}},_e.prototype.interfaces_=function(){return[e]},_e.prototype.getClass=function(){return _e},_e.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.getDefaultCoordinateSequenceFactory=function(){return he.instance()},_e.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},_e.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},me.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(_e,me);var ve=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],be=function(t){this.geometryFactory=t||new _e};be.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!xe[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==ve.indexOf(n)?xe[n].apply(this,[e.coordinates]):"GeometryCollection"===n?xe[n].apply(this,[e.geometries]):xe[n].apply(this,[e])},be.prototype.write=function(t){var e=t.getGeometryType();if(!Ee[e])throw new Error("Geometry is not supported");return Ee[e].apply(this,[t])};var xe={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!xe[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=xe.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new I(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new I(t[0],t[1]),new I(t[2],t[1]),new I(t[2],t[3]),new I(t[0],t[3]),new I(t[0],t[1])])},Point:function(t){var e=new I(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(xe.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=xe.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(xe.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=xe.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=xe.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(xe.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},Ee={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:Ee.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Ee.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(Ee.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Ee.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=Ee.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=Ee.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Ee.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(Ee[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}},we=function(t){this.geometryFactory=t||new _e,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new be(this.geometryFactory)};we.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===fe.FIXED&&this.reducePrecision(e),e},we.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Ie=function(){this.parser=new be(this.geometryFactory)};Ie.prototype.write=function(t){return this.parser.write(t)};var Le=function(){},Se={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le},Le.opposite=function(t){return t===Le.LEFT?Le.RIGHT:t===Le.RIGHT?Le.LEFT:t},Se.ON.get=function(){return 0},Se.LEFT.get=function(){return 1},Se.RIGHT.get=function(){return 2},Object.defineProperties(Le,Se),(g.prototype=new Error).name="EmptyStackException",(y.prototype=new Et).add=function(t){return this.array_.push(t),!0},y.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},y.prototype.push=function(t){return this.array_.push(t),t},y.prototype.pop=function(t){if(0===this.array_.length)throw new g;return this.array_.pop()},y.prototype.peek=function(){if(0===this.array_.length)throw new g;return this.array_[this.array_.length-1]},y.prototype.empty=function(){return 0===this.array_.length},y.prototype.isEmpty=function(){return this.empty()},y.prototype.search=function(t){return this.array_.indexOf(t)},y.prototype.size=function(){return this.array_.length},y.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Me=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Me.prototype.getCoordinate=function(){return this._minCoord},Me.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Me.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(0<this._minIndex&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=at.computeOrientation(this._minCoord,n,e),r=!1;e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===at.COUNTERCLOCKWISE?r=!0:e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===at.CLOCKWISE&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Me.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=Le.LEFT;return n[e].y<n[e+1].y&&(i=Le.RIGHT),i},Me.prototype.getEdge=function(){return this._orientedDe},Me.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Me.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Me.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Le.LEFT&&(this._orientedDe=this._minDe.getSym())},Me.prototype.interfaces_=function(){return[]},Me.prototype.getClass=function(){return Me};var Ce=function(n){function i(t,e){n.call(this,i.msgWithCoord(t,e)),this.pt=e?new I(e):null,this.name="TopologyException"}return n&&(i.__proto__=n),((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getCoordinate=function(){return this.pt},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},i}($),Pe=function(){this.array_=[]};Pe.prototype.addLast=function(t){this.array_.push(t)},Pe.prototype.removeFirst=function(){return this.array_.shift()},Pe.prototype.isEmpty=function(){return 0===this.array_.length};var Ne=function(){this._finder=null,this._dirEdgeList=new wt,this._nodes=new wt,this._rightMostCoord=null,this._env=null,this._finder=new Me};Ne.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Ne.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Ne.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new Ce("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},Ne.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Le.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Ne.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Ne.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();1<=e.getDepth(Le.RIGHT)&&e.getDepth(Le.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Ne.prototype.computeDepths=function(t){var e=new Tt,n=new Pe,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},Ne.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Ne.prototype.getEnvelope=function(){if(null===this._env){for(var t=new H,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},Ne.prototype.addReachable=function(t){var e=new y;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Ne.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Le.LEFT,t.getDepth(Le.RIGHT)),e.setDepth(Le.RIGHT,t.getDepth(Le.LEFT))},Ne.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},Ne.prototype.getNodes=function(){return this._nodes},Ne.prototype.getDirectedEdges=function(){return this._dirEdgeList},Ne.prototype.interfaces_=function(){return[x]},Ne.prototype.getClass=function(){return Ne};var Oe=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Le.ON]=n}else if(arguments[0]instanceof t){var i=arguments[0];if(this.init(i.location.length),null!==i)for(var r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Le.ON]=o,this.location[Le.LEFT]=s,this.location[Le.RIGHT]=a}};Oe.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Oe.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==C.NONE)return!1;return!0},Oe.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===C.NONE&&(this.location[e]=t)},Oe.prototype.isLine=function(){return 1===this.location.length},Oe.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Le.ON]=this.location[Le.ON],e[Le.LEFT]=C.NONE,e[Le.RIGHT]=C.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===C.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Oe.prototype.getLocations=function(){return this.location},Oe.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Le.LEFT];this.location[Le.LEFT]=this.location[Le.RIGHT],this.location[Le.RIGHT]=t},Oe.prototype.toString=function(){var t=new R;return 1<this.location.length&&t.append(C.toLocationSymbol(this.location[Le.LEFT])),t.append(C.toLocationSymbol(this.location[Le.ON])),1<this.location.length&&t.append(C.toLocationSymbol(this.location[Le.RIGHT])),t.toString()},Oe.prototype.setLocations=function(t,e,n){this.location[Le.ON]=t,this.location[Le.LEFT]=e,this.location[Le.RIGHT]=n},Oe.prototype.get=function(t){return t<this.location.length?this.location[t]:C.NONE},Oe.prototype.isArea=function(){return 1<this.location.length},Oe.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===C.NONE)return!0;return!1},Oe.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Le.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Oe.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(C.NONE)},Oe.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Oe.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Oe.prototype.interfaces_=function(){return[]},Oe.prototype.getClass=function(){return Oe};var Te=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Oe(e),this.elt[1]=new Oe(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Oe(n.elt[0]),this.elt[1]=new Oe(n.elt[1])}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.elt[0]=new Oe(C.NONE),this.elt[1]=new Oe(C.NONE),this.elt[i].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Oe(o,s,a),this.elt[1]=new Oe(o,s,a)}else if(4===arguments.length){var u=arguments[0],l=arguments[1],h=arguments[2],c=arguments[3];this.elt[0]=new Oe(C.NONE,C.NONE,C.NONE),this.elt[1]=new Oe(C.NONE,C.NONE,C.NONE),this.elt[u].setLocations(l,h,c)}};Te.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Te.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Te.prototype.isNull=function(t){return this.elt[t].isNull()},Te.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},Te.prototype.isLine=function(t){return this.elt[t].isLine()},Te.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Oe(t.elt[e]):this.elt[e].merge(t.elt[e])},Te.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Te.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Le.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},Te.prototype.toString=function(){var t=new R;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Te.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Te.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Te.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Le.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},Te.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Te.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Te.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Oe(this.elt[t].location[0]))},Te.prototype.interfaces_=function(){return[]},Te.prototype.getClass=function(){return Te},Te.toLineLabel=function(t){for(var e=new Te(C.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Re=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new wt,this._pts=new wt,this._label=new Te(C.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new wt,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Re.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},Re.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Re.prototype.computePoints=function(t){var e=this._startDe=t,n=!0;do{if(null===e)throw new Ce("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Ce("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();et.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Re.prototype.getLinearRing=function(){return this._ring},Re.prototype.getCoordinate=function(t){return this._pts.get(t)},Re.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Re.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var s=i.length-2;n&&(s=i.length-1);for(var a=s;0<=a;a--)this._pts.add(i[a])}},Re.prototype.isHole=function(){return this._isHole},Re.prototype.setInResult=function(){for(var t=this._startDe;t.getEdge().setInResult(!0),(t=t.getNext())!==this._startDe;);},Re.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},Re.prototype.addHole=function(t){this._holes.add(t)},Re.prototype.isShell=function(){return null===this._shell},Re.prototype.getLabel=function(){return this._label},Re.prototype.getEdges=function(){return this._edges},Re.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Re.prototype.getShell=function(){return this._shell},Re.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e.getLocation(n,Le.RIGHT);if(i===C.NONE)return null;if(this._label.getLocation(n)===C.NONE)return this._label.setLocation(n,i),null}},Re.prototype.setShell=function(t){null!==(this._shell=t)&&t.addHole(this)},Re.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re};var ke=function(n){function t(){var t=arguments[0],e=arguments[1];n.call(this,t,e)}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},t.prototype.getNext=function(t){return t.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Re),De=function(n){function t(){var t=arguments[0],e=arguments[1];n.call(this,t,e)}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.buildMinimalRings=function(){var t=new wt,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new ke(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},t.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){for(var t=this._startDe;t.getNode().getEdges().linkMinimalDirectedEdges(this),(t=t.getNext())!==this._startDe;);},t.prototype.getNext=function(t){return t.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Re),Ae=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};Ae.prototype.setVisited=function(t){this._isVisited=t},Ae.prototype.setInResult=function(t){this._isInResult=t},Ae.prototype.isCovered=function(){return this._isCovered},Ae.prototype.isCoveredSet=function(){return this._isCoveredSet},Ae.prototype.setLabel=function(t){this._label=t},Ae.prototype.getLabel=function(){return this._label},Ae.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},Ae.prototype.updateIM=function(t){et.isTrue(2<=this._label.getGeometryCount(),"found partial label"),this.computeIM(t)},Ae.prototype.isInResult=function(){return this._isInResult},Ae.prototype.isVisited=function(){return this._isVisited},Ae.prototype.interfaces_=function(){return[]},Ae.prototype.getClass=function(){return Ae};var Fe=function(n){function r(){n.call(this),this._coord=null,this._edges=null;var t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new Te(0,C.NONE)}return n&&(r.__proto__=n),((r.prototype=Object.create(n&&n.prototype)).constructor=r).prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},r.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},r.prototype.getCoordinate=function(){return this._coord},r.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},r.prototype.computeIM=function(t){},r.prototype.computeMergedLocation=function(t,e){var n=C.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==C.BOUNDARY&&(n=i)}return n},r.prototype.setLabel=function(){if(2!==arguments.length)return n.prototype.setLabel.apply(this,arguments);var t=arguments[0],e=arguments[1];null===this._label?this._label=new Te(t,e):this._label.setLocation(t,e)},r.prototype.getEdges=function(){return this._edges},r.prototype.mergeLabel=function(){if(arguments[0]instanceof r){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Te)for(var e=arguments[0],n=0;n<2;n++){var i=this.computeMergedLocation(e,n);this._label.getLocation(n)===C.NONE&&this._label.setLocation(n,i)}},r.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},r.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=C.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case C.BOUNDARY:n=C.INTERIOR;break;case C.INTERIOR:default:n=C.BOUNDARY}this._label.setLocation(t,n)},r.prototype.interfaces_=function(){return[]},r.prototype.getClass=function(){return r},r}(Ae),Ge=function(){this.nodeMap=new c,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Ge.prototype.find=function(t){return this.nodeMap.get(t)},Ge.prototype.addNode=function(){if(arguments[0]instanceof I){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Fe){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}},Ge.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},Ge.prototype.iterator=function(){return this.nodeMap.values().iterator()},Ge.prototype.values=function(){return this.nodeMap.values()},Ge.prototype.getBoundaryNodes=function(t){for(var e=new wt,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===C.BOUNDARY&&e.add(i)}return e},Ge.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge};var Be=function(){},Ue={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be},Be.isNorthern=function(t){return t===Be.NE||t===Be.NW},Be.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},Be.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(e<t?t:e)?3:n},Be.isInHalfPlane=function(t,e){return e===Be.SE?t===Be.SE||t===Be.SW:t===e||t===e+1},Be.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new m("Cannot compute the quadrant for point ( "+t+", "+e+" )");return 0<=t?0<=e?Be.NE:Be.SE:0<=e?Be.NW:Be.SW}if(arguments[0]instanceof I&&arguments[1]instanceof I){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new m("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?Be.NE:Be.SE:i.y>=n.y?Be.NW:Be.SW}},Ue.NE.get=function(){return 0},Ue.NW.get=function(){return 1},Ue.SW.get=function(){return 2},Ue.SE.get=function(){return 3},Object.defineProperties(Be,Ue);var qe=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._edge=e,this.init(n,i),this._label=null}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=r,this.init(o,s),this._label=a}};qe.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},qe.prototype.getDy=function(){return this._dy},qe.prototype.getCoordinate=function(){return this._p0},qe.prototype.setNode=function(t){this._node=t},qe.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},qe.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},qe.prototype.getDirectedCoordinate=function(){return this._p1},qe.prototype.getDx=function(){return this._dx},qe.prototype.getLabel=function(){return this._label},qe.prototype.getEdge=function(){return this._edge},qe.prototype.getQuadrant=function(){return this._quadrant},qe.prototype.getNode=function(){return this._node},qe.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},qe.prototype.computeLabel=function(t){},qe.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Be.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},qe.prototype.interfaces_=function(){return[x]},qe.prototype.getClass=function(){return qe};var je=function(i){function t(){var t=arguments[0],e=arguments[1];if(i.call(this,t),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(t){return this._depth[t]},t.prototype.setVisited=function(t){this._isVisited=t},t.prototype.computeDirectedLabel=function(){this._label=new Te(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Ce("assigned depths do not match",this.getCoordinate());this._depth[t]=e},t.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Le.LEFT)===C.INTERIOR&&this._label.getLocation(e,Le.RIGHT)===C.INTERIOR||(t=!1);return t},t.prototype.setNextMin=function(t){this._nextMin=t},t.prototype.print=function(t){i.prototype.print.call(this,t),t.print(" "+this._depth[Le.LEFT]+"/"+this._depth[Le.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},t.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},t.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,C.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,C.EXTERIOR);return t&&e&&n},t.prototype.setEdgeRing=function(t){this._edgeRing=t},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},t.prototype.setInResult=function(t){this._isInResult=t},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},t.prototype.setSym=function(t){this._sym=t},t.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},t.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===Le.LEFT&&(i=-1);var r=Le.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(t){this._next=t},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(t,e){return t===C.EXTERIOR&&e===C.INTERIOR?1:t===C.INTERIOR&&e===C.EXTERIOR?-1:0},t}(qe),ze=function(){};ze.prototype.createNode=function(t){return new Fe(t,null)},ze.prototype.interfaces_=function(){return[]},ze.prototype.getClass=function(){return ze};var Ve=function(){if(this._edges=new wt,this._nodes=null,this._edgeEndList=new wt,0===arguments.length)this._nodes=new Ge(new ze);else if(1===arguments.length){var t=arguments[0];this._nodes=new Ge(t)}};Ve.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},Ve.prototype.find=function(t){return this._nodes.find(t)},Ve.prototype.addNode=function(){if(arguments[0]instanceof Fe){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof I){var e=arguments[0];return this._nodes.addNode(e)}},Ve.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ve.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Ve.prototype.debugPrintln=function(t){V.out.println(t)},Ve.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===C.BOUNDARY},Ve.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Ve.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&at.computeOrientation(t,e,i)===at.COLLINEAR&&Be.quadrant(t,e)===Be.quadrant(n,i)},Ve.prototype.getEdgeEnds=function(){return this._edgeEndList},Ve.prototype.debugPrint=function(t){V.out.print(t)},Ve.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ve.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},Ve.prototype.insertEdge=function(t){this._edges.add(t)},Ve.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},Ve.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new je(n,!0),r=new je(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},Ve.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Ve.prototype.getNodes=function(){return this._nodes.values()},Ve.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},Ve.prototype.interfaces_=function(){return[]},Ve.prototype.getClass=function(){return Ve},Ve.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var Ye=function(){this._geometryFactory=null,this._shellList=new wt;var t=arguments[0];this._geometryFactory=t};Ye.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},Ye.prototype.computePolygons=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},Ye.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new Ce("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},Ye.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new wt,r=t.iterator();r.hasNext();){var o=r.next();if(2<o.getMaxNodeDegree()){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},Ye.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Ye.prototype.buildMaximalEdgeRings=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new De(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},Ye.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},Ye.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Ye.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getLinearRing(),h=l.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var c=!1;h.contains(i)&&at.isPointInRing(r,l.getCoordinates())&&(c=!0),c&&(null===o||s.contains(h))&&(o=u)}return o},Ye.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},Ye.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Ve.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new wt,o=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var He=function(){};He.prototype.getBounds=function(){},He.prototype.interfaces_=function(){return[]},He.prototype.getClass=function(){return He};var Xe=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Xe.prototype.getItem=function(){return this._item},Xe.prototype.getBounds=function(){return this._bounds},Xe.prototype.interfaces_=function(){return[He,e]},Xe.prototype.getClass=function(){return Xe};var We=function(){this._size=null,this._items=null,this._size=0,this._items=new wt,this._items.add(null)};We.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},We.prototype.size=function(){return this._size},We.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},We.prototype.clear=function(){this._size=0,this._items.clear()},We.prototype.isEmpty=function(){return 0===this._size},We.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We};var Je=function(){};Je.prototype.visitItem=function(t){},Je.prototype.interfaces_=function(){return[]},Je.prototype.getClass=function(){return Je};var Ke=function(){};Ke.prototype.insert=function(t,e){},Ke.prototype.remove=function(t,e){},Ke.prototype.query=function(){},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke};var Ze=function(){if(this._childBoundables=new wt,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Qe={serialVersionUID:{configurable:!0}};Ze.prototype.getLevel=function(){return this._level},Ze.prototype.size=function(){return this._childBoundables.size()},Ze.prototype.getChildBoundables=function(){return this._childBoundables},Ze.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Ze.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Ze.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Ze.prototype.interfaces_=function(){return[He,e]},Ze.prototype.getClass=function(){return Ze},Qe.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Ze,Qe);var $e=function(){};$e.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},$e.min=function(t){return $e.sort(t),t.get(0)},$e.sort=function(t,e){var n=t.toArray();e?Ft.sort(n,e):Ft.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},$e.singletonList=function(t){var e=new wt;return e.add(t),e};var tn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};tn.prototype.expandToQueue=function(t,e){var n=tn.isComposite(this._boundable1),i=tn.isComposite(this._boundable2);if(n&&i)return tn.area(this._boundable1)>tn.area(this._boundable2)?this.expand(this._boundable1,this._boundable2,t,e):this.expand(this._boundable2,this._boundable1,t,e),null;if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new m("neither boundable is composite")},tn.prototype.isLeaves=function(){return!(tn.isComposite(this._boundable1)||tn.isComposite(this._boundable2))},tn.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},tn.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new tn(o,e,this._itemDistance);s.getDistance()<i&&n.add(s)}},tn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},tn.prototype.getDistance=function(){return this._distance},tn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},tn.prototype.interfaces_=function(){return[x]},tn.prototype.getClass=function(){return tn},tn.area=function(t){return t.getBounds().getArea()},tn.isComposite=function(t){return t instanceof Ze};var en=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new wt,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];et.isTrue(1<n,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};en.prototype.getNodeCapacity=function(){return this._nodeCapacity},en.prototype.lastNode=function(t){return t.get(t.size()-1)},en.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Ze?t+=this.size(n):n instanceof Xe&&(t+=1)}return t}},en.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Xe&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},en.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new wt:t}if(1===arguments.length){for(var e=arguments[0],n=new wt,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Ze){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof Xe?n.add(r.getItem()):et.shouldNeverReachHere()}return n.size()<=0?null:n}},en.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Xe(t,e))},en.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new wt;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(et.isTrue(-2<n),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Ze?this.boundablesAtLevel(n,s,r):(et.isTrue(s instanceof Xe),-1===n&&r.add(s))}return null}},en.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new wt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(N(arguments[2],Je)&&arguments[0]instanceof Object&&arguments[1]instanceof Ze)for(var r=arguments[0],o=arguments[1],s=arguments[2],a=o.getChildBoundables(),u=0;u<a.size();u++){var l=a.get(u);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof Ze?this.query(r,l,s):l instanceof Xe?s.visitItem(l.getItem()):et.shouldNeverReachHere())}else if(N(arguments[2],Et)&&arguments[0]instanceof Object&&arguments[1]instanceof Ze)for(var h=arguments[0],c=arguments[1],p=arguments[2],f=c.getChildBoundables(),d=0;d<f.size();d++){var g=f.get(d);this.getIntersectsOp().intersects(g.getBounds(),h)&&(g instanceof Ze?this.query(h,g,p):g instanceof Xe?p.add(g.getItem()):et.shouldNeverReachHere())}},en.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},en.prototype.getRoot=function(){return this.build(),this._root},en.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var u=a.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&u instanceof Ze&&(o=this.remove(n,u,r))){s=u;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},en.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},en.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Ze){var i=this.depth(n);t<i&&(t=i)}}return t+1}},en.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=new wt;n.add(this.createNode(e));var i=new wt(t);$e.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},en.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},en.prototype.interfaces_=function(){return[e]},en.prototype.getClass=function(){return en},en.compareDoubles=function(t,e){return e<t?1:t<e?-1:0},nn.IntersectsOp.get=function(){return rn},nn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(en,nn);var rn=function(){},on=function(){};on.prototype.distance=function(t,e){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on};var sn=function(l){function _(t){t=t||_.DEFAULT_NODE_CAPACITY,l.call(this,t)}l&&(_.__proto__=l);var t={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return((_.prototype=Object.create(l&&l.prototype)).constructor=_).prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(0<t.length);for(var n=new wt,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},_.prototype.createNode=function(t){return new an(t)},_.prototype.size=function(){return 0===arguments.length?l.prototype.size.call(this):l.prototype.size.apply(this,arguments)},_.prototype.insert=function(){if(2!==arguments.length)return l.prototype.insert.apply(this,arguments);var t=arguments[0],e=arguments[1];if(t.isNull())return null;l.prototype.insert.call(this,t,e)},_.prototype.getIntersectsOp=function(){return _.intersectsOp},_.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new wt;for(var s=0;r.hasNext()&&s<n;){var a=r.next();i[o].add(a),s++}}return i},_.prototype.query=function(){if(1===arguments.length){var t=arguments[0];return l.prototype.query.call(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];l.prototype.query.call(this,e,n)}else if(3===arguments.length)if(N(arguments[2],Je)&&arguments[0]instanceof Object&&arguments[1]instanceof Ze){var i=arguments[0],r=arguments[1],o=arguments[2];l.prototype.query.call(this,i,r,o)}else if(N(arguments[2],Et)&&arguments[0]instanceof Object&&arguments[1]instanceof Ze){var s=arguments[0],a=arguments[1],u=arguments[2];l.prototype.query.call(this,s,a,u)}},_.prototype.getComparator=function(){return _.yComparator},_.prototype.createParentBoundablesFromVerticalSlice=function(t,e){return l.prototype.createParentBoundables.call(this,t,e)},_.prototype.remove=function(){if(2!==arguments.length)return l.prototype.remove.apply(this,arguments);var t=arguments[0],e=arguments[1];return l.prototype.remove.call(this,t,e)},_.prototype.depth=function(){return 0===arguments.length?l.prototype.depth.call(this):l.prototype.depth.apply(this,arguments)},_.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new wt(t);$e.sort(i,_.xComparator);var r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)},_.prototype.nearestNeighbour=function(){if(1===arguments.length){if(N(arguments[0],on)){var t=arguments[0],e=new tn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof tn){var n=arguments[0];return this.nearestNeighbour(n,v.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof _&&N(arguments[1],on)){var i=arguments[0],r=arguments[1],o=new tn(this.getRoot(),i.getRoot(),r);return this.nearestNeighbour(o)}if(arguments[0]instanceof tn&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],u=null,l=new We;for(l.add(s);!l.isEmpty()&&0<a;){var h=l.poll(),c=h.getDistance();if(a<=c)break;h.isLeaves()?(a=c,u=h):h.expandToQueue(l,a)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var p=arguments[0],f=arguments[1],d=arguments[2],g=new Xe(p,f),y=new tn(this.getRoot(),g,d);return this.nearestNeighbour(y)[0]}},_.prototype.interfaces_=function(){return[Ke,e]},_.prototype.getClass=function(){return _},_.centreX=function(t){return _.avg(t.getMinX(),t.getMaxX())},_.avg=function(t,e){return(t+e)/2},_.centreY=function(t){return _.avg(t.getMinY(),t.getMaxY())},t.STRtreeNode.get=function(){return an},t.serialVersionUID.get=function(){return 0x39920f7d5f261e0},t.xComparator.get=function(){return{interfaces_:function(){return[w]},compare:function(t,e){return l.compareDoubles(_.centreX(t.getBounds()),_.centreX(e.getBounds()))}}},t.yComparator.get=function(){return{interfaces_:function(){return[w]},compare:function(t,e){return l.compareDoubles(_.centreY(t.getBounds()),_.centreY(e.getBounds()))}}},t.intersectsOp.get=function(){return{interfaces_:function(){return[l.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},t.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(_,t),_}(en),an=function(e){function t(){var t=arguments[0];e.call(this,t)}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new H(n.getBounds()):t.expandToInclude(n.getBounds())}return t},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Ze),un=function(){};un.prototype.interfaces_=function(){return[]},un.prototype.getClass=function(){return un},un.relativeSign=function(t,e){return t<e?-1:e<t?1:0},un.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=un.relativeSign(e.x,n.x),r=un.relativeSign(e.y,n.y);switch(t){case 0:return un.compareValue(i,r);case 1:return un.compareValue(r,i);case 2:return un.compareValue(r,-i);case 3:return un.compareValue(-i,r);case 4:return un.compareValue(-i,-r);case 5:return un.compareValue(-r,-i);case 6:return un.compareValue(-r,i);case 7:return un.compareValue(i,-r)}return et.shouldNeverReachHere("invalid octant value"),0},un.compareValue=function(t,e){return t<0?-1:0<t?1:e<0?-1:0<e?1:0};var ln=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new I(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))};ln.prototype.getCoordinate=function(){return this.coord},ln.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},ln.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:un.compare(this._segmentOctant,this.coord,e.coord)},ln.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},ln.prototype.isInterior=function(){return this._isInterior},ln.prototype.interfaces_=function(){return[x]},ln.prototype.getClass=function(){return ln};var hn=function(){this._nodeMap=new c,this._edge=null;var t=arguments[0];this._edge=t};hn.prototype.getSplitCoordinates=function(){var t=new Lt;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},hn.prototype.addCollapsedNodes=function(){var t=new wt;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},hn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},hn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new k(e+1))}},hn.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new I(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new I(e.coord))},hn.prototype.iterator=function(){return this._nodeMap.values().iterator()},hn.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},hn.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},hn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new k(e[0])),i=r}},hn.prototype.getEdge=function(){return this._edge},hn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},hn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new I(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new I(e.coord)),new dn(o,this._edge.getData())},hn.prototype.add=function(t,e){var n=new ln(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(et.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},hn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new $("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new $("bad split edge end point at "+r)},hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn};var cn=function(){};cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn},cn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new m("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return 0<=t?0<=e?i<=n?0:1:i<=n?7:6:0<=e?i<=n?3:2:i<=n?4:5}if(arguments[0]instanceof I&&arguments[1]instanceof I){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new m("Cannot compute the octant for two identical points "+r);return cn.octant(s,a)}};var pn=function(){};pn.prototype.getCoordinates=function(){},pn.prototype.size=function(){},pn.prototype.getCoordinate=function(t){},pn.prototype.isClosed=function(){},pn.prototype.setData=function(t){},pn.prototype.getData=function(){},pn.prototype.interfaces_=function(){return[]},pn.prototype.getClass=function(){return pn};var fn=function(){};fn.prototype.addIntersection=function(t,e){},fn.prototype.interfaces_=function(){return[pn]},fn.prototype.getClass=function(){return fn};var dn=function(){this._nodeList=new hn(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};dn.prototype.getCoordinates=function(){return this._pts},dn.prototype.size=function(){return this._pts.length},dn.prototype.getCoordinate=function(t){return this._pts[t]},dn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},dn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},dn.prototype.setData=function(t){this._data=t},dn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:cn.octant(t,e)},dn.prototype.getData=function(){return this._data},dn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[3],o=new I(n.getIntersection(r));this.addIntersection(o,i)}},dn.prototype.toString=function(){return Q.toLineString(new ue(this._pts))},dn.prototype.getNodeList=function(){return this._nodeList},dn.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},dn.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},dn.prototype.interfaces_=function(){return[fn]},dn.prototype.getClass=function(){return dn},dn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new wt;return dn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(i)};var gn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new I,this.p1=new I;else if(1===arguments.length){var t=arguments[0];this.p0=new I(t.p0),this.p1=new I(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this.p0=new I(e,n),this.p1=new I(i,r)}},yn={serialVersionUID:{configurable:!0}};gn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},gn.prototype.orientationIndex=function(){if(arguments[0]instanceof gn){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),n=at.orientationIndex(this.p0,this.p1,t.p1);return 0<=e&&0<=n?Math.max(e,n):e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof I){var i=arguments[0];return at.orientationIndex(this.p0,this.p1,i)}},gn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},gn.prototype.isVertical=function(){return this.p0.x===this.p1.x},gn.prototype.equals=function(t){if(!(t instanceof gn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},gn.prototype.intersection=function(t){var e=new rt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},gn.prototype.project=function(){if(arguments[0]instanceof I){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new I(t);var e=this.projectionFactor(t),n=new I;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof gn){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(1<=r&&1<=o)return null;if(r<=0&&o<=0)return null;var s=this.project(i.p0);r<0&&(s=this.p0),1<r&&(s=this.p1);var a=this.project(i.p1);return o<0&&(a=this.p0),1<o&&(a=this.p1),new gn(s,a)}},gn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},gn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},gn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},gn.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},gn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},gn.prototype.midPoint=function(){return gn.midPoint(this.p0,this.p1)},gn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?v.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},gn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=v.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<i&&(i=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var u=t.closestPoint(this.p1);return(r=u.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=u),n},gn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return 0<e&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},gn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},gn.prototype.getLength=function(){return this.p0.distance(this.p1)},gn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},gn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},gn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},gn.prototype.lineIntersection=function(t){try{return Y.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof z))throw t}return null},gn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},gn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,u=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,u=e*o/s}return new I(n-u,i+a)},gn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},gn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(1<e||v.isNaN(e))&&(e=1),e},gn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},gn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},gn.prototype.distance=function(){if(arguments[0]instanceof gn){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof I){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},gn.prototype.pointAlong=function(t){var e=new I;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},gn.prototype.hashCode=function(){var t=v.doubleToLongBits(this.p0.x);t^=31*v.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=v.doubleToLongBits(this.p1.x);return n^=31*v.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},gn.prototype.interfaces_=function(){return[x,e]},gn.prototype.getClass=function(){return gn},gn.midPoint=function(t,e){return new I((t.x+e.x)/2,(t.y+e.y)/2)},yn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(gn,yn);var _n=function(){this.tempEnv1=new H,this.tempEnv2=new H,this._overlapSeg1=new gn,this._overlapSeg2=new gn};_n.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n};var mn=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i};mn.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},mn.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)},mn.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},mn.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},mn.prototype.setId=function(t){this._id=t},mn.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},mn.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new H(t,e)}return this._env},mn.prototype.getEndIndex=function(){return this._end},mn.prototype.getStartIndex=function(){return this._start},mn.prototype.getContext=function(){return this._context},mn.prototype.getId=function(){return this._id},mn.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var s=this._pts[t],a=this._pts[e],u=n._pts[i],l=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(u,l),!o.tempEnv1.intersects(o.tempEnv2))return null;var h=Math.trunc((t+e)/2),c=Math.trunc((i+r)/2);t<h&&(i<c&&this.computeOverlapsInternal(t,h,n,i,c,o),c<r&&this.computeOverlapsInternal(t,h,n,c,r,o)),h<e&&(i<c&&this.computeOverlapsInternal(h,e,n,i,c,o),c<r&&this.computeOverlapsInternal(h,e,n,c,r,o))},mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn};var vn=function(){};vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn},vn.getChainStartIndices=function(t){var e=0,n=new wt;n.add(new k(e));do{var i=vn.findChainEnd(t,e);n.add(new k(i)),e=i}while(e<t.length-1);return vn.toIntArray(n)},vn.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=Be.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Be.quadrant(t[r-1],t[r])===i);)r++;return r-1},vn.getChains=function(){if(1===arguments.length){var t=arguments[0];return vn.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new wt,r=vn.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new mn(e,r[o],r[o+1],n);i.add(s)}return i}},vn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var bn=function(){};bn.prototype.computeNodes=function(t){},bn.prototype.getNodedSubstrings=function(){},bn.prototype.interfaces_=function(){return[]},bn.prototype.getClass=function(){return bn};var xn=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};xn.prototype.setSegmentIntersector=function(t){this._segInt=t},xn.prototype.interfaces_=function(){return[bn]},xn.prototype.getClass=function(){return xn};var En=function(e){function t(t){t?e.call(this,t):e.call(this),this._monoChains=new wt,this._index=new sn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e);var n={SegmentOverlapAction:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return dn.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(t){for(var e=vn.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},t.prototype.computeNodes=function(t){for(var e=(this._nodedSegStrings=t).iterator();e.hasNext();)this.add(e.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var t=new wn(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.SegmentOverlapAction.get=function(){return wn},Object.defineProperties(t,n),t}(xn),wn=function(s){function t(){s.call(this),this._si=null;var t=arguments[0];this._si=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.overlap=function(){if(4!==arguments.length)return s.prototype.overlap.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=t.getContext(),o=n.getContext();this._si.processIntersections(r,e,o,i)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(_n),In=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(i)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},Ln={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};In.prototype.getEndCapStyle=function(){return this._endCapStyle},In.prototype.isSingleSided=function(){return this._isSingleSided},In.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=In.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=In.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==In.JOIN_ROUND&&(this._quadrantSegments=In.DEFAULT_QUADRANT_SEGMENTS)},In.prototype.getJoinStyle=function(){return this._joinStyle},In.prototype.setJoinStyle=function(t){this._joinStyle=t},In.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},In.prototype.getSimplifyFactor=function(){return this._simplifyFactor},In.prototype.getQuadrantSegments=function(){return this._quadrantSegments},In.prototype.setEndCapStyle=function(t){this._endCapStyle=t},In.prototype.getMitreLimit=function(){return this._mitreLimit},In.prototype.setMitreLimit=function(t){this._mitreLimit=t},In.prototype.setSingleSided=function(t){this._isSingleSided=t},In.prototype.interfaces_=function(){return[]},In.prototype.getClass=function(){return In},In.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Ln.CAP_ROUND.get=function(){return 1},Ln.CAP_FLAT.get=function(){return 2},Ln.CAP_SQUARE.get=function(){return 3},Ln.JOIN_ROUND.get=function(){return 1},Ln.JOIN_MITRE.get=function(){return 2},Ln.JOIN_BEVEL.get=function(){return 3},Ln.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Ln.DEFAULT_MITRE_LIMIT.get=function(){return 5},Ln.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(In,Ln);var Sn=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},Mn={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Sn.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i)},Sn.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Sn.DELETE,i=r=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},Sn.prototype.isShallowConcavity=function(t,e,n,i){return at.computeOrientation(t,e,n)===this._angleOrientation&&at.distancePointLine(e,t,n)<i},Sn.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/Sn.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Sn.prototype.isConcave=function(t,e,n){return at.computeOrientation(t,e,n)===this._angleOrientation},Sn.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);for(;this.deleteShallowConcavities(););return this.collapseLine()},Sn.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Sn.DELETE;)e++;return e},Sn.prototype.isShallow=function(t,e,n,i){return at.distancePointLine(e,t,n)<i},Sn.prototype.collapseLine=function(){for(var t=new Lt,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Sn.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn},Sn.simplify=function(t,e){return new Sn(t).simplify(e)},Mn.INIT.get=function(){return 0},Mn.DELETE.get=function(){return 1},Mn.KEEP.get=function(){return 1},Mn.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Sn,Mn);var Cn=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new wt},Pn={COORDINATE_ARRAY_TYPE:{configurable:!0}};Cn.prototype.getCoordinates=function(){return this._ptList.toArray(Cn.COORDINATE_ARRAY_TYPE)},Cn.prototype.setPrecisionModel=function(t){this._precisionModel=t},Cn.prototype.addPt=function(t){var e=new I(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Cn.prototype.revere=function(){},Cn.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;0<=i;i--)this.addPt(t[i])},Cn.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Cn.prototype.toString=function(){return(new _e).createLineString(this.getCoordinates()).toString()},Cn.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new I(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Cn.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn},Pn.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Cn,Pn);var Nn=function(){},On={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},Nn.toDegrees=function(t){return 180*t/Math.PI},Nn.normalize=function(t){for(;t>Math.PI;)t-=Nn.PI_TIMES_2;for(;t<=-Math.PI;)t+=Nn.PI_TIMES_2;return t},Nn.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},Nn.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return 0<i*(n.x-e.x)+r*(n.y-e.y)},Nn.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},Nn.interiorAngle=function(t,e,n){var i=Nn.angle(e,t),r=Nn.angle(e,n);return Math.abs(r-i)},Nn.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Nn.PI_TIMES_2;Nn.PI_TIMES_2<=t&&(t=0)}else{for(;Nn.PI_TIMES_2<=t;)t-=Nn.PI_TIMES_2;t<0&&(t=0)}return t},Nn.angleBetween=function(t,e,n){var i=Nn.angle(e,t),r=Nn.angle(e,n);return Nn.diff(i,r)},Nn.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Nn.toRadians=function(t){return t*Math.PI/180},Nn.getTurn=function(t,e){var n=Math.sin(e-t);return 0<n?Nn.COUNTERCLOCKWISE:n<0?Nn.CLOCKWISE:Nn.NONE},Nn.angleBetweenOriented=function(t,e,n){var i=Nn.angle(e,t),r=Nn.angle(e,n)-i;return r<=-Math.PI?r+Nn.PI_TIMES_2:r>Math.PI?r-Nn.PI_TIMES_2:r},On.PI_TIMES_2.get=function(){return 2*Math.PI},On.PI_OVER_2.get=function(){return Math.PI/2},On.PI_OVER_4.get=function(){return Math.PI/4},On.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},On.CLOCKWISE.get=function(){return at.CLOCKWISE},On.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(Nn,On);var Tn=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new gn,this._seg1=new gn,this._offset0=new gn,this._offset1=new gn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new rt,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),8<=n.getQuadrantSegments()&&n.getJoinStyle()===In.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},Rn={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Tn.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=at.computeOrientation(this._s0,this._s1,this._s2),i=n===at.CLOCKWISE&&this._side===Le.LEFT||n===at.COUNTERCLOCKWISE&&this._side===Le.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},Tn.prototype.addLineEndCap=function(t,e){var n=new gn(t,e),i=new gn;this.computeOffsetSegment(n,Le.LEFT,this._distance,i);var r=new gn;this.computeOffsetSegment(n,Le.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case In.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case In.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case In.CAP_SQUARE:var u=new I;u.x=Math.abs(this._distance)*Math.cos(a),u.y=Math.abs(this._distance)*Math.sin(a);var l=new I(i.p1.x+u.x,i.p1.y+u.y),h=new I(r.p1.x+u.x,r.p1.y+u.y);this._segList.addPt(l),this._segList.addPt(h)}},Tn.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Tn.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=Y.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof z))throw t;o=new I(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},Tn.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),u=n.x-t.x,l=n.y-t.y,h=Math.atan2(l,u);i===at.CLOCKWISE?a<=h&&(a+=2*Math.PI):h<=a&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,h,i,r),this._segList.addPt(n)},Tn.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Tn.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===In.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===In.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Tn.prototype.createSquare=function(t){this._segList.addPt(new I(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new I(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new I(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new I(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Tn.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Tn.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Tn.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Tn.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},Tn.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=Nn.angle(r,this._seg0.p0),s=Nn.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Nn.normalize(o+s),u=Nn.normalize(a+Math.PI),l=i*n,h=n-l*Math.abs(Math.sin(s)),c=r.x+l*Math.cos(u),p=r.y+l*Math.sin(u),f=new I(c,p),d=new gn(r,f),g=d.pointAlongOffset(1,h),y=d.pointAlongOffset(1,-h);this._side===Le.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))},Tn.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===Le.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),u=r*n*o/a,l=r*n*s/a;i.p0.x=t.p0.x-l,i.p0.y=t.p0.y+u,i.p1.x=t.p1.x-l,i.p1.y=t.p1.y+u},Tn.prototype.addFilletArc=function(t,e,n,i,r){var o=i===at.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var u=s/a,l=0,h=new I;l<s;){var c=e+o*l;h.x=t.x+r*Math.cos(c),h.y=t.y+r*Math.sin(c),this._segList.addPt(h),l+=u}},Tn.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Tn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),0<this._closingSegLengthFactor){var n=new I((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new I((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Tn.prototype.createCircle=function(t){var e=new I(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Tn.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Tn.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Cn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Tn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Tn.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),2<=this._li.getIntersectionNum()&&(this._bufParams.getJoinStyle()===In.JOIN_BEVEL||this._bufParams.getJoinStyle()===In.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},Tn.prototype.closeRing=function(){this._segList.closeRing()},Tn.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Tn.prototype.interfaces_=function(){return[]},Tn.prototype.getClass=function(){return Tn},Rn.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Rn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Rn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Rn.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Tn,Rn);var kn=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};kn.prototype.getOffsetCurve=function(t,e){if(0===(this._distance=e))return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&St.reverse(o),o},kn.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=Sn.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Le.LEFT),n.addFirstSegment();for(var s=o-2;0<=s;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=Sn.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],Le.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment(),n.closeRing()},kn.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===Le.RIGHT&&(i=-i);var r=Sn.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},kn.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=Sn.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Le.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=Sn.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Le.LEFT);for(var u=a-2;0<=u;u--)e.addNextSegment(s[u],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},kn.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case In.CAP_ROUND:e.createCircle(t);break;case In.CAP_SQUARE:e.createSquare(t)}},kn.prototype.getLineCurve=function(t,e){if((this._distance=e)<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},kn.prototype.getBufferParameters=function(){return this._bufParams},kn.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},kn.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return kn.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},kn.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=Sn.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Le.LEFT),n.addFirstSegment();for(var s=o-2;0<=s;s--)n.addNextSegment(r[s],!0)}else{var a=Sn.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],Le.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment()},kn.prototype.getSegGen=function(t){return new Tn(this._precisionModel,this._bufParams,t)},kn.prototype.interfaces_=function(){return[]},kn.prototype.getClass=function(){return kn},kn.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new I(t[n]);return e};var Dn=function(){this._subgraphs=null,this._seg=new gn,this._cga=new at;var t=arguments[0];this._subgraphs=t},An={DepthSegment:{configurable:!0}};Dn.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new wt,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(N(arguments[2],Et)&&arguments[0]instanceof I&&arguments[1]instanceof je){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=s.getEdge().getCoordinates(),l=0;l<u.length-1;l++)if(this._seg.p0=u[l],this._seg.p1=u[l+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,o)===at.RIGHT)){var h=s.getDepth(Le.LEFT);this._seg.p0.equals(u[l])||(h=s.getDepth(Le.RIGHT));var c=new Fn(this._seg,h);a.add(c)}}else if(N(arguments[2],Et)&&arguments[0]instanceof I&&N(arguments[1],Et))for(var p=arguments[0],f=arguments[1],d=arguments[2],g=f.iterator();g.hasNext();){var y=g.next();y.isForward()&&this.findStabbedSegments(p,y,d)}},Dn.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:$e.min(e)._leftDepth},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},An.DepthSegment.get=function(){return Fn},Object.defineProperties(Dn,An);var Fn=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new gn(t),this._leftDepth=e};Fn.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},Fn.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},Fn.prototype.toString=function(){return this._upwardSeg.toString()},Fn.prototype.interfaces_=function(){return[x]},Fn.prototype.getClass=function(){return Fn};var Gn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};Gn.prototype.area=function(){return Gn.area(this.p0,this.p1,this.p2)},Gn.prototype.signedArea=function(){return Gn.signedArea(this.p0,this.p1,this.p2)},Gn.prototype.interpolateZ=function(t){if(null===t)throw new m("Supplied point is null.");return Gn.interpolateZ(t,this.p0,this.p1,this.p2)},Gn.prototype.longestSideLength=function(){return Gn.longestSideLength(this.p0,this.p1,this.p2)},Gn.prototype.isAcute=function(){return Gn.isAcute(this.p0,this.p1,this.p2)},Gn.prototype.circumcentre=function(){return Gn.circumcentre(this.p0,this.p1,this.p2)},Gn.prototype.area3D=function(){return Gn.area3D(this.p0,this.p1,this.p2)},Gn.prototype.centroid=function(){return Gn.centroid(this.p0,this.p1,this.p2)},Gn.prototype.inCentre=function(){return Gn.inCentre(this.p0,this.p1,this.p2)},Gn.prototype.interfaces_=function(){return[]},Gn.prototype.getClass=function(){return Gn},Gn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Gn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Gn.det=function(t,e,n,i){return t*i-e*n},Gn.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,u=n.y-o,l=i.y-o,h=s*l-a*u,c=t.x-r,p=t.y-o,f=(l*c-a*p)/h,d=(-u*c+s*p)/h;return e.z+f*(n.z-e.z)+d*(i.z-e.z)},Gn.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return s<r&&(s=r),s<o&&(s=o),s},Gn.isAcute=function(t,e,n){return!!Nn.isAcute(t,e,n)&&!!Nn.isAcute(e,n,t)&&!!Nn.isAcute(n,t,e)},Gn.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,u=e.y-r,l=2*Gn.det(o,s,a,u),h=Gn.det(s,o*o+s*s,u,a*a+u*u),c=Gn.det(o,o*o+s*s,a,a*a+u*u);return new I(i-h/l,r+c/l)},Gn.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new Y(t.x+n/2,t.y+i/2,1),o=new Y(t.x-i+n/2,t.y+n+i/2,1);return new Y(r,o)},Gn.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new I(t.x+r*o,t.y+r*s)},Gn.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,u=n.z-t.z,l=r*u-o*a,h=o*s-i*u,c=i*a-r*s,p=l*l+h*h+c*c;return Math.sqrt(p)/2},Gn.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new I(i,r)},Gn.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,u=(i*t.y+r*e.y+o*n.y)/s;return new I(a,u)};var Bn=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new wt;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};Bn.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,C.EXTERIOR,C.INTERIOR)},Bn.prototype.addPolygon=function(t){var e=this._distance,n=Le.LEFT;this._distance<0&&(e=-this._distance,n=Le.RIGHT);var i=t.getExteriorRing(),r=St.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,C.EXTERIOR,C.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=St.removeRepeatedPoints(s.getCoordinates());0<this._distance&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Le.opposite(n),C.INTERIOR,C.EXTERIOR)}},Bn.prototype.isTriangleErodedCompletely=function(t,e){var n=new Gn(t[0],t[1],t[2]),i=n.inCentre();return at.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},Bn.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=St.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,C.EXTERIOR,C.INTERIOR)},Bn.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new dn(t,new Te(0,C.BOUNDARY,e,n));this._curveList.add(i)},Bn.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Bn.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(o=r,s=i,n=Le.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},Bn.prototype.add=function(t){if(t.isEmpty())return null;t instanceof $t?this.addPolygon(t):t instanceof Jt?this.addLineString(t):t instanceof Zt?this.addPoint(t):t instanceof te?this.addCollection(t):t instanceof zt?this.addCollection(t):t instanceof ne?this.addCollection(t):t instanceof jt&&this.addCollection(t)},Bn.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},Bn.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn};var Un=function(){};Un.prototype.locate=function(t){},Un.prototype.interfaces_=function(){return[]},Un.prototype.getClass=function(){return Un};var qn=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};qn.prototype.next=function(){if(this._atStart)return this._atStart=!1,qn.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new i;var t=this._parent.getGeometryN(this._index++);return t instanceof jt?(this._subcollectionIterator=new qn(t),this._subcollectionIterator.next()):t},qn.prototype.remove=function(){throw new Error(this.getClass().getName())},qn.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},qn.prototype.interfaces_=function(){return[xt]},qn.prototype.getClass=function(){return qn},qn.isAtomic=function(t){return!(t instanceof jt)};var jn=function(){this._geom=null;var t=arguments[0];this._geom=t};jn.prototype.locate=function(t){return jn.locate(t,this._geom)},jn.prototype.interfaces_=function(){return[Un]},jn.prototype.getClass=function(){return jn},jn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},jn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!jn.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(jn.isPointInRing(t,r))return!1}return!0},jn.containsPoint=function(t,e){if(e instanceof $t)return jn.containsPointInPolygon(t,e);if(e instanceof jt)for(var n=new qn(e);n.hasNext();){var i=n.next();if(i!==e&&jn.containsPoint(t,i))return!0}return!1},jn.locate=function(t,e){return e.isEmpty()?C.EXTERIOR:jn.containsPoint(t,e)?C.INTERIOR:C.EXTERIOR};var zn=function(){this._edgeMap=new c,this._edgeList=null,this._ptInAreaLocation=[C.NONE,C.NONE]};zn.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},zn.prototype.propagateSideLabels=function(t){for(var e=C.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,Le.LEFT)!==C.NONE&&(e=i.getLocation(t,Le.LEFT))}if(e===C.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Le.ON)===C.NONE&&a.setLocation(t,Le.ON,r),a.isArea(t)){var u=a.getLocation(t,Le.LEFT),l=a.getLocation(t,Le.RIGHT);if(l!==C.NONE){if(l!==r)throw new Ce("side location conflict",s.getCoordinate());u===C.NONE&&et.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=u}else et.isTrue(a.getLocation(t,Le.LEFT)===C.NONE,"found single null side"),a.setLocation(t,Le.RIGHT,r),a.setLocation(t,Le.LEFT,r)}}},zn.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},zn.prototype.print=function(t){V.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},zn.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},zn.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Le.LEFT);et.isTrue(i!==C.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();et.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Le.LEFT),u=s.getLocation(t,Le.RIGHT);if(a===u)return!1;if(u!==r)return!1;r=a}return!0},zn.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},zn.prototype.iterator=function(){return this.getEdges().iterator()},zn.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new wt(this._edgeMap.values())),this._edgeList},zn.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===C.NONE&&(this._ptInAreaLocation[t]=jn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},zn.prototype.toString=function(){var t=new R;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},zn.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},zn.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===C.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),u=0;u<2;u++)if(a.isAnyNull(u)){var l=C.NONE;if(e[u])l=C.EXTERIOR;else{var h=s.getCoordinate();l=this.getLocation(u,h,t)}a.setAllLocationsIfNull(u,l)}},zn.prototype.getDegree=function(){return this._edgeMap.size()},zn.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},zn.prototype.interfaces_=function(){return[]},zn.prototype.getClass=function(){return zn};var Vn=function(o){function t(){o.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Ce("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},t.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},t.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return Be.isNorthern(r)&&Be.isNorthern(o)?n:Be.isNorthern(r)||Be.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},t.prototype.print=function(t){V.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},t.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new wt;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;0<=n;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},t.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Le.LEFT),i=t.getDepth(Le.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new Ce("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=o;u<s;u++){var l=this._edgeList.get(u);l.setEdgeDepths(Le.RIGHT,a),a=l.getDepth(Le.LEFT)}return a}},t.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;0<=r;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},t.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&i++;return i}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var t=C.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=C.INTERIOR;break}if(i.isInResult()){t=C.EXTERIOR;break}}}if(t===C.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===C.INTERIOR):(s.isInResult()&&(r=C.EXTERIOR),a.isInResult()&&(r=C.INTERIOR))}},t.prototype.computeLabelling=function(t){o.prototype.computeLabelling.call(this,t),this._label=new Te(C.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next().getEdge().getLabel(),i=0;i<2;i++){var r=n.getLocation(i);r!==C.INTERIOR&&r!==C.BOUNDARY||this._label.setLocation(i,C.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(zn),Yn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.createNode=function(t){return new Fe(t,new Vn)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ze),Hn=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Hn.prototype.compareTo=function(t){var e=t;return Hn.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Hn.prototype.interfaces_=function(){return[x]},Hn.prototype.getClass=function(){return Hn},Hn.orientation=function(t){return 1===St.increasingDirection(t)},Hn.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,u=e?0:t.length-1,l=i?0:n.length-1;;){var h=t[u].compareTo(n[l]);if(0!==h)return h;var c=(u+=r)===s,p=(l+=o)===a;if(c&&!p)return-1;if(!c&&p)return 1;if(c&&p)return 0}};var Xn=function(){this._edges=new wt,this._ocaMap=new c};Xn.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);0<e&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)0<r&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},Xn.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Xn.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Xn.prototype.iterator=function(){return this._edges.iterator()},Xn.prototype.getEdges=function(){return this._edges},Xn.prototype.get=function(t){return this._edges.get(t)},Xn.prototype.findEqualEdge=function(t){var e=new Hn(t.getCoordinates());return this._ocaMap.get(e)},Xn.prototype.add=function(t){this._edges.add(t);var e=new Hn(t.getCoordinates());this._ocaMap.put(e,t)},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var Wn=function(){};Wn.prototype.processIntersections=function(t,e,n,i){},Wn.prototype.isDone=function(){},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn};var Jn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0;var t=arguments[this.numTests=0];this._li=t};Jn.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Jn.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Jn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Jn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Jn.prototype.getLineIntersector=function(){return this._li},Jn.prototype.hasProperIntersection=function(){return this._hasProper},Jn.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Jn.prototype.hasIntersection=function(){return this._hasIntersection},Jn.prototype.isDone=function(){return!1},Jn.prototype.hasInteriorIntersection=function(){return this._hasInterior},Jn.prototype.interfaces_=function(){return[Wn]},Jn.prototype.getClass=function(){return Jn},Jn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Kn=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new I(t),this.segmentIndex=e,this.dist=n};Kn.prototype.getSegmentIndex=function(){return this.segmentIndex},Kn.prototype.getCoordinate=function(){return this.coord},Kn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Kn.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Kn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Kn.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Kn.prototype.getDistance=function(){return this.dist},Kn.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Kn.prototype.interfaces_=function(){return[x]},Kn.prototype.getClass=function(){return Kn};var Zn=function(){this._nodeMap=new c,this.edge=null;var t=arguments[0];this.edge=t};Zn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Zn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Zn.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Zn.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Zn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=0<e.dist||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new I(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new ni(o,new Te(this.edge._label))},Zn.prototype.add=function(t,e,n){var i=new Kn(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},Zn.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Zn.prototype.interfaces_=function(){return[]},Zn.prototype.getClass=function(){return Zn};var Qn=function(){};Qn.prototype.getChainStartIndices=function(t){var e=0,n=new wt;n.add(new k(e));do{var i=this.findChainEnd(t,e);n.add(new k(i)),e=i}while(e<t.length-1);return Qn.toIntArray(n)},Qn.prototype.findChainEnd=function(t,e){for(var n=Be.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&Be.quadrant(t[i-1],t[i])===n;)i++;return i-1},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn},Qn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var $n=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new H,this.env2=new H;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Qn;this.startIndex=e.getChainStartIndices(this.pts)};$n.prototype.getCoordinates=function(){return this.pts},$n.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return n<e?e:n},$n.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},$n.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],u=arguments[4],l=arguments[5],h=this.pts[r],c=this.pts[o],p=s.pts[a],f=s.pts[u];if(o-r==1&&u-a==1)return l.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(h,c),this.env2.init(p,f),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),g=Math.trunc((a+u)/2);r<d&&(a<g&&this.computeIntersectsForChain(r,d,s,a,g,l),g<u&&this.computeIntersectsForChain(r,d,s,g,u,l)),d<o&&(a<g&&this.computeIntersectsForChain(d,o,s,a,g,l),g<u&&this.computeIntersectsForChain(d,o,s,g,u,l))}},$n.prototype.getStartIndexes=function(){return this.startIndex},$n.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n};var ti=function t(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},ei={NULL_VALUE:{configurable:!0}};ti.prototype.getDepth=function(t,e){return this._depth[t][e]},ti.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},ti.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==ti.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===ti.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._depth[i][r]===ti.NULL_VALUE}},ti.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},ti.prototype.getDelta=function(t){return this._depth[t][Le.RIGHT]-this._depth[t][Le.LEFT]},ti.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?C.EXTERIOR:C.INTERIOR},ti.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},ti.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==C.EXTERIOR&&i!==C.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=ti.depthAtLocation(i):this._depth[e][n]+=ti.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===C.INTERIOR&&this._depth[r][o]++}},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},ti.depthAtLocation=function(t){return t===C.EXTERIOR?0:t===C.INTERIOR?1:ti.NULL_VALUE},ei.NULL_VALUE.get=function(){return-1},Object.defineProperties(ti,ei);var ni=function(i){function s(){if(i.call(this),this.pts=null,this._env=null,this.eiList=new Zn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ti,this._depthDelta=0,1===arguments.length){var t=arguments[0];s.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pts=e,this._label=n}}return i&&(s.__proto__=i),((s.prototype=Object.create(i&&i.prototype)).constructor=s).prototype.getDepth=function(){return this._depth},s.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new s(t,Te.toLineLabel(this._label))},s.prototype.isIsolated=function(){return this._isIsolated},s.prototype.getCoordinates=function(){return this.pts},s.prototype.setIsolated=function(t){this._isIsolated=t},s.prototype.setName=function(t){this._name=t},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,i=!0,r=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(n=!1),this.pts[o].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0},s.prototype.getCoordinate=function(){if(0===arguments.length)return 0<this.pts.length?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},s.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},s.prototype.computeIM=function(t){s.updateIM(this._label,t)},s.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},s.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},s.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},s.prototype.getDepthDelta=function(){return this._depthDelta},s.prototype.getNumPoints=function(){return this.pts.length},s.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;0<=e;e--)t.print(this.pts[e]+" ");t.println("")},s.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new $n(this)),this._mce},s.prototype.getEnvelope=function(){if(null===this._env){this._env=new H;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},s.prototype.addIntersection=function(t,e,n,i){var r=new I(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var u=this.pts[a];r.equals2D(u)&&(o=a,s=0)}this.eiList.add(r,o,s)},s.prototype.toString=function(){var t=new R;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},s.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},s.prototype.setDepthDelta=function(t){this._depthDelta=t},s.prototype.getEdgeIntersectionList=function(){return this.eiList},s.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.updateIM=function(){if(2!==arguments.length)return i.prototype.updateIM.apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,Le.ON),t.getLocation(1,Le.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,Le.LEFT),t.getLocation(1,Le.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,Le.RIGHT),t.getLocation(1,Le.RIGHT),2))},s}(Ae),ii=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Xn,this._bufParams=t||null};ii.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},ii.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Te(t.getLabel())).flip(),n.merge(i);var r=ii.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(ii.depthDelta(t.getLabel()))},ii.prototype.buildSubgraphs=function(t,e){for(var n=new wt,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new Dn(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},ii.prototype.createSubgraphs=function(t){for(var e=new wt,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Ne;r.create(i),e.add(r)}}return $e.sort(e,$e.reverseOrder()),e},ii.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},ii.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new En,n=new rt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Jn(n)),e},ii.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new kn(n,this._bufParams),r=new Bn(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new Ve(new Yn),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new Ye(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},ii.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new ni(r.getCoordinates(),new Te(s));this.insertUniqueEdge(a)}}},ii.prototype.setNoder=function(t){this._workingNoder=t},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.depthDelta=function(t){var e=t.getLocation(0,Le.LEFT),n=t.getLocation(0,Le.RIGHT);return e===C.INTERIOR&&n===C.EXTERIOR?1:e===C.EXTERIOR&&n===C.INTERIOR?-1:0},ii.convertSegStrings=function(t){for(var e=new _e,n=new wt;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};var ri=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=i,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};ri.prototype.rescale=function(){if(N(arguments[0],bt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&V.out.println(n)}},ri.prototype.scale=function(){if(N(arguments[0],bt)){for(var t=arguments[0],e=new wt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new dn(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),s=0;s<r.length;s++)o[s]=new I(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return St.removeRepeatedPoints(o)}},ri.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},ri.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},ri.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},ri.prototype.interfaces_=function(){return[bn]},ri.prototype.getClass=function(){return ri};var oi=function(){this._li=new rt,this._segStrings=null;var t=arguments[0];this._segStrings=t},si={fact:{configurable:!0}};oi.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(n))throw new $("found endpt/interior pt intersection at index "+o+" :pt "+n)},oi.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),u=0;u<s.length-1;u++)for(var l=0;l<a.length-1;l++)this.checkInteriorIntersections(r,u,o,l);else if(4===arguments.length){var h=arguments[0],c=arguments[1],p=arguments[2],f=arguments[3];if(h===p&&c===f)return null;var d=h.getCoordinates()[c],g=h.getCoordinates()[c+1],y=p.getCoordinates()[f],_=p.getCoordinates()[f+1];if(this._li.computeIntersection(d,g,y,_),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,g)||this.hasInteriorIntersection(this._li,y,_)))throw new $("found non-noded intersection at "+d+"-"+g+" and "+y+"-"+_)}},oi.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},oi.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])},oi.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},oi.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new $("found non-noded collapse at "+oi.fact.createLineString([t,e,n]))},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},si.fact.get=function(){return new _e},Object.defineProperties(oi,si);var ai=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new m("Scale factor must be non-zero");1!==e&&(this._pt=new I(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new I,this._p1Scaled=new I),this.initCorners(this._pt)},ui={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ai.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(s&&a),"Found bad envelope test"),a},ai.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new I(this._maxx,this._maxy),this._corner[1]=new I(this._minx,this._maxy),this._corner[2]=new I(this._minx,this._miny),this._corner[3]=new I(this._maxx,this._miny)},ai.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ai.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},ai.prototype.getCoordinate=function(){return this._originalPt},ai.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},ai.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=ai.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new H(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},ai.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},ai.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))},ai.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},ui.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(ai,ui);var li=function(){this.tempEnv1=new H,this.selectedSegment=new gn};li.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},li.prototype.interfaces_=function(){return[]},li.prototype.getClass=function(){return li};var hi=function(){this._index=null;var t=arguments[0];this._index=t},ci={HotPixelSnapAction:{configurable:!0}};hi.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new pi(e,n,i);return this._index.query(r,{interfaces_:function(){return[Je]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi},ci.HotPixelSnapAction.get=function(){return pi},Object.defineProperties(hi,ci);var pi=function(i){function t(){i.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(2!==arguments.length)return i.prototype.select.apply(this,arguments);var t=arguments[0],e=arguments[1],n=t.getContext();if(null!==this._parentEdge&&n===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,e)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(li),fi=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new wt};fi.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},fi.prototype.isDone=function(){return!1},fi.prototype.getInteriorIntersections=function(){return this._interiorIntersections},fi.prototype.interfaces_=function(){return[Wn]},fi.prototype.getClass=function(){return fi};var di=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new rt,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};di.prototype.checkCorrectness=function(t){var e=dn.getNodedSubstrings(t),n=new oi(e);try{n.checkValid()}catch(t){if(!(t instanceof j))throw t;t.printStackTrace()}},di.prototype.getNodedSubstrings=function(){return dn.getNodedSubstrings(this._nodedSegStrings)},di.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},di.prototype.findInteriorIntersections=function(t,e){var n=new fi(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},di.prototype.computeVertexSnaps=function(){if(N(arguments[0],bt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof dn)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new ai(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},di.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new En,this._pointSnapper=new hi(this._noder.getIndex()),this.snapRound(t,this._li)},di.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new ai(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},di.prototype.interfaces_=function(){return[bn]},di.prototype.getClass=function(){return di};var gi=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new In,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},yi={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};gi.prototype.bufferFixedPrecision=function(t){var e=new ri(new di(new fe(1)),t.getScale()),n=new ii(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},gi.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=gi.MAX_PRECISION_DIGITS;0<=e;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Ce))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],i=gi.precisionScaleFactor(this._argGeom,this._distance,n),r=new fe(i);this.bufferFixedPrecision(r)}},gi.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===fe.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},gi.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},gi.prototype.bufferOriginalPrecision=function(){try{var t=new ii(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof $))throw t;this._saveException=t}},gi.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},gi.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},gi.prototype.interfaces_=function(){return[]},gi.prototype.getClass=function(){return gi},gi.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new gi(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ht&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1],r=arguments[2],o=new gi(n);return o.setQuadrantSegments(r),o.getResultGeometry(i)}if(arguments[2]instanceof In&&arguments[0]instanceof ht&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],u=arguments[2];return new gi(s,u).getResultGeometry(a)}}else if(4===arguments.length){var l=arguments[0],h=arguments[1],c=arguments[2],p=arguments[3],f=new gi(l);return f.setQuadrantSegments(c),f.setEndCapStyle(p),f.getResultGeometry(h)}},gi.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=O.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(0<e?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},yi.CAP_ROUND.get=function(){return In.CAP_ROUND},yi.CAP_BUTT.get=function(){return In.CAP_FLAT},yi.CAP_FLAT.get=function(){return In.CAP_FLAT},yi.CAP_SQUARE.get=function(){return In.CAP_SQUARE},yi.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(gi,yi);var _i=function(){this._pt=[new I,new I],this._distance=v.NaN,this._isNull=!0};_i.prototype.getCoordinates=function(){return this._pt},_i.prototype.getCoordinate=function(t){return this._pt[t]},_i.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},_i.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},_i.prototype.getDistance=function(){return this._distance},_i.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i};var mi=function(){};mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},mi.computeDistance=function(){if(arguments[2]instanceof _i&&arguments[0]instanceof Jt&&arguments[1]instanceof I)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=t.getCoordinates(),r=new gn,o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var s=r.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof _i&&arguments[0]instanceof $t&&arguments[1]instanceof I){var a=arguments[0],u=arguments[1],l=arguments[2];mi.computeDistance(a.getExteriorRing(),u,l);for(var h=0;h<a.getNumInteriorRing();h++)mi.computeDistance(a.getInteriorRingN(h),u,l)}else if(arguments[2]instanceof _i&&arguments[0]instanceof ht&&arguments[1]instanceof I){var c=arguments[0],p=arguments[1],f=arguments[2];if(c instanceof Jt)mi.computeDistance(c,p,f);else if(c instanceof $t)mi.computeDistance(c,p,f);else if(c instanceof jt)for(var d=c,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);mi.computeDistance(y,p,f)}else f.setMinimum(c.getCoordinate(),p)}else if(arguments[2]instanceof _i&&arguments[0]instanceof gn&&arguments[1]instanceof I){var _=arguments[0],m=arguments[1],v=arguments[2],b=_.closestPoint(m);v.setMinimum(b,m)}};var vi=function(t){this._maxPtDist=new _i,this._inputGeom=t||null},bi={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};vi.prototype.computeMaxMidpointDistance=function(t){var e=new Ei(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vi.prototype.computeMaxVertexDistance=function(t){var e=new xi(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vi.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},vi.prototype.getDistancePoints=function(){return this._maxPtDist},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi},bi.MaxPointDistanceFilter.get=function(){return xi},bi.MaxMidpointDistanceFilter.get=function(){return Ei},Object.defineProperties(vi,bi);var xi=function(t){this._maxPtDist=new _i,this._minPtDist=new _i,this._geom=t||null};xi.prototype.filter=function(t){this._minPtDist.initialize(),mi.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},xi.prototype.getMaxPointDistance=function(){return this._maxPtDist},xi.prototype.interfaces_=function(){return[ft]},xi.prototype.getClass=function(){return xi};var Ei=function(t){this._maxPtDist=new _i,this._minPtDist=new _i,this._geom=t||null};Ei.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new I((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),mi.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Ei.prototype.isDone=function(){return!1},Ei.prototype.isGeometryChanged=function(){return!1},Ei.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ei.prototype.interfaces_=function(){return[qt]},Ei.prototype.getClass=function(){return Ei};var wi=function(t){this._comps=t||null};wi.prototype.filter=function(t){t instanceof $t&&this._comps.add(t)},wi.prototype.interfaces_=function(){return[Ut]},wi.prototype.getClass=function(){return wi},wi.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return wi.getPolygons(t,new wt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof $t?n.add(e):e instanceof jt&&e.apply(new wi(n)),n}};var Ii=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};Ii.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Jt&&this._lines.add(t)},Ii.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Ii.prototype.interfaces_=function(){return[lt]},Ii.prototype.getClass=function(){return Ii},Ii.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Ii.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Ii.getLines(e,n))}},Ii.getLines=function(){if(1===arguments.length){var t=arguments[0];return Ii.getLines(t,!1)}if(2===arguments.length){if(N(arguments[0],bt)&&N(arguments[1],bt)){for(var e=arguments[0],n=arguments[1],i=e.iterator();i.hasNext();){var r=i.next();Ii.getLines(r,n)}return n}if(arguments[0]instanceof ht&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1],a=new wt;return o.apply(new Ii(a,s)),a}if(arguments[0]instanceof ht&&N(arguments[1],bt)){var u=arguments[0],l=arguments[1];return u instanceof Jt?l.add(u):u.apply(new Ii(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&N(arguments[0],bt)&&N(arguments[1],bt)){for(var h=arguments[0],c=arguments[1],p=arguments[2],f=h.iterator();f.hasNext();){var d=f.next();Ii.getLines(d,c,p)}return c}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ht&&N(arguments[1],bt)){var g=arguments[0],y=arguments[1],_=arguments[2];return g.apply(new Ii(y,_)),y}}};var Li=function(){if(this._boundaryRule=dt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new m("Rule must be non-null");this._boundaryRule=t}};Li.prototype.locateInternal=function(){if(arguments[0]instanceof I&&arguments[1]instanceof $t){var t=arguments[0],e=arguments[1];if(e.isEmpty())return C.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===C.EXTERIOR)return C.EXTERIOR;if(i===C.BOUNDARY)return C.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===C.INTERIOR)return C.EXTERIOR;if(s===C.BOUNDARY)return C.BOUNDARY}return C.INTERIOR}if(arguments[0]instanceof I&&arguments[1]instanceof Jt){var a=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(a))return C.EXTERIOR;var l=u.getCoordinates();return u.isClosed()||!a.equals(l[0])&&!a.equals(l[l.length-1])?at.isOnLine(a,l)?C.INTERIOR:C.EXTERIOR:C.BOUNDARY}if(arguments[0]instanceof I&&arguments[1]instanceof Zt){var h=arguments[0];return arguments[1].getCoordinate().equals2D(h)?C.INTERIOR:C.EXTERIOR}},Li.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):C.EXTERIOR},Li.prototype.intersects=function(t,e){return this.locate(t,e)!==C.EXTERIOR},Li.prototype.updateLocationInfo=function(t){t===C.INTERIOR&&(this._isIn=!0),t===C.BOUNDARY&&this._numBoundaries++},Li.prototype.computeLocation=function(t,e){if(e instanceof Zt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Jt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof $t)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof zt)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof ne)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof jt)for(var u=new qn(e);u.hasNext();){var l=u.next();l!==e&&this.computeLocation(t,l)}},Li.prototype.locate=function(t,e){return e.isEmpty()?C.EXTERIOR:e instanceof Jt?this.locateInternal(t,e):e instanceof $t?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?C.BOUNDARY:0<this._numBoundaries||this._isIn?C.INTERIOR:C.EXTERIOR)},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li};var Si=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._component=i,this._segIndex=r,this._pt=o}},Mi={INSIDE_AREA:{configurable:!0}};Si.prototype.isInsideArea=function(){return this._segIndex===Si.INSIDE_AREA},Si.prototype.getCoordinate=function(){return this._pt},Si.prototype.getGeometryComponent=function(){return this._component},Si.prototype.getSegmentIndex=function(){return this._segIndex},Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si},Mi.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Si,Mi);var Ci=function(t){this._pts=t||null};Ci.prototype.filter=function(t){t instanceof Zt&&this._pts.add(t)},Ci.prototype.interfaces_=function(){return[Ut]},Ci.prototype.getClass=function(){return Ci},Ci.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Zt?$e.singletonList(t):Ci.getPoints(t,new wt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Zt?n.add(e):e instanceof jt&&e.apply(new Ci(n)),n}};var Pi=function(){this._locations=null;var t=arguments[0];this._locations=t};Pi.prototype.filter=function(t){(t instanceof Zt||t instanceof Jt||t instanceof $t)&&this._locations.add(new Si(t,0,t.getCoordinate()))},Pi.prototype.interfaces_=function(){return[Ut]},Pi.prototype.getClass=function(){return Pi},Pi.getLocations=function(t){var e=new wt;return t.apply(new Pi(e)),e};var Ni=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Li,this._minDistanceLocation=null,this._minDistance=v.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=i,this._terminateDistance=r}};Ni.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=wi.getPolygons(this._geom[e]);if(0<r.size()){var o=Pi.getLocations(this._geom[i]);if(this.computeContainmentDistance(o,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&N(arguments[0],Et)&&N(arguments[1],Et)){for(var s=arguments[0],a=arguments[1],u=arguments[2],l=0;l<s.size();l++)for(var h=s.get(l),c=0;c<a.size();c++)if(this.computeContainmentDistance(h,a.get(c),u),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Si&&arguments[1]instanceof $t){var p=arguments[0],f=arguments[1],d=arguments[2],g=p.getCoordinate();if(C.EXTERIOR!==this._ptLocator.locate(g,f))return d[this._minDistance=0]=p,d[1]=new Si(f,g),null}},Ni.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Ni.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Ii.getLines(this._geom[0]),n=Ii.getLines(this._geom[1]),i=Ci.getPoints(this._geom[0]),r=Ci.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},Ni.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Ni.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;this._minDistanceLocation[1]=e?(this._minDistanceLocation[0]=t[1],t[0]):(this._minDistanceLocation[0]=t[0],t[1])},Ni.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Ni.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Jt&&arguments[1]instanceof Zt){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var s=at.distancePointLine(r,i[o],i[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new gn(i[o],i[o+1]).closestPoint(r);n[0]=new Si(t,o,a),n[1]=new Si(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Jt&&arguments[1]instanceof Jt){var u=arguments[0],l=arguments[1],h=arguments[2];if(u.getEnvelopeInternal().distance(l.getEnvelopeInternal())>this._minDistance)return null;for(var c=u.getCoordinates(),p=l.getCoordinates(),f=0;f<c.length-1;f++)for(var d=0;d<p.length-1;d++){var g=at.distanceLineLine(c[f],c[f+1],p[d],p[d+1]);if(g<this._minDistance){this._minDistance=g;var y=new gn(c[f],c[f+1]),_=new gn(p[d],p[d+1]),m=y.closestPoints(_);h[0]=new Si(u,f,m[0]),h[1]=new Si(l,d,m[1])}if(this._minDistance<=this._terminateDistance)return null}}},Ni.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Si(r,0,r.getCoordinate()),n[1]=new Si(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Ni.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new m("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Ni.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni},Ni.distance=function(t,e){return new Ni(t,e).distance()},Ni.isWithinDistance=function(t,e,n){return new Ni(t,e,n).distance()<=n},Ni.nearestPoints=function(t,e){return new Ni(t,e).nearestPoints()};var Oi=function(){this._pt=[new I,new I],this._distance=v.NaN,this._isNull=!0};Oi.prototype.getCoordinates=function(){return this._pt},Oi.prototype.getCoordinate=function(t){return this._pt[t]},Oi.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Oi.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Oi.prototype.toString=function(){return Q.toLineString(this._pt[0],this._pt[1])},Oi.prototype.getDistance=function(){return this._distance},Oi.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Oi.prototype.interfaces_=function(){return[]},Oi.prototype.getClass=function(){return Oi};var Ti=function(){};Ti.prototype.interfaces_=function(){return[]},Ti.prototype.getClass=function(){return Ti},Ti.computeDistance=function(){if(arguments[2]instanceof Oi&&arguments[0]instanceof Jt&&arguments[1]instanceof I)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=new gn,r=t.getCoordinates(),o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Oi&&arguments[0]instanceof $t&&arguments[1]instanceof I){var a=arguments[0],u=arguments[1],l=arguments[2];Ti.computeDistance(a.getExteriorRing(),u,l);for(var h=0;h<a.getNumInteriorRing();h++)Ti.computeDistance(a.getInteriorRingN(h),u,l)}else if(arguments[2]instanceof Oi&&arguments[0]instanceof ht&&arguments[1]instanceof I){var c=arguments[0],p=arguments[1],f=arguments[2];if(c instanceof Jt)Ti.computeDistance(c,p,f);else if(c instanceof $t)Ti.computeDistance(c,p,f);else if(c instanceof jt)for(var d=c,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);Ti.computeDistance(y,p,f)}else f.setMinimum(c.getCoordinate(),p)}else if(arguments[2]instanceof Oi&&arguments[0]instanceof gn&&arguments[1]instanceof I){var _=arguments[0],m=arguments[1],v=arguments[2],b=_.closestPoint(m);v.setMinimum(b,m)}};var Ri=function(){this._g0=null,this._g1=null,this._ptDist=new Oi;var t=arguments[this._densifyFrac=0],e=arguments[1];this._g0=t,this._g1=e},ki={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Ri.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Ri.prototype.setDensifyFraction=function(t){if(1<t||t<=0)throw new m("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Ri.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Ri.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Ri.prototype.computeOrientedDistance=function(t,e,n){var i=new Di(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),0<this._densifyFrac){var r=new Ai(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},Ri.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri},Ri.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Ri(t,e).distance()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new Ri(n,i);return o.setDensifyFraction(r),o.distance()}},ki.MaxPointDistanceFilter.get=function(){return Di},ki.MaxDensifiedByFractionDistanceFilter.get=function(){return Ai},Object.defineProperties(Ri,ki);var Di=function(){this._maxPtDist=new Oi,this._minPtDist=new Oi,this._euclideanDist=new Ti,this._geom=null;var t=arguments[0];this._geom=t};Di.prototype.filter=function(t){this._minPtDist.initialize(),Ti.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Di.prototype.getMaxPointDistance=function(){return this._maxPtDist},Di.prototype.interfaces_=function(){return[ft]},Di.prototype.getClass=function(){return Di};var Ai=function(){this._maxPtDist=new Oi,this._minPtDist=new Oi,this._geom=null;var t=arguments[this._numSubSegs=0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Ai.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,u=n.y+s*o,l=new I(a,u);this._minPtDist.initialize(),Ti.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Ai.prototype.isDone=function(){return!1},Ai.prototype.isGeometryChanged=function(){return!1},Ai.prototype.getMaxPointDistance=function(){return this._maxPtDist},Ai.prototype.interfaces_=function(){return[qt]},Ai.prototype.getClass=function(){return Ai};var Fi=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},Gi={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Fi.prototype.checkMaximumDistance=function(t,e,n){var i=new Ri(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Q.toLineString(r[0],r[1])+")"}},Fi.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Fi.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(0<this._bufDistance?this.checkPositiveValid():this.checkNegativeValid(),Fi.VERBOSE&&V.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Fi.prototype.checkNegativeValid=function(){if(!(this._input instanceof $t||this._input instanceof ne||this._input instanceof jt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Fi.prototype.getErrorIndicator=function(){return this._errorIndicator},Fi.prototype.checkMinimumDistance=function(t,e,n){var i=new Ni(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Q.toLineString(r[0],r[1])+" )"}},Fi.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Fi.prototype.getErrorLocation=function(){return this._errorLocation},Fi.prototype.getPolygonLines=function(t){for(var e=new wt,n=new Ii(e),i=wi.getPolygons(t).iterator();i.hasNext();)i.next().apply(n);return t.getFactory().buildGeometry(e)},Fi.prototype.getErrorMessage=function(){return this._errMsg},Fi.prototype.interfaces_=function(){return[]},Fi.prototype.getClass=function(){return Fi},Gi.VERBOSE.get=function(){return!1},Gi.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Fi,Gi);var Bi=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},Ui={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Bi.prototype.isValid=function(){return this.checkPolygonal(),this._isValid&&(this.checkExpectedEmpty(),this._isValid&&(this.checkEnvelope(),this._isValid&&(this.checkArea(),this._isValid&&this.checkDistance()))),this._isValid},Bi.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Bi.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new H(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new H(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},Bi.prototype.checkDistance=function(){var t=new Fi(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Bi.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();0<this._distance&&e<t&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Bi.prototype.checkPolygonal=function(){this._result instanceof $t||this._result instanceof ne||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Bi.prototype.getErrorIndicator=function(){return this._errorIndicator},Bi.prototype.getErrorLocation=function(){return this._errorLocation},Bi.prototype.checkExpectedEmpty=function(){return 2<=this._input.getDimension()?null:0<this._distance?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Bi.prototype.report=function(t){if(!Bi.VERBOSE)return null;V.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Bi.prototype.getErrorMessage=function(){return this._errorMsg},Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi},Bi.isValidMsg=function(t,e,n){var i=new Bi(t,e,n);return i.isValid()?null:i.getErrorMessage()},Bi.isValid=function(t,e,n){return!!new Bi(t,e,n).isValid()},Ui.VERBOSE.get=function(){return!1},Ui.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Bi,Ui);var qi=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};qi.prototype.getCoordinates=function(){return this._pts},qi.prototype.size=function(){return this._pts.length},qi.prototype.getCoordinate=function(t){return this._pts[t]},qi.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},qi.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:cn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},qi.prototype.setData=function(t){this._data=t},qi.prototype.getData=function(){return this._data},qi.prototype.toString=function(){return Q.toLineString(new ue(this._pts))},qi.prototype.interfaces_=function(){return[pn]},qi.prototype.getClass=function(){return qi};var ji=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new wt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};ji.prototype.getInteriorIntersection=function(){return this._interiorIntersection},ji.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},ji.prototype.getIntersectionSegments=function(){return this._intSegments},ji.prototype.count=function(){return this._intersectionCount},ji.prototype.getIntersections=function(){return this._intersections},ji.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},ji.prototype.setKeepIntersections=function(t){this._keepIntersections=t},ji.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},ji.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},ji.prototype.hasIntersection=function(){return null!==this._interiorIntersection},ji.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},ji.prototype.interfaces_=function(){return[Wn]},ji.prototype.getClass=function(){return ji},ji.createAllIntersectionsFinder=function(t){var e=new ji(t);return e.setFindAllIntersections(!0),e},ji.createAnyIntersectionFinder=function(t){return new ji(t)},ji.createIntersectionCounter=function(t){var e=new ji(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var zi=function(){this._li=new rt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};zi.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},zi.prototype.getIntersections=function(){return this._segInt.getIntersections()},zi.prototype.isValid=function(){return this.execute(),this._isValid},zi.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},zi.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new ji(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new En;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},zi.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Ce(this.getErrorMessage(),this._segInt.getInteriorIntersection())},zi.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Q.toLineString(t[0],t[1])+" and "+Q.toLineString(t[2],t[3])},zi.prototype.interfaces_=function(){return[]},zi.prototype.getClass=function(){return zi},zi.computeIntersections=function(t){var e=new zi(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Vi=function t(){this._nv=null;var e=arguments[0];this._nv=new zi(t.toSegmentStrings(e))};Vi.prototype.checkValid=function(){this._nv.checkValid()},Vi.prototype.interfaces_=function(){return[]},Vi.prototype.getClass=function(){return Vi},Vi.toSegmentStrings=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new qi(i.getCoordinates(),i))}return e},Vi.checkValid=function(t){new Vi(t).checkValid()};var Yi=function(t){this._mapOp=t};Yi.prototype.map=function(t){for(var e=new wt,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(_e.toGeometryArray(e))},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi},Yi.map=function(t,e){return new Yi(e).map(t)};var Hi=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new wt,this._resultLineList=new wt;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Hi.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Hi.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Hi.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Hi.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Sr.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},Hi.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},Hi.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Hi.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}},Hi.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Sr.isResultOfOp(i,e)&&e===Sr.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Hi.prototype.interfaces_=function(){return[]},Hi.prototype.getClass=function(){return Hi};var Xi=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new wt;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Xi.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Xi.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==Sr.INTERSECTION)){var i=n.getLabel();Sr.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},Xi.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Xi.prototype.interfaces_=function(){return[]},Xi.prototype.getClass=function(){return Xi};var Wi=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Wi.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Wi.prototype.transformPolygon=function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof ee&&!i.isEmpty()||(n=!1);for(var r=new wt,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof ee||(n=!1),r.add(s))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new wt;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)},Wi.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Wi.prototype.getInputGeometry=function(){return this._inputGeom},Wi.prototype.transformMultiLineString=function(t,e){for(var n=new wt,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Wi.prototype.transformCoordinates=function(t,e){return this.copy(t)},Wi.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Wi.prototype.transformMultiPoint=function(t,e){for(var n=new wt,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Wi.prototype.transformMultiPolygon=function(t,e){for(var n=new wt,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Wi.prototype.copy=function(t){return t.copy()},Wi.prototype.transformGeometryCollection=function(t,e){for(var n=new wt,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(_e.toGeometryArray(n)):this._factory.buildGeometry(n)},Wi.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Zt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof Jt)return this.transformLineString(t,null);if(t instanceof zt)return this.transformMultiLineString(t,null);if(t instanceof $t)return this.transformPolygon(t,null);if(t instanceof ne)return this.transformMultiPolygon(t,null);if(t instanceof jt)return this.transformGeometryCollection(t,null);throw new m("Unknown Geometry subtype: "+t.getClass().getName())},Wi.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return 0<i&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi};var Ji=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new gn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Jt&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=t.isClosed(i),this._snapTolerance=r}};Ji.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new I(o)),0===i&&this._isClosed&&t.set(t.size()-1,new I(o)))}},Ji.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Ji.prototype.snapTo=function(t){var e=new Lt(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Ji.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);0<=o&&t.add(o+1,new I(r),!1)}},Ji.prototype.findSegmentIndexToSnap=function(t,e){for(var n=v.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},Ji.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Ji.prototype.interfaces_=function(){return[]},Ji.prototype.getClass=function(){return Ji},Ji.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Ki=function(t){this._srcGeom=t||null},Zi={SNAP_PRECISION_FACTOR:{configurable:!0}};Ki.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Qi(e,n).transform(this._srcGeom)},Ki.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new Qi(t,n,!0).transform(this._srcGeom),r=i;return e&&N(r,Qt)&&(r=i.buffer(0)),r},Ki.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Ki.prototype.extractTargetCoordinates=function(t){for(var e=new f,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},Ki.prototype.computeMinimumSegmentLength=function(t){for(var e=v.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},Ki.prototype.interfaces_=function(){return[]},Ki.prototype.getClass=function(){return Ki},Ki.snap=function(t,e,n){var i=new Array(2).fill(null),r=new Ki(t);i[0]=r.snapTo(e,n);var o=new Ki(e);return i[1]=o.snapTo(i[0],n),i},Ki.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Ki.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===fe.FIXED){var i=1/n.getScale()*2/1.415;e<i&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(Ki.computeOverlaySnapTolerance(r),Ki.computeOverlaySnapTolerance(o))}},Ki.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Ki.SNAP_PRECISION_FACTOR},Ki.snapToSelf=function(t,e,n){return new Ki(t).snapToSelf(e,n)},Zi.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Ki,Zi);var Qi=function(i){function t(t,e,n){i.call(this),this._snapTolerance=t||null,this._snapPts=e||null,this._isSelfSnap=void 0!==n&&n}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.snapLine=function(t,e){var n=new Ji(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},t.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Wi),$i=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};$i.prototype.getCommon=function(){return v.longBitsToDouble(this._commonBits)},$i.prototype.add=function(t){var e=v.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=$i.signExpBits(this._commonBits),this._isFirst=!1,null):$i.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=$i.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=$i.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},$i.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=v.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+v.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},$i.prototype.interfaces_=function(){return[]},$i.prototype.getClass=function(){return $i},$i.getBit=function(t,e){return 0!=(t&1<<e)?1:0},$i.signExpBits=function(t){return t>>52},$i.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},$i.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;0<=i;i--){if($i.getBit(t,i)!==$i.getBit(e,i))return n;n++}return 52};var tr=function(){this._commonCoord=null,this._ccFilter=new nr},er={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};tr.prototype.addCommonBits=function(t){var e=new ir(this._commonCoord);t.apply(e),t.geometryChanged()},tr.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new I(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ir(e);return t.apply(n),t.geometryChanged(),t},tr.prototype.getCommonCoordinate=function(){return this._commonCoord},tr.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},er.CommonCoordinateFilter.get=function(){return nr},er.Translater.get=function(){return ir},Object.defineProperties(tr,er);var nr=function(){this._commonBitsX=new $i,this._commonBitsY=new $i};nr.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},nr.prototype.getCommonCoordinate=function(){return new I(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},nr.prototype.interfaces_=function(){return[ft]},nr.prototype.getClass=function(){return nr};var ir=function(){this.trans=null;var t=arguments[0];this.trans=t};ir.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},ir.prototype.isDone=function(){return!1},ir.prototype.isGeometryChanged=function(){return!0},ir.prototype.interfaces_=function(){return[qt]},ir.prototype.getClass=function(){return ir};var rr=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};rr.prototype.selfSnap=function(t){return new Ki(t).snapTo(t,this._snapTolerance)},rr.prototype.removeCommonBits=function(t){this._cbr=new tr,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},rr.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},rr.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Sr.overlayOp(e[0],e[1],t);return this.prepareResult(n)},rr.prototype.checkValid=function(t){t.isValid()||V.out.println("Snapped geometry is invalid")},rr.prototype.computeSnapTolerance=function(){this._snapTolerance=Ki.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},rr.prototype.snap=function(t){var e=this.removeCommonBits(t);return Ki.snap(e[0],e[1],this._snapTolerance)},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.overlayOp=function(t,e,n){return new rr(t,e).getResultGeometry(n)},rr.union=function(t,e){return rr.overlayOp(t,e,Sr.UNION)},rr.intersection=function(t,e){return rr.overlayOp(t,e,Sr.INTERSECTION)},rr.symDifference=function(t,e){return rr.overlayOp(t,e,Sr.SYMDIFFERENCE)},rr.difference=function(t,e){return rr.overlayOp(t,e,Sr.DIFFERENCE)};var or=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};or.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=Sr.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof $))throw t;i=t}if(!n)try{e=rr.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof $?i:t}return e},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},or.overlayOp=function(t,e,n){return new or(t,e).getResultGeometry(n)},or.union=function(t,e){return or.overlayOp(t,e,Sr.UNION)},or.intersection=function(t,e){return or.overlayOp(t,e,Sr.INTERSECTION)},or.symDifference=function(t,e){return or.overlayOp(t,e,Sr.SYMDIFFERENCE)},or.difference=function(t,e){return or.overlayOp(t,e,Sr.DIFFERENCE)};var sr=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};sr.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr};var ar=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=i,this._xValue=r,this._obj=o}},ur={INSERT:{configurable:!0},DELETE:{configurable:!0}};ar.prototype.isDelete=function(){return this._eventType===ar.DELETE},ar.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ar.prototype.getObject=function(){return this._obj},ar.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ar.prototype.getInsertEvent=function(){return this._insertEvent},ar.prototype.isInsert=function(){return this._eventType===ar.INSERT},ar.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ar.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ar.prototype.interfaces_=function(){return[x]},ar.prototype.getClass=function(){return ar},ur.INSERT.get=function(){return 1},ur.DELETE.get=function(){return 2},Object.defineProperties(ar,ur);var lr=function(){};lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr};var hr=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};hr.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(hr.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},hr.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},hr.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},hr.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},hr.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},hr.prototype.hasProperIntersection=function(){return this._hasProper},hr.prototype.hasIntersection=function(){return this._hasIntersection},hr.prototype.isDone=function(){return this._isDone},hr.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},hr.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},hr.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},hr.prototype.interfaces_=function(){return[]},hr.prototype.getClass=function(){return hr},hr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var cr=function(t){function e(){t.call(this),this.events=new wt,this.nOverlaps=null}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.prepareEvents=function(){$e.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof hr&&N(arguments[0],Et)&&N(arguments[1],Et)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&N(arguments[0],Et)&&arguments[1]instanceof hr){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new sr(n,r),s=new ar(e,n.getMinX(r),o);this.events.add(s),this.events.add(new ar(n.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var o=r.next();this.addEdge(o,i)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(lr),pr=function(){this._min=v.POSITIVE_INFINITY,this._max=v.NEGATIVE_INFINITY},fr={NodeComparator:{configurable:!0}};pr.prototype.getMin=function(){return this._min},pr.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},pr.prototype.getMax=function(){return this._max},pr.prototype.toString=function(){return Q.toLineString(new I(this._min,0),new I(this._max,0))},pr.prototype.interfaces_=function(){return[]},pr.prototype.getClass=function(){return pr},fr.NodeComparator.get=function(){return dr},Object.defineProperties(pr,fr);var dr=function(){};dr.prototype.compare=function(t,e){var n=t,i=e,r=(n._min+n._max)/2,o=(i._min+i._max)/2;return r<o?-1:o<r?1:0},dr.prototype.interfaces_=function(){return[w]},dr.prototype.getClass=function(){return dr};var gr=function(i){function t(){i.call(this),this._item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._min=t,this._max=e,this._item=n}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(pr),yr=function(n){function t(){n.call(this),this._node1=null,this._node2=null;var t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},t.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(pr),_r=function(){this._leaves=new wt,this._root=null,this._level=0};_r.prototype.buildTree=function(){$e.sort(this._leaves,new pr.NodeComparator);for(var t=this._leaves,e=null,n=new wt;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},_r.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new gr(t,e,n))},_r.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},_r.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},_r.prototype.printNode=function(t){V.out.println(Q.toLineString(new I(t._min,this._level),new I(t._max,this._level)))},_r.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},_r.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new yr(t.get(n),t.get(n+1));e.add(r)}}},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r};var mr=function(){this._items=new wt};mr.prototype.visitItem=function(t){this._items.add(t)},mr.prototype.getItems=function(){return this._items},mr.prototype.interfaces_=function(){return[Je]},mr.prototype.getClass=function(){return mr};var vr=function(){this._index=null;var t=arguments[0];if(!N(t,Qt))throw new m("Argument must be Polygonal");this._index=new Er(t)},br={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};vr.prototype.locate=function(t){var e=new st(t),n=new xr(e);return this._index.query(t.y,t.y,n),e.getLocation()},vr.prototype.interfaces_=function(){return[Un]},vr.prototype.getClass=function(){return vr},br.SegmentVisitor.get=function(){return xr},br.IntervalIndexedGeometry.get=function(){return Er},Object.defineProperties(vr,br);var xr=function(){this._counter=null;var t=arguments[0];this._counter=t};xr.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},xr.prototype.interfaces_=function(){return[Je]},xr.prototype.getClass=function(){return xr};var Er=function(){this._index=new _r;var t=arguments[0];this.init(t)};Er.prototype.init=function(t){for(var e=Ii.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},Er.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new gn(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},Er.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new mr;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._index.query(i,r,o)}},Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er};var wr=function(s){function o(){if(s.call(this),this._parentGeom=null,this._lineEdgeMap=new pe,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Li,2===arguments.length){var t=arguments[0],e=arguments[1],n=dt.OGC_SFS_BOUNDARY_RULE;this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=n,null!==e&&this.add(e)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._argIndex=i,this._parentGeom=r,this._boundaryNodeRule=o,null!==r&&this.add(r)}}return s&&(o.__proto__=s),((o.prototype=Object.create(s&&s.prototype)).constructor=o).prototype.insertBoundaryPoint=function(t,e){var n=this._nodes.addNode(e).getLabel(),i=1;n.getLocation(t,Le.ON)===C.BOUNDARY&&i++;var r=o.determineBoundary(this._boundaryNodeRule,i);n.setLocation(t,r)},o.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new hr(n,!0,!1);o.setIsDoneIfProperInt(r);var s=this.createEdgeSetIntersector(),a=this._parentGeom instanceof ee||this._parentGeom instanceof $t||this._parentGeom instanceof ne,u=i||!a;return s.computeIntersections(this._edges,o,u),this.addSelfIntersectionNodes(this._argIndex),o}},o.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},o.prototype.computeEdgeIntersections=function(t,e,n){var i=new hr(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},o.prototype.getGeometry=function(){return this._parentGeom},o.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},o.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},o.prototype.addPoint=function(){if(arguments[0]instanceof Zt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,C.INTERIOR)}else if(arguments[0]instanceof I){var e=arguments[0];this.insertPoint(this._argIndex,e,C.INTERIOR)}},o.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),C.EXTERIOR,C.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,C.INTERIOR,C.EXTERIOR)}},o.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],C.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],C.BOUNDARY)},o.prototype.addLineString=function(t){var e=St.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new ni(e,new Te(this._argIndex,C.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),et.isTrue(2<=e.length,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},o.prototype.getInvalidPoint=function(){return this._invalidPoint},o.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},o.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},o.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===C.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},o.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=St.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;at.isCCW(i)&&(r=n,o=e);var s=new ni(i,new Te(this._argIndex,C.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],C.BOUNDARY)},o.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new Te(t,n):r.setLocation(t,n)},o.prototype.createEdgeSetIntersector=function(){return new cr},o.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},o.prototype.add=function(){if(1!==arguments.length)return s.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof ne&&(this._useBoundaryDeterminationRule=!1),t instanceof $t)this.addPolygon(t);else if(t instanceof Jt)this.addLineString(t);else if(t instanceof Zt)this.addPoint(t);else if(t instanceof te)this.addCollection(t);else if(t instanceof zt)this.addCollection(t);else if(t instanceof ne)this.addCollection(t);else{if(!(t instanceof jt))throw new Error(t.getClass().getName());this.addCollection(t)}},o.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},o.prototype.locate=function(t){return N(this._parentGeom,Qt)&&50<this._parentGeom.getNumGeometries()?(null===this._areaPtLocator&&(this._areaPtLocator=new vr(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},o.prototype.findEdge=function(){if(1!==arguments.length)return s.prototype.findEdge.apply(this,arguments);var t=arguments[0];return this._lineEdgeMap.get(t)},o.prototype.interfaces_=function(){return[]},o.prototype.getClass=function(){return o},o.determineBoundary=function(t,e){return t.isInBoundary(e)?C.BOUNDARY:C.INTERIOR},o}(Ve),Ir=function(){if(this._li=new rt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new wr(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=dt.OGC_SFS_BOUNDARY_RULE;0<=e.getPrecisionModel().compareTo(n.getPrecisionModel())?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new wr(0,e,i),this._arg[1]=new wr(1,n,i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];0<=r.getPrecisionModel().compareTo(o.getPrecisionModel())?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new wr(0,r,s),this._arg[1]=new wr(1,o,s)}};Ir.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Ir.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir};var Lr=function(){};Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.map=function(){if(arguments[0]instanceof ht&&N(arguments[1],Lr.MapOp)){for(var t=arguments[0],e=arguments[1],n=new wt,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(N(arguments[0],bt)&&N(arguments[1],Lr.MapOp)){for(var o=arguments[0],s=arguments[1],a=new wt,u=o.iterator();u.hasNext();){var l=u.next(),h=s.map(l);null!==h&&a.add(h)}return a}},Lr.MapOp=function(){};var Sr=function(n){function o(){var t=arguments[0],e=arguments[1];n.call(this,t,e),this._ptLocator=new Li,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Xn,this._resultPolyList=new wt,this._resultLineList=new wt,this._resultPointList=new wt,this._graph=new Ve(new Yn),this._geomFact=t.getFactory()}return n&&(o.__proto__=n),((o.prototype=Object.create(n&&n.prototype)).constructor=o).prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Te(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},o.prototype.getGraph=function(){return this._graph},o.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},o.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},o.prototype.computeGeometry=function(t,e,n,i){var r=new wt;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?o.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(r)},o.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},o.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==C.EXTERIOR)return!0}return!1},o.prototype.replaceCollapsedEdges=function(){for(var t=new wt,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},o.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},o.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},o.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},o.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new wt;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Vi.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new Ye(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new Hi(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new Xi(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},o.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},o.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},o.prototype.findResultAreaEdges=function(t){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&o.isResultOfOp(i.getLocation(0,Le.RIGHT),i.getLocation(1,Le.RIGHT),t)&&n.setInResult(!0)}},o.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(et.isTrue(!i.isNull(r,Le.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Le.LEFT,i.getLocation(r,Le.LEFT)),et.isTrue(!i.isNull(r,Le.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Le.RIGHT,i.getLocation(r,Le.RIGHT))))}}},o.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},o.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},o.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},o.prototype.interfaces_=function(){return[]},o.prototype.getClass=function(){return o},o}(Ir);Sr.overlayOp=function(t,e,n){return new Sr(t,e).getResultGeometry(n)},Sr.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Sr.createEmptyResult(Sr.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Yi.map(t,{interfaces_:function(){return[Lr.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Sr.INTERSECTION)},Sr.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Sr.createEmptyResult(Sr.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Sr.SYMDIFFERENCE)},Sr.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case Sr.INTERSECTION:o=Math.min(i,r);break;case Sr.UNION:o=Math.max(i,r);break;case Sr.DIFFERENCE:o=i;break;case Sr.SYMDIFFERENCE:o=Math.max(i,r)}return o},Sr.createEmptyResult=function(t,e,n,i){var r=null;switch(Sr.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},Sr.difference=function(t,e){return t.isEmpty()?Sr.createEmptyResult(Sr.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Sr.DIFFERENCE))},Sr.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return Sr.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===C.BOUNDARY&&(r=C.INTERIOR),o===C.BOUNDARY&&(o=C.INTERIOR),s){case Sr.INTERSECTION:return r===C.INTERIOR&&o===C.INTERIOR;case Sr.UNION:return r===C.INTERIOR||o===C.INTERIOR;case Sr.DIFFERENCE:return r===C.INTERIOR&&o!==C.INTERIOR;case Sr.SYMDIFFERENCE:return r===C.INTERIOR&&o!==C.INTERIOR||r!==C.INTERIOR&&o===C.INTERIOR}return!1}},Sr.INTERSECTION=1,Sr.UNION=2,Sr.DIFFERENCE=3,Sr.SYMDIFFERENCE=4;var Mr=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Li,this._seg=new gn;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Mr.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++)if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Mr.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?C.BOUNDARY:this._ptLocator.locate(t,this._g)},Mr.prototype.extractLinework=function(t){var e=new Cr;t.apply(e);var n=e.getLinework(),i=_e.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},Mr.prototype.interfaces_=function(){return[]},Mr.prototype.getClass=function(){return Mr};var Cr=function(){this._linework=null,this._linework=new wt};Cr.prototype.getLinework=function(){return this._linework},Cr.prototype.filter=function(t){if(t instanceof $t){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Cr.prototype.interfaces_=function(){return[Ut]},Cr.prototype.getClass=function(){return Cr};var Pr=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Pr.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},Pr.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Pr.prototype.getPoints=function(t){for(var e=new wt,n=Ii.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},Pr.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=n*r/s,u=n*o/s,l=(e.x+t.x)/2,h=(e.y+t.y)/2;if(this._doLeft){var c=new I(l-u,h+a);i.add(c)}if(this._doRight){var p=new I(l+u,h-a);i.add(p)}},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr};var Nr=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new wt;var e=arguments[0],n=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,i],this._locFinder=[new Mr(this._geom[0],this._boundaryDistanceTolerance),new Mr(this._geom[1],this._boundaryDistanceTolerance),new Mr(this._geom[2],this._boundaryDistanceTolerance)]},Or={TOLERANCE:{configurable:!0}};Nr.prototype.reportResult=function(t,e,n){V.out.println("Overlay result invalid - A:"+C.toLocationSymbol(e[0])+" B:"+C.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+C.toLocationSymbol(e[2]))},Nr.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Nr.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Nr.hasLocation(this._location,C.BOUNDARY)||this.isValidResult(i,this._location)}},Nr.prototype.addTestPts=function(t){var e=new Pr(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Nr.prototype.isValidResult=function(t,e){var n=Sr.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===C.INTERIOR);return i||this.reportResult(t,e,n),i},Nr.prototype.getInvalidLocation=function(){return this._invalidLocation},Nr.prototype.interfaces_=function(){return[]},Nr.prototype.getClass=function(){return Nr},Nr.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Nr.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Ki.computeSizeBasedSnapTolerance(t),Ki.computeSizeBasedSnapTolerance(e))},Nr.isValid=function(t,e,n,i){return new Nr(t,e,i).isValid(n)},Or.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Nr,Or);var Tr=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Tr.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},Tr.prototype.combine=function(){for(var t=new wt,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr},Tr.combine=function(){if(1===arguments.length){var t=arguments[0];return new Tr(t).combine()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new Tr(Tr.createList(e,n)).combine()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];return new Tr(Tr.createList(i,r,o)).combine()}},Tr.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Tr.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new wt;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=new wt;return s.add(i),s.add(r),s.add(o),s}};var Rr=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new wt)},kr={STRTREE_NODE_CAPACITY:{configurable:!0}};Rr.prototype.reduceToGeometries=function(t){for(var e=new wt,n=t.iterator();n.hasNext();){var i=n.next(),r=null;N(i,Et)?r=this.unionTree(i):i instanceof ht&&(r=i),e.add(r)}return e},Rr.prototype.extractByEnvelope=function(t,e,n){for(var i=new wt,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},Rr.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return Tr.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},Rr.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new sn(Rr.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},Rr.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=Rr.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Rr.getGeometry(e,n),Rr.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,i);return this.unionSafe(s,a)}},Rr.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},Rr.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Rr.prototype.unionActual=function(t,e){return Rr.restrictToPolygons(t.union(e))},Rr.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Rr.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new wt,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),Tr.combine(i)},Rr.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Rr.prototype.interfaces_=function(){return[]},Rr.prototype.getClass=function(){return Rr},Rr.restrictToPolygons=function(t){if(N(t,Qt))return t;var e=wi.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(_e.toPolygonArray(e))},Rr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Rr.union=function(t){return new Rr(t).union()},kr.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Rr,kr);var Dr=function(){};Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr},Dr.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Sr.createEmptyResult(Sr.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Sr.UNION)},t.GeoJSONReader=we,t.GeoJSONWriter=Ie,t.OverlayOp=Sr,t.UnionOp=Dr,t.BufferOp=gi,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){var i=n(6),l=6378137;function r(t){var e=0;if(t&&0<t.length){e+=Math.abs(o(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(o(t[n]))}return e}function o(t){var e,n,i,r,o,s,a=0,u=t.length;if(2<u){for(s=0;s<u;s++)o=s===u-2?(i=u-2,r=u-1,0):s===u-1?(i=u-1,r=0,1):(r=(i=s)+1,s+2),e=t[i],n=t[r],a+=(h(t[o][0])-h(e[0]))*Math.sin(h(n[1]));a=a*l*l/2}return a}function h(t){return t*Math.PI/180}e.a=function(t){return Object(i.b)(t,function(t,e){return t+function t(e){var n,i=0;switch(e.type){case"Polygon":return r(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=r(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}}(e)},0)}},function(t,e,n){function i(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")}n.d(e,"a",function(){return i}),n(2)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={_initDraggableLayer:function(){this._tempDragCoord=null;var t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.addClass(t,"leaflet-pm-draggable"),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0,this._layer.on("mousedown",this._dragMixinOnMouseDown,this)},_dragMixinOnMouseUp:function(){var t=this,e=this._layer._path?this._layer._path:this._layer._renderer._container;return this._originalMapDragState&&this._layer._map.dragging.enable(),this._safeToCacheDragState=!0,this._layer._map.off("mousemove",this._dragMixinOnMouseMove,this),this._layer.off("mouseup",this._dragMixinOnMouseUp,this),!!this._dragging&&(this._initMarkers(),window.setTimeout(function(){t._dragging=!1,L.DomUtil.removeClass(e,"leaflet-pm-dragging"),t._layer.fire("pm:dragend"),t._fireEdit()},10),!0)},_dragMixinOnMouseMove:function(t){var e=this._layer._path?this._layer._path:this._layer._renderer._container;this._dragging||(this._dragging=!0,L.DomUtil.addClass(e,"leaflet-pm-dragging"),this._layer.bringToFront(),this._originalMapDragState&&this._layer._map.dragging.disable(),this._markerGroup.clearLayers(),this._layer.fire("pm:dragstart")),this._onLayerDrag(t)},_dragMixinOnMouseDown:function(t){0<t.originalEvent.button||(this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=t.latlng,this._layer.on("mouseup",this._dragMixinOnMouseUp,this),this._layer._map.on("mousemove",this._dragMixinOnMouseMove,this))},dragging:function(){return this._dragging},_onLayerDrag:function(t){var e,n=t.latlng,i=n.lat-this._tempDragCoord.lat,r=n.lng-this._tempDragCoord.lng,o=function(t){return t.map(function(t){return{lat:t.lat+i,lng:t.lng+r}})};e=this.isPolygon()?this._layer._latlngs.map(o,this):o(this._layer._latlngs),this._layer.setLatLngs(e).redraw(),this._tempDragCoord=n,this._layer.fire("pm:drag")}};e.default=i},function(t,e,n){var i;((i=n(1))&&i.__esModule?i:{default:i}).default.LayerGroup=L.Class.extend({initialize:function(t){var e=this;this._layerGroup=t,this._layers=this.findLayers(),this._layers.forEach(function(t){return e._initLayer(t)}),this._layerGroup.on("layeradd",function(t){t.target._pmTempLayer||(e._layers=e.findLayers(),t.layer.pm&&e._initLayer(t.layer),t.target.pm.enabled())})},findLayers:function(){var t=this._layerGroup.getLayers();return(t=t.filter(function(t){return!!t.pm})).filter(function(t){return!t._pmTempLayer})},_initLayer:function(e){var n=this;["pm:edit","pm:update","pm:remove","pm:dragstart","pm:drag","pm:dragend","pm:snap","pm:unsnap","pm:cut","pm:intersect","pm:raiseMarkers","pm:markerdragend","pm:markerdragstart","pm:vertexadded","pm:vertexremoved","pm:centerplaced"].forEach(function(t){e.on(t,n._fireEvent,n)}),e.pm._layerGroup=this._layerGroup},_fireEvent:function(t){this._layerGroup.fireEvent(t.type,t)},toggleEdit:function(e){this._options=e,this._layers.forEach(function(t){t.pm.toggleEdit(e)})},enable:function(e){this._options=e,this._layers.forEach(function(t){t.pm.enable(e)})},disable:function(){this._layers.forEach(function(t){t.pm.disable()})},enabled:function(){return!!this._layers.find(function(t){return t.pm.enabled()})},dragging:function(){return!!this._layers.find(function(t){return t.pm.dragging()})},getOptions:function(){return this._options}})},function(t,e,n){var i,r=(i=n(1))&&i.__esModule?i:{default:i};r.default.Marker=r.default.extend({initialize:function(t){this._layer=t,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{draggable:!0,snappable:!0};this.options=t,this._map=this._layer._map,this.enabled()||(this._enabled=!0,this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this),this.options.draggable&&this._layer.dragging.enable(),this.options.snappable&&this._initSnappableMarkers())},enabled:function(){return this._enabled},disable:function(){this._enabled=!1,this._layer.dragging.disable(),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._layer.fire("pm:update",{}),this._layerEdited=!1},_removeMarker:function(t){var e=t.target;e.remove(),e.fire("pm:remove")},_onDragEnd:function(t){t.target.fire("pm:edit"),this._layerEdited=!0},_initSnappableMarkers:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,t.off("drag",this._handleSnapping,this),t.on("drag",this._handleSnapping,this),t.off("dragend",this._cleanupSnapping,this),t.on("dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)}})},function(t,e,n){var i=o(n(4)),r=o(n(1));function o(t){return t&&t.__esModule?t:{default:t}}r.default.Line=r.default.extend({initialize:function(t){this._layer=t,this._enabled=!1},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enable:function(t){L.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this._layer.on("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.draggable&&this._initDraggableLayer(),this.options.allowSelfIntersection||this._handleLayerStyle())},_onLayerRemove:function(t){this.disable(t.target)},enabled:function(){return this._enabled},disable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._layer;if(!this.enabled())return!1;if(t.pm._dragging)return!1;t.pm._enabled=!1,t.pm._markerGroup.clearLayers(),t.off("mousedown"),t.off("mouseup"),this._layer.off("remove",this._onLayerRemove),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval);var e=t._path?t._path:this._layer._renderer._container;return L.DomUtil.removeClass(e,"leaflet-pm-draggable"),this.hasSelfIntersection()&&L.DomUtil.removeClass(e,"leaflet-pm-invalid"),this._layerEdited&&this._layer.fire("pm:update",{}),!(this._layerEdited=!1)},hasSelfIntersection:function(){return 0<(0,i.default)(this._layer.toGeoJSON()).features.length},_handleSelfIntersectionOnVertexRemoval:function(){this._handleLayerStyle(!0),this.hasSelfIntersection()&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle:function(t){var e=this._layer._path?this._layer._path:this._layer._renderer._container;if(this.hasSelfIntersection()){if(L.DomUtil.hasClass(e,"leaflet-pm-invalid"))return;t?(L.DomUtil.addClass(e,"leaflet-pm-invalid"),window.setTimeout(function(){L.DomUtil.removeClass(e,"leaflet-pm-invalid")},200)):L.DomUtil.addClass(e,"leaflet-pm-invalid"),this._layer.fire("pm:intersect",{intersection:(0,i.default)(this._layer.toGeoJSON())})}else L.DomUtil.removeClass(e,"leaflet-pm-invalid")},_initMarkers:function(){var o=this,t=this._map,e=this._layer.getLatLngs();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,t.addLayer(this._markerGroup);var n=function(i){var r=i.map(o._createMarker,o);return i.map(function(t,e){var n;return n=o.isPolygon()?(e+1)%i.length:e+1,o._createMiddleMarker(r[e],r[n])}),r};this._markers=[],this.isPolygon()?this._markers=e.map(n,this):this._markers=n(e),this.options.snappable&&this._initSnappableMarkers()},_createMarker:function(t){var e=new L.Marker(t,{draggable:!this.options.preventVertexEdit,icon:L.divIcon({className:"marker-icon"})});return e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("move",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||e.on("contextmenu",this._removeMarker,this),this._markerGroup.addLayer(e),e},_createMiddleMarker:function(e,n){var i=this;if(!e||!n)return!1;var t=this._calcMiddleLatLng(e.getLatLng(),n.getLatLng()),r=this._createMarker(t),o=L.divIcon({className:"marker-icon marker-icon-middle"});return r.setIcon(o),e._middleMarkerNext=r,(n._middleMarkerPrev=r).on("click",function(){var t=L.divIcon({className:"marker-icon"});r.setIcon(t),i._addMarker(r,e,n)}),r.on("movestart",function(){r.on("moveend",function(){var t=L.divIcon({className:"marker-icon"});r.setIcon(t),r.off("moveend")}),i._addMarker(r,e,n)}),r},_addMarker:function(t,e,n){t.off("movestart"),t.off("click");var i=t.getLatLng(),r=this._layer._latlngs,o=this.findMarkerIndex(this._markers,n),s=o.ringIndex,a=o.index,u=-1<s?r[s]:r,l=-1<s?this._markers[s]:this._markers;u.splice(a,0,i),l.splice(a,0,t),this._layer.setLatLngs(r),this._createMiddleMarker(e,t),this._createMiddleMarker(t,n),this._fireEdit(),this._layer.fire("pm:vertexadded",{layer:this._layer,marker:t,index:a,ringIndex:s}),this.options.snappable&&this._initSnappableMarkers()},_removeMarker:function(t){if(!this.options.allowSelfIntersection){var e=this._layer.getLatLngs();this._coordsBeforeEdit=JSON.parse(JSON.stringify(e))}var n=t.target,i=this._layer.getLatLngs(),r=this.findMarkerIndex(this._markers,n),o=r.ringIndex,s=r.index,a=-1<o?i[o]:i,u=-1<o?this._markers[o]:this._markers;if(-1!==this.findMarkerIndex(this._markers,n).index){var l,h;if(a.splice(s,1),this._layer.setLatLngs(i),a.length<=1&&(i.splice(o,1),this._layer.setLatLngs(i),this.disable(),this.enable(this.options)),i.length<1&&this._layer.remove(),n._middleMarkerPrev&&this._markerGroup.removeLayer(n._middleMarkerPrev),n._middleMarkerNext&&this._markerGroup.removeLayer(n._middleMarkerNext),this._markerGroup.removeLayer(n),this.isPolygon()?(l=(s+1)%u.length,h=(s+(u.length-1))%u.length):(h=s-1<0?void 0:s-1,l=s+1>=u.length?void 0:s+1),l!==h){var c=u[h],p=u[l];this._createMiddleMarker(c,p)}u.splice(s,1),this._fireEdit(),this._layer.fire("pm:vertexremoved",{layer:this._layer,marker:n,index:s,ringIndex:o})}},findMarkerIndex:function(t,e){var n,i;return this.isPolygon()?i=t.findIndex(function(t){return-1<(n=t.findIndex(function(t){return e._leaflet_id===t._leaflet_id}))}):n=t.findIndex(function(t){return e._leaflet_id===t._leaflet_id}),{index:n,ringIndex:i}},updatePolygonCoordsFromMarkerDrag:function(t){var e=this._layer.getLatLngs(),n=this.findMarkerIndex(this._markers,t),i=n.ringIndex,r=n.index;(-1<i?e[i]:e).splice(r,1,t.getLatLng()),this._layer.setLatLngs(e).redraw()},_onMarkerDrag:function(t){var e=t.target;if(-1!==this.findMarkerIndex(this._markers,e).index){this.updatePolygonCoordsFromMarkerDrag(e);var n=this.findMarkerIndex(this._markers,e),i=n.ringIndex,r=n.index,o=-1<i?this._markers[i]:this._markers,s=(r+1)%o.length,a=(r+o.length-1)%o.length,u=e.getLatLng(),l=o[a].getLatLng(),h=o[s].getLatLng();if(e._middleMarkerNext){var c=this._calcMiddleLatLng(u,h);e._middleMarkerNext.setLatLng(c)}if(e._middleMarkerPrev){var p=this._calcMiddleLatLng(u,l);e._middleMarkerPrev.setLatLng(p)}this.options.allowSelfIntersection||this._handleLayerStyle()}},_onMarkerDragEnd:function(t){var e=t.target,n=this.findMarkerIndex(this._markers,e),i=n.ringIndex,r=n.index;if(!this.options.allowSelfIntersection&&this.hasSelfIntersection())return this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),void this._handleLayerStyle();this._layer.fire("pm:markerdragend",{markerEvent:t,ringIndex:i,index:r}),this._fireEdit()},_onMarkerDragStart:function(t){var e=t.target,n=this.findMarkerIndex(this._markers,e),i=n.ringIndex,r=n.index;this._layer.fire("pm:markerdragstart",{markerEvent:t,ringIndex:i,index:r}),this.options.allowSelfIntersection||(this._coordsBeforeEdit=this._layer.getLatLngs())},_fireEdit:function(){this._layerEdited=!0,this._layer.fire("pm:edit")},_calcMiddleLatLng:function(t,e){var n=this._map,i=n.project(t),r=n.project(e);return n.unproject(i._add(r)._divideBy(2))}})},function(t,e,n){var i,r=(i=n(1))&&i.__esModule?i:{default:i};r.default.Poly=r.default.Line.extend({})},function(t,e,n){var i,r=(i=n(1))&&i.__esModule?i:{default:i};r.default.Rectangle=r.default.Poly.extend({_initMarkers:function(){var t=this._map,e=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,t.addLayer(this._markerGroup),this._markers=[],this._markers[0]=e.map(this._createMarker,this),this._cornerMarkers=this._markers[0],this.options.snappable&&this._initSnappableMarkers()},_createMarker:function(t,e){var n=new L.Marker(t,{draggable:!this.options.preventVertexEdit,icon:L.divIcon({className:"marker-icon"})});return n._origLatLng=t,n._index=e,n._pmTempLayer=!0,n.on("dragstart",this._onMarkerDragStart,this),n.on("drag",this._onMarkerDrag,this),n.on("dragend",this._onMarkerDragEnd,this),n.on("pm:snap",this._adjustRectangleForMarkerSnap,this),this.options.preventMarkerRemoval||n.on("contextmenu",this._removeMarker,this),this._markerGroup.addLayer(n),n},_removeMarker:function(){return null},_onMarkerDragStart:function(t){var e=t.target,n=this._findCorners();e._oppositeCornerLatLng=n[(e._index+2)%4],e._snapped=!1,this._layer.fire("pm:markerdragstart",{markerEvent:t})},_onMarkerDrag:function(t){var e=t.target;void 0!==e._index&&(e._snapped||this._adjustRectangleForMarkerMove(e))},_onMarkerDragEnd:function(t){var e=this._findCorners();this._adjustAllMarkers(e),this._cornerMarkers.forEach(function(t){delete t._oppositeCornerLatLng}),this._layer.setLatLngs(e),this._layer.redraw(),this._layer.fire("pm:markerdragend",{markerEvent:t}),this._fireEdit()},_adjustRectangleForMarkerMove:function(t){L.extend(t._origLatLng,t._latlng);var e=t.getLatLng();this._layer.setBounds(L.latLngBounds(e,t._oppositeCornerLatLng)),this._adjustAdjacentMarkers(t),this._layer.redraw()},_adjustRectangleForMarkerSnap:function(t){if(this.options.snappable){var e=t.target;this._adjustRectangleForMarkerMove(e)}},_adjustAllMarkers:function(n){n.length&&4==n.length?this._cornerMarkers.forEach(function(t,e){t.setLatLng(n[e])}):console.error("_adjustAllMarkers() requires an array of EXACTLY 4 LatLng coordinates")},_adjustAdjacentMarkers:function(t){if(t&&t.getLatLng&&t._oppositeCornerLatLng){var n=t.getLatLng(),i=t._oppositeCornerLatLng,r=[];this._findCorners().forEach(function(t){t.equals(n)||t.equals(i)||r.push(t)});var o=0;2==r.length&&this._cornerMarkers.forEach(function(t){var e=t.getLatLng();e.equals(n)||e.equals(i)||(t.setLatLng(r[o]),o+=1)})}else console.error("_adjustAdjacentMarkers() requires a valid Marker object")},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}})},function(t,e,n){var i,r=(i=n(1))&&i.__esModule?i:{default:i};r.default.Circle=r.default.extend({initialize:function(t){this._layer=t,this._enabled=!1},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enabled:function(){return this._enabled},enable:function(t){var e=this;L.Util.setOptions(this,t),this._map=this._layer._map,this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this._layer.on("remove",function(t){e.disable(t.target)})},disable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._layer;if(!this.enabled())return!1;if(t.pm._dragging)return!1;t.pm._enabled=!1,t.pm._layerGroup.clearLayers(),t.off("mousedown"),t.off("mouseup");var e=t._path;return L.DomUtil.removeClass(e,"leaflet-pm-draggable"),this._layerEdited&&this._layer.fire("pm:update",{}),!(this._layerEdited=!1)},_initMarkers:function(){var t=this._map;this._layerGroup&&this._layerGroup.clearLayers(),this._layerGroup=new L.LayerGroup,t.addLayer(this._layerGroup);var e=this._layer.getLatLng(),n=this._layer._radius,i=this._getLatLngOnCircle(e,n);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(i),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker),this.options.snappable&&this._initSnappableMarkers()},_getLatLngOnCircle:function(t,e){var n=this._map.project(t),i=L.point(n.x+e,n.y);return this._map.unproject(i)},_resizeCircle:function(){this._syncHintLine(),this._syncCircleRadius()},_moveCircle:function(t){var e=t.latlng;this._layer.setLatLng(e);var n=this._layer._radius,i=this._getLatLngOnCircle(e,n);this._outerMarker.setLatLng(i),this._syncHintLine(),this._layer.fire("pm:centerplaced",{layer:this._layer,latlng:e})},_onMarkerDragStart:function(t){this._layer.fire("pm:markerdragstart",{markerEvent:t})},_onMarkerDragEnd:function(t){this._fireEdit(),this._layer.fire("pm:markerdragend",{markerEvent:t})},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),n=t.distanceTo(e);this._layer.setRadius(n)},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_createHintLine:function(t,e){var n=t.getLatLng(),i=e.getLatLng();this._hintline=L.polyline([n,i],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline)},_createCenterMarker:function(t){var e=this._createMarker(t);return e.on("move",this._moveCircle,this),e},_createOuterMarker:function(t){var e=this._createMarker(t);return this.options.preventVertexEdit&&e.dragging.disable(),e.on("move",this._resizeCircle,this),e},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("dragend",this._onMarkerDragEnd,this),this._layerGroup.addLayer(e),e},_fireEdit:function(){this._layer.fire("pm:edit"),this._layerEdited=!0}})},function(t,e){},function(t,e){}]),G.SVG.include({_updatecurve:function(t){var e=this._curvePointsToPath(t._points);if(this._setPath(t,e),t.options.animate){var n=t._path,i=n.getTotalLength();t.options.dashArray||(n.style.strokeDasharray=i+" "+i),t._initialUpdate&&(n.animate([{strokeDashoffset:i},{strokeDashoffset:0}],t.options.animate),t._initialUpdate=!1)}return e},_curvePointsToPath:function(t){for(var e=void 0,n="",i=0;i<t.length;i++)"string"==typeof(e=t[i])||e instanceof String?n+=e:n+=e.x+","+e.y+" ";return n||"M0 0"}});var _=G.Path.extend({options:{},initialize:function(t,e){t.mid||(t.mid=this.getMidPoint(t.from,t.to,t.from.deep?t.from.deep:4,t.from.slide)),G.setOptions(this,e),this._initialUpdate=!0,this.setPath(t)},onAdd:function(t){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this),t.on("zoom",function(){})},getPath:function(){return this._coords},setPath:function(t){return this._setPath(t),this.redraw()},getBounds:function(){return this._bounds},getMidPoint:function(t,e,n){var i=3.14;"RIGHT_ROUND"===(3<arguments.length&&void 0!==arguments[3]?arguments[3]:"LEFT_ROUND")&&(i*=-1);var r=t,o=e,s=o.lng-r.lng,a=o.lat-r.lat,u=Math.sqrt(Math.pow(s,2)+Math.pow(a,2)),l=Math.atan2(a,s),h=i/(n||4),c=u/2/Math.cos(h),p=l+h,f=c*Math.cos(p)+r.lng;return[c*Math.sin(p)+r.lat,f]},_setPath:function(t){this._coords=t,this._bounds=this._computeBounds()},_computeBounds:function(){var t=new G.LatLngBounds;return t.extend(this._coords.from),t.extend(this._coords.to),t.extend(this._coords.mid),t},getCenter:function(){return this._bounds.getCenter()},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updatecurve(this)},_project:function(){this._points=[],this._points.push("M");var t=this._map.latLngToLayerPoint(this._coords.from);this._points.push(t),this._coords.mid&&(this._points.push("Q"),t=this._map.latLngToLayerPoint(this._coords.mid),this._points.push(t)),t=this._map.latLngToLayerPoint(this._coords.to),this._points.push(t)}}),m=52.35987755982988,v=3.141592653589793,x=6378245,E=.006693421622965943,w=function(t,e){var n=2*(t=+t)-100+3*(e=+e)+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*v)+20*Math.sin(2*t*v))/3,n+=2*(20*Math.sin(e*v)+40*Math.sin(e/3*v))/3,n+=2*(160*Math.sin(e/12*v)+320*Math.sin(e*v/30))/3},I=function(t,e){var n=300+(t=+t)+2*(e=+e)+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*v)+20*Math.sin(2*t*v))/3,n+=2*(20*Math.sin(t*v)+40*Math.sin(t/3*v))/3,n+=2*(150*Math.sin(t/12*v)+300*Math.sin(t/30*v))/3},S=function(t,e){e=+e;return!(73.66<(t=+t)&&t<135.05&&3.86<e&&e<53.55)},M={bd09togcj02:function(t,e){var n=(t=+t)-.0065,i=(e=+e)-.006,r=Math.sqrt(n*n+i*i)-2e-5*Math.sin(i*m),o=Math.atan2(i,n)-3e-6*Math.cos(n*m);return[r*Math.cos(o),r*Math.sin(o)]},gcj02tobd09:function(t,e){e=+e,t=+t;var n=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*m),i=Math.atan2(e,t)+3e-6*Math.cos(t*m);return[n*Math.cos(i)+.0065,n*Math.sin(i)+.006]},wgs84togcj02:function(t,e){if(S(t=+t,e=+e))return[t,e];var n=w(t-105,e-35),i=I(t-105,e-35),r=e/180*v,o=Math.sin(r);o=1-E*o*o;var s=Math.sqrt(o);return n=180*n/(x*(1-E)/(o*s)*v),[t+(i=180*i/(x/s*Math.cos(r)*v)),e+n]},gcj02towgs84:function(t,e){if(S(t=+t,e=+e))return[t,e];var n=w(t-105,e-35),i=I(t-105,e-35),r=e/180*v,o=Math.sin(r);o=1-E*o*o;var s=Math.sqrt(o);return n=180*n/(x*(1-E)/(o*s)*v),[2*t-(t+(i=180*i/(x/s*Math.cos(r)*v))),2*e-(e+n)]}},C=G.Renderer.extend({options:{padding:.1,width:0,height:0,zIndex:0,className:""},initialize:function(t){G.Renderer.prototype.initialize.call(this,t),this._initContainer()},_initContainer:function(){this._divContainer=G.DomUtil.create("div","leaflet-layer "+this.options.className),this._container=document.createElement("canvas"),this.container=this._container,this._divContainer.appendChild(this.container),this.options.zIndex&&(this._divContainer.style.zIndex=this.options.zIndex),this._ctx=this.container.getContext("2d"),this.ctx=this._ctx,G.DomUtil.addClass(this._container,"leaflet-zoom-animated")},getContainer:function(){return this._container},setZIndex:function(t){this.options.zIndex=t,this._divContainer.style.zIndex=t},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&G.DomUtil.addClass(this._divContainer,"leaflet-zoom-animated")),this.getPane().appendChild(this._divContainer),this.clear()},onRemove:function(){G.DomUtil.remove(this._divContainer)},_update:function(){var t=this.options.padding,e=this._map.getSize();this.options.width&&this.options.height&&(e.x=this.options.width,e.y=this.options.height);var n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new G.Bounds(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},clear:function(){if(this._map&&(!this._map._animatingZoom||!this._bounds)){G.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=G.Browser.retina?2:1;G.DomUtil.setPosition(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",G.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y)}}}),P=G.Layer.extend({options:{color:"rgba(250,113,122,0.8)",type:"circle",speed:.15,max:20,latlng:null,name:""},beforeAdd:function(t){this._renderer=this._getRenderer(t),t.hasLayer(this._renderer)||t.addLayer(this._renderer)},onAdd:function(){this.update()},onRemove:function(){this._renderer.clear(),this.drawFrame&&G.Util.cancelAnimFrame(this.drawFrame)},_getRenderer:function(t){var e=t._paneRenderers.flashMarker;return e||(e=new C({pane:this.options.pane}),t._paneRenderers.flashMarker=e),e},initialize:function(t,e){G.setOptions(this,e),this.latlng=t,this.name=this.options.name||"",this.size=0},getEvents:function(){return{moveend:this.update,viewreset:this.update}},update:function(){var e=this;this._map&&(this._renderer.clear(),this.drawFrame&&G.Util.cancelAnimFrame(this.drawFrame),function t(){e.drawFrame=G.Util.requestAnimFrame(t),e.draw()}())},draw:function(){var t=this._renderer.ctx;t.fillStyle="rgba(0,0,0,.93)";var e=t.globalCompositeOperation;switch(t.globalCompositeOperation="destination-in",t.fillRect(0,0,this._renderer.getContainer().width,this._renderer.getContainer().height),t.globalCompositeOperation=e,t.save(),t.beginPath(),this.options.type){case"circle":this._drawCircle(t);break;case"ellipse":this._drawEllipse(t)}t.closePath(),t.restore(),this.size+=this.options.speed,this.size>this.options.max&&(this.size=0)},_drawCircle:function(t){var e=this._map.latLngToLayerPoint(this.latlng);t.strokeStyle=this.options.color,t.arc(e.x,e.y,this.size,0,2*Math.PI),t.stroke()},_drawEllipse:function(t){var e=this._map.latLngToLayerPoint(this.latlng),n=e.x,i=e.y,r=this.size,o=this.size/2,s=r/2*.5522848,a=o/2*.5522848,u=n-r/2,l=i-o/2,h=n+r/2,c=i+o/2;t.strokeStyle=this.options.color,t.moveTo(u,i),t.bezierCurveTo(u,i-a,n-s,l,n,l),t.bezierCurveTo(n+s,l,h,i-a,h,i),t.bezierCurveTo(h,i+a,n+s,c,n,c),t.bezierCurveTo(n-s,c,u,i+a,u,i),t.stroke()}}),N=G.DivOverlay.extend({options:{latlng:null,text:"",opacity:1,offset:[8,0]},initialize:function(t){G.setOptions(this,t),this.setLatLng(this.options.latlng),this.setContent(this.options.text)},onAdd:function(t){G.DivOverlay.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity)},_initLayout:function(){var t="leaflet-label "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._container=G.DomUtil.create("div",t),this._contentNode=this._container},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=G.point(this.options.offset),n=this._getAnchor();this._zoomAnimated?G.DomUtil.setPosition(this._container,t.add(n)):e=e.add(t).add(n);var i=e.y-this._container.clientHeight/2,r=e.x;this._container.style.top=i+"px",this._container.style.left=r+"px"},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&G.DomUtil.setOpacity(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)}});var O=G.Marker.extend({statics:{notStartedState:0,endedState:1,pausedState:2,runState:3},options:{autostart:!1,loop:!1,bCenter:!1},initialize:function(t,e,n){G.Marker.prototype.initialize.call(this,t[0],n),this._latlngs=t.map(function(t){return G.latLng(t)}),e instanceof Array?this._durations=e:this._durations=this._createDurations(this._latlngs,e),this._currentDuration=0,this._currentIndex=0,this._state=O.notStartedState,this._startTime=0,this._startTimeStamp=0,this._pauseStartTime=0,this._animId=0,this._animRequested=!1,this._currentLine=[],this._stations={}},isRunning:function(){return this._state===O.runState},isEnded:function(){return this._state===O.endedState},isStarted:function(){return this._state!==O.notStartedState},isPaused:function(){return this._state===O.pausedState},start:function(){this.isRunning()||(this.isPaused()?this.resume():(this._loadLine(0),this._startAnimation(),this.fire("start")))},resume:function(){this.isPaused()&&(this._currentLine[0]=this.getLatLng(),this._currentDuration-=this._pauseStartTime-this._startTime,this._startAnimation())},pause:function(){this.isRunning()&&(this._pauseStartTime=Date.now(),this._state=O.pausedState,this._stopAnimation(),this._updatePosition())},stop:function(t){this.isEnded()||(this._stopAnimation(),void 0===t&&(t=0,this._updatePosition()),this._state=O.endedState,this.fire("end",{elapsedTime:t}))},addLatLng:function(t,e){this._latlngs.push(G.latLng(t)),this._durations.push(e)},moveTo:function(t,e){this._stopAnimation(),this._latlngs=[this.getLatLng(),G.latLng(t)],this._durations=[e],this._state=O.notStartedState,this.start(),this.options.loop=!1},addStation:function(t,e){t>this._latlngs.length-2||t<1||(this._stations[t]=e)},onAdd:function(t){G.Marker.prototype.onAdd.call(this,t),!this.options.autostart||this.isStarted()?this.isRunning()&&this._resumeAnimation():this.start()},onRemove:function(t){G.Marker.prototype.onRemove.call(this,t),this._stopAnimation()},_createDurations:function(t,e){for(var n=t.length-1,i=[],r=0,o=0,s=0;s<n;s++)o=t[s+1].distanceTo(t[s]),i.push(o),r+=o;for(var a=e/r,u=[],l=0;l<i.length;l++)u.push(i[l]*a);return u},_startAnimation:function(){this._state=O.runState,this._animId=G.Util.requestAnimFrame(function(t){this._startTime=Date.now(),this._startTimeStamp=t,this._animate(t)},this,!0),this._animRequested=!0},_resumeAnimation:function(){this._animRequested||(this._animRequested=!0,this._animId=G.Util.requestAnimFrame(function(t){this._animate(t)},this,!0))},_stopAnimation:function(){this._animRequested&&(G.Util.cancelAnimFrame(this._animId),this._animRequested=!1)},_updatePosition:function(){var t=Date.now()-this._startTime;this._animate(this._startTimeStamp+t,!0)},_loadLine:function(t){this._currentIndex=t,this._currentDuration=this._durations[t],this._currentLine=this._latlngs.slice(t,t+2),this.fire("pointChange",{index:t,marker:this,p1:this._currentLine[0],p2:this._currentLine[1]})},_updateLine:function(t){var e=t-this._startTimeStamp;if(e<=this._currentDuration)return e;for(var n=this._currentIndex,i=this._currentDuration,r=void 0;i<e;){if(e-=i,void 0!==(r=this._stations[n+1])){if(e<r)return this.setLatLng(this._latlngs[n+1]),null;e-=r}if(++n>=this._latlngs.length-1){if(!this.options.loop)return this.setLatLng(this._latlngs[this._latlngs.length-1]),this.stop(e),null;n=0,this.fire("loop",{elapsedTime:e})}i=this._durations[n]}return this._loadLine(n),this._startTimeStamp=t-e,this._startTime=Date.now()-e,e},_animate:function(t,e){this._animRequested=!1;var n=this._updateLine(t);if(!this.isEnded()){if(null!=n){var i=(r=this._currentLine[0],o=this._currentLine[1],s=this._currentDuration,a=1<(a=0<(a=n/s)?a:0)?1:a,G.latLng(r.lat+a*(o.lat-r.lat),r.lng+a*(o.lng-r.lng)));this.options.bCenter&&this._map.panTo(i),this.setLatLng(i)}var r,o,s,a;e||(this._animId=G.Util.requestAnimFrame(this._animate,this,!1),this._animRequested=!0)}}}),T=G.Evented.extend({options:{polygonStyle:{color:"red",fillOpacity:.2,interactive:!1},labelStyle:{offset:[8,0]}},initialize:function(t,e){G.setOptions(this,e),this._map=t,this._enabled=!1,this._defaultCursor=this._map._container.style.cursor,this._allLayers=new G.LayerGroup,this._map.addLayer(this._allLayers)},enable:function(){this._enabled||(this._enabled=!0,this._map.doubleClickZoom.disable(),this._map._container.style.cursor="crosshair",this._map.on("click",this._clicked,this),this._map.on("mousemove",this._moving,this),this._map.on("dblclick",this._closePath,this),this._start())},disable:function(){this._enabled&&(this._enabled=!1,this._map.doubleClickZoom.enable(),this._map._container.style.cursor=this._defaultCursor,this._map.off("click",this._clicked,this),this._map.off("mousemove",this._moving,this),this._map.off("dblclick",this._closePath,this))},clear:function(){this._allLayers.clearLayers()},_start:function(){this._clickPoints=[],this._tempLayer=null,this._tempLines=null,this._tempLabel=null},_closePath:function(){var t=new G.FeatureGroup;this._allLayers.addLayer(t),this._drawPath(this._clickPoints,t,!0),this._clearTemp(),this._start(),this.fire("finish")},_clearTemp:function(){this._tempLayer&&(this._map.removeLayer(this._tempLayer),this._tempLayer=null),this._tempLines&&(this._map.removeLayer(this._tempLines),this._tempLines=null),this._tempLabel&&(this._map.removeLayer(this._tempLabel),this._tempLabel=null)},_clicked:function(t){var e=t.latlng;if(0<this._clickPoints.length){var n=this._clickPoints[this._clickPoints.length-1];if(e.equals(n))return void this._closePath()}this._clickPoints.push(e),this._drawTempLayer(this._clickPoints)},_moving:function(t){var e=t.latlng;if(this._clickPoints&&0!==this._clickPoints.length){this._tempLines||(this._tempLines=new G.FeatureGroup,this._map.addLayer(this._tempLines)),this._tempLines.clearLayers();var n=this._clickPoints.length,i=this._clickPoints[0],r=G.Util.clone(this.options.polygonStyle);r.dashArray=[5,5];var o=new G.Polyline([i,e],r);if(this._tempLines.addLayer(o),2<=n){var s=this._clickPoints[n-1],a=new G.Polyline([s,e],r);this._tempLines.addLayer(a)}this._tempLabel?this._tempLabel.setLatLng(e):(this._tempLabel=new N({latlng:e,text:"双击结束",offset:[10,10]}),this._map.addLayer(this._tempLabel))}},_drawTempLayer:function(t){this._tempLayer||(this._tempLayer=new G.FeatureGroup,this._map.addLayer(this._tempLayer)),this._tempLayer.clearLayers(),this._drawPath(t,this._tempLayer)},_drawPath:function(t,e,n){var i=this;if(t&&!(t.length<2)){var r,o=t.length,s=G.Util.clone(this.options.polygonStyle);if(2===o){if(n)return;var a=new G.Polyline(t,s);e.addLayer(a)}else{var u=new G.Polygon(t,s);if(e.addLayer(u),n){var l=this.geodesicArea(t);l=parseInt(l/1e6*1e4)/1e4;var h=document.createElement("span");h.className="measure-close",r=e,h.onclick=function(){i._allLayers.removeLayer(r)},h.innerHTML="X",G.DomEvent.disableClickPropagation(h);var c=document.createElement("span");c.innerHTML="总面积："+l+"平方千米",c.appendChild(h);var p=G.Util.clone(this.options.labelStyle);p.latlng=t[o-1],p.text=c;var f=new N(p);e.addLayer(f)}}}},geodesicArea:function(t){var e=function(t){return t*Math.PI/180},n=void 0,i=void 0,r=void 0,o=void 0,s=void 0,a=0,u=t.length;if(2<u){for(var l=0;l<u;l++)s=l===u-2?(r=u-2,o=u-1,0):l===u-1?(r=u-1,o=0,1):(o=(r=l)+1,l+2),n=t[r],i=t[o],a+=(e(t[s].lng)-e(n.lng))*Math.sin(e(i.lat));a=6378137*a*6378137/2}return Math.abs(a)}}),R=G.Evented.extend({options:{circleMarker:{color:"red",radius:5,fillColor:"#ffffff",weight:1,fillOpacity:1,interactive:!1},lineStyle:{color:"red",interactive:!1},labelStyle:{offset:[8,0]}},initialize:function(t,e){G.setOptions(this,e),this._map=t,this._enabled=!1,this._defaultCursor=this._map._container.style.cursor,this._allLayers=new G.LayerGroup,this._map.addLayer(this._allLayers)},enable:function(){this._enabled||(this._enabled=!0,this._map.doubleClickZoom.disable(),this._map._container.style.cursor="crosshair",this._map.on("click",this._clicked,this),this._map.on("mousemove",this._moving,this),this._map.on("dblclick",this._closePath,this),this._start())},disable:function(){this._enabled&&(this._enabled=!1,this._map.doubleClickZoom.enable(),this._map._container.style.cursor=this._defaultCursor,this._map.off("click",this._clicked,this),this._map.off("mousemove",this._moving,this),this._map.off("dblclick",this._closePath,this))},clear:function(){this._allLayers.clearLayers()},_start:function(){this._clickPoints=[],this._tempLayer=null,this._tempLine=null,this._tempLabel=null},_closePath:function(){var t=new G.FeatureGroup;this._allLayers.addLayer(t),this._drawPath(this._clickPoints,t,!0),this._clearTemp(),this._start(),this.fire("finish")},_clearTemp:function(){this._tempLayer&&(this._map.removeLayer(this._tempLayer),this._tempLayer=null),this._tempLine&&(this._map.removeLayer(this._tempLine),this._tempLine=null),this._tempLabel&&(this._map.removeLayer(this._tempLabel),this._tempLabel=null)},_clicked:function(t){var e=t.latlng;if(0<this._clickPoints.length){var n=this._clickPoints[this._clickPoints.length-1];if(e.equals(n))return void this._closePath()}this._clickPoints.push(e),this._drawTempLayer(this._clickPoints)},_moving:function(t){var e=t.latlng;if(this._clickPoints&&0!==this._clickPoints.length){var n=this._clickPoints[this._clickPoints.length-1];if(this._tempLine)this._tempLine.setLatLngs([n,e]);else{var i=G.Util.clone(this.options.lineStyle);i.dashArray=[5,5],this._tempLine=new G.Polyline([n,e],i),this._map.addLayer(this._tempLine)}this._tempLabel?this._tempLabel.setLatLng(e):(this._tempLabel=new N({latlng:e,text:"双击结束",offset:[10,10]}),this._map.addLayer(this._tempLabel))}},_drawTempLayer:function(t){this._tempLayer||(this._tempLayer=new G.FeatureGroup,this._map.addLayer(this._tempLayer)),this._tempLayer.clearLayers(),this._drawPath(t,this._tempLayer)},_drawPath:function(t,n,e){var i=this;if(t&&0!==t.length){var r=t.length;if(1<r){var o=new G.Polyline(t,this.options.lineStyle);n.addLayer(o)}for(var s=0,a=0;a<r;a++){var u=t[a],l=new G.CircleMarker(u,this.options.circleMarker);n.addLayer(l);var h="";if(0===a&&(h="开始"),0<a){var c=t[a-1],p=this._map.distance(c,u),f=parseInt(s+=p)/1e3;a===r-1&&e?function(){var t,e=document.createElement("span");e.className="measure-close",t=n,e.onclick=function(){i._allLayers.removeLayer(t)},e.innerHTML="X",G.DomEvent.disableClickPropagation(e),(h=document.createElement("span")).innerHTML="总长："+f+"公里",h.appendChild(e)}():h=f+"公里"}var d=G.Util.clone(this.options.labelStyle);d.latlng=u,d.text=h;var g=new N(d);n.addLayer(g)}}}}),k="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function D(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function A(t,e){return t(e={exports:{}},e.exports),e.exports}var F,B,U,q,j,z,V,Y,H,X=A(function(t,e){t.exports=function r(o,s,a){function u(n,t){if(!s[n]){if(!o[n]){var e=D;if(!t&&e)return e(n,!0);if(l)return l(n,!0);throw new Error("Cannot find module '"+n+"'")}var i=s[n]={exports:{}};o[n][0].call(i.exports,function(t){var e=o[n][1][t];return u(e||t)},i,i.exports,r,o,s,a)}return s[n].exports}for(var l=D,t=0;t<a.length;t++)u(a[t]);return u}({1:[function(t,e,n){var i=t("mgrs");function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"===(void 0===t?"undefined":g(t)))this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var i=t.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}r.fromMGRS=function(t){return new r(i.toPoint(t))},r.prototype.toMGRS=function(t){return i.forward([this.x,this.y],t)},e.exports=r},{mgrs:67}],2:[function(t,e,n){var o=t("./parseCode"),s=t("./extend"),i=t("./projections"),a=t("./deriveConstants");function u(t,e){if(!(this instanceof u))return new u(t);e=e||function(t){if(t)throw t};var n=o(t);if("object"===(void 0===n?"undefined":g(n))){var i=a(n),r=u.projections.get(i.projName);r?(s(this,i),s(this,r),this.init(),e(null,this)):e(t)}else e(t)}(u.projections=i).start(),e.exports=u},{"./deriveConstants":33,"./extend":34,"./parseCode":37,"./projections":39}],3:[function(t,e,n){e.exports=function(t,e,n){var i,r,o,s=n.x,a=n.y,u=n.z||0;for(o=0;o<3;o++)if(!e||2!==o||void 0!==n.z)switch(r=0===o?(i=s,"x"):1===o?(i=a,"y"):(i=u,"z"),t.axis[o]){case"e":n[r]=i;break;case"w":n[r]=-i;break;case"n":n[r]=i;break;case"s":n[r]=-i;break;case"u":void 0!==n[r]&&(n.z=i);break;case"d":void 0!==n[r]&&(n.z=-i);break;default:return null}return n}},{}],4:[function(t,e,n){var i=Math.PI/2,r=t("./sign");e.exports=function(t){return Math.abs(t)<i?t:t-r(t)*Math.PI}},{"./sign":21}],5:[function(t,e,n){var i=2*Math.PI,r=t("./sign");e.exports=function(t){return Math.abs(t)<=3.14159265359?t:t-r(t)*i}},{"./sign":21}],6:[function(t,e,n){e.exports=function(t){return 1<Math.abs(t)&&(t=1<t?1:-1),Math.asin(t)}},{}],7:[function(t,e,n){e.exports=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))}},{}],8:[function(t,e,n){e.exports=function(t){return.375*t*(1+.25*t*(1+.46875*t))}},{}],9:[function(t,e,n){e.exports=function(t){return.05859375*t*t*(1+.75*t)}},{}],10:[function(t,e,n){e.exports=function(t){return t*t*t*(35/3072)}},{}],11:[function(t,e,n){e.exports=function(t,e,n){var i=e*n;return t/Math.sqrt(1-i*i)}},{}],12:[function(t,e,n){e.exports=function(t,e,n,i,r){var o,s;o=t/e;for(var a=0;a<15;a++)if(s=(t-(e*o-n*Math.sin(2*o)+i*Math.sin(4*o)-r*Math.sin(6*o)))/(e-2*n*Math.cos(2*o)+4*i*Math.cos(4*o)-6*r*Math.cos(6*o)),o+=s,Math.abs(s)<=1e-10)return o;return NaN}},{}],13:[function(t,e,n){var l=Math.PI/2;e.exports=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*l:l;for(var i,r,o,s,a=Math.asin(.5*e),u=0;u<30;u++)if(r=Math.sin(a),o=Math.cos(a),s=t*r,i=Math.pow(1-s*s,2)/(2*o)*(e/(1-t*t)-r/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),a+=i,Math.abs(i)<=1e-10)return a;return NaN}},{}],14:[function(t,e,n){e.exports=function(t,e,n,i,r){return t*r-e*Math.sin(2*r)+n*Math.sin(4*r)-i*Math.sin(6*r)}},{}],15:[function(t,e,n){e.exports=function(t,e,n){var i=t*e;return n/Math.sqrt(1-i*i)}},{}],16:[function(t,e,n){var a=Math.PI/2;e.exports=function(t,e){for(var n,i,r=.5*t,o=a-2*Math.atan(e),s=0;s<=15;s++)if(n=t*Math.sin(o),i=a-2*Math.atan(e*Math.pow((1-n)/(1+n),r))-o,o+=i,Math.abs(i)<=1e-10)return o;return-9999}},{}],17:[function(t,e,n){var i=.01068115234375;e.exports=function(t){var e=[];e[0]=1-t*(.25+t*(.046875+t*(.01953125+t*i))),e[1]=t*(.75-t*(.046875+t*(.01953125+t*i)));var n=t*t;return e[2]=n*(.46875-t*(.013020833333333334+.007120768229166667*t)),n*=t,e[3]=n*(.3645833333333333-.005696614583333333*t),e[4]=n*t*.3076171875,e}},{}],18:[function(t,e,n){var u=t("./pj_mlfn");e.exports=function(t,e,n){for(var i=1/(1-e),r=t,o=20;o;--o){var s=Math.sin(r),a=1-e*s*s;if(a=(u(r,s,Math.cos(r),n)-t)*(a*Math.sqrt(a))*i,r-=a,Math.abs(a)<1e-10)return r}return r}},{"./pj_mlfn":19}],19:[function(t,e,n){e.exports=function(t,e,n,i){return n*=e,e*=e,i[0]*t-n*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}},{}],20:[function(t,e,n){e.exports=function(t,e){var n;return 1e-7<t?(1-t*t)*(e/(1-(n=t*e)*n)-.5/t*Math.log((1-n)/(1+n))):2*e}},{}],21:[function(t,e,n){e.exports=function(t){return t<0?-1:1}},{}],22:[function(t,e,n){e.exports=function(t,e){return Math.pow((1-t)/(1+t),e)}},{}],23:[function(t,e,n){e.exports=function(t){var e={x:t[0],y:t[1]};return 2<t.length&&(e.z=t[2]),3<t.length&&(e.m=t[3]),e}},{}],24:[function(t,e,n){var o=Math.PI/2;e.exports=function(t,e,n){var i=t*n,r=.5*t;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(o-e))/i}},{}],25:[function(t,e,n){n.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},n.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},n.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},n.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},n.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},n.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},n.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},n.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},n.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},n.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},n.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},n.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},n.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},n.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},n.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},n.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(t,e,n){n.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},n.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},n.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},n.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},n.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},n.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},n.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},n.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},n.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},n.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},n.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},n.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},n.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},n.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},n.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},n.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},n.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},n.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},n.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},n.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},n.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},n.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},n.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},n.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},n.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},n.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},n.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},n.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},n.hough={a:6378270,rf:297,ellipseName:"Hough"},n.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},n.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},n.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},n.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},n.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},n.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},n.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},n.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},n.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},n.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},n.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},n.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},n.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},n.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(t,e,n){n.greenwich=0,n.lisbon=-9.131906111111,n.paris=2.337229166667,n.bogota=-74.080916666667,n.madrid=-3.687938888889,n.rome=12.452333333333,n.bern=7.439583333333,n.jakarta=106.807719444444,n.ferro=-17.666666666667,n.brussels=4.367975,n.stockholm=18.058277777778,n.athens=23.7163375,n.oslo=10.722916666667},{}],28:[function(t,e,n){n.ft={to_meter:.3048},n["us-ft"]={to_meter:1200/3937}},{}],29:[function(t,e,n){var i=t("./Proj"),r=t("./transform"),o=i("WGS84");function s(t,e,n){var i;return Array.isArray(n)?(i=r(t,e,n),3===n.length?[i.x,i.y,i.z]:[i.x,i.y]):r(t,e,n)}function a(t){return t instanceof i?t:t.oProj?t.oProj:i(t)}e.exports=function(e,n,t){e=a(e);var i,r=!1;return void 0===n?(n=e,e=o,r=!0):(void 0!==n.x||Array.isArray(n))&&(t=n,n=e,e=o,r=!0),n=a(n),t?s(e,n,t):(i={forward:function(t){return s(e,n,t)},inverse:function(t){return s(n,e,t)}},r&&(i.oProj=n),i)}},{"./Proj":2,"./transform":65}],30:[function(t,e,n){var x=Math.PI/2,i=484813681109536e-20,E=.3826834323650898,r=function t(e){if(!(this instanceof t))return new t(e);if(this.datum_type=4,e){if(e.datumCode&&"none"===e.datumCode&&(this.datum_type=5),e.datum_params){for(var n=0;n<e.datum_params.length;n++)e.datum_params[n]=parseFloat(e.datum_params[n]);0===e.datum_params[0]&&0===e.datum_params[1]&&0===e.datum_params[2]||(this.datum_type=1),3<e.datum_params.length&&(0===e.datum_params[3]&&0===e.datum_params[4]&&0===e.datum_params[5]&&0===e.datum_params[6]||(this.datum_type=2,e.datum_params[3]*=i,e.datum_params[4]*=i,e.datum_params[5]*=i,e.datum_params[6]=e.datum_params[6]/1e6+1))}this.datum_type=e.grids?3:this.datum_type,this.a=e.a,this.b=e.b,this.es=e.es,this.ep2=e.ep2,this.datum_params=e.datum_params,3===this.datum_type&&(this.grids=e.grids)}};r.prototype={compare_datums:function(t){return this.datum_type===t.datum_type&&!(this.a!==t.a||5e-11<Math.abs(this.es-t.es))&&(1===this.datum_type?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]:2===this.datum_type?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]&&this.datum_params[3]===t.datum_params[3]&&this.datum_params[4]===t.datum_params[4]&&this.datum_params[5]===t.datum_params[5]&&this.datum_params[6]===t.datum_params[6]:3!==this.datum_type&&3!==t.datum_type||this.nadgrids===t.nadgrids)},geodetic_to_geocentric:function(t){var e,n,i,r,o,s,a,u=t.x,l=t.y,h=t.z?t.z:0;if(l<-x&&-1.001*x<l)l=-x;else if(x<l&&l<1.001*x)l=x;else if(l<-x||x<l)return null;return u>Math.PI&&(u-=2*Math.PI),o=Math.sin(l),a=Math.cos(l),s=o*o,r=this.a/Math.sqrt(1-this.es*s),e=(r+h)*a*Math.cos(u),n=(r+h)*a*Math.sin(u),i=(r*(1-this.es)+h)*o,t.x=e,t.y=n,t.z=i,0},geocentric_to_geodetic:function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_=t.x,m=t.y,v=t.z?t.z:0;if(e=Math.sqrt(_*_+m*m),n=Math.sqrt(_*_+m*m+v*v),e/this.a<1e-12){if(d=0,n/this.a<1e-12)return g=x,void(y=-this.b)}else d=Math.atan2(m,_);for(i=v/n,r=e/n,o=1/Math.sqrt(1-this.es*(2-this.es)*r*r),u=r*(1-this.es)*o,l=i*o,f=0;f++,a=this.a/Math.sqrt(1-this.es*l*l),y=e*u+v*l-a*(1-this.es*l*l),s=this.es*a/(a+y),o=1/Math.sqrt(1-s*(2-s)*r*r),p=(c=i*o)*u-(h=r*(1-s)*o)*l,u=h,l=c,1e-24<p*p&&f<30;);return g=Math.atan(c/Math.abs(h)),t.x=d,t.y=g,t.z=y,t},geocentric_to_geodetic_noniter:function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_,m=t.x,v=t.y,b=t.z?t.z:0;if(m=parseFloat(m),v=parseFloat(v),b=parseFloat(b),_=!1,0!==m)e=Math.atan2(v,m);else if(0<v)e=x;else if(v<0)e=-x;else if(_=!0,(e=0)<b)n=x;else{if(!(b<0))return n=x,void(i=-this.b);n=-x}return o=m*m+v*v,r=Math.sqrt(o),s=1.0026*b,u=Math.sqrt(s*s+o),p=r/u,c=(h=s/u)*h*h,a=b+this.b*this.ep2*c,y=r-this.a*this.es*p*p*p,l=Math.sqrt(a*a+y*y),f=a/l,d=y/l,g=this.a/Math.sqrt(1-this.es*f*f),i=E<=d?r/d-g:d<=-E?r/-d-g:b/f+g*(this.es-1),!1===_&&(n=Math.atan(f/d)),t.x=e,t.y=n,t.z=i,t},geocentric_to_wgs84:function(t){if(1===this.datum_type)t.x+=this.datum_params[0],t.y+=this.datum_params[1],t.z+=this.datum_params[2];else if(2===this.datum_type){var e=this.datum_params[0],n=this.datum_params[1],i=this.datum_params[2],r=this.datum_params[3],o=this.datum_params[4],s=this.datum_params[5],a=this.datum_params[6],u=a*(t.x-s*t.y+o*t.z)+e,l=a*(s*t.x+t.y-r*t.z)+n,h=a*(-o*t.x+r*t.y+t.z)+i;t.x=u,t.y=l,t.z=h}},geocentric_from_wgs84:function(t){if(1===this.datum_type)t.x-=this.datum_params[0],t.y-=this.datum_params[1],t.z-=this.datum_params[2];else if(2===this.datum_type){var e=this.datum_params[0],n=this.datum_params[1],i=this.datum_params[2],r=this.datum_params[3],o=this.datum_params[4],s=this.datum_params[5],a=this.datum_params[6],u=(t.x-e)/a,l=(t.y-n)/a,h=(t.z-i)/a;t.x=u+s*l-o*h,t.y=-s*u+l+r*h,t.z=o*u-r*l+h}}},e.exports=r},{}],31:[function(t,e,n){var p=.006694379990141316;e.exports=function(t,e,n){var i,r,o;function s(t){return 1===t||2===t}if(t.compare_datums(e))return n;if(5===t.datum_type||5===e.datum_type)return n;var a=t.a,u=t.es,l=e.a,h=e.es,c=t.datum_type;if(3===c)if(0===this.apply_gridshift(t,0,n))t.a=6378137,t.es=p;else{if(!t.datum_params)return t.a=a,t.es=t.es,n;for(i=1,r=0,o=t.datum_params.length;r<o;r++)i*=t.datum_params[r];if(0===i)return t.a=a,t.es=t.es,n;c=3<t.datum_params.length?2:1}return 3===e.datum_type&&(e.a=6378137,e.es=p),(t.es!==e.es||t.a!==e.a||s(c)||s(e.datum_type))&&(t.geodetic_to_geocentric(n),s(t.datum_type)&&t.geocentric_to_wgs84(n),s(e.datum_type)&&e.geocentric_from_wgs84(n),e.geocentric_to_geodetic(n)),3===e.datum_type&&this.apply_gridshift(e,1,n),t.a=a,t.es=u,e.a=l,e.es=h,n}},{}],32:[function(t,e,n){var i=t("./global"),r=t("./projString"),o=t("./wkt");function s(t){var e=this;if(2===arguments.length){var n=arguments[1];s[t]="string"==typeof n?"+"===n.charAt(0)?r(arguments[1]):o(arguments[1]):n}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?s.apply(e,t):s(t)});if("string"==typeof t){if(t in s)return s[t]}else"EPSG"in t?s["EPSG:"+t.EPSG]=t:"ESRI"in t?s["ESRI:"+t.ESRI]=t:"IAU2000"in t?s["IAU2000:"+t.IAU2000]=t:console.log(t);return}}i(s),e.exports=s},{"./global":35,"./projString":38,"./wkt":66}],33:[function(t,e,n){var i=t("./constants/Datum"),r=t("./constants/Ellipsoid"),o=t("./extend"),s=t("./datum");e.exports=function(t){if(t.datumCode&&"none"!==t.datumCode){var e=i[t.datumCode];e&&(t.datum_params=e.towgs84?e.towgs84.split(","):null,t.ellps=e.ellipse,t.datumName=e.datumName?e.datumName:t.datumCode)}if(!t.a){var n=r[t.ellps]?r[t.ellps]:r.WGS84;o(t,n)}return t.rf&&!t.b&&(t.b=(1-1/t.rf)*t.a),(0===t.rf||Math.abs(t.a-t.b)<1e-10)&&(t.sphere=!0,t.b=t.a),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=(t.a2-t.b2)/t.a2,t.e=Math.sqrt(t.es),t.R_A&&(t.a*=1-t.es*(.16666666666666666+t.es*(.04722222222222222+.022156084656084655*t.es)),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=0),t.ep2=(t.a2-t.b2)/t.b2,t.k0||(t.k0=1),t.axis||(t.axis="enu"),t.datum||(t.datum=s(t)),t}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":30,"./extend":34}],34:[function(t,e,n){e.exports=function(t,e){var n,i;if(t=t||{},!e)return t;for(i in e)void 0!==(n=e[i])&&(t[i]=n);return t}},{}],35:[function(t,e,n){e.exports=function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}},{}],36:[function(t,e,n){var i=t("./core");i.defaultDatum="WGS84",i.Proj=t("./Proj"),i.WGS84=new i.Proj("WGS84"),i.Point=t("./Point"),i.toPoint=t("./common/toPoint"),i.defs=t("./defs"),i.transform=t("./transform"),i.mgrs=t("mgrs"),i.version=t("../package.json").version,t("./includedProjections")(i),e.exports=i},{"../package.json":68,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":29,"./defs":32,"./includedProjections":"hTEDpn","./transform":65,mgrs:67}],37:[function(t,e,n){var i=t("./defs"),r=t("./wkt"),o=t("./projString");e.exports=function(t){return"string"!=typeof t?t:t in i?i[t]:(n=t,["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"].reduce(function(t,e){return t+1+n.indexOf(e)},0)?r(t):"+"===t[0]?o(t):void 0);var n}},{"./defs":32,"./projString":38,"./wkt":66}],38:[function(t,e,n){var a=.017453292519943295,u=t("./constants/PrimeMeridian"),l=t("./constants/units");e.exports=function(t){var e,n,i,r={},o={};t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).forEach(function(t){var e=t.split("=");e.push(!0),o[e[0].toLowerCase()]=e[1]});var s={proj:"projName",datum:"datumCode",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*a},lat_1:function(t){r.lat1=t*a},lat_2:function(t){r.lat2=t*a},lat_ts:function(t){r.lat_ts=t*a},lon_0:function(t){r.long0=t*a},lon_1:function(t){r.long1=t*a},lon_2:function(t){r.long2=t*a},alpha:function(t){r.alpha=parseFloat(t)*a},lonc:function(t){r.longc=t*a},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t,l[t]&&(r.to_meter=l[t].to_meter)},from_greenwich:function(t){r.from_greenwich=t*a},pm:function(t){r.from_greenwich=(u[t]?u[t]:parseFloat(t))*a},nadgrids:function(t){"@null"===t?r.datumCode="none":r.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(r.axis=t)}};for(e in o)n=o[e],e in s?"function"==typeof(i=s[e])?i(n):r[i]=n:r[e]=n;return"string"==typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}},{"./constants/PrimeMeridian":27,"./constants/units":28}],39:[function(t,e,n){var i=[t("./projections/merc"),t("./projections/longlat")],r={},o=[];function s(t,e){var n=o.length;return t.names?((o[n]=t).names.forEach(function(t){r[t.toLowerCase()]=n}),this):(console.log(e),!0)}n.add=s,n.get=function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==r[e]&&o[r[e]]?o[r[e]]:void 0},n.start=function(){i.forEach(s)}},{"./projections/longlat":51,"./projections/merc":52}],40:[function(t,e,n){var i=t("../common/msfnz"),u=t("../common/qsfnz"),l=t("../common/adjust_lon"),h=t("../common/asinz");n.init=function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=i(this.e3,this.sin_po,this.cos_po),this.qs1=u(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=i(this.e3,this.sin_po,this.cos_po),this.qs2=u(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=u(this.e3,this.sin_po,this.cos_po),1e-10<Math.abs(this.lat1-this.lat2)?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},n.forward=function(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var i=u(this.e3,this.sin_phi,this.cos_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,o=this.ns0*l(e-this.long0),s=r*Math.sin(o)+this.x0,a=this.rh-r*Math.cos(o)+this.y0;return t.x=s,t.y=a,t},n.inverse=function(t){var e,n,i,r,o,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,i=0<=this.ns0?(e=Math.sqrt(t.x*t.x+t.y*t.y),1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),-1),(r=0)!==e&&(r=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,s=this.sphere?Math.asin((this.c-i*i)/(2*this.ns0)):(n=(this.c-i*i)/this.ns0,this.phi1z(this.e3,n)),o=l(r/this.ns0+this.long0),t.x=o,t.y=s,t},n.phi1z=function(t,e){var n,i,r,o,s,a=h(.5*e);if(t<1e-10)return a;for(var u=t*t,l=1;l<=25;l++)if(n=Math.sin(a),i=Math.cos(a),s=.5*(o=1-(r=t*n)*r)*o/i*(e/(1-u)-n/o+.5/t*Math.log((1-r)/(1+r))),a+=s,Math.abs(s)<=1e-7)return a;return null},n.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],41:[function(t,e,n){var C=t("../common/adjust_lon"),P=Math.PI/2,N=1e-10,O=t("../common/mlfn"),T=t("../common/e0fn"),R=t("../common/e1fn"),k=t("../common/e2fn"),D=t("../common/e3fn"),A=t("../common/gN"),w=t("../common/asinz"),I=t("../common/imlfn");n.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},n.forward=function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_,m,v,b,x,E,w=t.x,I=t.y,L=Math.sin(t.y),S=Math.cos(t.y),M=C(w-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=N?(t.x=this.x0+this.a*(P-I)*Math.sin(M),t.y=this.y0-this.a*(P-I)*Math.cos(M)):Math.abs(this.sin_p12+1)<=N?(t.x=this.x0+this.a*(P+I)*Math.sin(M),t.y=this.y0+this.a*(P+I)*Math.cos(M)):(m=this.sin_p12*L+this.cos_p12*S*Math.cos(M),y=Math.acos(m),_=y/Math.sin(y),t.x=this.x0+this.a*_*S*Math.sin(M),t.y=this.y0+this.a*_*(this.cos_p12*L-this.sin_p12*S*Math.cos(M))):(e=T(this.es),n=R(this.es),i=k(this.es),r=D(this.es),Math.abs(this.sin_p12-1)<=N?(o=this.a*O(e,n,i,r,P),s=this.a*O(e,n,i,r,I),t.x=this.x0+(o-s)*Math.sin(M),t.y=this.y0-(o-s)*Math.cos(M)):Math.abs(this.sin_p12+1)<=N?(o=this.a*O(e,n,i,r,P),s=this.a*O(e,n,i,r,I),t.x=this.x0+(o+s)*Math.sin(M),t.y=this.y0+(o+s)*Math.cos(M)):(a=L/S,u=A(this.a,this.e,this.sin_p12),l=A(this.a,this.e,L),h=Math.atan((1-this.es)*a+this.es*u*this.sin_p12/(l*S)),c=Math.atan2(Math.sin(M),this.cos_p12*Math.tan(h)-this.sin_p12*Math.cos(M)),v=0===c?Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.abs(Math.abs(c)-Math.PI)<=N?-Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.asin(Math.sin(M)*Math.cos(h)/Math.sin(c)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),f=this.e*this.cos_p12*Math.cos(c)/Math.sqrt(1-this.es),y=u*v*(1-(b=v*v)*(g=f*f)*(1-g)/6+(x=b*v)/8*(d=p*f)*(1-2*g)+(E=x*v)/120*(g*(4-7*g)-3*p*p*(1-7*g))-E*v/48*d),t.x=this.x0+y*Math.sin(c),t.y=this.y0+y*Math.cos(c))),t},n.inverse=function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_,m,v,b,x,E;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*P*this.a)return;return n=e/this.a,i=Math.sin(n),r=Math.cos(n),o=this.long0,Math.abs(e)<=N?s=this.lat0:(s=w(r*this.sin_p12+t.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-P,o=Math.abs(a)<=N?0<=this.lat0?C(this.long0+Math.atan2(t.x,-t.y)):C(this.long0-Math.atan2(-t.x,t.y)):C(this.long0+Math.atan2(t.x*i,e*this.cos_p12*r-t.y*this.sin_p12*i))),t.x=o,t.y=s,t}return u=T(this.es),l=R(this.es),h=k(this.es),c=D(this.es),Math.abs(this.sin_p12-1)<=N?(p=this.a*O(u,l,h,c,P),e=Math.sqrt(t.x*t.x+t.y*t.y),s=I((p-e)/this.a,u,l,h,c),o=C(this.long0+Math.atan2(t.x,-1*t.y))):Math.abs(this.sin_p12+1)<=N?(p=this.a*O(u,l,h,c,P),e=Math.sqrt(t.x*t.x+t.y*t.y),s=I((e-p)/this.a,u,l,h,c),o=C(this.long0+Math.atan2(t.x,t.y))):(e=Math.sqrt(t.x*t.x+t.y*t.y),g=Math.atan2(t.x,t.y),f=A(this.a,this.e,this.sin_p12),y=Math.cos(g),_=this.e*this.cos_p12*y,m=-_*_/(1-this.es),v=3*this.es*(1-m)*this.sin_p12*this.cos_p12*y/(1-this.es),x=(b=e/f)-m*(1+m)*Math.pow(b,3)/6-v*(1+3*m)*Math.pow(b,4)/24,E=1-m*x*x/2-b*x*x*x/6,d=Math.asin(this.sin_p12*Math.cos(x)+this.cos_p12*Math.sin(x)*y),o=C(this.long0+Math.asin(Math.sin(g)*Math.sin(x)/Math.cos(d))),s=Math.atan((1-this.es*E*this.sin_p12/Math.sin(d))*Math.tan(d)/(1-this.es))),t.x=o,t.y=s,t},n.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(t,e,n){var f=t("../common/mlfn"),i=t("../common/e0fn"),r=t("../common/e1fn"),o=t("../common/e2fn"),s=t("../common/e3fn"),d=t("../common/gN"),g=t("../common/adjust_lon"),y=t("../common/adjust_lat"),_=t("../common/imlfn"),m=Math.PI/2;n.init=function(){this.sphere||(this.e0=i(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=s(this.es),this.ml0=this.a*f(this.e0,this.e1,this.e2,this.e3,this.lat0))},n.forward=function(t){var e,n,i=t.x,r=t.y;if(i=g(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),n=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var o=Math.sin(r),s=Math.cos(r),a=d(this.a,this.e,o),u=Math.tan(r)*Math.tan(r),l=i*Math.cos(r),h=l*l,c=this.es*s*s/(1-this.es),p=this.a*f(this.e0,this.e1,this.e2,this.e3,r);e=a*l*(1-h*u*(1/6-(8-u+8*c)*h/120)),n=p-this.ml0+a*o/s*h*(.5+(5-u+6*c)*h/24)}return t.x=e+this.x0,t.y=n+this.y0,t},n.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i=t.x/this.a,r=t.y/this.a;if(this.sphere){var o=r+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(i)),n=Math.atan2(Math.tan(i),Math.cos(o))}else{var s=this.ml0/this.a+r,a=_(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-m)<=1e-10)return t.x=this.long0,t.y=m,r<0&&(t.y*=-1),t;var u=d(this.a,this.e,Math.sin(a)),l=u*u*u/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(a),2),c=i*this.a/u,p=c*c;e=a-u*Math.tan(a)/l*c*c*(.5-(1+3*h)*c*c/24),n=c*(1-p*(h/3+(1+3*h)*h*p/15))/Math.cos(a)}return t.x=g(n+this.long0),t.y=y(e),t},n.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],43:[function(t,e,n){var a=t("../common/adjust_lon"),u=t("../common/qsfnz"),i=t("../common/msfnz"),r=t("../common/iqsfnz");n.init=function(){this.sphere||(this.k0=i(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},n.forward=function(t){var e,n,i=t.x,r=t.y,o=a(i-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var s=u(this.e,Math.sin(r));e=this.x0+this.a*this.k0*o,n=this.y0+this.a*s*.5/this.k0}return t.x=e,t.y=n,t},n.inverse=function(t){var e,n;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=a(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=r(this.e,2*t.y*this.k0/this.a),e=a(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t},n.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],44:[function(t,e,n){var o=t("../common/adjust_lon"),s=t("../common/adjust_lat");n.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},n.forward=function(t){var e=t.x,n=t.y,i=o(e-this.long0),r=s(n-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*r,t},n.inverse=function(t){var e=t.x,n=t.y;return t.x=o(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=s(this.lat0+(n-this.y0)/this.a),t},n.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],45:[function(t,e,n){var i=t("../common/e0fn"),r=t("../common/e1fn"),o=t("../common/e2fn"),s=t("../common/e3fn"),a=t("../common/msfnz"),u=t("../common/mlfn"),l=t("../common/adjust_lon"),h=t("../common/adjust_lat"),c=t("../common/imlfn");n.init=function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=i(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=s(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=a(this.e,this.sinphi,this.cosphi),this.ml1=u(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<1e-10?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=a(this.e,this.sinphi,this.cosphi),this.ml2=u(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=u(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},n.forward=function(t){var e,n=t.x,i=t.y;if(this.sphere)e=this.a*(this.g-i);else{var r=u(this.e0,this.e1,this.e2,this.e3,i);e=this.a*(this.g-r)}var o=this.ns*l(n-this.long0),s=this.x0+e*Math.sin(o),a=this.y0+this.rh-e*Math.cos(o);return t.x=s,t.y=a,t},n.inverse=function(t){var e,n,i,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,e=0<=this.ns?(n=Math.sqrt(t.x*t.x+t.y*t.y),1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),-1);var o=0;if(0!==n&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return r=l(this.long0+o/this.ns),i=h(this.g-n/this.a),t.x=r,t.y=i,t;var s=this.g-n/this.a;return i=c(s,this.e0,this.e1,this.e2,this.e3),r=l(this.long0+o/this.ns),t.x=r,t.y=i,t},n.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],46:[function(t,e,n){var o=Math.PI/4,s=t("../common/srat"),a=Math.PI/2;n.init=function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+o)/(Math.pow(Math.tan(.5*this.lat0+o),this.C)*s(this.e*t,this.ratexp))},n.forward=function(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+o),this.C)*s(this.e*Math.sin(n),this.ratexp))-a,t.x=this.C*e,t},n.inverse=function(t){for(var e=t.x/this.C,n=t.y,i=Math.pow(Math.tan(.5*n+o)/this.K,1/this.C),r=20;0<r&&(n=2*Math.atan(i*s(this.e*Math.sin(t.y),-.5*this.e))-a,!(Math.abs(n-t.y)<1e-14));--r)t.y=n;return r?(t.x=e,t.y=n,t):null},n.names=["gauss"]},{"../common/srat":22}],47:[function(t,e,n){var h=t("../common/adjust_lon"),a=t("../common/asinz");n.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},n.forward=function(t){var e,n,i,r,o,s,a,u=t.x,l=t.y;return i=h(u-this.long0),e=Math.sin(l),n=Math.cos(l),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*n*r,a=0<o||Math.abs(o)<=1e-10?(s=this.x0+1*this.a*n*Math.sin(i)/o,this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)/o):(s=this.x0+this.infinity_dist*n*Math.sin(i),this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*r)),t.x=s,t.y=a,t},n.inverse=function(t){var e,n,i,r,o,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),n=Math.sin(r),i=Math.cos(r),s=a(i*this.sin_p14+t.y*n*this.cos_p14/e),o=Math.atan2(t.x*n,e*this.cos_p14*i-t.y*this.sin_p14*n),h(this.long0+o)):(s=this.phic0,0),t.x=o,t.y=s,t},n.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],48:[function(t,e,n){var c=t("../common/adjust_lon");n.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},n.forward=function(t){var e,n,i,r,o,s,a,u=t.x,l=t.y,h=c(u-this.long0);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),i=-h*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),o=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(r)),s=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=a*Math.cos(s)/1,t.x=a*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t},n.inverse=function(t){var e,n,i,r,o,s,a,u,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),s=Math.sqrt(t.x*t.x+t.y*t.y),o=Math.atan2(t.y,t.x),r=o/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),n=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),t.x=this.long0-n/this.alfa,a=e;for(var h=u=0;t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(u=1),a=t.y,h+=1,0===u&&h<15;);return 15<=h?null:t},n.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],49:[function(t,e,n){var f=Math.PI/2,d=Math.PI/4,g=1e-10,y=t("../common/qsfnz"),_=t("../common/adjust_lon");n.S_POLE=1,n.N_POLE=2,n.EQUIT=3,n.OBLIQ=4,n.init=function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-f)<g?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<g?this.mode=this.EQUIT:this.mode=this.OBLIQ,0<this.es)switch(this.qp=y(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=y(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},n.forward=function(t){var e,n,i,r,o,s,a,u,l,h,c=t.x,p=t.y;if(c=_(c-this.long0),this.sphere){if(o=Math.sin(p),h=Math.cos(p),i=Math.cos(c),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+h*i:1+this.sinph0*o+this.cosph0*h*i)<=g)return null;n=Math.sqrt(2/n),e=n*h*Math.sin(c),n*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*h*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(p+this.phi0)<g)return null;n=d-.5*p,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(c),n*=i}}else{switch(l=u=a=0,i=Math.cos(c),r=Math.sin(c),o=Math.sin(p),s=y(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=s/this.qp,u=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:l=1+this.sinb1*a+this.cosb1*u*i;break;case this.EQUIT:l=1+u*i;break;case this.N_POLE:l=f+p,s=this.qp-s;break;case this.S_POLE:l=p-f,s=this.qp+s}if(Math.abs(l)<g)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),n=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*a-this.sinb1*u*i):(l=Math.sqrt(2/(1+u*i)))*a*this.ymf,e=this.xmf*l*u*r;break;case this.N_POLE:case this.S_POLE:0<=s?(e=(l=Math.sqrt(s))*r,n=i*(this.mode===this.S_POLE?l:-l)):e=n=0}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t},n.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i,r,o,s,a,u=t.x/this.a,l=t.y/this.a;if(this.sphere){var h,c=0,p=0;if(h=Math.sqrt(u*u+l*l),1<(n=.5*h))return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(p=Math.sin(n),c=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(h)<=g?0:Math.asin(l*p/h),u*=p,l=c*h;break;case this.OBLIQ:n=Math.abs(h)<=g?this.phi0:Math.asin(c*this.sinph0+l*p*this.cosph0/h),u*=p*this.cosph0,l=(c-Math.sin(n)*this.sinph0)*h;break;case this.N_POLE:l=-l,n=f-n;break;case this.S_POLE:n-=f}e=0!==l||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,l):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,l*=this.dd,(s=Math.sqrt(u*u+l*l))<g)return t.x=0,t.y=this.phi0,t;r=2*Math.asin(.5*s/this.rq),i=Math.cos(r),u*=r=Math.sin(r),l=this.mode===this.OBLIQ?(a=i*this.sinb1+l*r*this.cosb1/s,o=this.qp*a,s*this.cosb1*i-l*this.sinb1*r):(a=l*r/s,o=this.qp*a,s*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(l=-l),!(o=u*u+l*l))return t.x=0,t.y=this.phi0,t;a=1-o/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(u,l),n=this.authlat(Math.asin(a),this.apa)}return t.x=_(this.long0+e),t.y=n,t},n.P00=.3333333333333333,n.P01=.17222222222222222,n.P02=.10257936507936508,n.P10=.06388888888888888,n.P11=.0664021164021164,n.P20=.016415012942191543,n.authset=function(t){var e,n=[];return n[0]=t*this.P00,e=t*t,n[0]+=e*this.P01,n[1]=e*this.P10,e*=t,n[0]+=e*this.P02,n[1]+=e*this.P11,n[2]=e*this.P20,n},n.authlat=function(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)},n.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],50:[function(t,e,n){var h=t("../common/msfnz"),c=t("../common/tsfnz"),l=Math.PI/2,a=t("../common/sign"),p=t("../common/adjust_lon"),f=t("../common/phi2z");n.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<1e-10)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),i=h(this.e,e,n),r=c(this.e,this.lat1,e),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=h(this.e,o,s),u=c(this.e,this.lat2,o),l=c(this.e,this.lat0,Math.sin(this.lat0));1e-10<Math.abs(this.lat1-this.lat2)?this.ns=Math.log(i/a)/Math.log(r/u):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}},n.forward=function(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=1e-10&&(n=a(n)*(l-2e-10));var i,r,o=Math.abs(Math.abs(n)-l);if(1e-10<o)i=c(this.e,n,Math.sin(n)),r=this.a*this.f0*Math.pow(i,this.ns);else{if((o=n*this.ns)<=0)return null;r=0}var s=this.ns*p(e-this.long0);return t.x=this.k0*(r*Math.sin(s))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(s))+this.y0,t},n.inverse=function(t){var e,n,i,r,o,s=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;n=0<this.ns?(e=Math.sqrt(s*s+a*a),1):(e=-Math.sqrt(s*s+a*a),-1);var u=0;if(0!==e&&(u=Math.atan2(n*s,n*a)),0!==e||0<this.ns){if(n=1/this.ns,i=Math.pow(e/(this.a*this.f0),n),-9999===(r=f(this.e,i)))return null}else r=-l;return o=p(u/this.ns+this.long0),t.x=o,t.y=r,t},n.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],51:[function(t,e,n){function i(t){return t}n.init=function(){},n.forward=i,n.inverse=i,n.names=["longlat","identity"]},{}],52:[function(t,e,n){var i=t("../common/msfnz"),a=Math.PI/2,u=57.29577951308232,l=t("../common/adjust_lon"),h=Math.PI/4,c=t("../common/tsfnz"),s=t("../common/phi2z");n.init=function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=i(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},n.forward=function(t){var e,n,i=t.x,r=t.y;if(90<r*u&&r*u<-90&&180<i*u&&i*u<-180)return null;if(Math.abs(Math.abs(r)-a)<=1e-10)return null;if(this.sphere)e=this.x0+this.a*this.k0*l(i-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(h+.5*r));else{var o=Math.sin(r),s=c(this.e,r,o);e=this.x0+this.a*this.k0*l(i-this.long0),n=this.y0-this.a*this.k0*Math.log(s)}return t.x=e,t.y=n,t},n.inverse=function(t){var e,n,i=t.x-this.x0,r=t.y-this.y0;if(this.sphere)n=a-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var o=Math.exp(-r/(this.a*this.k0));if(-9999===(n=s(this.e,o)))return null}return e=l(this.long0+i/(this.a*this.k0)),t.x=e,t.y=n,t},n.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],53:[function(t,e,n){var s=t("../common/adjust_lon");n.init=function(){},n.forward=function(t){var e=t.x,n=t.y,i=s(e-this.long0),r=this.x0+this.a*i,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=r,t.y=o,t},n.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e=s(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t},n.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],54:[function(t,e,n){var h=t("../common/adjust_lon");n.init=function(){},n.forward=function(t){for(var e=t.x,n=t.y,i=h(e-this.long0),r=n,o=Math.PI*Math.sin(n),s=0;;s++){var a=-(r+Math.sin(r)-o)/(1+Math.cos(r));if(r+=a,Math.abs(a)<1e-10)break}r/=2,Math.PI/2-Math.abs(n)<1e-10&&(i=0);var u=.900316316158*this.a*i*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=u,t.y=l,t},n.inverse=function(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),.999999999999<Math.abs(n)&&(n=.999999999999),e=Math.asin(n);var i=h(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,1<Math.abs(n)&&(n=1);var r=Math.asin(n);return t.x=i,t.y=r,t},n.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],55:[function(t,e,n){var C=484813681109536e-20;n.iterations=1,n.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},n.forward=function(t){var e,n=t.x,i=t.y,r=i-this.lat0,o=n-this.long0,s=r/C*1e-5,a=o,u=1,l=0;for(e=1;e<=10;e++)u*=s,l+=this.A[e]*u;var h,c=l,p=a,f=1,d=0,g=0,y=0;for(e=1;e<=6;e++)h=d*c+f*p,f=f*c-d*p,d=h,g=g+this.B_re[e]*f-this.B_im[e]*d,y=y+this.B_im[e]*f+this.B_re[e]*d;return t.x=y*this.a+this.x0,t.y=g*this.a+this.y0,t},n.inverse=function(t){var e,n,i=t.x,r=t.y,o=i-this.x0,s=r-this.y0,a=s/this.a,u=o/this.a,l=1,h=0,c=0,p=0;for(e=1;e<=6;e++)n=h*a+l*u,l=l*a-h*u,h=n,c=c+this.C_re[e]*l-this.C_im[e]*h,p=p+this.C_im[e]*l+this.C_re[e]*h;for(var f=0;f<this.iterations;f++){var d,g=c,y=p,_=a,m=u;for(e=2;e<=6;e++)d=y*c+g*p,g=g*c-y*p,y=d,_+=(e-1)*(this.B_re[e]*g-this.B_im[e]*y),m+=(e-1)*(this.B_im[e]*g+this.B_re[e]*y);g=1,y=0;var v=this.B_re[1],b=this.B_im[1];for(e=2;e<=6;e++)d=y*c+g*p,g=g*c-y*p,y=d,v+=e*(this.B_re[e]*g-this.B_im[e]*y),b+=e*(this.B_im[e]*g+this.B_re[e]*y);var x=v*v+b*b;c=(_*v+m*b)/x,p=(m*v-_*b)/x}var E=c,w=p,I=1,L=0;for(e=1;e<=9;e++)I*=E,L+=this.D[e]*I;var S=this.lat0+L*C*1e5,M=this.long0+w;return t.x=M,t.y=S,t},n.names=["New_Zealand_Map_Grid","nzmg"]},{}],56:[function(t,e,n){var g=t("../common/tsfnz"),y=t("../common/adjust_lon"),l=t("../common/phi2z"),f=Math.PI/2,d=Math.PI/4;n.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),n=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-n*n);var i,r,o=g(this.e,this.lat0,t),s=this.bl/e*Math.sqrt((1-this.es)/(1-n*n));if(s*s<1&&(s=1),isNaN(this.longc)){var a=g(this.e,this.lat1,Math.sin(this.lat1)),u=g(this.e,this.lat2,Math.sin(this.lat2));0<=this.lat0?this.el=(s+Math.sqrt(s*s-1))*Math.pow(o,this.bl):this.el=(s-Math.sqrt(s*s-1))*Math.pow(o,this.bl);var l=Math.pow(a,this.bl),h=Math.pow(u,this.bl);i=this.el/l,r=.5*(i-1/i);var c=(this.el*this.el-h*l)/(this.el*this.el+h*l),p=(h-l)/(h+l),f=y(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(c*Math.tan(.5*this.bl*f)/p)/this.bl,this.long0=y(this.long0);var d=y(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*d)/r),this.alpha=Math.asin(s*Math.sin(this.gamma0))}else i=0<=this.lat0?s+Math.sqrt(s*s-1):s-Math.sqrt(s*s-1),this.el=i*Math.pow(o,this.bl),r=.5*(i-1/i),this.gamma0=Math.asin(Math.sin(this.alpha)/s),this.long0=this.longc-Math.asin(r*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:0<=this.lat0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha))},n.forward=function(t){var e,n,i,r=t.x,o=t.y,s=y(r-this.long0);if(Math.abs(Math.abs(o)-f)<=1e-10)i=0<o?-1:1,n=this.al/this.bl*Math.log(Math.tan(d+i*this.gamma0*.5)),e=-1*i*f*this.al/this.bl;else{var a=g(this.e,o,Math.sin(o)),u=this.el/Math.pow(a,this.bl),l=.5*(u-1/u),h=.5*(u+1/u),c=Math.sin(this.bl*s),p=(l*Math.sin(this.gamma0)-c*Math.cos(this.gamma0))/h;n=Math.abs(Math.abs(p)-1)<=1e-10?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-p)/(1+p))/this.bl,e=Math.abs(Math.cos(this.bl*s))<=1e-10?this.al*this.bl*s:this.al*Math.atan2(l*Math.cos(this.gamma0)+c*Math.sin(this.gamma0),Math.cos(this.bl*s))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+n):(e-=this.uc,t.x=this.x0+n*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-n*Math.sin(this.alpha)),t},n.inverse=function(t){var e,n;this.no_rot?(n=t.y-this.y0,e=t.x-this.x0):(n=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var i=Math.exp(-1*this.bl*n/this.al),r=.5*(i-1/i),o=.5*(i+1/i),s=Math.sin(this.bl*e/this.al),a=(s*Math.cos(this.gamma0)+r*Math.sin(this.gamma0))/o,u=Math.pow(this.el/Math.sqrt((1+a)/(1-a)),1/this.bl);return Math.abs(a-1)<1e-10?(t.x=this.long0,t.y=f):Math.abs(a+1)<1e-10?(t.x=this.long0,t.y=-1*f):(t.y=l(this.e,u),t.x=y(this.long0-Math.atan2(r*Math.cos(this.gamma0)-s*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},n.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],57:[function(t,e,n){var i=t("../common/e0fn"),r=t("../common/e1fn"),o=t("../common/e2fn"),s=t("../common/e3fn"),y=t("../common/adjust_lon"),u=t("../common/adjust_lat"),_=t("../common/mlfn"),m=1e-10,l=t("../common/gN");n.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=i(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=s(this.es),this.ml0=this.a*_(this.e0,this.e1,this.e2,this.e3,this.lat0)},n.forward=function(t){var e,n,i,r=t.x,o=t.y,s=y(r-this.long0);if(i=s*Math.sin(o),this.sphere)n=Math.abs(o)<=m?(e=this.a*s,-1*this.a*this.lat0):(e=this.a*Math.sin(i)/Math.tan(o),this.a*(u(o-this.lat0)+(1-Math.cos(i))/Math.tan(o)));else if(Math.abs(o)<=m)e=this.a*s,n=-1*this.ml0;else{var a=l(this.a,this.e,Math.sin(o))/Math.tan(o);e=a*Math.sin(i),n=this.a*_(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+a*(1-Math.cos(i))}return t.x=e+this.x0,t.y=n+this.y0,t},n.inverse=function(t){var e,n,i,r,o,s,a,u,l;if(i=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=m)e=y(i/this.a+this.long0),n=0;else{var h;for(s=this.lat0+r/this.a,a=i*i/this.a/this.a+s*s,u=s,o=20;o;--o)if(h=Math.tan(u),u+=l=-1*(s*(u*h+1)-u-.5*(u*u+a)*h)/((u-s)/h-1),Math.abs(l)<=m){n=u;break}e=y(this.long0+Math.asin(i*Math.tan(u)/this.a)/Math.sin(n))}else if(Math.abs(r+this.ml0)<=m)n=0,e=y(this.long0+i/this.a);else{var c,p,f,d,g;for(s=(this.ml0+r)/this.a,a=i*i/this.a/this.a+s*s,u=s,o=20;o;--o)if(g=this.e*Math.sin(u),c=Math.sqrt(1-g*g)*Math.tan(u),p=this.a*_(this.e0,this.e1,this.e2,this.e3,u),f=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),d=p/this.a,l=(s*(c*d+1)-d-.5*c*(d*d+a))/(this.es*Math.sin(2*u)*(d*d+a-2*s*d)/(4*c)+(s-d)*(c*f-2/Math.sin(2*u))-f),u-=l,Math.abs(l)<=m){n=u;break}c=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=y(this.long0+Math.asin(i*c/this.a)/Math.sin(n))}return t.x=e,t.y=n,t},n.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],58:[function(t,e,n){var h=t("../common/adjust_lon"),o=t("../common/adjust_lat"),i=t("../common/pj_enfn"),c=t("../common/pj_mlfn"),s=t("../common/pj_inv_mlfn"),a=Math.PI/2,u=t("../common/asinz");n.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=i(this.es)},n.forward=function(t){var e,n,i=t.x,r=t.y;if(i=h(i-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(r),s=20;s;--s){var a=(this.m*r+Math.sin(r)-o)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<1e-10)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*i*(this.m+Math.cos(r)),n=this.a*this.C_y*r}else{var u=Math.sin(r),l=Math.cos(r);n=this.a*c(r,u,l,this.en),e=this.a*i*l/Math.sqrt(1-this.es*u*u)}return t.x=e,t.y=n,t},n.inverse=function(t){var e,n,i,r;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=u((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=u(Math.sin(e)/this.n)),i=h(i+this.long0),e=o(e)):(e=s(t.y/this.a,this.es,this.en),(r=Math.abs(e))<a?(r=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=h(n)):r-1e-10<a&&(i=this.long0)),t.x=i,t.y=e,t},n.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],59:[function(t,e,n){n.init=function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,i=this.rf,r=1/i,o=2*r-Math.pow(r,2),s=this.e=Math.sqrt(o);this.R=this.k0*n*Math.sqrt(1-o)/(1-o*Math.pow(e,2)),this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),u=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+s*e)/(1-s*e));this.K=a-this.alpha*u+this.alpha*s/2*l},n.forward=function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+n)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*s+this.x0,t},n.inverse=function(t){for(var e=t.x-this.x0,n=t.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),s=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+s/this.alpha,u=0,l=o,h=-1e3,c=0;1e-7<Math.abs(l-h);){if(20<++c)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),h=l,l=2*Math.atan(Math.exp(u))-Math.PI/2}return t.x=a,t.y=l,t},n.names=["somerc"]},{}],60:[function(t,e,n){var p=Math.PI/2,f=1e-10,i=t("../common/sign"),r=t("../common/msfnz"),d=t("../common/tsfnz"),u=t("../common/phi2z"),g=t("../common/adjust_lon");n.ssfn_=function(t,e,n){return e*=n,Math.tan(.5*(p+t))*Math.pow((1-e)/(1+e),.5*n)},n.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=f&&(this.k0=.5*(1+i(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=f&&(0<this.lat0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=f&&(this.k0=.5*this.cons*r(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/d(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=r(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-p,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},n.forward=function(t){var e,n,i,r,o,s,a=t.x,u=t.y,l=Math.sin(u),h=Math.cos(u),c=g(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=f&&Math.abs(u+this.lat0)<=f?(t.x=NaN,t.y=NaN):this.sphere?(e=2*this.k0/(1+this.sinlat0*l+this.coslat0*h*Math.cos(c)),t.x=this.a*e*h*Math.sin(c)+this.x0,t.y=this.a*e*(this.coslat0*l-this.sinlat0*h*Math.cos(c))+this.y0):(n=2*Math.atan(this.ssfn_(u,l,this.e))-p,r=Math.cos(n),i=Math.sin(n),Math.abs(this.coslat0)<=f?(o=d(this.e,u*this.con,this.con*l),s=2*this.a*this.k0*o/this.cons,t.x=this.x0+s*Math.sin(a-this.long0),t.y=this.y0-this.con*s*Math.cos(a-this.long0)):(Math.abs(this.sinlat0)<f?(e=2*this.a*this.k0/(1+r*Math.cos(c)),t.y=e*i):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*i+this.cosX0*r*Math.cos(c))),t.y=e*(this.cosX0*i-this.sinX0*r*Math.cos(c))+this.y0),t.x=e*r*Math.sin(c)+this.x0)),t},n.inverse=function(t){var e,n,i,r,o;t.x-=this.x0,t.y-=this.y0;var s=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(s/(.5*this.a*this.k0));return e=this.long0,n=this.lat0,t.y=(t.x=(s<=f||(n=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/s),e=Math.abs(this.coslat0)<f?0<this.lat0?g(this.long0+Math.atan2(t.x,-1*t.y)):g(this.long0+Math.atan2(t.x,t.y)):g(this.long0+Math.atan2(t.x*Math.sin(a),s*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a)))),e),n),t}if(Math.abs(this.coslat0)<=f){if(s<=f)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,i=s*this.cons/(2*this.a*this.k0),n=this.con*u(this.e,i),e=this.con*g(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=f?o=this.X0:(o=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/s),e=g(this.long0+Math.atan2(t.x*Math.sin(r),s*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),n=-1*u(this.e,Math.tan(.5*(p+o)));return t.x=e,t.y=n,t},n.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],61:[function(t,e,n){var a=t("./gauss"),u=t("../common/adjust_lon");n.init=function(){a.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},n.forward=function(t){var e,n,i,r;return t.x=u(t.x-this.long0),a.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),i=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*i),t.x=r*n*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*n*i),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},n.inverse=function(t){var e,n,i,r,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Math.sqrt(t.x*t.x+t.y*t.y)){var s=2*Math.atan2(o,this.R2);e=Math.sin(s),n=Math.cos(s),r=Math.asin(n*this.sinc0+t.y*e*this.cosc0/o),i=Math.atan2(t.x*e,o*this.cosc0*n-t.y*this.sinc0*e)}else r=this.phic0,i=0;return t.x=i,t.y=r,a.inverse.apply(this,[t]),t.x=u(t.x+this.long0),t},n.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":46}],62:[function(t,e,n){var i=t("../common/e0fn"),r=t("../common/e1fn"),o=t("../common/e2fn"),s=t("../common/e3fn"),_=t("../common/mlfn"),I=t("../common/adjust_lon"),L=Math.PI/2,S=t("../common/sign"),M=t("../common/asinz");n.init=function(){this.e0=i(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=s(this.es),this.ml0=this.a*_(this.e0,this.e1,this.e2,this.e3,this.lat0)},n.forward=function(t){var e,n,i,r=t.x,o=t.y,s=I(r-this.long0),a=Math.sin(o),u=Math.cos(o);if(this.sphere){var l=u*Math.sin(s);if(Math.abs(Math.abs(l)-1)<1e-10)return 93;n=.5*this.a*this.k0*Math.log((1+l)/(1-l)),e=Math.acos(u*Math.cos(s)/Math.sqrt(1-l*l)),o<0&&(e=-e),i=this.a*this.k0*(e-this.lat0)}else{var h=u*s,c=Math.pow(h,2),p=this.ep2*Math.pow(u,2),f=Math.tan(o),d=Math.pow(f,2);e=1-this.es*Math.pow(a,2);var g=this.a/Math.sqrt(e),y=this.a*_(this.e0,this.e1,this.e2,this.e3,o);n=this.k0*g*h*(1+c/6*(1-d+p+c/20*(5-18*d+Math.pow(d,2)+72*p-58*this.ep2)))+this.x0,i=this.k0*(y-this.ml0+g*f*(c*(.5+c/24*(5-d+9*p+4*Math.pow(p,2)+c/30*(61-58*d+Math.pow(d,2)+600*p-330*this.ep2)))))+this.y0}return t.x=n,t.y=i,t},n.inverse=function(t){var e,n,i,r,o,s;if(this.sphere){var a=Math.exp(t.x/(this.a*this.k0)),u=.5*(a-1/a),l=this.lat0+t.y/(this.a*this.k0),h=Math.cos(l);e=Math.sqrt((1-h*h)/(1+u*u)),o=M(e),l<0&&(o=-o),s=0===u&&0===h?this.long0:I(Math.atan2(u,h)+this.long0)}else{var c=t.x-this.x0,p=t.y-this.y0;for(e=(this.ml0+p/this.k0)/this.a,n=e,r=0;i=(e+this.e1*Math.sin(2*n)-this.e2*Math.sin(4*n)+this.e3*Math.sin(6*n))/this.e0-n,n+=i,!(Math.abs(i)<=1e-10);r++)if(6<=r)return 95;if(Math.abs(n)<L){var f=Math.sin(n),d=Math.cos(n),g=Math.tan(n),y=this.ep2*Math.pow(d,2),_=Math.pow(y,2),m=Math.pow(g,2),v=Math.pow(m,2);e=1-this.es*Math.pow(f,2);var b=this.a/Math.sqrt(e),x=b*(1-this.es)/e,E=c/(b*this.k0),w=Math.pow(E,2);o=n-b*g*w/x*(.5-w/24*(5+3*m+10*y-4*_-9*this.ep2-w/30*(61+90*m+298*y+45*v-252*this.ep2-3*_))),s=I(this.long0+E*(1-w/6*(1+2*m+y-w/20*(5-2*y+28*m-3*_+8*this.ep2+24*v)))/d)}else o=L*S(p),s=this.long0}return t.x=s,t.y=o,t},n.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],63:[function(t,e,n){var i=t("./tmerc");n.dependsOn="tmerc",n.init=function(){this.zone&&(this.lat0=0,this.long0=.017453292519943295*(6*Math.abs(this.zone)-183),this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,i.init.apply(this),this.forward=i.forward,this.inverse=i.inverse)},n.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":62}],64:[function(t,e,n){var _=t("../common/adjust_lon"),m=Math.PI/2,v=t("../common/asinz");n.init=function(){this.R=this.a},n.forward=function(t){var e,n,i=t.x,r=t.y,o=_(i-this.long0);Math.abs(r)<=1e-10&&(e=this.x0+this.R*o,n=this.y0);var s=v(2*Math.abs(r/Math.PI));(Math.abs(o)<=1e-10||Math.abs(Math.abs(r)-m)<=1e-10)&&(e=this.x0,n=0<=r?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var a=.5*Math.abs(Math.PI/o-o/Math.PI),u=a*a,l=Math.sin(s),h=Math.cos(s),c=h/(l+h-1),p=c*c,f=c*(2/l-1),d=f*f,g=Math.PI*this.R*(a*(c-d)+Math.sqrt(u*(c-d)*(c-d)-(d+u)*(p-d)))/(d+u);o<0&&(g=-g),e=this.x0+g;var y=u+c;return g=Math.PI*this.R*(f*y-a*Math.sqrt((d+u)*(u+1)-y*y))/(d+u),n=0<=r?this.y0+g:this.y0-g,t.x=e,t.y=n,t},n.inverse=function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f;return t.x-=this.x0,t.y-=this.y0,c=Math.PI*this.R,i=t.x/c,r=t.y/c,o=i*i+r*r,s=-Math.abs(r)*(1+o),f=r*r/(u=-2*s+1+2*r*r+o*o)+(2*(a=s-2*r*r+i*i)*a*a/u/u/u-9*s*a/u/u)/27,l=(s-a*a/3/u)/u,h=2*Math.sqrt(-l/3),c=3*f/l/h,1<Math.abs(c)&&(c=0<=c?1:-1),p=Math.acos(c)/3,n=0<=t.y?(-h*Math.cos(p+Math.PI/3)-a/3/u)*Math.PI:-(-h*Math.cos(p+Math.PI/3)-a/3/u)*Math.PI,e=Math.abs(i)<1e-10?this.long0:_(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(i*i-r*r)+o*o))/2/i),t.x=e,t.y=n,t},n.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],65:[function(t,e,n){var s=.017453292519943295,a=57.29577951308232,u=t("./datum_transform"),l=t("./adjust_axis"),h=t("./Proj"),c=t("./common/toPoint");e.exports=function t(e,n,i){var r;function o(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode}return Array.isArray(i)&&(i=c(i)),e.datum&&n.datum&&(o(e,n)||o(n,e))&&(r=new h("WGS84"),t(e,r,i),e=r),"enu"!==e.axis&&l(e,!1,i),"longlat"===e.projName?(i.x*=s,i.y*=s):(e.to_meter&&(i.x*=e.to_meter,i.y*=e.to_meter),e.inverse(i)),e.from_greenwich&&(i.x+=e.from_greenwich),i=u(e.datum,n.datum,i),n.from_greenwich&&(i.x-=n.from_greenwich),"longlat"===n.projName?(i.x*=a,i.y*=a):(n.forward(i),n.to_meter&&(i.x/=n.to_meter,i.y/=n.to_meter)),"enu"!==n.axis&&l(n,!0,i),i}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":31}],66:[function(t,e,n){var i=.017453292519943295,s=t("./extend");function r(t,e,n){t[e]=n.map(function(t){var e={};return a(t,e),e}).reduce(function(t,e){return s(t,e)},{})}function a(t,e){var n;Array.isArray(t)?("PARAMETER"===(n=t.shift())&&(n=t.shift()),1===t.length?Array.isArray(t[0])?(e[n]={},a(t[0],e[n])):e[n]=t[0]:t.length?"TOWGS84"===n?e[n]=t:(e[n]={},-1<["UNIT","PRIMEM","VERT_DATUM"].indexOf(n)?(e[n]={name:t[0].toLowerCase(),convert:t[1]},3===t.length&&(e[n].auth=t[2])):"SPHEROID"===n?(e[n]={name:t[0],a:t[1],rf:t[2]},4===t.length&&(e[n].auth=t[3])):-1<["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(n)?(t[0]=["name",t[0]],r(e,n,t)):t.every(function(t){return Array.isArray(t)})?r(e,n,t):a(t,e[n])):e[n]=!0):e[t]=!0}function u(t,e){var n=e[0],i=e[1];!(n in t)&&i in t&&(t[n]=t[i],3===e.length&&(t[n]=e[2](t[n])))}function l(t){return t*i}e.exports=function(t,e){var n=JSON.parse((","+t).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),i=n.shift(),r=n.shift();n.unshift(["name",r]),n.unshift(["type",i]),n.unshift("output");var o={};return a(n,o),function(n){function t(t){var e=n.to_meter||1;return parseFloat(t,10)*e}"GEOGCS"===n.type?n.projName="longlat":"LOCAL_CS"===n.type?(n.projName="identity",n.local=!0):"object"===g(n.PROJECTION)?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),"metre"===n.units&&(n.units="meter"),n.UNIT.convert&&(n.to_meter=parseFloat(n.UNIT.convert,10))),n.GEOGCS&&(n.GEOGCS.DATUM?n.datumCode=n.GEOGCS.DATUM.name.toLowerCase():n.datumCode=n.GEOGCS.name.toLowerCase(),"d_"===n.datumCode.slice(0,2)&&(n.datumCode=n.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==n.datumCode&&"new_zealand_1949"!==n.datumCode||(n.datumCode="nzgd49"),"wgs_1984"===n.datumCode&&("Mercator_Auxiliary_Sphere"===n.PROJECTION&&(n.sphere=!0),n.datumCode="wgs84"),"_ferro"===n.datumCode.slice(-6)&&(n.datumCode=n.datumCode.slice(0,-6)),"_jakarta"===n.datumCode.slice(-8)&&(n.datumCode=n.datumCode.slice(0,-8)),~n.datumCode.indexOf("belge")&&(n.datumCode="rnb72"),n.GEOGCS.DATUM&&n.GEOGCS.DATUM.SPHEROID&&(n.ellps=n.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===n.ellps.toLowerCase().slice(0,13)&&(n.ellps="intl"),n.a=n.GEOGCS.DATUM.SPHEROID.a,n.rf=parseFloat(n.GEOGCS.DATUM.SPHEROID.rf,10)),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36")),n.b&&!isFinite(n.b)&&(n.b=n.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",l],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",l],["x0","false_easting",t],["y0","false_northing",t],["long0","central_meridian",l],["lat0","latitude_of_origin",l],["lat0","standard_parallel_1",l],["lat1","standard_parallel_1",l],["lat2","standard_parallel_2",l],["alpha","azimuth",l],["srsCode","name"]].forEach(function(t){return u(n,t)}),n.long0||!n.longc||"Albers_Conic_Equal_Area"!==n.projName&&"Lambert_Azimuthal_Equal_Area"!==n.projName||(n.long0=n.longc),n.lat_ts||!n.lat1||"Stereographic_South_Pole"!==n.projName&&"Polar Stereographic (variant B)"!==n.projName||(n.lat0=l(0<n.lat1?90:-90),n.lat_ts=n.lat1)}(o.output),s(e,o.output)}},{"./extend":34}],67:[function(t,e,n){var i=6,b="AJSAJS",x="AFAFAF",E=65,w=73,I=79,L=86,S=90;function M(t){return t*(Math.PI/180)}function C(t){return t/Math.PI*180}function P(t){var e=t.northing,n=t.easting,i=t.zoneLetter,r=t.zoneNumber;if(r<0||60<r)return null;var o,s,a,u,l,h,c,p,f,d=.00669438,g=(1-Math.sqrt(1-d))/(1+Math.sqrt(1-d)),y=n-5e5,_=e;i<"N"&&(_-=1e7),c=6*(r-1)-180+3,o=d/(1-d),f=(p=_/.9996/6367449.145945056)+(3*g/2-27*g*g*g/32)*Math.sin(2*p)+(21*g*g/16-55*g*g*g*g/32)*Math.sin(4*p)+151*g*g*g/96*Math.sin(6*p),s=6378137/Math.sqrt(1-d*Math.sin(f)*Math.sin(f)),a=Math.tan(f)*Math.tan(f),u=o*Math.cos(f)*Math.cos(f),l=6378137*(1-d)/Math.pow(1-d*Math.sin(f)*Math.sin(f),1.5),h=y/(.9996*s);var m=f-s*Math.tan(f)/l*(h*h/2-(5+3*a+10*u-4*u*u-9*o)*h*h*h*h/24+(61+90*a+298*u+45*a*a-252*o-3*u*u)*h*h*h*h*h*h/720);m=C(m);var v,b=(h-(1+2*a+u)*h*h*h/6+(5-2*u+28*a-3*u*u+8*o+24*a*a)*h*h*h*h*h/120)/Math.cos(f);if(b=c+C(b),t.accuracy){var x=P({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});v={top:x.lat,right:x.lon,bottom:m,left:b}}else v={lat:m,lon:b};return v}function N(t){var e=t%i;return 0===e&&(e=i),e}function r(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,n=t.length,i=null,r="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(2<=o)throw"MGRSPoint bad conversion from: "+t;r+=e,o++}var s=parseInt(r,10);if(0===o||n<o+3)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(o++);if(a<="A"||"B"===a||"Y"===a||"Z"<=a||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;i=t.substring(o,o+=2);for(var u=N(s),l=function(t,e){for(var n=b.charCodeAt(e-1),i=1e5,r=!1;n!==t.charCodeAt(0);){if(++n===w&&n++,n===I&&n++,S<n){if(r)throw"Bad character: "+t;n=E,r=!0}i+=1e5}return i}(i.charAt(0),u),h=function(t,e){if("V"<t)throw"MGRSPoint given invalid Northing "+t;for(var n=x.charCodeAt(e-1),i=0,r=!1;n!==t.charCodeAt(0);){if(++n===w&&n++,n===I&&n++,L<n){if(r)throw"Bad character: "+t;n=E,r=!0}i+=1e5}return i}(i.charAt(1),u);h<m(a);)h+=2e6;var c=n-o;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var p,f,d,g=c/2,y=0,_=0;return 0<g&&(p=1e5/Math.pow(10,g),f=t.substring(o,o+g),y=parseFloat(f)*p,d=t.substring(o+g),_=parseFloat(d)*p),{easting:y+l,northing:_+h,zoneLetter:a,zoneNumber:s,accuracy:p}}function m(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(0<=e)return e;throw"Invalid zone letter: "+t}n.forward=function(t,e){return e=e||5,n=function(t){var e,n,i,r,o,s,a,u,l=t.lat,h=t.lon,c=.00669438,p=M(l),f=M(h);u=Math.floor((h+180)/6)+1,180===h&&(u=60),56<=l&&l<64&&3<=h&&h<12&&(u=32),72<=l&&l<84&&(0<=h&&h<9?u=31:9<=h&&h<21?u=33:21<=h&&h<33?u=35:33<=h&&h<42&&(u=37)),a=M(6*(u-1)-180+3),e=c/(1-c),n=6378137/Math.sqrt(1-c*Math.sin(p)*Math.sin(p)),i=Math.tan(p)*Math.tan(p),r=e*Math.cos(p)*Math.cos(p),o=Math.cos(p)*(f-a),s=6378137*(.9983242984503243*p-.002514607064228144*Math.sin(2*p)+2639046602129982e-21*Math.sin(4*p)-35*c*c*c/3072*Math.sin(6*p));var d,g,y=.9996*n*(o+(1-i+r)*o*o*o/6+(5-18*i+i*i+72*r-58*e)*o*o*o*o*o/120)+5e5,_=.9996*(s+n*Math.tan(p)*(o*o/2+(5-i+9*r+4*r*r)*o*o*o*o/24+(61-58*i+i*i+600*r-330*e)*o*o*o*o*o*o/720));return l<0&&(_+=1e7),{northing:Math.round(_),easting:Math.round(y),zoneNumber:u,zoneLetter:(d=l,g="Z",d<=84&&72<=d?g="X":d<72&&64<=d?g="W":d<64&&56<=d?g="V":d<56&&48<=d?g="U":d<48&&40<=d?g="T":d<40&&32<=d?g="S":d<32&&24<=d?g="R":d<24&&16<=d?g="Q":d<16&&8<=d?g="P":d<8&&0<=d?g="N":d<0&&-8<=d?g="M":d<-8&&-16<=d?g="L":d<-16&&-24<=d?g="K":d<-24&&-32<=d?g="J":d<-32&&-40<=d?g="H":d<-40&&-48<=d?g="G":d<-48&&-56<=d?g="F":d<-56&&-64<=d?g="E":d<-64&&-72<=d?g="D":d<-72&&-80<=d&&(g="C"),g)}}({lat:t[1],lon:t[0]}),i=e,r="00000"+n.easting,o="00000"+n.northing,n.zoneNumber+n.zoneLetter+(d=n.easting,g=n.northing,y=n.zoneNumber,_=N(y),m=Math.floor(d/1e5),v=Math.floor(g/1e5)%20,s=m,a=v,u=_-1,l=b.charCodeAt(u),h=x.charCodeAt(u),f=!1,S<(c=l+s-1)&&(c=c-S+E-1,f=!0),(c===w||l<w&&w<c||(w<c||l<w)&&f)&&c++,(c===I||l<I&&I<c||(I<c||l<I)&&f)&&++c===w&&c++,S<c&&(c=c-S+E-1),f=L<(p=h+a)&&(p=p-L+E-1,!0),(p===w||h<w&&w<p||(w<p||h<w)&&f)&&p++,(p===I||h<I&&I<p||(I<p||h<I)&&f)&&++p===w&&p++,L<p&&(p=p-L+E-1),String.fromCharCode(c)+String.fromCharCode(p))+r.substr(r.length-5,i)+o.substr(o.length-5,i);var n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_,m,v},n.inverse=function(t){var e=P(r(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},n.toPoint=function(t){var e=P(r(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}},{}],68:[function(t,e,n){e.exports={name:"proj4",version:"2.3.10",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"~0.0.2"}}},{}],"./includedProjections":[function(t,e,n){e.exports=t("hTEDpn")},{}],hTEDpn:[function(t,e,n){var i=[t("./lib/projections/tmerc"),t("./lib/projections/utm"),t("./lib/projections/sterea"),t("./lib/projections/stere"),t("./lib/projections/somerc"),t("./lib/projections/omerc"),t("./lib/projections/lcc"),t("./lib/projections/krovak"),t("./lib/projections/cass"),t("./lib/projections/laea"),t("./lib/projections/aea"),t("./lib/projections/gnom"),t("./lib/projections/cea"),t("./lib/projections/eqc"),t("./lib/projections/poly"),t("./lib/projections/nzmg"),t("./lib/projections/mill"),t("./lib/projections/sinu"),t("./lib/projections/moll"),t("./lib/projections/eqdc"),t("./lib/projections/vandg"),t("./lib/projections/aeqd")];e.exports=function(e){i.forEach(function(t){e.Proj.projections.add(t)})}},{"./lib/projections/aea":40,"./lib/projections/aeqd":41,"./lib/projections/cass":42,"./lib/projections/cea":43,"./lib/projections/eqc":44,"./lib/projections/eqdc":45,"./lib/projections/gnom":47,"./lib/projections/krovak":48,"./lib/projections/laea":49,"./lib/projections/lcc":50,"./lib/projections/mill":53,"./lib/projections/moll":54,"./lib/projections/nzmg":55,"./lib/projections/omerc":56,"./lib/projections/poly":57,"./lib/projections/sinu":58,"./lib/projections/somerc":59,"./lib/projections/stere":60,"./lib/projections/sterea":61,"./lib/projections/tmerc":62,"./lib/projections/utm":63,"./lib/projections/vandg":64}]},{},[36])(36)}),W={};W._isProj4Obj=function(t){return void 0!==t.inverse&&void 0!==t.forward},W.Projection=G.Class.extend({initialize:function(t,e,n){var i=W._isProj4Obj(t);this._proj=i?t:this._projFromCodeDef(t,e),this.bounds=i?e:n},project:function(t){if(t){var e=this._proj.forward([t.lng,t.lat]);return new G.Point(e[0],e[1])}},unproject:function(t,e){if(t){var n=this._proj.inverse([t.x,t.y]);return new G.LatLng(n[1],n[0],e)}},_projFromCodeDef:function(t,e){if(e)X.defs(t,e);else if(void 0===X.defs[t]){var n=t.split(":");if(3<n.length&&(t=n[n.length-3]+":"+n[n.length-1]),void 0===X.defs[t])throw"No projection definition for code "+t}return X(t)}}),W.CRS=G.Class.extend({statics:{},wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,r=e.lat*n,o=Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos((e.lng-t.lng)*n);return this.R*Math.acos(Math.min(o,1))},includes:G.CRS,options:{transformation:new G.Transformation(1,0,-1,0)},initialize:function(t,e,n){var i,r,o,s;if(W._isProj4Obj(t)?(i=(r=t).srsCode,s=e||{},this.projection=new W.Projection(r,s.bounds)):(i=t,o=e,s=n||{},this.projection=new W.Projection(i,o,s.bounds)),G.Util.setOptions(this,s),this.code=i,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new G.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var a=this.options.resolutions.length-1;0<=a;a--)this.options.resolutions[a]&&(this._scales[a]=1/this.options.resolutions[a])}this.infinite=!this.options.bounds},scale:function(t){var e,n=Math.floor(t);return t===n?this._scales[t]:(e=this._scales[n])+(this._scales[n+1]-e)*(t-n)},zoom:function(t){var e,n=this._closestElement(this._scales,t),i=this._scales.indexOf(n);return t===n?i:(e=i+1,(t-n)/(this._scales[e]-n)+i)},_closestElement:function(t,e){for(var n,i=t.length;i--;)t[i]<=e&&(void 0===n||n<t[i])&&(n=t[i]);return n}}),W.GeoJSON=G.GeoJSON.extend({initialize:function(t,e){if(t.crs&&"name"===t.crs.type){var n=new W.CRS(t.crs.properties.name);(e=e||{}).coordsToLatLng=function(t){var e=G.point(t[0],t[1]);return n.projection.unproject(e)}}G.GeoJSON.prototype.initialize.call(this,t,e)}}),W.geoJson=function(t,e){return new W.GeoJSON(t,e)},k.h337=(H=(F={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}}).defaultRadius,(Y=function(t){this._coordinator={},this._data=[],this._radi=[],this._min=0,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)}).prototype={_organiseData:function(t,e){var n=t[this._xField],i=t[this._yField],r=this._radi,o=this._data,s=this._max,a=this._min,u=t[this._valueField]||1,l=t.radius||this._cfgRadius||H;return o[n]||(o[n]=[],r[n]=[]),o[n][i]?o[n][i]+=u:(o[n][i]=u,r[n][i]=l),o[n][i]>s?(e?this.setDataMax(o[n][i]):this._max=o[n][i],!1):{x:n,y:i,value:u,radius:l,min:a,max:s}},_unOrganizeData:function(){var t=[],e=this._data,n=this._radi;for(var i in e)for(var r in e[i])t.push({x:i,y:r,radius:n[i][r],value:e[i][r]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(0<arguments[0].length)for(var t=arguments[0],e=t.length;e--;)this.addData.call(this,t[e]);else{var n=this._organiseData(arguments[0],!0);n&&this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[n]})}return this},setData:function(t){var e=t.data,n=e.length;this._data=[],this._radi=[];for(var i=0;i<n;i++)this._organiseData(e[i],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},B=Y,U=function(){var o=function(t){var e=t.gradient||t.defaultGradient,n=document.createElement("canvas"),i=n.getContext("2d");n.width=256,n.height=1;var r=i.createLinearGradient(0,0,256,1);for(var o in e)r.addColorStop(o,e[o]);return i.fillStyle=r,i.fillRect(0,0,256,1),i.getImageData(0,0,256,1).data},d=function(t,e){var n=document.createElement("canvas"),i=n.getContext("2d"),r=t,o=t;if(n.width=n.height=2*t,1==e)i.beginPath(),i.arc(r,o,t,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{var s=i.createRadialGradient(r,o,t*e,r,o,t);s.addColorStop(0,"rgba(0,0,0,1)"),s.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=s,i.fillRect(0,0,2*t,2*t)}return n};function t(t){var e=t.container,n=this.shadowCanvas=document.createElement("canvas"),i=this.canvas=t.canvas||document.createElement("canvas"),r=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});i.className="heatmap-canvas",this._width=i.width=n.width=+r.width.replace(/px/,""),this._height=i.height=n.height=+r.height.replace(/px/,""),this.shadowCtx=n.getContext("2d"),this.ctx=i.getContext("2d"),i.style.cssText=n.style.cssText="position:absolute;left:0;top:0;",e.style.position="relative",e.appendChild(i),this._palette=o(t),this._templates={},this._setStyles(t)}return t.prototype={renderPartial:function(t){this._drawAlpha(t),this._colorize()},renderAll:function(t){this._clear(),this._drawAlpha(function(t){for(var e=[],n=t.min,i=t.max,r=t.radi,t=t.data,o=Object.keys(t),s=o.length;s--;)for(var a=o[s],u=Object.keys(t[a]),l=u.length;l--;){var h=u[l],c=t[a][h],p=r[a][h];e.push({x:a,y:h,value:c,radius:p})}return{min:n,max:i,data:e}}(t)),this._colorize()},_updateGradient:function(t){this._palette=o(t)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var e=this._min=t.min,n=this._max=t.max,t=t.data||[],i=t.length,r=1-this._blur;i--;){var o,s=t[i],a=s.x,u=s.y,l=s.radius,h=Math.min(s.value,n),c=a-l,p=u-l,f=this.shadowCtx;this._templates[l]?o=this._templates[l]:this._templates[l]=o=d(l,r),f.globalAlpha=(h-e)/(n-e),f.drawImage(o,c,p),c<this._renderBoundaries[0]&&(this._renderBoundaries[0]=c),p<this._renderBoundaries[1]&&(this._renderBoundaries[1]=p),c+2*l>this._renderBoundaries[2]&&(this._renderBoundaries[2]=c+2*l),p+2*l>this._renderBoundaries[3]&&(this._renderBoundaries[3]=p+2*l)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],n=this._renderBoundaries[2]-t,i=this._renderBoundaries[3]-e,r=this._width,o=this._height,s=this._opacity,a=this._maxOpacity,u=this._minOpacity,l=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),r<t+n&&(n=r-t),o<e+i&&(i=o-e);for(var h=this.shadowCtx.getImageData(t,e,n,i),c=h.data,p=c.length,f=this._palette,d=3;d<p;d+=4){var g,y=c[d],_=4*y;_&&(g=0<s?s:y<a?y<u?u:y:a,c[d-3]=f[_],c[d-2]=f[_+1],c[d-1]=f[_+2],c[d]=l?f[_+3]:g)}this.ctx.putImageData(h,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e=this.shadowCtx,n=e.getImageData(t.x,t.y,1,1),i=n.data[3],r=this._max,o=this._min;return Math.abs(r-o)*(i/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},t}(),V=!1,"canvas2d"===F.defaultRenderer&&(V=U),q=V,j={merge:function(){for(var t={},e=arguments.length,n=0;n<e;n++){var i=arguments[n];for(var r in i)t[r]=i[r]}return t}},z=function(){var a=function(){function t(){this.cStore={}}return t.prototype={on:function(t,e,n){var i=this.cStore;i[t]||(i[t]=[]),i[t].push(function(t){return e.call(n,t)})},emit:function(t,e){var n=this.cStore;if(n[t])for(var i=n[t].length,r=0;r<i;r++){var o=n[t][r];o(e)}}},t}();function t(){var e,t,n,i,r=this._config=j.merge(F,arguments[0]||{});if(this._coordinator=new a,r.plugin){var o=r.plugin;if(!F.plugins[o])throw new Error("Plugin '"+o+"' not found. Maybe it was not registered.");var s=F.plugins[o];this._renderer=new s.renderer(r),this._store=new s.store(r)}else this._renderer=new q(r),this._store=new B(r);t=(e=this)._renderer,n=e._coordinator,i=e._store,n.on("renderpartial",t.renderPartial,t),n.on("renderall",t.renderAll,t),n.on("extremachange",function(t){e._config.onExtremaChange&&e._config.onExtremaChange({min:t.min,max:t.max,gradient:e._config.gradient||e._config.defaultGradient})}),i.setCoordinator(n)}return t.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=j.merge(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},t}(),{create:function(t){return new z(t)},register:function(t,e){F.plugins[t]=e}});var J={},K=G.Layer.extend({initialize:function(t){this.cfg=t,this._el=G.DomUtil.create("div","leaflet-zoom-hide"),this._data=[],this._max=1,this._min=0,this.cfg.container=this._el},onAdd:function(t){var e=t.getSize();this._map=t,this._width=e.x,this._height=e.y,this._el.style.width=e.x+"px",this._el.style.height=e.y+"px",this._el.style.position="absolute",this._origin=this._map.layerPointToLatLng(new G.Point(0,0)),t.getPanes().overlayPane.appendChild(this._el),this._heatmap||(this._heatmap=J.create(this.cfg)),t.on("moveend",this._reset,this),this._draw()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._el),t.off("moveend",this._reset,this)},_draw:function(){if(this._map){var t=this._map.getPanes().mapPane._leaflet_pos;this._el.style[K.CSS_TRANSFORM]="translate("+-Math.round(t.x)+"px,"+-Math.round(t.y)+"px)",this._update()}},_update:function(){var t,e,n,i={max:this._max,min:this._min,data:[]};if(t=this._map.getBounds(),e=this._map.getZoom(),n=Math.pow(2,e),0!=this._data.length){for(var r=[],o=this.cfg.scaleRadius?n:1,s=0,a=0,u=this.cfg.valueField,l=this._data.length;l--;){var h=this._data[l],c=h[u],p=h.latlng;if(t.contains(p)){s=Math.max(c,s),a=Math.min(c,a);var f,d=this._map.latLngToContainerPoint(p),g={x:Math.round(d.x),y:Math.round(d.y)};g[u]=c,f=h.radius?h.radius*o:(this.cfg.radius||2)*o,g.radius=f,r.push(g)}}this.cfg.useLocalExtrema&&(i.max=s,i.min=a),i.data=r,this._heatmap.setData(i)}else this._heatmap&&this._heatmap.setData(i)},setData:function(t){this._max=t.max||this._max,this._min=t.min||this._min;for(var e=this.cfg.latField||"lat",n=this.cfg.lngField||"lng",i=this.cfg.valueField||"value",r=(t=t.data).length,o=[];r--;){var s=t[r],a={latlng:new G.LatLng(s[e],s[n])};a[i]=s[i],s.radius&&(a.radius=s.radius),o.push(a)}this._data=o,this._draw()},addData:function(t){if(0<t.length)for(var e=t.length;e--;)this.addData(t[e]);else{var n=this.cfg.latField||"lat",i=this.cfg.lngField||"lng",r=this.cfg.valueField||"value",o=t,s={latlng:new G.LatLng(o[n],o[i])};s[r]=o[r],this._max=Math.max(this._max,s[r]),this._min=Math.min(this._min,s[r]),o.radius&&(s.radius=o.radius),this._data.push(s),this._draw()}},_reset:function(){this._origin=this._map.layerPointToLatLng(new G.Point(0,0));var t=this._map.getSize();this._width===t.x&&this._height===t.y||(this._width=t.x,this._height=t.y,this._el.style.width=this._width+"px",this._el.style.height=this._height+"px",this._heatmap._renderer.setDimensions(this._width,this._height)),this._draw()}});K.CSS_TRANSFORM=function(){for(var t=document.createElement("div"),e=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],n=0;n<e.length;n++){var i=e[n];if(void 0!==t.style[i])return i}return e[0]}();A(function(t,e){var n,i;n=function(u){var t=u.Control.extend({includes:u.Evented?u.Evented.prototype:u.Mixin.Events,options:{position:"bottomright",toggleDisplay:!1,zoomLevelOffset:-5,zoomLevelFixed:!1,centerFixed:!1,zoomAnimation:!1,autoToggleDisplay:!1,minimized:!1,width:150,height:150,collapsedWidth:19,collapsedHeight:19,aimingRectOptions:{color:"#ff7800",weight:1,clickable:!1},shadowRectOptions:{color:"#000000",weight:1,clickable:!1,opacity:0,fillOpacity:0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"},mapOptions:{}},initialize:function(t,e){u.Util.setOptions(this,e),this.options.aimingRectOptions.clickable=!1,this.options.shadowRectOptions.clickable=!1,this._layer=t},onAdd:function(t){this._mainMap=t,this._container=u.DomUtil.create("div","leaflet-control-minimap"),this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",u.DomEvent.disableClickPropagation(this._container),u.DomEvent.on(this._container,"mousewheel",u.DomEvent.stopPropagation);var e={attributionControl:!1,dragging:!this.options.centerFixed,zoomControl:!1,zoomAnimation:this.options.zoomAnimation,autoToggleDisplay:this.options.autoToggleDisplay,touchZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),scrollWheelZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),doubleClickZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),boxZoom:!this._isZoomLevelFixed(),crs:t.options.crs};return e=u.Util.extend(this.options.mapOptions,e),this._miniMap=new u.Map(this._container,e),this._miniMap.addLayer(this._layer),this._mainMapMoving=!1,this._miniMapMoving=!1,this._userToggledDisplay=!1,this._minimized=!1,this.options.toggleDisplay&&this._addToggleButton(),this._miniMap.whenReady(u.Util.bind(function(){this._aimingRect=u.rectangle(this._mainMap.getBounds(),this.options.aimingRectOptions).addTo(this._miniMap),this._shadowRect=u.rectangle(this._mainMap.getBounds(),this.options.shadowRectOptions).addTo(this._miniMap),this._mainMap.on("moveend",this._onMainMapMoved,this),this._mainMap.on("move",this._onMainMapMoving,this),this._miniMap.on("movestart",this._onMiniMapMoveStarted,this),this._miniMap.on("move",this._onMiniMapMoving,this),this._miniMap.on("moveend",this._onMiniMapMoved,this)},this)),this._container},addTo:function(t){u.Control.prototype.addTo.call(this,t);var e=this.options.centerFixed||this._mainMap.getCenter();return this._miniMap.setView(e,this._decideZoom(!0)),this._setDisplay(this.options.minimized),this},onRemove:function(t){this._mainMap.off("moveend",this._onMainMapMoved,this),this._mainMap.off("move",this._onMainMapMoving,this),this._miniMap.off("moveend",this._onMiniMapMoved,this),this._miniMap.removeLayer(this._layer)},changeLayer:function(t){this._miniMap.removeLayer(this._layer),this._layer=t,this._miniMap.addLayer(this._layer)},_addToggleButton:function(){this._toggleDisplayButton=this.options.toggleDisplay?this._createButton("",this._toggleButtonInitialTitleText(),"leaflet-control-minimap-toggle-display leaflet-control-minimap-toggle-display-"+this.options.position,this._container,this._toggleDisplayButtonClicked,this):void 0,this._toggleDisplayButton.style.width=this.options.collapsedWidth+"px",this._toggleDisplayButton.style.height=this.options.collapsedHeight+"px"},_toggleButtonInitialTitleText:function(){return this.options.minimized?this.options.strings.showText:this.options.strings.hideText},_createButton:function(t,e,n,i,r,o){var s=u.DomUtil.create("a",n,i);s.innerHTML=t,s.href="#",s.title=e;var a=u.DomEvent.stopPropagation;return u.DomEvent.on(s,"click",a).on(s,"mousedown",a).on(s,"dblclick",a).on(s,"click",u.DomEvent.preventDefault).on(s,"click",r,o),s},_toggleDisplayButtonClicked:function(){this._userToggledDisplay=!0,this._minimized?this._restore():this._minimize()},_setDisplay:function(t){t!==this._minimized&&(this._minimized?this._restore():this._minimize())},_minimize:function(){this.options.toggleDisplay?(this._container.style.width=this.options.collapsedWidth+"px",this._container.style.height=this.options.collapsedHeight+"px",this._toggleDisplayButton.className+=" minimized-"+this.options.position,this._toggleDisplayButton.title=this.options.strings.showText):this._container.style.display="none",this._minimized=!0,this._onToggle()},_restore:function(){this.options.toggleDisplay?(this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._toggleDisplayButton.className=this._toggleDisplayButton.className.replace("minimized-"+this.options.position,""),this._toggleDisplayButton.title=this.options.strings.hideText):this._container.style.display="block",this._minimized=!1,this._onToggle()},_onMainMapMoved:function(t){if(this._miniMapMoving)this._miniMapMoving=!1;else{var e=this.options.centerFixed||this._mainMap.getCenter();this._mainMapMoving=!0,this._miniMap.setView(e,this._decideZoom(!0)),this._setDisplay(this._decideMinimized())}this._aimingRect.setBounds(this._mainMap.getBounds())},_onMainMapMoving:function(t){this._aimingRect.setBounds(this._mainMap.getBounds())},_onMiniMapMoveStarted:function(t){if(!this.options.centerFixed){var e=this._aimingRect.getBounds(),n=this._miniMap.latLngToContainerPoint(e.getSouthWest()),i=this._miniMap.latLngToContainerPoint(e.getNorthEast());this._lastAimingRectPosition={sw:n,ne:i}}},_onMiniMapMoving:function(t){this.options.centerFixed||!this._mainMapMoving&&this._lastAimingRectPosition&&(this._shadowRect.setBounds(new u.LatLngBounds(this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.sw),this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.ne))),this._shadowRect.setStyle({opacity:1,fillOpacity:.3}))},_onMiniMapMoved:function(t){this._mainMapMoving?this._mainMapMoving=!1:(this._miniMapMoving=!0,this._mainMap.setView(this._miniMap.getCenter(),this._decideZoom(!1)),this._shadowRect.setStyle({opacity:0,fillOpacity:0}))},_isZoomLevelFixed:function(){var t=this.options.zoomLevelFixed;return this._isDefined(t)&&this._isInteger(t)},_decideZoom:function(t){if(this._isZoomLevelFixed())return t?this.options.zoomLevelFixed:this._mainMap.getZoom();if(t)return this._mainMap.getZoom()+this.options.zoomLevelOffset;var e,n=this._miniMap.getZoom()-this._mainMap.getZoom(),i=this._miniMap.getZoom()-this.options.zoomLevelOffset;return n>this.options.zoomLevelOffset&&this._mainMap.getZoom()<this._miniMap.getMinZoom()-this.options.zoomLevelOffset?this._miniMap.getZoom()>this._lastMiniMapZoom?(e=this._mainMap.getZoom()+1,this._miniMap.setZoom(this._miniMap.getZoom()-1)):e=this._mainMap.getZoom():e=i,this._lastMiniMapZoom=this._miniMap.getZoom(),e},_decideMinimized:function(){return this._userToggledDisplay?this._minimized:this.options.autoToggleDisplay?!!this._mainMap.getBounds().contains(this._miniMap.getBounds()):this._minimized},_isInteger:function(t){return"number"==typeof t},_isDefined:function(t){return void 0!==t},_onToggle:function(){u.Util.requestAnimFrame(function(){u.DomEvent.on(this._container,"transitionend",this._fireToggleEvents,this),u.Browser.any3d||u.Util.requestAnimFrame(this._fireToggleEvents,this)},this)},_fireToggleEvents:function(){u.DomEvent.off(this._container,"transitionend",this._fireToggleEvents,this);var t={minimized:this._minimized};this.fire(this._minimized?"minimize":"restore",t),this.fire("toggle",t)}});return u.Map.mergeOptions({miniMapControl:!1}),u.Map.addInitHook(function(){this.options.miniMapControl&&(this.miniMapControl=(new t).addTo(this))}),t},i=window,t.exports=n(G),void 0!==i&&i.L&&(i.L.Control.MiniMap=n(L),i.L.control.minimap=function(t,e){return new i.L.Control.MiniMap(t,e)})});var Z,Q=Object.freeze({Bezier:_,Coordtransform:M,FlashMarker:P,Label:N,MovingMarker:O,SeCanvas:C,MeasureAreaTool:T,MeasurePathTool:R,Proj:W,HeatmapOverlay:K}),$={serviceUrl:"",token:"",styleVersion:30291022};function tt(t){t&&(t.serviceUrl&&($.serviceUrl=t.serviceUrl),t.token&&($.token=t.token))}var et="/sevs/v5/api/",nt="/auth/v3/",it=(p(Z={deleteUser:{url:nt+"user/{0}?op=delete",type:"GET"},register:{url:nt+"register",type:"POST"},logout:{url:nt+"login?op=delete",type:"GET"},login:{url:nt+"login",type:"POST"},noCodeLogin:{url:nt+"nocode_login",type:"POST"},createKey:{url:nt+"key",type:"GET"},getCaptcha:{url:nt+"captcha",type:"GET"},keyCheck:{url:nt+"key_check",type:"GET"},getUserList:{url:nt+"user",type:"GET"},createUser:{url:nt+"user",type:"post"},getUser:{url:nt+"user/{0}",type:"GET"},updateUser:{url:nt+"user/{0}",type:"POST"},updatePassword:{url:nt+"user/password",type:"post"},getGroupList:{url:nt+"group",type:"GET"},createGroup:{url:nt+"group",type:"post"},getGroup:{url:nt+"group/{0}?op=get_ex",type:"GET"},deleteGroup:{url:nt+"group/{0}?op=delete",type:"GET"},updateGroup:{url:nt+"group/{0}?op=update_ex",type:"post"},getResourceList:{url:nt+"resource",type:"GET"},getServiceConfig:{url:et+"config",type:"GET"},scaleset:{url:et+"crs/scaleset",type:"GET"},mapThumbnail:{url:et+"map/thumbnail",type:"GET"},crsInfo:{url:et+"crs/info",type:"GET"},crs:{url:et+"crs/list",type:"GET"},queryDir:{url:et+"dir",type:"GET"},queryAllTag:{url:et+"tag",type:"GET"},createTag:{url:et+"tag",type:"POST"},queryTag:{url:et+"tag/{0}",type:"GET"},updateTag:{url:et+"tag/{0}",type:"POST"},deleteTag:{url:et+"tag/{0}",type:"DELETE"}},"queryDir",{url:et+"dir",type:"GET"}),p(Z,"queryLayerListSummary",{url:et+"layer/list/summary",type:"GET"}),p(Z,"queryLayerListInfo",{url:et+"layer/list/info",type:"GET"}),p(Z,"queryLayerInfo",{url:et+"laye/info",type:"GET"}),p(Z,"queryLayerPreview",{url:et+"laye/preview",type:"GET"}),p(Z,"queryAllDataset",{url:et+"dataset",type:"GET"}),p(Z,"queryAllPublicDataset",{url:et+"dataset/public",type:"GET"}),p(Z,"createDataset",{url:et+"dataset",type:"POST"}),p(Z,"queryDataset",{url:et+"dataset/{0}",type:"GET"}),p(Z,"updateDataset",{url:et+"dataset/{0}",type:"POST"}),p(Z,"deleteDataset",{url:et+"dataset/{0}",type:"DELETE"}),p(Z,"datasetInfo",{url:et+"dataset/info",type:"POST"}),p(Z,"getFieldDistinct",{url:et+"dataset/util?op=get_field_distinct",type:"post"}),p(Z,"fieldStatistics",{url:et+"dataset/util?op=statistics",type:"post"}),p(Z,"getMapList",{url:et+"map",type:"GET"}),p(Z,"getPublicMapList",{url:et+"map/public",type:"GET"}),p(Z,"getMap",{url:et+"map/{0}",type:"GET"}),p(Z,"updateMap",{url:et+"map/{0}",type:"POST"}),p(Z,"deleteMap",{url:et+"map/{0}?op=delete",type:"GET"}),p(Z,"saveMap",{url:et+"map",type:"post"}),p(Z,"getMapData",{url:et+"render",type:"post"}),p(Z,"getMapServiceList",{url:et+"map/service",type:"GET"}),p(Z,"createMapService",{url:et+"map/service",type:"post"}),p(Z,"getMapService",{url:et+"map/service/{0}",type:"GET"}),p(Z,"updateMapService",{url:et+"map/service/{0}",type:"post"}),p(Z,"deleteMapService",{url:et+"map/service/{0}?op=delete",type:"GET"}),p(Z,"projection",{url:et+"import/projection",type:"GET"}),p(Z,"createImportMission",{url:et+"import/mission",type:"POST"}),p(Z,"files",{url:et+"datasource/server_file",type:"GET"}),p(Z,"getMissionInfos",{url:et+"import/mission",type:"GET"}),p(Z,"updateMission",{url:et+"import/mission/{0}",type:"POST"}),p(Z,"createImportProcess",{url:et+"import/process",type:"POST"}),p(Z,"deleteImportMission",{url:et+"import/mission/{0}",type:"DELETE"}),p(Z,"queryImportMission",{url:et+"import/mission/{0}",type:"GET"}),p(Z,"gjbImport",{url:et+"gjb/import",type:"post"}),p(Z,"getMapsheetBytagid",{url:et+"gjb/mapsheet/tagid",type:"GET"}),p(Z,"getMapsheetByfile",{url:et+"gjb/mapsheet/gjbfile",type:"GET"}),p(Z,"updateGjb",{url:et+"gjb/update",type:"post"}),p(Z,"metadataList",{url:et+"gjb/metadata/{0}",type:"GET"}),p(Z,"createMetadata",{url:et+"gjb/metadata/{0}",type:"post"}),p(Z,"updateMetadata",{url:et+"gjb/metadata/{0}",type:"post"}),p(Z,"deleteMetadata",{url:et+"gjb/metadata/{0}?op=delete",type:"GET"}),p(Z,"importGjbRecord",{url:et+"import/gjbrecord",type:"POST"}),p(Z,"importOnline",{url:et+"import/online",type:"GET"}),p(Z,"createExport",{url:et+"export/vector",type:"post"}),p(Z,"exportMissionList",{url:et+"export/vector",type:"GET"}),p(Z,"exportMissionStart",{url:et+"export/process",type:"GET"}),p(Z,"uploadShpExport",{url:et+"export/uploadshp",type:"GET"}),p(Z,"exportDownload",{url:et+"export/download",type:"GET"}),p(Z,"createAddressService",{url:et+"addr/service",type:"POST"}),p(Z,"addressSearch",{url:et+"addr/search",type:"GET"}),p(Z,"searchDetail",{url:et+"addr/search/{0}",type:"GET"}),p(Z,"queryFulltextRecord",{url:et+"fulltext/record",type:"GET"}),p(Z,"fulltextAdddataset",{url:et+"fulltext/adddataset",type:"POST"}),p(Z,"fulltextAddIndex",{url:et+"fulltext/addindex",type:"POST"}),p(Z,"fulltextDeleteIndex",{url:et+"fulltext/deleteindex",type:"POST"}),p(Z,"fulltextDefaultIndex",{url:et+"fulltext/defaultindex",type:"GET"}),p(Z,"fulltextSearch",{url:et+"fulltext/search",type:"POST"}),p(Z,"query",{url:et+"query",type:"post"}),p(Z,"unlock",{url:et+"edit/lock?op=unlock",type:"POST"}),p(Z,"unlockAll",{url:et+"edit/lock?op=unlock_all",type:"POST"}),p(Z,"lock",{url:et+"edit/lock?op=lock",type:"POST"}),p(Z,"batchFeatures",{url:et+"edit",type:"POST"}),p(Z,"symbolLibList",{url:et+"symbolic_library",type:"GET"}),p(Z,"createSymbolLib",{url:et+"symbolic_library",type:"post"}),p(Z,"getSymbolLib",{url:et+"symbolic_library/{0}",type:"GET"}),p(Z,"updateSymbolLib",{url:et+"symbolic_library/{0}",type:"post"}),p(Z,"deleteSymbolLib",{url:et+"symbolic_library/{0}?op=delete",type:"GET"}),p(Z,"getDtPVInfo",{url:et+"se_pv/query?cmd=getdatainfo",type:"GET"}),p(Z,"queryPV",{url:et+"se_pv/query",type:"POST"}),Z);var rt={SUCCESS:"$SUCCESS"};function ot(t,e){e||(e={});var n=e.success,i=e.error;try{var r=!1!==e.async,o=e.type||"GET";o=o.toUpperCase();var s=e.contentType||"text/plain",a=e.data||null,u=e.dataType||"json",l=void 0;if((l=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onload=function(){n&&n(l.response)},l.onerror=function(){i&&i()},"GET"===o||"DELETE"===o){if(a&&a instanceof Object){var h="";for(var c in a)h=h+c+"="+a[c]+"&";if(h)h=h.slice(0,-1),t=-1===t.indexOf("?")?t+"?"+h:t+"&"+h}a=null}return l.open(o,t,r),l.responseType=u,l.setRequestHeader("Content-Type",s),l.send(a),l}catch(t){i&&i()}return null}function st(t,e){e=e||{};var n=function(t){var e=$.serviceUrl;if(!e||!it[t])return"";var n=$.token,i="";return i=-1!==(i="/"===e.charAt(e.length-1)?(e=e.substring(0,e.length-1))+it[t].url:e+it[t].url).indexOf("?")?i+"&token="+n:i+"?token="+n}(t);if(!n)return!1;if(/\{\d+?\}/.test(n)){if(!e||!e.data||!e.data.id)return!1;n=function(t){if(!t)return null;for(var e=t.split(/\{\d+?\}/),n=0;n<e.length&&void 0!==arguments[n+1];n++)e[n]+=arguments[n+1];return e.join("")}(n,e.data.id),delete e.data.id}var i,r=it[i=t]?it[i].type:"";return e.type=r,e&&e.data&&"POST"===r.toUpperCase()&&(e.data=JSON.stringify(e.data)),ot(n,e)}var at={GENERAL:0,BOUNDS:1,IDS:2,STATE:3,CIRCLE:4,EMPTY:5,EQUALS:10,DISJOINT:11,TOUCHES:12,WITHIN:13,OVERLAPS:14,CROSSES:15,INTERSECTS:16,CONTAINS:17};function ut(t){if(!(t&&t.data&&t.data.query_define&&t.data.view_bbox&&t.data.dataset_list&&0!==t.data.dataset_list.length))return null;var e=t.data.query_define;return e.crs||(e.crs={crsid:"EPSG:4326",proj4:"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs",wkt:'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.01745329251994328,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]]'}),st("getMapData",t)}function lt(t){if(!(t&&t.data&&t.data.query_define&&t.data.dataset_list&&0!==t.data.dataset_list.length))return null;var e=t.data.query_define;return e.crs||(e.crs={crsid:"EPSG:4326",proj4:"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs",wkt:'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.01745329251994328,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]]'}),t.effective_dataset_count||(t.effective_dataset_count=t.data.dataset_list.length),st("query",t)}function ht(t){return t&&t.data&&t.data.dataset_list&&0!==t.data.dataset_list.length?(t.data.query_define={type:at.IDS},lt(t)):null}var ct=Object.freeze({render:ut,query:lt,queryByIds:ht,queryBySql:function(t){return t&&t.data&&t.data.dataset_list&&0!==t.data.dataset_list.length?(t.data.query_define={type:at.GENERAL},lt(t)):null},queryBySpatial:function(t){return t&&t.data&&t.data.dataset_list&&0!==t.data.dataset_list.length&&t.data.query_define&&t.data.query_define.feature?lt(t):null}}),pt=A(function(s){!function(t){function c(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function a(t,e,n,i,r,o){return c((s=c(c(e,t),c(i,o)))<<(a=r)|s>>>32-a,n);var s,a}function p(t,e,n,i,r,o,s){return a(e&n|~e&i,t,e,r,o,s)}function f(t,e,n,i,r,o,s){return a(e&i|n&~i,t,e,r,o,s)}function d(t,e,n,i,r,o,s){return a(e^n^i,t,e,r,o,s)}function g(t,e,n,i,r,o,s){return a(n^(e|~i),t,e,r,o,s)}function u(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var n,i,r,o,s,a=1732584193,u=-271733879,l=-1732584194,h=271733878;for(n=0;n<t.length;n+=16)u=g(u=g(u=g(u=g(u=d(u=d(u=d(u=d(u=f(u=f(u=f(u=f(u=p(u=p(u=p(u=p(r=u,l=p(o=l,h=p(s=h,a=p(i=a,u,l,h,t[n],7,-680876936),u,l,t[n+1],12,-389564586),a,u,t[n+2],17,606105819),h,a,t[n+3],22,-1044525330),l=p(l,h=p(h,a=p(a,u,l,h,t[n+4],7,-176418897),u,l,t[n+5],12,1200080426),a,u,t[n+6],17,-1473231341),h,a,t[n+7],22,-45705983),l=p(l,h=p(h,a=p(a,u,l,h,t[n+8],7,1770035416),u,l,t[n+9],12,-1958414417),a,u,t[n+10],17,-42063),h,a,t[n+11],22,-1990404162),l=p(l,h=p(h,a=p(a,u,l,h,t[n+12],7,1804603682),u,l,t[n+13],12,-40341101),a,u,t[n+14],17,-1502002290),h,a,t[n+15],22,1236535329),l=f(l,h=f(h,a=f(a,u,l,h,t[n+1],5,-165796510),u,l,t[n+6],9,-1069501632),a,u,t[n+11],14,643717713),h,a,t[n],20,-373897302),l=f(l,h=f(h,a=f(a,u,l,h,t[n+5],5,-701558691),u,l,t[n+10],9,38016083),a,u,t[n+15],14,-660478335),h,a,t[n+4],20,-405537848),l=f(l,h=f(h,a=f(a,u,l,h,t[n+9],5,568446438),u,l,t[n+14],9,-1019803690),a,u,t[n+3],14,-187363961),h,a,t[n+8],20,1163531501),l=f(l,h=f(h,a=f(a,u,l,h,t[n+13],5,-1444681467),u,l,t[n+2],9,-51403784),a,u,t[n+7],14,1735328473),h,a,t[n+12],20,-1926607734),l=d(l,h=d(h,a=d(a,u,l,h,t[n+5],4,-378558),u,l,t[n+8],11,-2022574463),a,u,t[n+11],16,1839030562),h,a,t[n+14],23,-35309556),l=d(l,h=d(h,a=d(a,u,l,h,t[n+1],4,-1530992060),u,l,t[n+4],11,1272893353),a,u,t[n+7],16,-155497632),h,a,t[n+10],23,-1094730640),l=d(l,h=d(h,a=d(a,u,l,h,t[n+13],4,681279174),u,l,t[n],11,-358537222),a,u,t[n+3],16,-722521979),h,a,t[n+6],23,76029189),l=d(l,h=d(h,a=d(a,u,l,h,t[n+9],4,-640364487),u,l,t[n+12],11,-421815835),a,u,t[n+15],16,530742520),h,a,t[n+2],23,-995338651),l=g(l,h=g(h,a=g(a,u,l,h,t[n],6,-198630844),u,l,t[n+7],10,1126891415),a,u,t[n+14],15,-1416354905),h,a,t[n+5],21,-57434055),l=g(l,h=g(h,a=g(a,u,l,h,t[n+12],6,1700485571),u,l,t[n+3],10,-1894986606),a,u,t[n+10],15,-1051523),h,a,t[n+1],21,-2054922799),l=g(l,h=g(h,a=g(a,u,l,h,t[n+8],6,1873313359),u,l,t[n+15],10,-30611744),a,u,t[n+6],15,-1560198380),h,a,t[n+13],21,1309151649),l=g(l,h=g(h,a=g(a,u,l,h,t[n+4],6,-145523070),u,l,t[n+11],10,-1120210379),a,u,t[n+2],15,718787259),h,a,t[n+9],21,-343485551),a=c(a,i),u=c(u,r),l=c(l,o),h=c(h,s);return[a,u,l,h]}function l(t){var e,n="",i=32*t.length;for(e=0;e<i;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function h(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var i=8*t.length;for(e=0;e<i;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function i(t){var e,n,i="0123456789abcdef",r="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),r+=i.charAt(e>>>4&15)+i.charAt(15&e);return r}function n(t){return unescape(encodeURIComponent(t))}function r(t){return l(u(h(e=n(t)),8*e.length));var e}function o(t,e){return function(t,e){var n,i,r=h(t),o=[],s=[];for(o[15]=s[15]=void 0,16<r.length&&(r=u(r,8*t.length)),n=0;n<16;n+=1)o[n]=909522486^r[n],s[n]=1549556828^r[n];return i=u(o.concat(h(e)),512+8*e.length),l(u(s.concat(i),640))}(n(t),n(e))}function e(t,e,n){return e?n?o(e,t):i(o(e,t)):n?r(t):i(r(t))}s.exports?s.exports=e:t.md5=e}(k)}),ft={register:function(t){if(!t||!t.data)return!1;var e=t.data;return!!(e.account&&e.email&&e.name&&e.password)&&(e.password=pt(e.password),st("register",t))},login:function(t){if(!t||!t.data)return!1;var e=t.data;if(!(e.user_name&&e.verify_code&&e.verify_string&&e.password))return!1;var n=pt(e.password),i=e.user_name+"_"+n+"_"+e.verify_string,r=pt(i);return t.data={user_name:e.user_name,verify_code:e.verify_code,encode_result:r,verify_string:e.verify_string},st("login",t)},noCodeLogin:function(t){if(!t||!t.data)return!1;var e=t.data;if(!e.user_name||!e.password)return!1;var n=pt(e.password),i=e.user_name+"_"+n+"_ABC12",r=pt(i);return t.data={user_name:e.user_name,verify_code:"uuid",encode_result:r,verify_string:"ABC12"},st("noCodeLogin",t)},logout:function(t){return st("logout",t)},keyCheck:function(t){return st("keyCheck",t)}},dt=Object.freeze({ajax:ot,httpRequest:st,StatusEnum:rt,setConfig:tt,getConfig:function(){return $},Query:ct,User:ft}),gt={getUid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}).toLowerCase()},create:Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}(),setOptions:function(t,e){for(var n in t.options||(t.options=t.options?this.create(t.options):{}),e)t.options[n]=e[n];return t.options},extend:function(t){var e,n=void 0,i=void 0,r=void 0;for(i=1,e=arguments.length;i<e;i++)for(n in r=arguments[i])t[n]=r[n];return t},clone:function(t){if(!t)return null;var e=JSON.stringify(t);return JSON.parse(e)},poundToPixel:function(t){return t/72*96},pixelToPound:function(t){return t/96*72},deg2Rad:function(t){return t*Math.PI/180},rad2Deg:function(t){return 180*t/Math.PI},char2buf:function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;i++)n[i]=t[i].charCodeAt();return e},getPolylineMidPoint:function(t,e,n,i,r){var o=e;if(o<2)return!1;for(var s=0,a=0;a<o-1;a++)s+=Math.sqrt((t[a+1].x-t[a].x)*(t[a+1].x-t[a].x)+(t[a+1].y-t[a].y)*(t[a+1].y-t[a].y));var u=s/2;if((u+=i)<0||s<u)return!1;for(var l=0,h=0,c=1;c<o;c++){var p=Math.sqrt(Math.pow(t[c].x-t[c-1].x,2)+Math.pow(t[c].y-t[c-1].y,2));if(h=(l+=p)-u,Math.abs(h)<1e-5){if(n.x=t[c].x,n.y=t[c].y,r)n.a=360*Math.random();else if(c===o-1)n.a=this.getFastAngle(t[c-1].x,t[c-c].y,t[c].x,t[c].y);else{var f=(Math.atan((t[c].y-t[c-1].y)/(t[c].x-t[c-1].x))+Math.atan((t[c+1].y-t[c].y)/(t[c+1].x-t[c].x)))/2;n.a=f}return!0}if(0<h)return n.x=t[c-1].x+(p-h)*(t[c].x-t[c-1].x)/p,n.y=t[c-1].y+(p-h)*(t[c].y-t[c-1].y)/p,n.a=r?360*Math.random():this.getFastAngle(t[c-1].x,t[c-1].y,t[c].x,t[c].y),!0}return!1},getFastAngle:function(t,e,n,i){var r=void 0;return Math.abs(t-n)<1e-5?(r=90,i===e&&(r=0),i<e&&(r+=180)):Math.abs(i-e)<1e-5?r=t<n?0:180:(r=Math.atan((i-e)/(n-t)),r*=180/Math.PI,t<n?i<=e&&(r+=360):r+=180),r},getPolylineDecroPoints:function(t,e,n,i,r,o,s){var a=n;if(a<2)return!1;var u=i.length;if(u<1)return!1;for(var l=r,h=0,c=0,p=0,f=0,d=0,g=0,y=0;y<a-1;y++)if(h=c,l<(c+=Math.sqrt(Math.pow(e[y+1].x-e[y].x,2)+Math.pow(e[y+1].y-e[y].y,2)))){var _=0;_=s?Math.random()%360:y===a-1?this.getFastAngle(e[y-1].x,e[y-1].y,e[y].x,e[y].y):this.getFastAngle(e[y].x,e[y].y,e[y+1].x,e[y+1].y);do{var m={x:0,y:0,a:0};m.a=_;var v=this.deg2Rad(_);p=l-h,f=Math.cos(v),d=Math.sin(v),m.x=e[y].x+p*f,m.y=e[y].y+p*d,t.push(m),l+=i[g%u],g++}while(l<c)}return!0},getCenter:function(t){if(!t||t.length<3)return null;var e=void 0,n=void 0,i=void 0,r=void 0,o=void 0,s=0,a=0,u=0,l=t.length;for(e=0,n=l-1;e<l;n=e++)i=t[e],r=t[n],o=i.y*r.x-r.y*i.x,a+=(i.x+r.x)*o,u+=(i.y+r.y)*o,s+=3*o;return 0===s?t[0]:{x:a/s,y:u/s}},getPolygonBox:function(t){if(!t||0===t.length)return null;var e=t[0].x,n=t[0].y,i=t[0].x,r=t[0].y;return t.forEach(function(t){t.x<e?e=t.x:t.x>i&&(i=t.x),t.y<n?n=t.y:t.y>r&&(r=t.y)}),[e,n,i,r]}},yt={points:null,polyCount:null,subCount:0},_t=function(){function e(t){h(this,e),this.options=gt.extend({},yt,t)}return c(e,[{key:"points",get:function(){return this.options.points},set:function(t){this.options.points=t}},{key:"polyCount",get:function(){return this.options.polyCount},set:function(t){this.options.polyCount=t}},{key:"subCount",get:function(){return this.options.subCount},set:function(t){this.options.subCount=t}}]),e}(),mt=G.Class.extend({options:{left:0,bottom:0,right:0,top:0},initialize:function(t){G.setOptions(this,t)},getLeft:function(){return this.options.left},getBottom:function(){return this.options.bottom},getRight:function(){return this.options.right},getTop:function(){return this.options.top},getLeftTop:function(){return new G.Point(this.getLeft(),this.getTop())},getRightBottom:function(){return new G.Point(this.getRight(),this.getBottom())},toLatLngBounds:function(t){if(!this.isValid())return null;var e=null;if(t&&!t.isEPSG4326()){var n=t.createProj(),i=this.getLeftTop(),r=this.getRightBottom(),o=n.projection.unproject(i),s=n.projection.unproject(r);e=new G.LatLngBounds(o,s)}else e=new G.LatLngBounds([this.getBottom(),this.getLeft()],[this.getTop(),this.getRight()]);return e},isValid:function(){return!(this.options.left>=this.options.right||this.options.bottom>=this.options.top)},isNull:function(){return this.options.left===this.options.right||this.options.bottom===this.options.top},containsPoint:function(t){return!(!t||this.isNull())&&(t.x>=this.options.left&&t.x<=this.options.right&&t.y>=this.options.bottom&&t.y<=this.options.top)},clone:function(){return new mt(this.options)},getCenter:function(){var t=new G.Point(0,0);return t.x=.5*(this.options.left+this.options.right),t.y=.5*(this.options.top+this.options.bottom),t},getWidth:function(){return this.isNull()?0:this.options.right-this.options.left},getHeight:function(){return this.isNull()?0:this.options.top-this.options.bottom},readJson:function(t){t&&(this.options.left=t.min_x?t.min_x:0,this.options.bottom=t.min_y?t.min_y:0,this.options.right=t.max_x?t.max_x:0,this.options.top=t.max_y?t.max_y:0)},toJson:function(){return{min_x:this.options.left,min_y:this.options.bottom,max_x:this.options.right,max_y:this.options.top}},containsBounds:function(t){return!(!t||this.isNull())&&(t.getLeft()>=this.options.left&&t.getRight()<=this.options.right&&t.getTop()<=this.options.top&&t.getBottom()>=this.options.bottom)},add:function(t){t&&(this.options.left=Math.min(this.options.left,t.getLeft()),this.options.right=Math.max(this.options.right,t.getRight()),this.options.top=Math.max(this.options.top,t.getTop()),this.options.bottom=Math.min(this.options.bottom,t.getBottom()))}});mt.createFromLatLngBounds=function(t,e){if(!t)return null;var n=null;if(e&&!e.isEPSG4326()){var i=e.createProj(),r=i.projection.project(t.getSouthWest()),o=i.projection.project(t.getNorthEast());n=new mt({left:r.x,bottom:r.y,right:o.x,top:o.y})}else n=new mt({left:t.getWest(),bottom:t.getSouth(),right:t.getEast(),top:t.getNorth()});return n},mt.createFromPoints=function(t){if(!t||0===t.length)return null;var e=t[0],i=e.x,r=e.y,o=e.x,s=e.y;return t.forEach(function(t){var e=t.x,n=t.y;i=Math.min(i,e),r=Math.min(r,n),o=Math.max(o,e),s=Math.max(s,n)}),new mt({left:i,bottom:r,right:o,top:s})};var vt={lastId:0,stamp:function(){return++this.lastId},projTransform:function(t,e,n){if(!t||!e||!n)return null;var i=e.projection.unproject(t);return i?n.projection.project(i):null},clone:function(t){var e=this.typeof(t),n=void 0,i=void 0,r=void 0;if("array"===e)n=[];else{if("object"!==e)return t;n={}}if("array"===e){for(i=0,r=t.length;i<r;i++)n.push(this.clone(t[i]));return n}if("object"!==e)return null;for(i in t){var o=t[i];o&&o.clone?n[i]=o.clone():n[i]=this.clone(o)}return n},typeof:function(t){var e=Object.prototype.toString;return t instanceof Element?"element":{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[e.call(t)]},extend:function(t){var e,n=void 0,i=void 0,r=void 0;for(i=1,e=arguments.length;i<e;i++)for(n in r=arguments[i])t[n]=r[n];return t},mergeOptions:function(t){if(!t)return null;t.options||(t.options={});var e,n=void 0,i=void 0,r=void 0;for(i=1,e=arguments.length;i<e;i++)for(n in r=arguments[i])t.options[n]=r[n];return t.options},getUid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}).toLowerCase()},uniqueArray:function(t){if(!t||0===t.length)return t;var e=new Set(t);return[].concat(b(e))},rotatePoint:function(t,e,n){var i=Math.cos(n),r=Math.sin(n),o=t.x-e.x,s=t.y-e.y;t.x=o*i-s*r+e.x,t.y=o*r+s*i+e.y},getDistance:function(t,e,n,i){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-i,2))},isPointInPoint:function(t,e,n,i,r){return this.getDistance(t,e,n,i)<=r},isPointNearestOnLine:function(t,e,n,i,r,o,s){return this.getNearestDistance(t,e,n,i,r,o)<=s},getNearestDistance:function(t,e,n,i,r,o){var s,a,u;if(s=this.getDistance(t,e,r,o),this.IS0(s))return s;if(a=this.getDistance(n,i,r,o),this.IS0(a))return a;if(u=this.getDistance(t,e,n,i),this.IS0(u))return s;if(a*a+u*u<=s*s)return a;if(s*s+u*u<=a*a)return s;var l=(s+a+u)/2;return 2*Math.sqrt(l*(l-s)*(l-a)*(l-u))/u},IS0:function(t){return-1e-9<t&&t<1e-9},getPointFoot:function(t,e,n,i,r,o){var s=o-i,a=n-r,u=r*i-n*o;return{x:(a*a*t-s*a*e-s*u)/(s*s+a*a),y:(-s*a*t+s*s*e-a*u)/(s*s+a*a)}},convArc2PLine:function(t,e,n,i,r,o,s,a){if(!(t&&e&&n&&i))return!1;var u=a||45*Math.abs(s-o)/Math.PI,l=(s-o)/(u-1),h=0;for(h=0;h<u-1;h++){var c=new G.Point(0,0);c.x=e.x+n*Math.cos(o),c.y=e.y+i*Math.sin(o),t.push(c),o+=l}if(0<u){var p=new G.Point(0,0);p.x=e.x+n*Math.cos(s),p.y=e.y+i*Math.sin(s),t.push(p)}if(!this.IS0(r))for(var f=0;f<t.length;f++)this.rotatePoint(t[f],e,r)}},bt=G.Evented.extend({options:{id:-1,mapPoints:null,polyCount:null,subCount:0,properties:null,projInfo:null,symbol:null,renderItem:null},initialize:function(t){G.setOptions(this,t),this._bounds=null},getID:function(){return this.options.id},setID:function(t){this.options.id=t},getMapPoints:function(){return this.options.mapPoints},setMapPoints:function(t){this.options.mapPoints=t},getSubCount:function(){return this.options.subCount},setSubCount:function(t){this.options.subCount=t},getPolyCount:function(){return this.options.polyCount},setPolyCount:function(t){this.options.polyCount=t},getProperties:function(){return this.options.properties},setProperties:function(t){this.options.properties=t},getProjInfo:function(){return this.options.projInfo},setProjInfo:function(t){this.options.projInfo=t},getRenderItem:function(){return this.options.renderItem},setRenderItem:function(t){this.options.renderItem=t},getSymbol:function(){return this.options.symbol?this.options.symbol:this.options.renderItem&&this.options.renderItem.isVisible()?this.options.renderItem.getSymbol():null},setSymbol:function(t){this.options.symbol=t},getType:function(){return 0},getBounds:function(){var t=this.getMapPoints();return t&&0!==t.length?mt.createFromPoints(t):null},getPixelPoints:function(i,t){var r=this,e=this.options.mapPoints;if(!e||0===e.length)return null;if(this._pixelPoints&&!t)return this._pixelPoints;if(!i)return null;var o=null;return this.options.projInfo&&(o=this.options.projInfo.createProj()),this._pixelPoints=[],e.forEach(function(t){var e=null;e=o&&o.projection&&!r.options.projInfo.isEPSG4326()?o.projection.unproject(t):new G.LatLng(t.y,t.x);var n=i.latLngToLayerPoint(e);r._pixelPoints.push(n)}),this._pixelPoints},toPixelGeometry:function(t,e){var n=this.getPixelPoints(t,e),i=this.getSubCount(),r=this.getPolyCount();return new _t({points:n,subCount:i,polyCount:r})},clone:function(){return vt.clone(this)},transform:function(t){var e=this.clone();if(!t)return e;var n=t.createProj();if(!n)return e;var i=this.getProjInfo(),r=null;if(r=i?i.createProj():G.CRS.EPSG4326,n.code===r.code)return e;var o=e.getMapPoints(),s=[];return o.forEach(function(t){var e=vt.projTransform(t,r,n);s.push(e)}),e.setMapPoints(s),e}}),xt={UNKNOWN:0,POINT:1,LINE:2,POLYGON:3,MULTIPOINT:4,MULTIPOLYGON:5,ZIPPOINT:6,ZIPLINE:7,ZIPPOLYGON:8,ZIPMULTIPOINT:9,ZIPMULTIPOLYGON:10,TEXT:11,Circle:100},Et=bt.extend({initialize:function(t){bt.prototype.initialize.call(this,t)},getSize:function(){var t=this.getSymbol();return t?t.getSize():0},getType:function(){return xt.POINT},getSubCount:function(){return this.options.mapPoints?this.options.mapPoints.length:0},getPolyCount:function(){var t=this.options.mapPoints;if(t&&0<t.length){var n=new Array(t.length);return this.options.mapPoints.forEach(function(t,e){n[e]=1}),n}return null},isMulti:function(){return 1<this.getSubCount()},splitToSingle:function(){var n=this,i=[];this.isMulti()?this.getMapPoints().forEach(function(t){var e=new Et({id:n.getID(),mapPoints:[t],polyCount:[1],subCount:1,properties:n.getProperties(),projInfo:n.getProjInfo(),renderItem:n.getRenderItem()});i.push(e)}):i.push(this);return i},toGeoJSON:function(){var t=this.getMapPoints();if(!t||0===t.length)return null;var e="",n=[];if(1<t.length)e="MultiPoint",t.forEach(function(t){n.push([t.x,t.y])});else{e="Point";var i=t[0];n=[i.x,i.y]}return{type:"Feature",geometry:{type:e,coordinates:n},properties:this.getProperties()}}}),wt=bt.extend({initialize:function(t){bt.prototype.initialize.call(this,t)},getType:function(){return xt.LINE},isMulti:function(){return 1<this.getSubCount()},toGeoJSON:function(){var t=this.getMapPoints();if(!t||0===t.length)return null;var e={},n=[],i=null;if(1===this.getSubCount())e.type="LineString",t.forEach(function(t){n.push([t.x,t.y])});else{e.type="MultiLineString";for(var r=0,o=this.getSubCount(),s=this.getPolyCount(),a=0;a<o;a++){for(var u=[],l=s[a],h=0;h<l;h++)i=t[r+h],u.push([i.x,i.y]);r+=l,n.push(u)}}return e.coordinates=n,{type:"Feature",geometry:e,properties:this.properties}}}),It=bt.extend({initialize:function(t){bt.prototype.initialize.call(this,t)},getType:function(){return xt.POLYGON},toGeoJSON:function(){var t=this.getMapPoints();if(!t||0===t.length)return null;for(var e={type:"Polygon"},n=[],i=0,r=this.getPolyCount(),o=this.getSubCount(),s=0;s<o;s++){for(var a=[],u=r[s],l=0;l<u;l++){var h=t[i+l];a.push([h.x,h.y])}n.push(a),i+=u}return e.coordinates=n,{type:"Feature",geometry:e,properties:this.properties}}}),Lt=bt.extend({initialize:function(t){bt.prototype.initialize.call(this,t),this._polygons=[]},getPolygons:function(){return this._polygons},setPolygons:function(t){this._polygons=t},addPolygon:function(t){this._polygons||(this._polygons=[]),this._polygons.push(t)},getType:function(){return xt.MULTIPOLYGON},toGeoJSON:function(){if(!this._polygons||0===this._polygons.length)return null;for(var t={type:"MultiPolygon"},e=[],n=0;n<this._polygons.length;n++){var i=this._polygons[n];if(i){var r=i.getMapPoints(),o=i.getPolyCount(),s=i.getSubCount();if(r&&!(r.length<2)&&o&&0!==o.length&&0!==s){for(var a=0,u=[],l=0;l<s;l++){for(var h=[],c=o[l],p=0;p<c;p++){var f=r[a+p];h.push([f.x,f.y])}u.push(h),a+=c}e.push(u)}}}return t.coordinates=e,{type:"Feature",geometry:t,properties:this.properties}}});bt.createFeatureFromGeoJSON=function(t){if(!t)return null;"Feature"===t.type&&(t=t.geometry);var e=t.id?t.id:-1,n=t.coordinates;if(!n||0===n.length)return null;var i=void 0,r=void 0,o=void 0,s=void 0,a=void 0,u=[],l=[];switch(t.type){case"Point":return a=new G.Point(n[0],n[1]),new Et({mapPoints:[a],polyCount:[1],subCount:1,id:e});case"MultiPoint":for(o=n.length,i=0;i<o;i++){var h=n[i];a=new G.Point(h[0],h[1]),u.push(a)}return l=Array.apply(void 0,b(new Array(u.length))).map(function(){return 1}),new Et({mapPoints:u,polyCount:l,subCount:u.length,id:e});case"LineString":case"MultiLineString":if(!n[0])return null;var c=n[0];if(G.Util.isArray(c[0])){for(o=n.length,i=0;i<o;i++){var p=n[i];if(p&&0<p.length)for(s=p.length,l.push(s),r=0;r<s;r++)a=p[r],u.push(new G.Point(a[0],a[1]))}return new wt({mapPoints:u,polyCount:l,subCount:o,id:e})}for(o=n.length,i=0;i<o;i++)a=n[i],u.push(new G.Point(a[0],a[1]));return new wt({mapPoints:u,polyCount:[u.length],subCount:1,id:e});case"Polygon":for(o=n.length,i=0;i<o;i++){var f=n[i];if(f&&0<f.length)for(s=f.length,l.push(s),r=0;r<s;r++)a=f[r],u.push(new G.Point(a[0],a[1]))}return new It({mapPoints:u,polyCount:l,subCount:o,id:e});case"MultiPolygon":for(var d=n.length,g=new Lt({id:e}),y=0;y<d;y++){var _=n[y];for(o=_.length,l=[],u=[],i=0;i<o;i++){var m=_[i];if(m&&0<m.length)for(s=m.length,l.push(s),r=0;r<s;r++)a=m[r],u.push(new G.Point(a[0],a[1]))}var v=new It({mapPoints:u,polyCount:l,subCount:o,id:-1});g.addPolygon(v)}return g}return null};var St="geographic",Mt="arithmetic",Ct={renderItemId:"",renderItem:null,layerIndexList:[]},Pt=function(){function e(t){h(this,e),this.options=vt.mergeOptions(this,Ct,t)}return c(e,[{key:"readJson",value:function(t){this.options.renderItemId=t.render_item_id,this.options.layerIndexList=t.symbol_layer_level_list}},{key:"toJson",value:function(t){t.render_item_id=this.options.renderItemId,t.symbol_layer_level_list=this.options.layerIndexList}},{key:"getRenderItemId",value:function(){return this.options.renderItemId}},{key:"setRenderItemId",value:function(t){this.options.renderItemId=t}},{key:"getRenderItem",value:function(){return this.options.renderItem}},{key:"setRenderItem",value:function(t){this.options.renderItem=t}},{key:"getLayerIndexList",value:function(){return this.options.layerIndexList}},{key:"setLayerIndexList",value:function(t){this.options.layerIndexList=t}}]),e}(),Nt={legendClasses:null,isMerged:!1},Ot=function(){function e(t){h(this,e),this.options=vt.mergeOptions(this,Nt,t)}return c(e,[{key:"readJson",value:function(t){var n=this;t&&(this.options.isMerged=t.symbols_are_grduated,t.legend_class_list&&0<t.legend_class_list.length&&(this.options.legendClasses=[],t.legend_class_list.forEach(function(t){var e=new Pt;e.readJson(t),n.options.legendClasses.push(e)})))}},{key:"toJson",value:function(t){if(t)if(t.symbols_are_grduated=this.options.isMerged,this.options.legendClasses&&0<this.options.legendClasses.length){var n=[];this.options.legendClasses.forEach(function(t){var e={};t.toJson(e),n.push(e)}),t.legend_class_list=n}else t.legend_class_list=null}},{key:"getLegendClasses",value:function(){return this.options.legendClasses}},{key:"setLegendClasses",value:function(t){this.options.legendClasses=t}},{key:"isMerged",value:function(){return this.options.isMerged}},{key:"setIsMerged",value:function(t){this.options.isMerged=t}},{key:"getLayerIndexList",value:function(){var t=this.options.legendClasses;if(!t||0===t.length)return null;var n=[];return t.forEach(function(t){var e=t.getLayerIndexList();e&&0!==e.length&&e.forEach(function(t){-1!==t&&-1===n.indexOf(t)&&n.push(t)})}),n.sort(),n}}]),e}(),Tt="",Rt="simple_marker_symbol",kt="char_marker_symbol",Dt="picture_marker_symbol",At="arrow_marker_symbol",Ft="multi_layer_marker_symbol",Gt="simple_line_symbol",Bt="carto_line_symbol",Ut="marker_line_symbol",qt="hash_line_symbol",jt="multi_layer_line_symbol",zt="simple_fill_symbol",Vt="gradient_fill_symbol",Yt="marker_fill_symbol",Ht="line_fill_symbol",Xt="picture_fill_symbol",Wt="multi_layer_fill_symbol",Jt="text_symbol",Kt="unknow_symbol",Zt="mark_symbol",Qt="line_symbol",$t="fill_symbol",te="text_symbol",ee=A(function(t,e){var n;n=function(){var u=null,l={};function h(t){for(var e in 334<=t&&t<=360&&(t-=360),l){var n=l[e];if(n.hueRange&&t>=n.hueRange[0]&&t<=n.hueRange[1])return l[e]}return"Color not found"}function c(t){if(null===u)return Math.floor(t[0]+Math.random()*(t[1]+1-t[0]));var e=t[1]||1,n=t[0]||0,i=(u=(9301*u+49297)%233280)/233280;return Math.floor(n+i*(e-n))}function t(t,e,n){var i=n[0][0],r=n[n.length-1][0],o=n[n.length-1][1],s=n[0][1];l[t]={hueRange:e,lowerBounds:n,saturationRange:[i,r],brightnessRange:[o,s]}}function p(t){var e=t[0];0===e&&(e=1),360===e&&(e=359),e/=360;var n=t[1]/100,i=t[2]/100,r=Math.floor(6*e),o=6*e-r,s=i*(1-n),a=i*(1-o*n),u=i*(1-(1-o)*n),l=256,h=256,c=256;switch(r){case 0:l=i,h=u,c=s;break;case 1:l=a,h=i,c=s;break;case 2:l=s,h=i,c=u;break;case 3:l=s,h=a,c=i;break;case 4:l=u,h=s,c=i;break;case 5:l=i,h=s,c=a}var p=[Math.floor(255*l),Math.floor(255*h),Math.floor(255*c)];return p}function f(t){var e=t[0],n=t[1]/100,i=t[2]/100,r=(2-n)*i;return[e,Math.round(n*i/(r<1?r:2-r)*1e4)/100,r/2*100]}return t("monochrome",null,[[0,0],[100,0]]),t("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),t("orange",[19,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),t("yellow",[47,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),t("green",[63,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),t("blue",[179,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),t("purple",[258,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),t("pink",[283,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]),function t(e){if(void 0!==(e=e||{}).seed&&null!==e.seed&&e.seed===parseInt(e.seed,10))u=e.seed;else if("string"==typeof e.seed)u=function(t){for(var e=0,n=0;n!==t.length&&!(e>=Number.MAX_SAFE_INTEGER);n++)e+=t.charCodeAt(n);return e}(e.seed);else{if(void 0!==e.seed&&null!==e.seed)throw new TypeError("The seed value must be an integer or string");u=null}var n,i,r,o;if(null===e.count||void 0===e.count)return function(t,e){switch(e.format){case"hsvArray":return t;case"hslArray":return f(t);case"hsl":var n=f(t);return"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)";case"hsla":var i=f(t),r=e.alpha||Math.random();return"hsla("+i[0]+", "+i[1]+"%, "+i[2]+"%, "+r+")";case"rgbArray":return p(t);case"rgb":var o=p(t);return"rgb("+o.join(", ")+")";case"rgba":var s=p(t),r=e.alpha||Math.random();return"rgba("+s.join(", ")+", "+r+")";default:return function(t){var e=p(t);function n(t){var e=t.toString(16);return 1==e.length?"0"+e:e}return"#"+n(e[0])+n(e[1])+n(e[2])}(t)}}([(r=e,o=c(function(t){if("number"==typeof parseInt(t)){var e=parseInt(t);if(e<360&&0<e)return[e,e]}if("string"==typeof t)if(l[t]){var n=l[t];if(n.hueRange)return n.hueRange}else if(t.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var i=function(t){t=3===(t=t.replace(/^#/,"")).length?t.replace(/(.)/g,"$1$1"):t;var e=parseInt(t.substr(0,2),16)/255,n=parseInt(t.substr(2,2),16)/255,i=parseInt(t.substr(4,2),16)/255,r=Math.max(e,n,i),o=r-Math.min(e,n,i),s=r?o/r:0;switch(r){case e:return[(n-i)/o%6*60||0,s,r];case n:return[60*((i-e)/o+2)||0,s,r];case i:return[60*((e-n)/o+4)||0,s,r]}}(t)[0];return[i,i]}return[0,360]}(r.hue)),o<0&&(o=360+o),n=o),i=function(t,e){if("monochrome"===e.hue)return 0;if("random"===e.luminosity)return c([0,100]);var n=h(t).saturationRange,i=n[0],r=n[1];switch(e.luminosity){case"bright":i=55;break;case"dark":i=r-10;break;case"light":r=55}return c([i,r])}(n,e),function(t,e,n){var i=function(t,e){for(var n=h(t).lowerBounds,i=0;i<n.length-1;i++){var r=n[i][0],o=n[i][1],s=n[i+1][0],a=n[i+1][1];if(r<=e&&e<=s){var u=(a-o)/(s-r),l=o-u*r;return u*e+l}}return 0}(t,e),r=100;switch(n.luminosity){case"dark":r=i+20;break;case"light":i=(r+i)/2;break;case"random":i=0,r=100}return c([i,r])}(n,i,e)],e);var s=e.count,a=[];for(e.count=null;s>a.length;)u&&e.seed&&(e.seed+=1),a.push(t(e));return e.count=s,a}}(),t&&t.exports&&(e=t.exports=n),e.randomColor=n}).randomColor,ne=function(){function r(t,e,n,i){h(this,r),this.red=t||0,this.green=e||0,this.blue=n||0,this.alpha=void 0!==i?i:255}return c(r,null,[{key:"createRGBAColor",value:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var n=new r;return n.alpha=e,n.red=this.getRed(t),n.green=this.getGreen(t),n.blue=this.getBlue(t),n}},{key:"getRed",value:function(t){return t>>16}},{key:"getGreen",value:function(t){return t>>8&255}},{key:"getBlue",value:function(t){return 255&t}},{key:"createRandom",value:function(){var t=ee({format:"rgbArray",luminosity:"light"});return t&&4<=t.length&&(t[3]*=255),t=this.createFromArray(t)}},{key:"createFromArray",value:function(t){if(!t||t.length<3)return null;var e=new r(t[0],t[1],t[2]);return 3<t.length&&(e.alpha=t[3]),e}}]),c(r,[{key:"getColorValue",value:function(){return this.red<<16|this.green<<8|this.blue}},{key:"hexValue",value:function(){var t=this.red.toString(16),e=this.green.toString(16),n=this.blue.toString(16);return"#"+(this.red<16?"0"+t:t)+(this.green<16?"0"+e:e)+(this.blue<16?"0"+n:n)}},{key:"toArray",value:function(){return[this.red,this.green,this.blue,this.alpha]}},{key:"getStrColor",value:function(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha/255+")"}},{key:"clone",value:function(){return gt.clone(this)}}]),r}(),ie={name:"",label:"",color:null,group:""},re=function(){function e(t){h(this,e),this.mergeOptions(ie,t),this.options.color||(this.options.color=ne.createRandom()),this.id=gt.getUid(),this.class=Tt,this.type=Kt}return c(e,[{key:"mergeOptions",value:function(){this.options||(this.options={}),gt.extend.apply(gt,[this.options].concat(Array.prototype.slice.call(arguments)))}}]),c(e,[{key:"readJson",value:function(t){this.id=t.id,this.options.name=t.name,this.options.label=t.label,this.options.group=t.group,this.options.color=ne.createFromArray(t.color)}},{key:"toJson",value:function(t){t&&(t.id=this.id,t.class=this.class,t.name=this.options.name,t.label=this.options.label,t.group=this.options.group,this.options.color?t.color=this.options.color.toArray():t.color=null)}},{key:"clone",value:function(){var t={};return this.toJson(t),e.readFromJson(t)}},{key:"setName",value:function(t){this.options.name=t}},{key:"getName",value:function(){return this.options.name}},{key:"setLabel",value:function(t){this.options.label=t}},{key:"getLabel",value:function(){return this.options.label}},{key:"getColor",value:function(){return this.options.color}},{key:"setColor",value:function(t){this.options.color=t}},{key:"getGroup",value:function(){return this.options.group}},{key:"setGroup",value:function(t){this.options.group=t}},{key:"getID",value:function(){return this.id}},{key:"getClass",value:function(){return this.class}},{key:"getType",value:function(){return this.type}},{key:"getSymbolLayerCount",value:function(){return 1}},{key:"getSymbolLayer",value:function(t){return this}}]),e}(),oe={id:"",symbol:null,name:"",label:"",visible:!0},se=function(){function e(t){h(this,e),this.options=vt.mergeOptions(this,oe,t),this.options.id||(this.options.id=vt.getUid())}return c(e,[{key:"readJson",value:function(t){t&&(this.options.id=t.id,this.options.name=t.name,this.options.label=t.label,this.options.visible=t.visible,t.symbol&&(this.options.symbol=re.readFromJson(t.symbol)))}},{key:"toJson",value:function(t){if(t)if(t.id=this.options.id,t.name=this.options.name,t.label=this.options.label,t.visible=this.options.visible,this.options.symbol){var e={};this.options.symbol.toJson(e),t.symbol=e}else t.symbol=null}},{key:"getID",value:function(){return this.options.id}},{key:"setID",value:function(t){this.options.id=t}},{key:"getSymbol",value:function(){return this.options.symbol}},{key:"setSymbol",value:function(t){this.options.symbol=t}},{key:"getName",value:function(){return this.options.name}},{key:"setName",value:function(t){this.options.name=t}},{key:"getLabel",value:function(){return this.options.label}},{key:"setLabel",value:function(t){this.options.label=t}},{key:"isVisible",value:function(){return this.options.visible}},{key:"setVisible",value:function(t){this.options.visible=t}},{key:"clone",value:function(){var t=vt.extend({},this.options);return t.symbol=this.options.symbol?this.options.symbol.clone():null,new e(t)}}]),e}(),ae={UNKNOWN:0,POINT:1,LINE:2,POLYGON:3,TEXT:4,NETWORK:5,TABULAR:6,FLOW:7},ue=0,le=1,he=8,ce=0,pe=function t(e){h(this,t),e||(e={}),this.test_mask=void 0!==e.test_mask?e.test_mask:le,this.set_mask=void 0!==e.set_mask?e.set_mask:le,this.set_value=void 0!==e.set_value?e.set_value:le,this.elem_range_type=void 0!==e.elem_range_type?e.elem_range_type:ce,this.avoid_edge=void 0===e.avoid_edge||e.avoid_edge,this.entire_visble=void 0!==e.entire_visble?e.entire_visble:1},fe={defaultRenderItem:null,legendGroup:null,rotationField:"",rotationType:St,sizeField:"",colorField:"",transparencyField:"",transPercent:0,avoidFlag:le},de=function(){function e(t){h(this,e),this.options=vt.mergeOptions(this,fe,t),this.type=""}return c(e,[{key:"readJson",value:function(t){t&&(this.options.avoidFlag=t.avoid_flag||ue,t.color_renderer&&(this.options.colorField=t.color_renderer.field),t.rotation_renderer&&(this.options.rotationField=t.rotation_renderer.field,this.options.rotationType=t.rotation_renderer.rotation_type),t.size_renderer&&(this.options.sizeField=t.size_renderer.field),t.transparency_renderer&&(this.options.transparencyField=t.transparency_renderer.field),this.options.transPercent=t.transpercent,t.legend_group&&(this.options.legendGroup=new Ot,this.options.legendGroup.readJson(t.legend_group)),t.default_render_item&&(this.options.defaultRenderItem=new se,this.options.defaultRenderItem.readJson(t.default_render_item)))}},{key:"toJson",value:function(t){if(t){if(t.avoid_flag=this.options.avoidFlag,t.class=this.type,t.color_renderer={field:this.options.colorField},t.rotation_renderer={field:this.options.rotationField,rotation_type:this.options.rotationType},t.size_renderer={field:this.options.sizeField},t.transparency_renderer={field:this.options.transparencyField},t.transpercent=this.options.transPercent,this.options.legendGroup){var e={};this.options.legendGroup.toJson(e),t.legend_group=e}else t.legend_group=null;if(this.options.defaultRenderItem){var n={};this.options.defaultRenderItem.toJson(n),t.default_render_item=n}else t.default_render_item=null}}},{key:"setDefaultRenderItem",value:function(t){this.options.defaultRenderItem=t}},{key:"getDefaultRenderItem",value:function(){return this.options.defaultRenderItem}},{key:"getLegendGroup",value:function(){return this.options.legendGroup}},{key:"setLegendGroup",value:function(t){this.options.legendGroup=t}},{key:"getRotationField",value:function(){return this.options.rotationField}},{key:"setRotationField",value:function(t){this.options.rotationField=t}},{key:"getRotationType",value:function(){return this.options.rotationType}},{key:"setRotationType",value:function(t){this.options.rotationType=t}},{key:"getSizeField",value:function(){return this.options.sizeField}},{key:"setSizeField",value:function(t){this.options.sizeField=t}},{key:"getTransparencyField",value:function(){return this.options.transparencyField}},{key:"setTransparencyField",value:function(t){this.options.transparencyField=t}},{key:"getTransPercent",value:function(){return this.options.transPercent}},{key:"setTransPercent",value:function(t){this.options.transPercent=t}},{key:"getColorField",value:function(){return this.options.colorField}},{key:"setColorField",value:function(t){this.options.colorField=t}},{key:"getUsedFields",value:function(){var t=[];return this.options.rotationField&&t.push(this.options.rotationField),this.options.sizeField&&t.push(this.options.sizeField),this.options.colorField&&t.push(this.options.colorField),this.options.transparencyField&&t.push(this.options.transparencyField),vt.uniqueArray(t)}},{key:"findRenderItem",value:function(t,e){var n=this.options.defaultRenderItem;return this.isDynamic(t)&&(n=this.changeStyleByField(n,t,e)),n.isVisible()?n:null}},{key:"bDrawByLegendGroup",value:function(){var t=this.getLegendGroup();return!(!t||!t.isMerged())}},{key:"isDynamic",value:function(t){var e=!1;return t===ae.POINT?(this.options.rotationField||this.options.sizeField||this.options.colorField)&&(e=!0):t===ae.POLYGON&&this.options.transparencyField&&(e=!0),e}},{key:"changeStyleByField",value:function(t,e,n){if(!t||!t.symbol||!n)return t;var i=t.clone(),r=i.getSymbol();if(e===ae.POINT){if(this.options.rotationField){var o=n[this.options.rotationField.toLowerCase()]||0;this.options.rotationType===Mt&&(o=-1*(o-90)),r.setAngle(o)}if(this.options.sizeField){var s=n[this.options.sizeField.toLowerCase()];s&&r.setSize(s)}if(this.options.colorField){var a=n[this.options.colorField.toLowerCase()]||0,u=ne.createRGBAColor(a);a&&r.setColor(u)}}else if(e===ae.POLYGON&&this.options.transparencyField){var l=n[this.options.transparencyField.toLowerCase()]||0;l=255*(1-(l=parseInt(l))%100/100),r.setTranspercent(l)}return i}},{key:"getAvoidFlag",value:function(){return this.options.avoidFlag}},{key:"setAvoidFlag",value:function(t){this.options.avoidFlag=t}}]),e}(),ge={SYMBOLIC_SIMPLE:"simple_render",SYMBOLIC_UNIQUE_VALUE:"unique_value_render",SYMBOLIC_CLASS_BREAKS:"class_breaks_render"},ye={},_e=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.options=vt.mergeOptions(e,ye,t),e.type=ge.SYMBOLIC_SIMPLE,e}return d(n,de),c(n,[{key:"readJson",value:function(t){t&&f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t)}},{key:"toJson",value:function(t){t&&f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t)}}]),n}(),me={minBreak:0,maxBreak:0},ve=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.options=vt.mergeOptions(e,me,t),e}return d(n,se),c(n,[{key:"readJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.minBreak=t.maxinum_break,this.options.maxBreak=t.mininum_break)}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.maxinum_break=this.options.minBreak,t.mininum_break=this.options.maxBreak)}},{key:"getMinBreak",value:function(){return this.options.minBreak}},{key:"setMinBreak",value:function(t){this.options.minBreak=t}},{key:"getMaxBreak",value:function(){return this.options.maxBreak}},{key:"setMaxBreak",value:function(t){this.options.maxBreak=t}},{key:"clone",value:function(){var t=vt.extend({},this.options);return t.symbol=this.options.symbol?this.options.symbol.clone():null,new n(t)}}]),n}(),be={uniqueValues:[]},xe=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.options=vt.mergeOptions(e,be,t),e}return d(n,se),c(n,[{key:"readJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.uniqueValues=t.unique_value_list)}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.unique_value_list=this.options.uniqueValues)}},{key:"clone",value:function(){var t=vt.extend({},this.options);return t.symbol=this.options.symbol?this.options.symbol.clone():null,new n(t)}},{key:"getUniqueValues",value:function(){return this.options.uniqueValues}},{key:"setUniqueValues",value:function(t){this.options.uniqueValues=t}}]),n}(),Ee={items:null},we=function(t){function o(t){h(this,o);var e=y(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.options=vt.mergeOptions(e,Ee,t),e}return d(o,de),c(o,[{key:"readJson",value:function(i){if(i&&(f(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"readJson",this).call(this,i),i.render_item_list&&0<i.render_item_list.length)){var r=[];i.render_item_list.forEach(function(t){if(i.type===ge.SYMBOLIC_CLASS_BREAKS){var e=new ve;e.readJson(t),r.push(e)}else if(i.type===ge.SYMBOLIC_UNIQUE_VALUE){var n=new xe;n.readJson(t),r.push(n)}}),this.setItems(r)}}},{key:"toJson",value:function(t){if(t)if(f(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"toJson",this).call(this,t),this.options.items&&0<this.options.items.length){var n=[];this.options.items.forEach(function(t){var e={};t.toJson(e),n.push(e)}),t.render_item_list=n}else t.render_item_list=null}},{key:"getItems",value:function(){return this.options.items}},{key:"setItems",value:function(t){this.options.items=t}},{key:"getItemByName",value:function(t){var e=this.options.items;if(!e||0===e.length)return null;for(var n=0;n<e.length;n++){var i=e[n];if(i&&i.getName()===t)return i}return null}}]),o}(),Ie={classifyFields:[],colorBandIdx:-1},Le=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.options=vt.mergeOptions(e,Ie,t),e.type=ge.SYMBOLIC_UNIQUE_VALUE,e}return d(n,we),c(n,[{key:"readJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.classifyFields=t.field_list,this.options.colorBandIdx=t.color_band_index)}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.field_list=this.options.classifyFields,t.color_band_index=this.options.colorBandIdx)}},{key:"getClassifyFields",value:function(){return this.options.classifyFields}},{key:"setClassifyFields",value:function(t){this.options.classifyFields=t}},{key:"getUsedFields",value:function(){var t=f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getUsedFields",this).call(this);return t||(t=[]),this.options.classifyFields&&0<this.options.classifyFields.length&&(t=t.concat(this.options.classifyFields)),vt.uniqueArray(t)}},{key:"findRenderItem",value:function(t,e){var n=this.getDefaultRenderItem(),i=this.getItems();if(i&&i.length&&this.options.classifyFields&&0<this.options.classifyFields.length)for(var r=this.options.classifyFields,o=r.length,s=0;s<i.length;s++){var a=i[s];if(a){var u=a.getUniqueValues();if(u&&u.length===r.length){for(var l=!0,h=0;h<o;h++){if(e[r[h].toLowerCase()]!==u[h]){l=!1;break}}if(l){n=a;break}}}}return this.isDynamic(t)&&(n=this.changeStyleByField(n,t,e)),n.isVisible()?n:null}}]),n}(),Se={field:"",colorBandIdx:-1},Me=function(t){function i(t){h(this,i);var e=y(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.options=vt.mergeOptions(e,Se,t),e.type=ge.SYMBOLIC_CLASS_BREAKS,e}return d(i,we),c(i,[{key:"readJson",value:function(t){if(t&&(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"readJson",this).call(this,t),this.options.field=t.field,this.options.colorBandIdx=t.color_band_index,t.render_item_list&&0<t.render_item_list.length)){var n=[];t.render_item_list.forEach(function(t){var e=new ve;e.readJson(t),n.push(e)}),this.setItems(n)}}},{key:"toJson",value:function(t){t&&(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJson",this).call(this,t),t.field=this.options.field,t.color_band_index=this.options.colorBandIdx)}},{key:"getField",value:function(){return this.options.field}},{key:"setField",value:function(t){this.options.field=t}},{key:"getUsedFields",value:function(){var t=f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"getUsedFields",this).call(this);return t||(t=[]),this.options.field&&t.push(this.options.field),vt.uniqueArray(t)}},{key:"findRenderItem",value:function(t,e){var n=this.getDefaultRenderItem(),i=this.getItems();if(i&&i.length&&this.options.field){var r=e[this.options.field.toLowerCase()];if(void 0!==r){r=parseFloat(r);for(var o=0;o<i.length;o++){var s=i[o];if(s){var a=parseFloat(s.getMinBreak()),u=parseFloat(s.getMaxBreak());if(a<=r&&r<=u){n=s;break}}}}}return this.isDynamic(t)&&(n=this.changeStyleByField(n,t,e)),n.isVisible()?n:null}}]),i}();de.readFromJson=function(t){if(!t)return null;var e=null;switch(t.class){case ge.SYMBOLIC_SIMPLE:(e=new _e).readJson(t);break;case ge.SYMBOLIC_UNIQUE_VALUE:(e=new Le).readJson(t);break;case ge.SYMBOLIC_CLASS_BREAKS:(e=new Me).readJson(t)}return e},de.createDefault=function(t){var e=null;switch(t){case ae.POINT:e=re.createDefaultSymbol(Zt);break;case ae.LINE:e=re.createDefaultSymbol(Qt);break;case ae.POLYGON:e=re.createDefaultSymbol($t)}var n=new se({symbol:e});return new _e({defaultRenderItem:n})};var Ce="",Pe="simple_render_text_style",Ne="multi_render_text_style",Oe={priorityField:"",enable:!1,isRelate:!1,avoidFlag:le|he,ignoreFieldValues:null,maxScale:0,minScale:0,labelWeight:0},Te=function(){function e(t){h(this,e),this.mergeOptions(Oe,t),this.type=Ce,this._isQuery=!1}return c(e,[{key:"mergeOptions",value:function(){this.options||(this.options={}),vt.extend.apply(vt,[this.options].concat(Array.prototype.slice.call(arguments)))}}]),c(e,[{key:"readJson",value:function(t){t&&(this.options.priorityField=t.priority_field,this.options.enable=t.enable,this.options.isRelate=t.has_relate,this.options.avoidFlag=t.avoid_flag,this.options.ignoreFieldValues=t.excluded_label_list,this.options.maxScale=t.max_scale||0,this.options.minScale=t.min_scale||0,this.options.labelWeight=t.label_weight||0)}},{key:"toJson",value:function(t){t&&(t.class=this.type,t.priority_field=this.options.priorityField,t.enable=this.options.enable,t.has_relate=this.options.isRelate,t.avoid_flag=this.options.avoidFlag,t.excluded_label_list=this.options.ignoreFieldValues,t.max_scale=this.options.maxScale||0,t.min_scale=this.options.minScale||0,t.label_weight=this.options.labelWeight||0)}},{key:"getPriorityField",value:function(){return this.options.priorityField}},{key:"setPriorityField",value:function(t){this.options.priorityField=t}},{key:"isEnable",value:function(){return this.options.enable}},{key:"setEnable",value:function(t){this.options.enable=t}},{key:"isRelate",value:function(){return this.options.isRelate}},{key:"setIsRelate",value:function(t){this.options.isRelate=t}},{key:"getAvoidFlag",value:function(){return this.options.avoidFlag}},{key:"setAvoidFlag",value:function(t){this.options.avoidFlag=t}},{key:"getIgnoreFieldValues",value:function(){return this.options.ignoreFieldValues}},{key:"setIgnoreFieldValues",value:function(t){this.options.ignoreFieldValues=t}},{key:"getMaxScale",value:function(){return this.options.maxScale}},{key:"setMaxScale",value:function(t){this.options.maxScale=t}},{key:"getMinScale",value:function(){return this.options.minScale}},{key:"setMinScale",value:function(t){this.options.minScale=t}},{key:"getLabelWeight",value:function(){return this.options.labelWeight}},{key:"setLabelWeight",value:function(t){this.options.labelWeight=t}},{key:"getUsedFields",value:function(){var e=[];return this.options.priorityField&&e.push(this.options.priorityField),this.options.ignoreFieldValues&&0<this.options.ignoreFieldValues.length&&this.options.ignoreFieldValues.forEach(function(t){t&&t.field_name&&e.push(t.field_name)}),vt.uniqueArray(e)}},{key:"isQuery",value:function(t){if(void 0===t)return this._isQuery;if(this._isQuery=!1,!this.isEnable())return!1;if(0<=t){t=1/t;var e=this.options.minScale,n=this.options.maxScale;if(0===n&&0===e)return this._isQuery=!0;if(0===n&&0<e&&1/e<=t)return this._isQuery=!0;if(0<n&&0===e&&t<=1/n)return this._isQuery=!0;if(0<n&&0<e&&t<=1/n&&1/e<=t)return this._isQuery=!0}return!1}},{key:"isSortByPriority",value:function(){return!!this.options.priorityField}},{key:"isIgnore",value:function(t){if(t=t||{},this.options.ignoreFieldValues&&0<this.options.ignoreFieldValues.length)for(var e=this.options.ignoreFieldValues,n=0;n<e.length;n++){var i=e[n],r=i.field_name,o=i.value_list,s=t[r];if(-1!==o.indexOf(s))return!0}return!1}}]),e}(),Re=0,ke=1,De="",Ae="marker_label_position",Fe="line_label_position",Ge="fill_label_position",Be="around_point",Ue="on_point_top",qe="specified_angle",je="angle_field",ze=0,Ve=1,Ye=2,He=3,Xe=4,We=5,Je=6,Ke=7,Ze=0,Qe=1,$e=2,tn=3,en=4,nn=1,rn=2,on=4,sn=0,an={duplicateLabels:ke},un=function(){function e(t){h(this,e),this.options=this.mergeOptions(an,t),this.type=De}return c(e,[{key:"mergeOptions",value:function(){this.options||(this.options={}),vt.extend.apply(vt,[this.options].concat(Array.prototype.slice.call(arguments)))}}]),c(e,[{key:"readJson",value:function(t){t&&(this.options.duplicateLabels=t.duplicate_labels)}},{key:"toJson",value:function(t){t&&(t.class=this.type,t.duplicate_labels=this.options.duplicateLabels)}},{key:"getType",value:function(){return this.type}},{key:"getDuplicateLabels",value:function(){return this.options.duplicateLabels}},{key:"setDuplicateLabels",value:function(t){this.options.duplicateLabels=t}},{key:"clone",value:function(){var t={};return this.toJson(t),e.createFromJson(t)}}]),e}(),ln={blockOpen:"(",blockClose:")",escapeOpen:"'",escapeClose:"'",sentinels:["and","or","&&","||","not"],operators:["=","<",">","!"],textEscape:["'"],compare_operator:{"=":function(t,e){return t==e},"<>":function(t,e){return t!=e},"!=":function(t,e){return t!=e},">":function(t,e){return e<t},">=":function(t,e){return e<=t},"<":function(t,e){return t<e},"<=":function(t,e){return t<=e},or:function(t,e){return t||e},and:function(t,e){return t&&e},is:function(t,e){return t==e},like:function(t,e){return!!t&&-1<t.indexOf(e)},not:function(t){return!t}},getFilterFields:function(t){if(!t)return null;var e=[];return function t(e,n){if(e&&0!=e.length)for(var i=e.length,r=0;r<i;r++){var o=e[r];"array"==(Array.isArray(o)?"array":void 0===o?"undefined":g(o))?t(o,n):"expression"==o.type&&o.key&&n.push(o.key)}}(this.parse(t),e),e},compareFilter:function(t,e){if(!t)return!0;if(!e)return!1;var n=this.parse(t);return!(!n||0==n.length)&&this.compareItems(n,e)},compareItems:function(t,e){if(!t||!e||0==t.length)return!1;for(var n=t.length,i=!0,r="",o=!1,s=function(t){o&&(t=!t,o=!1),i="and"==r.toLowerCase()?i&&t:"or"==r.toLowerCase()&&i||t},a=0;a<n;a++){var u=t[a],l="";"array"==(Array.isArray(u)?"array":void 0===u?"undefined":g(u))?s(this.compareItems(u,e)):"expression"==u.type?s(this.compareItem(u,e)):"conjunction"==u.type&&(l="not"==u.value.toLowerCase()?(o=!0,r):u.value),r=l}return i},compareItem:function(t,e){if(!t||!e||null==e[t.key.toLowerCase()]&&null==e[t.key.toUpperCase()])return!1;var n=null==e[t.key.toLowerCase()]?e[t.key.toUpperCase()]:e[t.key.toLowerCase()],i=t.value,r=t.operator;return"<"==r?n<i:">"==r?i<n:"="==r?n==i:"<="==r?n<=i:">="==r?i<=n:"<>"==r&&n!=i},parse:function(t){var a=t;if(-1<t.indexOf(" in ")){var e=/(.*?)in\s+\((.*?)\)\s+(and|or)|(.*?)in\s+\((.*?)\)$/g,n="",i=t.length;for(a="";n=e.exec(t);){var r=[],o=[],s="";e.lastIndex!=i?(r=n[1],o=n[2].split(","),s=n[3]):e.lastIndex==i&&(r=n[4],o=n[5].split(","));var u=o.length;a+="(";var l=r.split(":");o.forEach(function(t,e,n){var i=(t=t.replace(/(^\s*\')|(\'\s*$)/g,"")).split(":"),r=i.length,o="";if(e<u-1){for(var s=0;s<r;s++)o+=l[s]+" = "+i[s]+" and ";o=o.slice(0,-4),a+="("+o+") or "}else{for(s=0;s<r;s++)o+=l[s]+" = "+i[s]+" and ";o=o.slice(0,-4),a+="("+o+")"}}),a+=")",""!=s&&(a+=" "+s+" ")}}return this.parse_where(a)},array_contains:function(t,e){return-1!=t.indexOf(e)},parse_where:function(t){var e=this.parse_blocks(t),n=this.parse_compound_phrases(e,[]),i=this,r=this;return n.map(function t(e){return Array.isArray(e)?e.map(t):r.array_contains(i.sentinels,e.toLowerCase())?{type:"conjunction",value:e}:i.parse_discriminant(e)},this)},parse_discriminant:function(t){for(var e,n="",i="",r="",o=!1,s=0;s<t.length;s++)e=t[s],o&&e===o?o=!1:o||!this.array_contains(this.textEscape,e)?this.array_contains(this.operators,e)?i+=e:""!==i?r+=e:n+=e:o=e;return{type:"expression",key:n,operator:i,value:r}},parse_blocks:function(t){for(var e,n=[],i=[],r=!1,o="",s=n,a=0;a<t.length;a++)if(e=t[a],r)o+=e,e===this.escapeClose&&(r=!1);else if(e!==this.escapeOpen)if(e!==this.blockOpen)e!==this.blockClose?o+=e:(""!==o.trim()&&n.push(o),n=i.pop(),o="");else{""!==o.trim()&&n.push(o);var u=[];n.push(u),i.push(n),n=u,o=""}else o+=e,r=!0;return""!==o.trim()&&n.push(o),s},parse_compound_phrases:function(t,i){var r=this;return t.forEach(function(t){var e=Array.isArray(t)?"array":void 0===t?"undefined":g(t);if("array"==e){var n=r.parse_compound_phrases(t,[]);i.push(n)}else"string"==e&&(i=i.concat(r.parse_compound_phrase(t)).filter(function(t){return""!==t}))}),i},parse_compound_phrase:function(t){for(var e,n=!1,i="",r="",o=[""],s=0;s<t.length;s++)e=t[s],n?(o[o.length-1]+=r+e,r="",e===i&&(n=!1)):(this.array_contains(this.textEscape,e)&&(n=!0,i=e)," "!=e?(r+=e,this.array_contains(this.sentinels,r.toLowerCase())&&(o.push(r),o.push(""),r="")):(o[o.length-1]+=r,r=""));return""!=r&&(o[o.length-1]+=r),""===o[o.length-1]&&o.pop(),o},filterByClause:function(t,e){if(!e)return!0;var n=this.parse(e);return this.filterByParsedClause(t,n)},filterByParsedClause:function(t,e){if(!e)return!1;for(var n=e.length,i=0;i<n;i++){if(d=e[i]){var r=null;if(Array.isArray(d))r=this.filterByParsedClause(t,d);else{if(!(a=d.type))continue;if("expression"===a){var o=d.key;if(!o)continue;o=o.toLowerCase();var s=d.operator,a=d.type,u=d.value,l=t[o],h=this.compare_operator[s];h&&(r=h(l,u),d.result=r)}}}}for(var c=0;c<n;c++){if(d=e[c])if(a=d.type)if("conjunction"===a)if("not"===(g=d.value.toLowerCase()))(y=e[c+1]).result=this.compare_operator[g](y.result)}for(var p=null,f=0;f<n;f++){var d;if(d=e[f])if(a=d.type)if("expression"===a&&null===p)p=d.result;else if("conjunction"===a){var g;if("not"===(g=d.value.toLowerCase()))continue;for(var y=e[++f],_=!0;f<n;)"expression"===y.type&&(_=y.result),y=e[++f];p=this.compare_operator[g](p,_)}}return p}},hn=function t(e,n,i,r){h(this,t),this.type=e,this.value=n,this.line=i,this.column=r};hn.EOS="EOS",hn.DOT="DOT",hn.GT="GT",hn.GE="GE",hn.LE="LE",hn.LT="LT",hn.ASSIGN="ASSIGN",hn.EQ="EQ",hn.ELLIPSES="ELLIPSES",hn.CONCAT="CONCAT",hn.NUMBER="NUMBER",hn.KEYWORD="KEYWORD",hn.IDENTIFIER="IDENTIFIER",hn.STRING="STRING",hn.SEMICOLON="SEMICOLON",hn.PLUS="PLUS",hn.MINUS="MINUS",hn.MUL="MUL",hn.DIV="DIV",hn.MOD="MOD",hn.MOD="POW",hn.COMMA="COMMA",hn.LPATTERN="LEFT PATTERN",hn.RPATTERN="RIGHT PATTERN",hn.LBRACKET="LEFT BRACKET",hn.RBRACKET="RIGHT BRACKET",hn.LBRACE="LEFT BRACE",hn.RBRACE="RIGHT BRACE",hn.COMMENT="COMMENT",hn.HASH="#";var cn=function(){function e(t){h(this,e),this.source=t,this.size=t.length,this.pos=0,this.column=1,this.line=1,this.keywords={and:1,break:1,do:1,else:1,elseif:1,end:1,false:1,for:1,function:1,if:1,in:1,local:1,nil:1,not:1,or:1,repeat:1,return:1,then:1,true:1,until:1,while:1}}return c(e,[{key:"is_digit_or_letter",value:function(t){return this.is_digit(t)||this.is_letter(t)}},{key:"is_digit",value:function(t){return!![1,1,1,1,1,1,1,1,1,1][t]}},{key:"is_hex",value:function(t){return/^[0-9a-fA-F]$/.test(t)}},{key:"is_letter",value:function(t){return/^[a-zA-Z_\u4e00-\u9fa5]$/.test(t)}},{key:"lookahead",value:function(t,e){return e?(this.pos+=t,this.source[this.pos]):this.source[this.pos+t]}},{key:"eat",value:function(t){this.pos+=t}},{key:"croak",value:function(){throw new Error("lexer error at "+this.line+":"+this.column)}},{key:"token",value:function(t,e,n){return this.pos+=t,this.column+=t,new hn(e,n,this.line,this.column)}},{key:"scan_integer",value:function(){var t=void 0;if(t=this.lookahead(0),!is_digit(t))return this.croak();for(var e=0;;){if(!is_digit(t))return e;e=10*e+parseInt(t,10),t=this.lookahead(1,!0)}}},{key:"scan_longstring",value:function(){var t=[];"["!=this.lookahead(0)&&this.croak();var e=this.lookahead(1,!0),n=0;if("="==e)for(n++;;){if("="!=(e=this.lookahead(1,!0))){if(e="[")break;return this.croak()}n++}else if("["!=e)return this.croak();for(;;){if("]"==(e=this.lookahead(1,!0))){var i=void 0;for(this.eat(1),i=0;i<n;i++)if("="!=(e=this.lookahead(i))&&null==e)return this.croak();if(i==n){if("]"==(e=this.lookahead(n)))return this.lookahead(2+n,!0),t.join("");if(null==e)return this.croak()}}else if(null==e)return this.croak();t.push(e)}}},{key:"scan",value:function(){for(var t=void 0,e=void 0,n=void 0,i=void 0,r=void 0,o=void 0,s=void 0;;)switch(r=this.lookahead(0),o=this.lookahead(1),s=this.lookahead(2),r){case void 0:return this.token(0,hn.EOS,hn.EOS);case"\f":case"\r":case" ":case"\t":this.column++,this.lookahead(1,!0);continue;case"\n":this.line++,this.column=0,this.lookahead(1,!0);continue;case";":return this.token(1,hn.SEMICOLON,";");case"+":return this.token(1,hn.PLUS,"+");case"-":if("-"!=o)return this.token(1,hn.MINUS,"-");if("["!=s)for(o=this.lookahead(1,!0),i=[];;){if("\n"==(o=this.lookahead(1,!0))||null==o)return this.column++,this.token(0,hn.COMMENT,i.join(""));i.push(o)}return this.lookahead(2,!0),i=this.scan_longstring(),this.token(0,hn.COMMENT,i);case"*":return this.token(1,hn.MUL,"*");case"/":return this.token(1,hn.DIV,"/");case"%":return this.token(1,hn.MOD,"%");case"^":return this.token(1,hn.POW,"%");case",":return this.token(1,hn.COMMA,",");case"(":return this.token(1,hn.LPATTERN,"(");case")":return this.token(1,hn.RPATTERN,")");case"[":return"["==o||"="==o?(n=this.scan_longstring(),this.token(0,hn.STRING,n)):this.token(1,hn.LBRACKET,"[");case"]":return this.token(1,hn.RBRACKET,"]");case"{":return this.token(1,hn.LBRACE,"{");case"}":return this.token(1,hn.RBRACE,"}");case"=":return"="==o?this.token(2,hn.EQ,"=="):this.token(1,hn.ASSIGN,"=");case">":return"="==o?this.token(2,hn.GE,">="):this.token(1,hn.GT,">");case"<":return"="==o?this.token(2,hn.LE,"<="):this.token(1,hn.LT,"<");case"~":return"="==o?this.token(2,hn.NE,"~="):this.croak();case".":return"."==o?"."==s?this.token(3,hn.ELLIPSES,"..."):this.token(2,hn.CONCAT,"+"):this.token(1,hn.DOT,".");case"'":for(n=[];;){if((o=this.lookahead(1,!0))==r)return this.token(1,hn.STRING,n.join(""));if(null==o)return this.croak();n.push(o)}case"#":return this.token(1,hn.HASH,"#");case'"':for(n=[];;){if((o=this.lookahead(1,!0))==r)return this.token(1,hn.STRING,n.join(""));if(null==o)return this.croak();n.push(o)}default:if(this.is_digit(r)){var a=0;if("x"==o||"X"==o){if(this.eat(1),o=this.lookahead(1),!this.is_hex(o))return this.croak();for(;;){if(o=this.lookahead(1,!0),!this.is_hex(o))return this.token(0,hn.NUMBER,a);a=16*a+parseInt(o,16)}}for(o=r;a=10*a+parseInt(o,10),o=this.lookahead(1,!0),this.is_digit(o););if("."==o)for(e=1;o=this.lookahead(1,!0),this.is_digit(o);)a=(e*=.1)*parseInt(o,10)+a;if("E"==o||"e"==o){var u=(e="-"==(o=this.lookahead(1,!0))?(this.eat(1),-1):("+"==o&&this.eat(1),1))*this.scan_integer();a*=Math.pow(10,u)}return this.token(0,hn.NUMBER,a)}if(this.is_letter(r))for(t=[r];;){if(o=this.lookahead(1,!0),!this.is_digit_or_letter(o))return t=t.join(""),this.keywords[t]?this.token(0,hn.KEYWORD,t):this.token(0,hn.IDENTIFIER,t);if(null==o)return this.croak();t.push(o)}return this.croak()}}}]),e}(),pn=function(){function e(t){h(this,e),this.vars={},this.parent=t}return c(e,[{key:"extend",value:function(){return new e(this)}},{key:"lookup",value:function(t){for(var e=this;e;){if(e.vars.hasOwnProperty(t))return e;e=e.parent}return null}},{key:"get",value:function(t){var e=this.lookup(t);if(e)return e.vars[t];throw new Error("Undefined variable "+t)}},{key:"set",value:function(t,e){var n=this.lookup(t);if(!n)throw new Error("Undefined variable "+t);n.vars[t]=e}},{key:"def",value:function(t,e){return this.vars[t]=e}}]),e}(),fn=function(){function e(t){h(this,e),this.ast=t}return c(e,[{key:"to_js",value:function(){return v(this.ast);function v(t){switch(t.type){case"Program":return""+v(t.body);case"Chunk":return t.body.map(v).join("\n");case"LocalStatement":return(m=t).variables.map(function(t,e){return"let "+t.name+" = "+v(m.init[e])}).join("\n");case"Literal":return _=t,JSON.stringify(_.value);case"Identifier":return t.name;case"ExpressionStatement":return v(t.expression);case"CallExpression":return v((y=t).callee)+"("+y.params.map(function(t){return v(t)}).join(",")+")";case"BinaryExpression":return"("+v((g=t).left)+" "+g.op+" "+v(g.right)+")";case"UnaryExpression":return""+function(t){switch(t){case"#-":return"-";default:return t}}((d=t).op)+v(d.argument);case"DoStatement":return"\n{\n\n"+v(t.body)+"\n\n}\n";case"BreakStatement":return"break";case"TableExpression":return f=0,"{"+t.fields.map(function(t){return"Recfield"==t.type?'"'+v(t.key)+'": '+v(t.value):'"'+f+++'": '+v(t.value)}).join(",")+"}";case"MemberExpression":return v((p=t).object)+"."+v(p.property);case"AssignExpression":return(c=t).left.map(function(t,e){return""+v(t)+c.op+v(c.right[e])}).join("\n");case"IfStatement":return l=(u=t).elseif.map(function(t){return"else if ("+v(t.cond)+") {\n                    "+v(t.body)+"\n                }"}).join("\n"),h="",u.else&&(h="else {\n                    "+v(u.else)+"\n                }"),"\nif ("+v(u.cond)+") {\n    "+v(u.body)+"\n}\n"+l+"\n"+h;case"FornumStatement":return"\n            for (let "+v((a=t).id)+" = "+v(a.begin)+"; "+v(a.id)+" < "+v(a.end)+"; "+v(a.id)+" += "+v(a.step)+") {\n                "+v(a.body)+"\n            }\n";case"ForlistStatement":return s=(o=t).left.map(function(t,e){return"let "+v(t)+"=value["+e+"]"}).join("\n"),"\n            for (const iterator = "+v(o.right)+";;) {\n                let value = iterator();\n                if (value[0] == undefined) break\n\n                "+s+"\n                "+v(o.body)+"\n            }";case"WhileStatement":return"while("+v((r=t).cond)+") {\n                "+v(r.body)+"\n            }";case"RepeatStatement":return"\n                for (;;) {\n                    "+v((i=t).body)+"\n                    if ("+v(i.cond)+") {\n                        break\n                    }\n                }\n            ";case"FunctionDeclaration":return n=(e=t).params.map(function(t){return v(t)}).join(","),"function "+v(e.id)+"("+n+") {\n                "+v(e.body)+"\n            }";case"ReturnStatement":return"return "+t.params.map(function(t){return v(t)}).join(",");default:throw new Error("Dunno how to generate for "+JSON.stringify(t))}var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_,m}}}]),e}(),dn={or:function(t,e){return t||e},and:function(t,e){return t&&e},"<":function(t,e){return t<e},">":function(t,e){return e<t},"<=":function(t,e){return t<=e},">=":function(t,e){return e<=t},"==":function(t,e){return t==e},"~=":function(t,e){return t!=e},"..":function(t,e){return""+t+e},"+":function(t,e){return t+e},"-":function(t,e){return t-e},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"^":function(t,e){return math.pow(t,right)},"#-":function(t){return-t},not:function(t){return!t},"#":function(t){if("string"!=typeof t)throw new Error("attempt to get length of a nonstring value");return t.length}},gn=function(){function n(t,e){h(this,n),this.ast=t,this.env=e}return c(n,[{key:"interprete",value:function(){return this.evaluate(this.ast,this.env)}},{key:"evaluate",value:function(t,e){switch(t.type){case"Program":return this.evaluate(t.body,e);case"Chunk":return this.evaluate_chunk(t,e);case"Identifier":return this.evaluate_identifier(t,e);case"Literal":return this.evaluate_literal(t,e);case"AssignExpression":return this.evaluate_assign_expression(t,e);case"LocalStatement":return this.evaluate_local_stat(t,e);case"ExpressionStatement":return this.evaluate_expression_stat(t,e);case"CallExpression":return this.evaluate_call_expression(t,e);case"UnaryExpression":return this.evaluate_unary_expression(t,e);case"BinaryExpression":return this.evaluate_binary_expression(t,e);case"DoStatement":return this.evaluate_do_statment(t,e);case"BreakStatement":return this.evaluate_break_statment(t,e);case"ReturnStatement":return this.evaluate_return_statment(t,e);case"FunctionDeclaration":return this.evaluate_function_declaration(t,e);case"TableExpression":return this.evaluate_table_expression(t,e);case"MemberExpression":return this.evaluate_member_expression(t,e);case"IfStatement":return this.evaluate_if_statement(t,e);case"FornumStatement":return this.evaluate_fornum_statement(t,e);case"ForlistStatement":return this.evaluate_forlist_statement(t,e);case"WhileStatement":return this.evaluate_while_statement(t,e);case"RepeatStatement":return this.evaluate_repeat_statement(t,e);default:throw new Error("unknow ast node with "+t.type)}}},{key:"evaluate_program",value:function(t,e){return this.evaluate(t.body,e)}},{key:"evaluate_chunk",value:function(t,e){for(var n=void 0,i=0;i<t.body.length;i++)n=this.evaluate(t.body[i],e);return n}},{key:"evaluate_table_expression",value:function(t,r){var o={},s=this,a=1;return t.fields.map(function(t){if("Recfield"==t.type){var e=t.key.name,n=s.evaluate(t.value,r);o[e]=n}else{var i=s.evaluate(t.value,r);o[a++]=i}}),o}},{key:"evaluate_literal",value:function(t,e){return t.value}},{key:"evaluate_assign_expression",value:function(t,e){for(var n=0;n<t.left.length;n++){var i=t.left[n];if("Identifier"==i.type)e.set(i.name,this.evaluate(t.right[n],e));else if("MemberExpression"==i.type){e.get(i.object.name)[i.property.name]=this.evaluate(t.right[n],e)}}}},{key:"evaluate_do_statment",value:function(t,e){return this.evaluate(t.body,e.extend())}},{key:"evaluate_break_statment",value:function(t,e){}},{key:"evaluate_return_statment",value:function(t,e){var n=this,i=t.params.map(function(t){return n.evaluate(t,e)});return i[i.length-1]}},{key:"evaluate_binary_expression",value:function(t,e){return(0,dn[t.op])(this.evaluate(t.left,e),this.evaluate(t.right,e))}},{key:"evaluate_unary_expression",value:function(t,e){return(0,dn[t.op])(this.evaluate(t.argument,e))}},{key:"evaluate_fornum_statement",value:function(t,e){var n=e.extend(),i=this.evaluate(t.begin,n),r=this.evaluate(t.end,n),o=this.evaluate(t.step,n);n.def(t.id.name,i);for(var s=i;s<r;s+=o)n.set(t.id.name,s),this.evaluate(t.body,n)}},{key:"evaluate_forlist_statement",value:function(t,e){for(var n=e.extend(),i=t.left,r=this.evaluate(t.right,n),o=0;o<i.length;o++)n.def(i[o].name,null);for(;;){var s=r();if(s.done)break;for(var a=0;a<i.length;a++)n.set(i[a].name,s.value[a]);this.evaluate(t.body,n)}}},{key:"evaluate_while_statement",value:function(t,e){for(var n=e.extend();;){if(!this.evaluate(t.cond,n))break;this.evaluate(t.body,n)}}},{key:"evaluate_repeat_statement",value:function(t,e){for(var n=e.extend();;){if(this.evaluate(t.body,n),1==this.evaluate(t.cond,n))break}}},{key:"evaluate_identifier",value:function(t,e){return e.get(t.name)}},{key:"evaluate_call_expression",value:function(t,e){var n=this.evaluate(t.callee,e),i=this;return n.apply(null,t.params.map(function(t){return i.evaluate(t,e)}))}},{key:"evaluate_if_statement",value:function(t,e){if(this.evaluate(t.cond,e))return this.evaluate(t.body,e),!0;for(var n=0;n<t.elseif.length;n++){var i=t.elseif[n];if(this.evaluate(i,e))return!0}return t.else&&this.evaluate(t.else,e),!1}},{key:"evaluate_member_expression",value:function(t,e){var n=void 0,i=void 0;return"."==t.sep&&(n=e.get(t.object.name),i=t.property.name),n[i]}},{key:"evaluate_expression_stat",value:function(t,e){return this.evaluate(t.expression,e)}},{key:"evaluate_local_stat",value:function(t,e){for(var n=t.variables,i=t.init,r=0;r<n.length;r++){var o=n[r],s=i[r];e.def(o.name,this.evaluate(s,e))}}},{key:"evaluate_function_declaration",value:function(s,a){var u=this;function t(){for(var t=s.params,e=a.extend(),n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];for(var o=0;o<t.length;++o)e.def(t[o].name,i[o]);return u.evaluate(s.body,e)}var e=void 0;return"Identifier"==s.id.type&&(e=s.id.name),a.def(e,t),t}}]),n}(),yn=function(){function t(e){h(this,t),this.visitor=function(t){return e&&e(t),t}}return c(t,[{key:"program",value:function(t){return this.visitor({body:t,type:"Program"})}},{key:"chunk",value:function(t){return this.visitor({body:t,type:"Chunk"})}},{key:"do_stat",value:function(t){return this.visitor({body:t,type:"DoStatement"})}},{key:"break_stat",value:function(){return this.visitor({type:"BreakStatement"})}},{key:"return_stat",value:function(t){return this.visitor({params:t,type:"ReturnStatement"})}},{key:"expr_stat",value:function(t){return this.visitor({expression:t,type:"ExpressionStatement"})}},{key:"func_stat",value:function(t,e,n){return this.visitor({id:t,params:e,body:n,type:"FunctionDeclaration"})}},{key:"local_stat",value:function(t,e){return this.visitor({init:e,variables:t,type:"LocalStatement"})}},{key:"if_stat",value:function(t,e,n,i){return this.visitor({cond:t,body:e,elseif:n,else:i,type:"IfStatement"})}},{key:"fornum_stat",value:function(t,e,n,i,r){return this.visitor({id:t,begin:e,end:n,step:i,body:r,type:"FornumStatement"})}},{key:"forlist_stat",value:function(t,e,n,i){return this.visitor({id:t,left:e,right:n,body:i,type:"ForlistStatement"})}},{key:"while_stat",value:function(t,e){return this.visitor({cond:t,body:e,type:"WhileStatement"})}},{key:"repeat_stat",value:function(t,e){return this.visitor({cond:t,body:e,type:"RepeatStatement"})}},{key:"identifier",value:function(t){return this.visitor({name:t,type:"Identifier"})}},{key:"literal",value:function(t,e){return this.visitor({value:t,raw:e,type:"Literal"})}},{key:"unary_expr",value:function(t,e){return this.visitor({op:t,argument:e,type:"UnaryExpression"})}},{key:"binary_expr",value:function(t,e,n){return this.visitor({op:t,left:e,right:n,type:"BinaryExpression"})}},{key:"call_expr",value:function(t,e){return this.visitor({callee:t,params:e,type:"CallExpression"})}},{key:"member_expr",value:function(t,e,n){return this.visitor({object:t,sep:e,property:n,type:"MemberExpression"})}},{key:"assign_expr",value:function(t,e,n){return this.visitor({op:t,left:e,right:n,type:"AssignExpression"})}},{key:"table_expr",value:function(t){return this.visitor({fields:t,type:"TableExpression"})}},{key:"recfield",value:function(t,e){return this.visitor({key:t,value:e,type:"Recfield"})}},{key:"listfield",value:function(t){return this.visitor({value:t,type:"Listfield"})}},{key:"comment",value:function(t){return this.visitor({value:t,type:"Comment"})}}]),t}(),_n={or:{prec:1,left:1,binary:1},and:{prec:2,left:1,binary:1},"<":{prec:3,left:1,binary:1},">":{prec:3,left:1,binary:1},"<=":{prec:3,left:1,binary:1},">=":{prec:3,left:1,binary:1},"==":{prec:3,left:1,binary:1},"~=":{prec:3,left:1,binary:1},"..":{prec:4,left:0,binary:1},"+":{prec:5,left:1,binary:1},"-":{prec:5,left:1,binary:1},"*":{prec:6,left:1,binary:1},"/":{prec:6,left:1,binary:1},"%":{prec:4,left:1,binary:1},not:{prec:7,left:1,binary:0},"#":{prec:7,left:1,binary:0},"u-":{prec:7,left:1,binary:0},"^":{prec:8,left:0,binary:1}},mn=function(){function n(t,e){h(this,n),this.lexer=t,this.cur_token=null,this.ast=new yn(function(t){return e&&e(t),t}),this.location=[]}return c(n,[{key:"croak",value:function(t){throw new SyntaxError(t)}},{key:"next",value:function(){var t=this.cur_token;return this.cur_token=this.lexer.scan(),t}},{key:"match",value:function(t,e){if(t){if(e&&this.cur_token.type==t&&this.cur_token.val==e){var n=this.cur_token;return this.next(),n}if(this.cur_token.type==t){var i=this.cur_token;return this.next(),i}}this.croak()}},{key:"consume",value:function(t,e){if(t){if(e&&this.cur_token.type==t&&this.cur_token.value==e){var n=this.cur_token;return this.next(),n}if(this.cur_token.type==t){var i=this.cur_token;return this.next(),i}}return this.cur_token}},{key:"anchor",value:function(){this.location.push({line:this.cur_token.line,column:this.cur_token.column})}},{key:"parse",value:function(){return this.next(),this.anchor(),this.ast.program(this.parse_chunk())}},{key:"parse_chunk",value:function(){for(var t=[];!this.is_block_follow();){if("return"==this.cur_token.value){t.push(this.parse_stat()),this.consume(hn.SEMICOLON);break}var e=this.parse_stat();this.consume(hn.SEMICOLON),t.push(e)}return this.ast.chunk(t)}},{key:"parse_block",value:function(){return this.parse_chunk()}},{key:"parse_stat",value:function(){switch(this.cur_token.value){case"do":return this.parse_do_stat();case"break":return this.parse_break_stat();case"return":return this.parse_return_stat();case"function":return this.parse_func_stat();case"local":return this.parse_local_stat();case"if":return this.parse_if_stat();case"for":return this.parse_for_stat();case"while":return this.parse_while_stat();case"repeat":return this.parse_repeat_stat();default:return this.parse_expr_stat()}}},{key:"parse_do_stat",value:function(){this.match(hn.KEYWORD,"do");var t=this.ast.do_stat(this.parse_block());return this.match(hn.KEYWORD,"end"),t}},{key:"parse_break_stat",value:function(){return this.match(hn.KEYWORD,"break"),this.ast.break_stat()}},{key:"parse_return_stat",value:function(){this.next();var t=this.parse_explist1();return this.ast.return_stat(t)}},{key:"parse_func_stat",value:function(){this.match(hn.KEYWORD,"function");var t=this.parse_funcname();this.match(hn.LPATTERN);var e=this.parse_parlist();this.match(hn.RPATTERN);var n=this.parse_block();return this.match(hn.KEYWORD,"end"),this.ast.func_stat(t,e,n)}},{key:"parse_parlist",value:function(){var t=[];if(this.is_param())for(t.push(this.parse_param());","==this.cur_token.value;)this.next(),t.push(this.parse_param());return t}},{key:"parse_param",value:function(){return this.parse_name()}},{key:"parse_funcname",value:function(){for(var t=this.parse_name();"."==this.cur_token.value;)this.next(),t=this.ast.member_expr(t,".",this.parse_name());return":"==this.cur_token.value&&(this.next(),t=this.ast.member_expr(t,":",this.parse_name())),t}},{key:"parse_local_stat",value:function(){if(this.match(hn.KEYWORD,"local"),"function"==this.cur_token.value){this.next();var t=this.parse_name();this.match(hn.LPATTERN);var e=this.parse_parlist();this.match(hn.RPATTERN);var n=this.parse_block();return this.match(hn.KEYWORD,"end"),this.ast.call_expr(t,e,n)}var i=[],r=[];for(i.push(this.parse_name());","==this.cur_token.value;)this.next(),i.push(this.parse_name());return"="==this.cur_token.value&&(this.next(),r=this.parse_explist1()),this.ast.local_stat(i,r)}},{key:"parse_if_stat",value:function(){this.match(hn.KEYWORD,"if");var t=this.parse_cond();this.match(hn.KEYWORD,"then");for(var e=this.parse_block(),n=[],i=null;"elseif"==this.cur_token.value;){this.next();var r=this.parse_cond();this.match(hn.KEYWORD,"then");var o=this.parse_block();n.push(this.ast.if_stat(r,o,[]))}return"else"==this.cur_token.value&&(this.next(),i=this.parse_block()),this.match(hn.KEYWORD,"end"),this.ast.if_stat(t,e,n,i)}},{key:"parse_cond",value:function(){return this.parse_expr()}},{key:"parse_for_stat",value:function(){this.match(hn.KEYWORD,"for");var t=this.parse_name();if("="==this.cur_token.value){this.next();var e=this.parse_exp1();this.match(hn.COMMA,",");var n=this.parse_exp1(),i=this.ast.literal(1);","==this.cur_token.value&&(this.next(),i=this.parse_exp1());var r=this.parse_forbody();return this.match(hn.KEYWORD,"end"),this.ast.fornum_stat(t,e,n,i,r)}for(var o=[t];","==this.cur_token.value;)this.next(),o.push(this.parse_name());this.match(hn.KEYWORD,"in");var s=this.parse_exp1(),a=this.parse_forbody();return this.match(hn.KEYWORD,"end"),this.ast.forlist_stat(t,o,s,a)}},{key:"parse_forbody",value:function(){return this.match(hn.KEYWORD,"do"),this.parse_block()}},{key:"parse_while_stat",value:function(){this.match(hn.KEYWORD,"while");var t=this.parse_cond();this.match(hn.KEYWORD,"do");var e=this.parse_block();return this.match(hn.KEYWORD,"end"),this.ast.while_stat(t,e)}},{key:"parse_repeat_stat",value:function(){this.match(hn.KEYWORD,"repeat");var t=this.parse_block();this.match(hn.KEYWORD,"until");var e=this.parse_cond();return this.ast.repeat_stat(e,t)}},{key:"parse_expr_stat",value:function(){var t=this.parse_primaryexp();if("CallExpression"==t.type)return this.ast.expr_stat(t);var e=this.parse_assignment([t]);return this.ast.expr_stat(e)}},{key:"parse_assignment",value:function(t){if("="==this.cur_token.value){this.next();var e=this.parse_explist1();return this.ast.assign_expr("=",t,e)}this.match(hn.COMMA),t.push(this.parse_primaryexp()),this.parse_assignment(t)}},{key:"parse_explist1",value:function(){for(var t=[this.parse_expr()];","==this.cur_token.value;)this.next(),t.push(this.parse_expr());return t}},{key:"parse_expr",value:function(){return this.parse_subexpr()}},{key:"parse_subexpr",value:function(t){t=t||0;var e=void 0;if(this.is_unary()){var n=this.parse_unary(),i=this.parse_subexpr();e=this.ast.unary_expr(n,i)}else e=this.parse_simpleexp();for(;this.is_binary()&&_n[this.cur_token.value].prec>=t;){var r=this.next(),o=_n[r.value],s=void 0;s=o.left?o.prec+1:o.prec;var a=this.parse_subexpr(s);e=this.ast.binary_expr(r.value,e,a)}return e}},{key:"parse_simpleexp",value:function(){if(this.cur_token.type==hn.NUMBER||this.cur_token.type==hn.STRING){var t=this.next();return this.ast.literal(t.value)}if(this.cur_token.type!=hn.KEYWORD)return"{"==this.cur_token.value?this.parse_constructor():this.parse_primaryexp();switch(this.cur_token.value){case"nil":return this.next(),this.ast.literal(null);case"true":return this.next(),this.ast.literal(!0);case"false":return this.next(),this.ast.literal(!1);case"...":return this.next(),this.ast.literal("...");case"function":var e=this.cur_token,n=this.ast.literal(e.line+":"+e.column);this.next(),this.match(hn.LPATTERN);var i=this.parse_parlist();this.match(hn.RPATTERN);var r=this.parse_block();return this.match(hn.KEYWORD,"end"),this.ast.func_stat(n,i,r);default:this.croak()}}},{key:"parse_primaryexp",value:function(){for(var t=this.parse_prefixexp(),e=void 0;;){switch(this.cur_token.value){case".":this.next(),e=this.parse_name(),t=this.ast.member_expr(t,".",e);break;case"[":this.next(),e=this.parse_expr(),t=this.ast.member_expr(t,"[",e),this.match(hn.RBRACKET);break;case":":this.next(),e=this.parse_expr(),t=this.ast.member_expr(t,":",e);var n=this.parse_funcargs();t=this.ast.call_expr(t,n)}if("("!=this.cur_token.value&&"{"!=this.cur_token.value&&this.cur_token.type!=hn.STRING)return t;var i=this.parse_funcargs();t=this.ast.call_expr(t,i)}}},{key:"parse_funcargs",value:function(){var t=[];return"("==this.cur_token.value?(this.next(),")"!=this.cur_token.value&&(t=this.parse_explist1()),this.match(hn.RPATTERN),t):this.cur_token.type==hn.STRING?this.ast.literal(this.cur_token.value):this.parse_constructor()}},{key:"parse_constructor",value:function(){var t=[];if(this.match(hn.LBRACE),"}"!=this.cur_token.value){for(t.push(this.parse_field());this.is_fieldsep();)this.parse_fieldsep(),t.push(this.parse_field());this.is_fieldsep()&&this.parse_fieldsep()}return this.match(hn.RBRACE),this.ast.table_expr(t)}},{key:"parse_fieldsep",value:function(){if(","==this.cur_token.value||";"==this.cur_token.value){var t=this.next();return this.ast.literal(t.value)}this.croak()}},{key:"parse_field",value:function(){return"["==this.cur_token.value||this.cur_token.type==hn.IDENTIFIER?this.parse_recfield():this.parse_listfield()}},{key:"parse_recfield",value:function(){var t,e=void 0;return"["==this.cur_token.value?(e=this.parse_exp1(),this.match(hn.RBRACKET)):e=this.parse_name(),this.match(hn.ASSIGN),t=this.parse_exp1(),this.ast.recfield(e,t)}},{key:"parse_listfield",value:function(){return this.ast.listfield(this.parse_expr())}},{key:"parse_prefixexp",value:function(){if("("!=this.cur_token.value)return this.parse_name();this.match(hn.LPATTERN);var t=this.parse_expr();return this.match(hn.RPATTERN),t}},{key:"parse_exp1",value:function(){return this.parse_expr()}},{key:"parse_unary",value:function(){var t=this.next();switch(t.value){case"-":return"#-";default:return t.value}}},{key:"parse_name",value:function(){return this.ast.identifier(this.match(hn.IDENTIFIER).value)}},{key:"is_unary",value:function(){switch(this.cur_token.value){case"#":case"-":case"not":return!0;default:return!1}}},{key:"is_fieldsep",value:function(){switch(this.cur_token.value){case",":case";":return!0;default:return!1}}},{key:"is_binary",value:function(){return!(!_n[this.cur_token.value]||!_n[this.cur_token.value].binary)}},{key:"is_param",value:function(){return this.cur_token.type==hn.IDENTIFIER}},{key:"is_block_follow",value:function(){switch(this.cur_token.value){case"else":case"elseif":case"end":case"until":case"EOS":return!0}return!1}}]),n}();var vn={parserExpress:function(t,e){if(!t)return"";e||(e=[]);var n=new cn(t),i=new mn(n).parse(),r=new pn,o=new fn(i);new gn(i,r).interprete();var s=o.to_js();return s=s+";"+function(t){if(!t)return"";var e=t.indexOf("function");if(-1==e)return"";var n=t.indexOf("(");return-1==n?"":t.slice(e,n)}(s)+"(...values)",window.eval(s)}},bn={textSymbol:null,labelPosition:null,fieldList:null,name:"",filter:"",express:""},xn=function(){function e(t){h(this,e),this.options=vt.extend({},bn,t)}return c(e,[{key:"readJson",value:function(t){t&&(t.text_symbol&&(this.options.textSymbol=re.readFromJson(t.text_symbol)),t.label_position&&(this.options.labelPosition=un.createFromJson(t.label_position)),this.options.fieldList=t.field_list,this.options.name=t.name,this.options.filter=t.filter,this.options.express=t.express)}},{key:"toJson",value:function(t){t&&(t.text_symbol=null,this.options.textSymbol&&(t.text_symbol={},this.options.textSymbol.toJson(t.text_symbol)),t.label_position=null,this.options.labelPosition&&(t.label_position={},this.options.labelPosition.toJson(t.label_position)),t.field_list=this.options.fieldList,t.name=this.options.name,t.filter=this.options.filter,t.express=this.options.express)}},{key:"getTextSymbol",value:function(){return this.options.textSymbol}},{key:"setTextSymbol",value:function(t){this.options.textSymbol=t}},{key:"getLabelPosition",value:function(){return this.options.labelPosition}},{key:"setLabelPosition",value:function(t){this.options.labelPosition=t}},{key:"getFieldList",value:function(){return this.options.fieldList}},{key:"setFieldList",value:function(t){this.options.fieldList=t}},{key:"getName",value:function(){return this.options.name}},{key:"setName",value:function(t){this.options.name=t}},{key:"getFilter",value:function(){return this.options.filter}},{key:"setFilter",value:function(t){this.options.filter=t}},{key:"getExpress",value:function(){return this.options.express}},{key:"setExpress",value:function(t){this.options.express=t}},{key:"getUsedFields",value:function(){var t=[];if(this.options.fieldList&&0<this.options.fieldList.length&&(t=t.concat(this.options.fieldList)),this.options.filter){var e=ln.getFilterFields(this.options.filter);e&&0<e.length&&(t=t.concat(e))}return vt.uniqueArray(t)}},{key:"getText",value:function(n){n||(n={});var t="";if(this.options.express&&-1!==this.options.express.indexOf("function")){var i=[];this.options.fieldList&&this.options.fieldList.forEach(function(t){t=t.toLowerCase();var e=n[t]||"";i.push(e)}),t=vn.parserExpress(this.options.express,i)}else{var e=this.options.fieldList[0];e=e.toLowerCase(),t=n[e]||""}return t}},{key:"compareFilter",value:function(t){return ln.compareFilter(this.options.filter,t)}}]),e}(),En={renderItem:null},wn=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(En,t),e.type=Pe,e}return d(n,Te),c(n,[{key:"readJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),t.render_text_item&&(this.options.renderItem=new xn,this.options.renderItem.readJson(t.render_text_item)))}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.render_text_item=null,this.options.renderItem&&(t.render_text_item={},this.options.renderItem.toJson(t.render_text_item)))}},{key:"getRenderItem",value:function(){return this.options.renderItem}},{key:"setRenderItem",value:function(t){this.options.renderItem=t}},{key:"getUsedFields",value:function(){var t=f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getUsedFields",this).call(this);if(t||(t=[]),this.options.renderItem){var e=this.options.renderItem.getUsedFields();e&&0<e.length&&(t=t.concat(e))}return vt.uniqueArray(t)}},{key:"getRenderItemList",value:function(){return this.options.renderItem?[this.options.renderItem]:null}}]),n}(),In={renderItemList:null},Ln=function(t){function i(t){h(this,i);var e=y(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.mergeOptions(In,t),e.type=Ne,e}return d(i,Te),c(i,[{key:"readJson",value:function(t){var n=this;t&&(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"readJson",this).call(this,t),t.render_text_item_list&&0<t.render_text_item_list.length&&(this.options.renderItemList=[],t.render_text_item_list.forEach(function(t){if(t){var e=new xn;e.readJson(t),n.options.renderItemList.push(e)}})))}},{key:"toJson",value:function(n){n&&(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJson",this).call(this,n),n.render_text_item_list=null,this.options.renderItemList&&0<this.options.renderItemList.length&&(n.render_text_item_list=[],this.options.renderItemList.forEach(function(t){if(t){var e={};t.toJson(e),n.render_text_item_list.push(e)}})))}},{key:"getRenderItemList",value:function(){return this.options.renderItemList}},{key:"setRenderItemList",value:function(t){this.options.renderItemList=t}},{key:"getUsedFields",value:function(){var n=f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"getUsedFields",this).call(this);return n||(n=[]),this.options.renderItemList&&0<this.options.renderItemList.length&&this.options.renderItemList.forEach(function(t){var e=t.getUsedFields();e&&0<e.length&&(n=n.concat(e))}),vt.uniqueArray(n)}}]),i}(),Sn={aroundOffset:0,positionType:Be,specifiedAngle:0,angleField:"",labelPosList:[Ve,We,He,Ke,Xe,ze,Ye,Je]},Mn=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Sn,t),e.type=Ae,e}return d(n,un),c(n,[{key:"readJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.aroundOffset=t.arround_offset,this.options.positionType=t.position_type,this.options.specifiedAngle=t.specified_angle,this.options.angleField=t.angle_field,this.options.labelPosList=t.position_list)}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.arround_offset=this.options.aroundOffset,t.position_type=this.options.positionType,t.specified_angle=this.options.specifiedAngle,t.angle_field=this.options.angleField,t.position_list=this.options.labelPosList)}},{key:"getAroundOffset",value:function(){return this.options.aroundOffset}},{key:"setAroundOffset",value:function(t){this.options.aroundOffset=t}},{key:"getPositionType",value:function(){return this.options.positionType}},{key:"setPositionType",value:function(t){this.options.positionType=t}},{key:"getSpecifiedAngle",value:function(){return this.options.specifiedAngle}},{key:"setSpecifiedAngle",value:function(t){this.options.specifiedAngle=t}},{key:"getAngleField",value:function(){return this.options.angleField}},{key:"setAngleField",value:function(t){this.options.angleField=t}},{key:"getLabelPosList",value:function(){return this.options.labelPosList}},{key:"setLabelPosList",value:function(t){this.options.labelPosList=t}}]),n}(),Cn={positionType:Qe,vertPos:rn,offset:0,joinAdjacent:!1},Pn=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Cn,t),e.type=Fe,e}return d(n,un),c(n,[{key:"readJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.positionType=t.position_type,this.options.vertPos=t.text_vert_place,this.options.offset=t.offset,this.options.joinAdjacent=t.joint)}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.position_type=this.options.positionType,t.text_vert_place=this.options.vertPos,t.offset=this.options.offset,t.joint=this.options.joinAdjacent)}},{key:"getPositionType",value:function(){return this.options.positionType}},{key:"setPositionType",value:function(t){this.options.positionType=t}},{key:"getVertPos",value:function(){return this.options.vertPos}},{key:"setVertPos",value:function(t){this.options.vertPos=t}},{key:"getOffset",value:function(){return this.options.offset}},{key:"setOffset",value:function(t){this.options.offset=t}},{key:"isJoinAdjacent",value:function(){return this.options.joinAdjacent}},{key:"setJoinAdjacent",value:function(t){this.options.joinAdjacent=t}},{key:"isVertPosOnLine",value:function(){return!!(this.options.vertPos&nn)}},{key:"isVertPosAboveLine",value:function(){return!!(this.options.vertPos&rn)}},{key:"isVertPosBelowLine",value:function(){return!!(this.options.vertPos&on)}},{key:"getVertPosList",value:function(){var t=[];return this.isVertPosAboveLine()&&t.push(rn),this.isVertPosOnLine()&&t.push(nn),this.isVertPosBelowLine()&&t.push(on),t}}]),n}(),Nn={positionType:sn,onlyInPolygon:!1},On=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Nn,t),e.type=Ge,e}return d(n,un),c(n,[{key:"readJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.positionType=t.position_type,this.options.onlyInPolygon=t.only_in_polygon)}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.position_type=this.options.positionType,t.only_in_polygon=this.options.onlyInPolygon)}},{key:"getPositionType",value:function(){return this.options.positionType}},{key:"setPositionType",value:function(t){this.options.positionType=t}},{key:"isOnlyInPolygon",value:function(){return this.options.onlyInPolygon}},{key:"setOnlyInPolygon",value:function(t){this.options.onlyInPolygon=t}}]),n}(),Tn={hasHalo:!1,size:1,color:null},Rn=function(){function e(t){h(this,e),this.options=gt.extend({},Tn,t),this.options.color||(this.options.color=ne.createRandom())}return c(e,[{key:"readJson",value:function(t){t&&(this.options.hasHalo=t.enable,this.options.size=gt.poundToPixel(t.size),this.options.color=ne.createFromArray(t.color))}},{key:"toJson",value:function(t){t&&(t.enable=this.options.hasHalo,t.size=gt.pixelToPound(this.options.size),this.options.color?t.color=this.options.color.toArray():t.color=null)}},{key:"hasHalo",value:function(){return this.options.hasHalo}},{key:"setHasHalo",value:function(t){this.options.hasHalo=t}},{key:"getSize",value:function(){return this.options.size}},{key:"setSize",value:function(t){this.options.size=t}},{key:"getColor",value:function(){return this.options.color}},{key:"setColor",value:function(t){this.options.color=t}}]),e}(),kn={bold:!1,italic:!1,underline:!1,strikeout:!1,size:16,fontFace:"宋体",faceIndex:0,fontFileName:""},Dn=function(){function e(t){h(this,e),this.options=gt.extend({},kn,t)}return c(e,[{key:"readJson",value:function(t){t&&(this.options.bold=t.bold,this.options.italic=t.italic,this.options.underline=t.underline,this.options.strikeout=t.strikeout,this.options.size=gt.poundToPixel(t.font_size),this.options.fontFace=t.family_name,this.options.faceIndex=t.face_index,this.options.fontFileName=t.font_file_name)}},{key:"toJson",value:function(t){t&&(t.bold=this.options.bold,t.italic=this.options.italic,t.underline=this.options.underline,t.strikeout=this.options.strikeout,t.font_size=gt.pixelToPound(this.options.size),t.family_name=this.options.fontFace,t.face_index=this.options.faceIndex,t.font_file_name=this.options.fontFileName)}},{key:"isBold",value:function(){return this.options.bold}},{key:"setBold",value:function(t){this.options.bold=t}},{key:"isItalic",value:function(){return this.options.italic}},{key:"setItalic",value:function(t){this.options.italic=t}},{key:"isUnderline",value:function(){return this.options.underline}},{key:"setUnderline",value:function(t){this.options.underline=t}},{key:"isStrikeout",value:function(){return this.options.strikeout}},{key:"setStrikeout",value:function(t){this.options.strikeout=t}},{key:"getSize",value:function(){return this.options.size}},{key:"setSize",value:function(t){this.options.size=t}},{key:"getFontFace",value:function(){return this.options.fontFace}},{key:"setFontFace",value:function(t){this.options.fontFace=t}},{key:"getFontStr",value:function(){var t="";return this.isItalic()&&(t+="italic"),this.isBold()&&(t+=" bold"),t+=" "+this.getSize()+"px",t+=" "+this.getFontFace()}}]),e}(),An={fontInfo:new Dn,interval:0,wordInterval:0,lineSpacing:0,offsetX:0,offsetY:0,leftMargin:1,topMargin:1,rightMargin:1,bottomMargin:1,halo:new Rn({color:new ne(255,255,0,255)}),wrap:!0,wordCountPerLine:6,maxLineCount:2,wrapChar:"",alignment:1,angle:0},Fn=function(){function e(t){h(this,e),this.options=gt.extend({},An,t)}return c(e,[{key:"readJson",value:function(t){t&&(t.font_info&&(this.options.fontInfo=new Dn,this.options.fontInfo.readJson(t.font_info)),this.options.interval=gt.poundToPixel(t.interval),this.options.wordInterval=gt.poundToPixel(t.word_interval),this.options.lineSpacing=gt.poundToPixel(t.line_spacing),this.options.offsetX=gt.poundToPixel(t.offset_x),this.options.offsetY=gt.poundToPixel(t.offset_y),this.options.leftMargin=gt.poundToPixel(t.margin_left),this.options.topMargin=gt.poundToPixel(t.margin_top),this.options.rightMargin=gt.poundToPixel(t.margin_right),this.options.bottomMargin=gt.poundToPixel(t.margin_bottom),t.halo&&(this.options.halo=new Rn,this.options.halo.readJson(t.halo)),this.options.wrap=t.wrap,this.options.wordCountPerLine=t.word_count_per_line,this.options.wrapChar=t.wrap_char,this.options.angle=t.angle)}},{key:"toJson",value:function(t){t&&(t.font_info=null,this.options.fontInfo&&(t.font_info={},this.options.fontInfo.toJson(t.font_info)),t.interval=gt.pixelToPound(this.options.interval),t.word_interval=gt.pixelToPound(this.options.wordInterval),t.line_spacing=gt.pixelToPound(this.options.lineSpacing),t.offset_x=gt.pixelToPound(this.options.offsetX),t.offset_y=gt.pixelToPound(this.options.offsetY),t.margin_left=gt.pixelToPound(this.options.leftMargin),t.margin_top=gt.pixelToPound(this.options.topMargin),t.margin_right=gt.pixelToPound(this.options.rightMargin),t.margin_bottom=gt.pixelToPound(this.options.bottomMargin),t.halo=null,this.options.halo&&(t.halo={},this.options.halo.toJson(t.halo)),t.wrap=this.options.wrap,t.word_count_per_line=this.options.wordCountPerLine,t.wrap_char=this.options.wrapChar,t.angle=this.options.angle)}},{key:"getFontInfo",value:function(){return this.options.fontInfo}},{key:"setFontInfo",value:function(t){this.options.fontInfo=t}},{key:"getInterval",value:function(){return this.options.interval}},{key:"setInterval",value:function(t){this.options.interval=t}},{key:"getWordInterval",value:function(){return this.options.wordInterval}},{key:"setWordInterval",value:function(t){this.options.wordInterval=t}},{key:"getLineSpacing",value:function(){return this.options.lineSpacing}},{key:"setLineSpacing",value:function(t){this.options.lineSpacing=t}},{key:"getOffsetX",value:function(){return this.options.offsetX}},{key:"setOffsetX",value:function(t){this.options.offsetX=t}},{key:"getOffsetY",value:function(){return this.options.offsetY}},{key:"setOffsetY",value:function(t){this.options.offsetY=t}},{key:"getLeftMargin",value:function(){return this.options.leftMargin}},{key:"setLeftMargin",value:function(t){this.options.leftMargin=t}},{key:"getRightMargin",value:function(){return this.options.rightMargin}},{key:"setRightMargin",value:function(t){this.options.rightMargin=t}},{key:"getTopMargin",value:function(){return this.options.topMargin}},{key:"setTopMargin",value:function(t){this.options.topMargin=t}},{key:"getBottomMargin",value:function(){return this.options.bottomMargin}},{key:"setBottomMargin",value:function(t){this.options.bottomMargin=t}},{key:"getHalo",value:function(){return this.options.halo}},{key:"setHalo",value:function(t){this.options.halo=t}},{key:"isWrap",value:function(){return this.options.wrap}},{key:"setWrap",value:function(t){this.options.wrap=t}},{key:"getWordCountPerLine",value:function(){return this.options.wordCountPerLine}},{key:"setWordCountPerLine",value:function(t){this.options.wordCountPerLine=t}},{key:"getMaxLineCount",value:function(){return this.options.maxLineCount}},{key:"setMaxLineCount",value:function(t){this.options.maxLineCount=t}},{key:"getWrapChar",value:function(){return this.options.wrapChar}},{key:"setWrapChar",value:function(t){this.options.wrapChar=t}},{key:"getAlignment",value:function(){return this.options.alignment}},{key:"setAlignment",value:function(t){this.options.alignment=t}},{key:"getAngle",value:function(){return this.options.angle}},{key:"setAngle",value:function(t){this.options.angle=t}}]),e}(),Gn={textInfo:new Fn,fillSymbol:null},Bn=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Gn,t),e.type=te,e}return d(n,re),c(n,[{key:"readJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),t.text_info&&(this.options.textInfo=new Fn,this.options.textInfo.readJson(t.text_info)),t.background_fill_symbol&&(this.options.fillSymbol=re.readFromJson(t.background_fill_symbol)))}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.text_info=null,this.options.textInfo&&(t.text_info={},this.options.textInfo.toJson(t.text_info)),t.background_fill_symbol=null,this.options.fillSymbol&&(t.background_fill_symbol={},this.options.fillSymbol.toJson(t.background_fill_symbol)))}},{key:"getTextInfo",value:function(){return this.options.textInfo}},{key:"setTextInfo",value:function(t){this.options.textInfo=t}},{key:"getFillSymbol",value:function(){return this.options.fillSymbol}},{key:"setFillSymbol",value:function(t){this.options.fillSymbol=t}},{key:"getFontSize",value:function(){var t=0;return this.options.textInfo&&(t=this.options.textInfo.getFontInfo().getSize()),t}},{key:"setFontSize",value:function(t){this.options.textInfo||(this.options.textInfo=new Fn),this.options.textInfo.getFontInfo().setSize(t)}},{key:"validFillSymbol",value:function(){return!!this.options.fillSymbol}}]),n}();Te.readFromJson=function(t){if(!t)return null;var e=null;switch(t.class){case Pe:e=new wn;break;case Ne:e=new Ln}return e&&e.readJson(t),e},Te.createDefault=function(t){var e=null;switch(t){case ae.POINT:e=new Mn;break;case ae.LINE:e=new Pn;break;case ae.POLYGON:e=new On}var n=new Bn,i=new xn({textSymbol:n,labelPosition:e});return new wn({renderItem:i})},un.createFromJson=function(t){var e=null;switch(t.class){case Ae:e=new Mn;break;case Fe:e=new Pn;break;case Ge:e=new On}return e&&e.readJson(t),e};var Un="se",qn="se-vector-service",jn="se-select",zn="se-edit",Vn="se-temp",Yn={DB_STRING:"string",DB_INTEGER:"integer",DB_DATETIME:"datetime",DB_DOUBLE:"double",DB_BLOB:"blob",getTextMemo:function(t){var e="";if(t)switch(t=t.toLowerCase()){case this.DB_STRING:e="文本型";break;case this.DB_INTEGER:e="整数型";break;case this.DB_DATETIME:e="日期型";break;case this.DB_DOUBLE:e="数值型";break;case this.DB_BLOB:e="二进制型";break;default:e="未知"}else e="未知";return e}},Hn=G.Class.extend({options:{name:"",type:Yn.DB_STRING,length:0},initialize:function(t){G.setOptions(this,t)},getName:function(){return this.options.name},getType:function(){return this.options.type},getLength:function(){return this.options.length},readJson:function(t){t&&(this.options.name=t.name?t.name:"",this.options.type=t.type?t.type:"string",this.options.length=t.length?t.length:0)}}),Xn=G.Class.extend({options:{proj4:"",code:"",description:"",wkt:"",name:""},initialize:function(t){G.setOptions(this,t)},getProj4:function(){return this.options.proj4},getCode:function(){return this.options.code},getName:function(){return this.options.name},getWkt:function(){return this.options.wkt},getDescription:function(){return this.options.description},createProj:function(){return this.options.proj4?new W.CRS(this.options.code,this.options.proj4):null},readJson:function(t){t&&(this.options.code=t.crsid?t.crsid.toString():"",this.options.name=t.name?t.name:"",this.options.proj4=t.proj4?t.proj4:"",this.options.wkt=t.wkt?t.wkt:"")},isEPSG4326:function(){return"EPSG:4326"===this.options.code||"4326"===this.options.code},project:function(t){if(!t)return null;var e=this.createProj();return e&&!this.isEPSG4326()?e.projection.project(t):new G.Point(t.lng,t.lat)},unproject:function(t){if(!t)return null;var e=this.createProj();return e?e.projection.unproject(t):new G.LatLng(t.y,t.x)}}),Wn=function(){function e(t){h(this,e),this.pos=0,this.dataview=t}return c(e,[{key:"getInt8",value:function(){var t=this.dataview.getInt8(this.pos,!0);return this.pos++,t}},{key:"getUint8",value:function(){var t=this.dataview.getUint8(this.pos,!0);return this.pos++,t}},{key:"getInt16",value:function(){var t=this.dataview.getInt16(this.pos,!0);return this.pos+=2,t}},{key:"getUint16",value:function(){var t=this.dataview.getUint16(this.pos,!0);return this.pos+=2,t}},{key:"getInt32",value:function(){var t=this.dataview.getInt32(this.pos,!0);return this.pos+=4,t}},{key:"getUint32",value:function(){var t=this.dataview.getUint32(this.pos,!0);return this.pos+=4,t}},{key:"getFloat64",value:function(){var t=this.dataview.getFloat64(this.pos,!0);return this.pos+=8,t}},{key:"getFloat32",value:function(){var t=this.dataview.getFloat32(this.pos,!0);return this.pos+=4,t}},{key:"getBool",value:function(){return 0!==this.getInt8()}},{key:"size",value:function(){return this.dataview.byteLength}},{key:"getBits",value:function(t){var e=this.dataview.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e}},{key:"get_vchar_v2",value:function(){var t=0,e=this.getUint8();return 253<e?254===e?t=this.getUint16():255===e&&(t=this.getUint32()):t=e,t}},{key:"setData",value:function(t){if(t){for(var e=(t=atob(t)).length,n=new ArrayBuffer(e),i=new Uint8Array(n),r=0;r<e;r++)i[r]=t[r].charCodeAt();this.dataview=new DataView(n)}}},{key:"binayUtf8ToString",value:function(t,e){var n=0,i="",r=0,o=0;for(n=e;n<t.length;)(o=t[n])>>>7==0?(i+=String.fromCharCode(t[n]),n+=1):252==(252&o)?(r=(3&t[n])<<30,r|=(63&t[n+1])<<24,r|=(63&t[n+2])<<18,r|=(63&t[n+3])<<12,r|=(63&t[n+4])<<6,r|=63&t[n+5],i+=String.fromCharCode(r),n+=6):248==(248&o)?(r=(7&t[n])<<24,r|=(63&t[n+1])<<18,r|=(63&t[n+2])<<12,r|=(63&t[n+3])<<6,r|=63&t[n+4],i+=String.fromCharCode(r),n+=5):240==(240&o)?(r=(15&t[n])<<18,r|=(63&t[n+1])<<12,r|=(63&t[n+2])<<6,r|=63&t[n+3],i+=String.fromCharCode(r),n+=4):224==(224&o)?(r=(31&t[n])<<12,r|=(63&t[n+1])<<6,r|=63&t[n+2],i+=String.fromCharCode(r),n+=3):192==(192&o)?(r=(63&t[n])<<6,r|=63&t[n+1],i+=String.fromCharCode(r),n+=2):(i+=String.fromCharCode(t[n]),n+=1);return i}},{key:"getString",value:function(t){var e=this.getBits(t),n=new Int8Array(e);return this.binayUtf8ToString(n,0)}}]),e}(),Jn={set_double_bit:function(t,e,n){var i=7-e;t.setInt8(i,n,!0)},decodePoint:function(t){for(var e=t.get_vchar_v2(),n=t.get_vchar_v2(),i=new Array(n),r=new Array(n),o=new ArrayBuffer(8),s=new DataView(o),a=new ArrayBuffer(8),u=new DataView(a),l=0;l<n;l++){s.setFloat64(0,0,!0),u.setFloat64(0,0,!0);for(var h=0;h<=e+1;h++){var c=t.getInt8();this.set_double_bit(s,h,c);var p=t.getInt8();this.set_double_bit(u,h,p)}var f=s.getFloat64(0,!0),d=u.getFloat64(0,!0),g=new G.Point(f,d);i[l]=g,r[l]=1}return{points:i,polyCount:r,subCount:n}},decodeLine:function(t){for(var e=t.get_vchar_v2(),n=t.get_vchar_v2(),i=[],r=new Array(n),o=new ArrayBuffer(8),s=new DataView(o),a=new ArrayBuffer(8),u=new DataView(a),l=0;l<n;l++){for(var h=t.get_vchar_v2(),c=0;c<h;c++){s.setFloat64(0,0,!0),u.setFloat64(0,0,!0);for(var p=0;p<=e+1;p++){var f=t.getInt8();this.set_double_bit(s,p,f);var d=t.getInt8();this.set_double_bit(u,p,d)}var g=s.getFloat64(0,!0),y=u.getFloat64(0,!0),_=new G.Point(g,y);i.push(_)}r[l]=h}return{points:i,polyCount:r,subCount:n}},decodePolygon:function(t){for(var e=t.get_vchar_v2(),n=t.get_vchar_v2(),i=[],r=new Array(n),o=new Array(n),s=new ArrayBuffer(8),a=new DataView(s),u=new ArrayBuffer(8),l=new DataView(u),h=0;h<n;h++){var c=t.getBool();o[h]=c}for(var p=0;p<n;p++){for(var f=t.get_vchar_v2(),d=0;d<f;d++){a.setFloat64(0,0,!0),l.setFloat64(0,0,!0);for(var g=0;g<=e+1;g++){var y=t.getInt8();this.set_double_bit(a,g,y);var _=t.getInt8();this.set_double_bit(l,g,_)}var m=a.getFloat64(0,!0),v=l.getFloat64(0,!0),b=new G.Point(m,v);i.push(b)}r[p]=f}return{points:i,polyCount:r,subCount:n}}},Kn=G.Evented.extend({initialize:function(t){G.setOptions(this,t),this.id=-1,this.name="",this.type=ae.UNKNOWN,this.version=-1,this.pvVersion=0,this.fieldInfos=null,this.cacheFieldInfos=null,this.bounds=null,this.features=null,this.projInfo=null,this.lastIds=null,this._subPackFeatures=null},getType:function(){return this.type},getID:function(){return this.id},getBounds:function(){return this.bounds},setBounds:function(t){this.bounds=t},getProjInfo:function(){return this.projInfo},getName:function(){return this.name},getVersion:function(){return this.version},setVersion:function(t){this.version=t},getPvVersion:function(){return this.pvVersion},setPvVersion:function(t){this.pvVersion=t},getFieldInfos:function(){return this.fieldInfos},getFeatures:function(){return this.features},updateRecordset:function(t,e){var n=t.attr_list,i=t.feature_id_list,r=t.field_list,o=t.geo_list;if(i&&0!==i.length&&o&&0!==o.length&&i.length===o.length){var s=n&&n.length&&n.length===i.length*r.length,a=i.length,u=r?r.length:0,l=0,h=-1,c=null,p=[],f=0,d=null;switch(this.type){case ae.POINT:for(l=0;l<a;l++){h=i[l];var g=o[l];(d=new Wn).setData(g);var y=Jn.decodePoint(d);if(y){c=new Et({mapPoints:y.points,polyCount:y.polyCount,subCount:y.subCount,id:h,projInfo:this.projInfo}),s&&(f=l*u,this._updateGeoAttrsExt(c,n,r,f));var _=e.findRenderItem(this.type,c.getProperties());c.setRenderItem(_),_&&p.push(c)}}break;case ae.LINE:for(l=0;l<a;l++){h=i[l];var m=o[l];(d=new Wn).setData(m);var v=Jn.decodeLine(d);if(v){c=new wt({mapPoints:v.points,polyCount:v.polyCount,subCount:v.subCount,id:h,projInfo:this.projInfo}),s&&(f=l*u,this._updateGeoAttrsExt(c,n,r,f));var b=e.findRenderItem(this.type,c.getProperties());c.setRenderItem(b),b&&p.push(c)}}break;case ae.POLYGON:for(l=0;l<a;l++){h=i[l];var x=o[l];(d=new Wn).setData(x);var E=Jn.decodePolygon(d);if(E){c=new It({mapPoints:E.points,polyCount:E.polyCount,subCount:E.subCount,id:h,projInfo:this.projInfo}),s&&(f=l*u,this._updateGeoAttrsExt(c,n,r,f));var w=e.findRenderItem(this.type,c.getProperties());c.setRenderItem(w),w&&p.push(c)}}}t.sub_pack_index?(this._subPackFeatures||(this._subPackFeatures={}),this._subPackFeatures[t.sub_pack_index]=p):this.features=p}},_updateGeoAttrsExt:function(t,e,n,i){if(!t||!e||!n)return!1;for(var r=n.length,o={},s=0;s<r;s++){var a=n[s].toLowerCase(),u=this.getFieldInfo(a),l=e[s+i];u.getType()===Yn.DB_INTEGER?l=parseInt(l):u.getType()===Yn.DB_DOUBLE&&(l=parseFloat(l)),o[a]=l}return t.setProperties(o),!0},readJson:function(t){if(t&&(this.id=void 0!==t.data_id?t.data_id:-1,this.name=t.name?t.name:"",t.bbox&&(this.bounds=new mt,this.bounds.readJson(t.bbox)),t.crs&&(this.projInfo=new Xn,this.projInfo.readJson(t.crs)),this.version=void 0!==t.data_version?t.data_version:-1,this.pvVersion=t.pv_info?t.pv_info.pv_version:0,this.type=t.type?t.type:0,t.fields_list&&0<t.fields_list.length)){this.fieldInfos=[],this.cacheFieldInfos=[];for(var e=t.fields_list,n=e.length,i=0;i<n;i++){var r=e[i];if(r){var o=new Hn;o.readJson(r),this.fieldInfos.push(o),r.cached&&this.cacheFieldInfos.push(o)}}}},getFieldInfo:function(t){if(!t)return null;var e=null;if(this.fieldInfos&&0<this.fieldInfos.length){t=t.toLowerCase();for(var n=this.fieldInfos.length,i=0;i<n;i++){var r=this.fieldInfos[i];if(null!==r&&r.getName().toLowerCase()===t){e=r;break}}}return e},clone:function(){return vt.clone(this)},getFieldNames:function(){if(!this.fieldInfos||0===this.fieldInfos.length)return null;for(var t=this.fieldInfos.length,e=[],n=0;n<t;n++){var i=this.fieldInfos[n];i&&e.push(i.getName().toLowerCase())}return e},getlatLngBounds:function(){return this.bounds?this.bounds.toLatLngBounds(this.projInfo):null},mergeFeatures:function(){if(this._subPackFeatures){var t=Object.keys(this._subPackFeatures);if(t&&0!==t.length){t.sort(function(t,e){return t-e});for(var e=t.length,n=this._subPackFeatures[t[0]],i=1;i<e;i++){var r=t[i],o=this._subPackFeatures[r];n=n.concat(o)}this.features=n,this._subPackFeatures=null}}},hasFeatureData:function(){return!!(this.features&&0<this.features.length)},clearData:function(){this.features=null,this._subPackFeatures=null},getLocalFeaturesByIds:function(n){if(!n||0===n.length||!this.features||0===this.features.length)return null;var i=[];return this.features.forEach(function(t){if(t){var e=t.getID();-1!==n.indexOf(e)&&i.push(t)}}),i}}),Zn={SELAYER:"vector_layer",SEGROUPLAYER:"group_layer"},Qn=G.Evented.extend({options:{},initialize:function(t){G.setOptions(this,t),this.id=vt.stamp(),this.sId=-1,this.visible=!0,this.selected=!0,this.editable=!1,this.snapable=!1,this.clip=!0,this.type=Zn.SELAYER,this.dataset=null,this.renderStyle=null,this.renderTextStyle=null,this.minScale=0,this.maxScale=0,this.name="",this.filter="",this.label="",this._parentLayerId=-1,this.itemFilter="",this.subFilters=null},getItemFilter:function(){return this.itemFilter},getType:function(){return this.type},getParentLayerId:function(){return this._parentLayerId},setParentLayerId:function(t){this._parentLayerId=t},getName:function(){return this.name},setName:function(t){this.name=t,this.label=t},getID:function(){return this.id},isVisible:function(){return this.visible},setVisible:function(t){this.visible=t},isSelected:function(){return this.selected},setSelected:function(t){this.selected=t},getMinScale:function(){return this.minScale},setMinScale:function(t){this.minScale=t},getMaxScale:function(){return this.maxScale},setMaxScale:function(t){this.maxScale=t},getFilter:function(){return this.filter},setFilter:function(t){this.filter=t},getDataset:function(){return this.dataset},getDatasetType:function(){return this.dataset?this.dataset.getType():ae.UNKNOWN},getRenderStyle:function(){return this.renderStyle},setRenderStyle:function(t){this.renderStyle=t},getRenderTextStyle:function(){return this.renderTextStyle},setRenderTextStyle:function(t){this.renderTextStyle=t},getRequestObj:function(t,e){if(this.visible&&this.dataset&&this.isQuery(e)){var n=this.dataset,i={avoid_overlapping:!0};i.dataset_id=n.id,i.dataset_ver=n.version,i.pvVersion=n.getPvVersion(),i.field_list=this.getRequestFields(e),i.filter=this.getFilter(),i.geo_clip=this.clip,i.layer_id=this.id,i.type=n.type,i.itemFilter=this.itemFilter,t.push(i)}},clearData:function(){this.dataset&&this.dataset.clearData()},isQuery:function(t){if(void 0===t)return!0;if(0<=t){t=1/t;var e=this.minScale,n=this.maxScale;if(0===n&&0===e)return!0;if(0===n&&0<e&&1/e<=t)return!0;if(0<n&&0===e&&t<=1/n)return!0;if(0<n&&0<e&&t<=1/n&&1/e<=t)return!0}return!1},isQueryLabel:function(t){return!(!this.renderTextStyle||!this.renderTextStyle.isQuery(t))},updateData:function(t){this.renderStyle||(this.renderStyle=de.createDefault(this.dataset.getType())),this.renderTextStyle||(this.renderTextStyle=Te.createDefault(this.dataset.getType())),this.dataset.updateRecordset(t,this.renderStyle)},readJson:function(t,e){if(t&&t.dataset_info&&e){this.expand=!!t.expand,this.filter=t.filter||"",this.sId=void 0!==t.id?t.id:-1,this.name=t.name?t.name:"",this.label=t.label?t.label:"",this.visible=!!t.visible,this.selected=!!t.selectable,this.minScale=t.min_scale?t.min_scale:0,this.maxScale=t.max_scale?t.max_scale:0;var n=t.dataset_info;this.providerType=n.provider_type,this.dtUrl=n.dt_url;var i=n.id;this.dataset=this._createDtFromInfo(i,e),this.dataset&&(t.render_style&&(this.renderStyle=de.readFromJson(t.render_style)),t.render_text_style&&(this.renderTextStyle=Te.readFromJson(t.render_text_style)))}},toJson:function(){var t={};this.renderStyle&&this.renderStyle.toJson(t);var e={};return this.renderTextStyle&&this.renderTextStyle.toJson(e),{class:this.getType(),expand:this.expand,filter:this.filter,id:this.id,name:this.name,label:this.label,visible:this.visible,selectable:this.selected,min_scale:this.minScale,max_scale:this.maxScale,dataset_info:{dt_url:this.dtUrl,feature_type:this.dataset.getType(),id:this.dataset.getID(),provider_type:this.providerType},render_style:t,render_text_style:e}},_createDtFromInfo:function(t,e){if(!e||!e.length)return null;for(var n=null,i=0;i<e.length;i++){var r=e[i];if(r.data_id===t){n=r;break}}if(!n)return null;var o=new Kn;return o.readJson(n),o},getRequestFields:function(t){var e=[];if(this.renderStyle){var n=this.renderStyle.getUsedFields();n&&0<n.length&&(e=e.concat(n))}if(this.isQueryLabel(t)){var i=this.renderTextStyle.getUsedFields();i&&0<i.length&&(e=e.concat(i))}return vt.uniqueArray(e)},clone:function(){return vt.clone()},draw:function(t,e){if(this.visible&&this.renderStyle&&this.dataset&&this.dataset.features&&this.dataset.features.length){var n=this.getGroupFeatures(t);this.renderStyle.bDrawByLegendGroup()?this._drawFeaturesByMerged(e,n):this._drawFeatures(e,n)}},_drawFeatures:function(t,e){if(e)for(var n in e){var i=e[n];if(i){var r=i.renderItem,o=i.geometrys;r.getSymbol().draw(t,o)}}},_drawFeaturesByMerged:function(h,c){var t=this.renderStyle.getLegendGroup(),e=t.getLegendClasses(),n=t.getLayerIndexList();n&&0!==n.length&&n.forEach(function(l){e.forEach(function(t){var e=t.getLayerIndexList();if(e){var n=e.indexOf(l);if(-1!==n){var i=t.getRenderItemId(),r=c[i];if(r){var o=r.renderItem,s=r.geometrys,a=o.getSymbol();if(!(a.getSymbolLayerCount()<=n)){var u=a.getSymbolLayer(n);u&&u.draw(h,s)}}}}})})},getGroupFeatures:function(s){if(!(this.visible&&this.dataset&&this.dataset.features&&this.dataset.features.length))return null;var t=this.dataset.features,a={};return t.forEach(function(t){if(t&&t.getRenderItem()){var e=t.getRenderItem(),n=e.getID();a[n]||(a[n]={geometrys:[],renderItem:e});var i=a[n].geometrys;if(t.getType()===xt.MULTIPOLYGON){var r=t.getPolygons();r&&0<r.length&&r.forEach(function(t){var e=t.toPixelGeometry(s);i.push(e)})}else{var o=t.toPixelGeometry(s);i.push(o)}}}),a},getLocalFeaturesByIds:function(t){return this.dataset?this.dataset.getLocalFeaturesByIds(t):null},updateFileData:function(t,e){if(this.renderStyle||(this.renderStyle=de.createDefault(this.dataset.getType())),this.renderTextStyle||(this.renderTextStyle=Te.createDefault(this.dataset.getType())),t&&0!==t.length){var n=this.dataset,i=!1,r=null;this.subFilters&&0<this.subFilters.length&&(r=this.subFilters,i=!0);for(var o=this.renderStyle,s=t.length,a=[],u=0;u<s;u++){var l=t[u];if(l){var h=l.properties;if(i&&r)if(!ln.compareItems(r,h))continue;e&&(l=l.clone());var c=o.findRenderItem(n.getType(),l.getProperties());l.setRenderItem(c),c&&a.push(l)}}n.features=a}}}),$n={NULL:0,PAN:1,SELECT_BY_POINT:12,SELECT_BY_RECT:13,SELECT_BY_CIRCLE:14,SELECT_BY_POLYGON:15,ZOOM_IN_BY_RECT:16,ZOOM_OUT_BY_RECT:17,MEASURE_DISTANCE:19,MEASURE_AREA:19,CREATE_POINT:21,CREATE_POLYLINE:22,CREATE_HAND_LINE:23,CREATE_HAND_POLYGON:25,CREATE_RECT:26,CREATE_FILL_RECT:27,CREATE_CIRCLE:28,CREATE_FILL_CIRCLE:29,CREATE_ELLIPSE:30,CREATE_FILL_ELLIPSE:31,CREATE_POLYGON:32,IDENTIFY:51,MOVE:1001,ROTATE:1002,EDIT_NODE:1003,ADD_NODE:1004,CLIP_LINE:1005,CLIP_POLYGON:1006},ti="images/cursor/",ei={identify:"identify.cur",selectByPoint:"selectByPoint.cur",selectByRect:"selectByRect.cur",selectByCircle:"selectByCircle.cur",selectByPolygon:"selectByRegion.cur",measureDistance:"ruler.cur",measureArea:"measureArea.cur",zoomInByRect:"zoomInByRect.cur",zoomOutByRect:"zoomOutByRect.cur",createCircle:"createCircle.cur",createEllipse:"createEllipse.cur",createHandLine:"createHandLine.cur",createPolyline:"createLine.cur",createPoint:"createPoint.cur",createPolygon:"createPolygon.cur",createRect:"createRect.cur",addNode:"editAddNode.cur",editNode:"editReShape.cur",reMove:"reMove.cur",rotate:"rotate.cur",clipLine:"clipLine.cur"};function ni(t){var e=ei;return e&&e[t]?ti+e[t]:""}var ii=G.Evented.extend({options:{},initialize:function(t,e){G.setOptions(this,e),this._map=t},setMouseStyle:function(t){var e=this._map.getContainer(),n="";switch(t){case $n.IDENTIFY:n=ni("identify");break;case $n.SELECT_BY_POINT:n=ni("selectByPoint");break;case $n.SELECT_BY_RECT:n=ni("selectByRect");break;case $n.SELECT_BY_CIRCLE:n=ni("selectByCircle");break;case $n.SELECT_BY_POLYGON:n=ni("selectByPolygon");break;case $n.MEASURE_DISTANCE:n=ni("measureDistance");break;case $n.MEASURE_AREA:n=ni("measureArea");break;case $n.ZOOM_IN_BY_RECT:n=ni("zoomInByRect");break;case $n.ZOOM_OUT_BY_RECT:n=ni("zoomOutByRect");break;case $n.CREATE_POINT:n=ni("createPoint");break;case $n.CREATE_POLYLINE:n=ni("createPolyline");break;case $n.CREATE_HAND_LINE:case $n.CREATE_HAND_POLYGON:n=ni("createHandLine");break;case $n.CREATE_RECT:case $n.CREATE_FILL_RECT:n=ni("createRect");break;case $n.CREATE_CIRCLE:case $n.CREATE_FILL_CIRCLE:n=ni("createCircle");break;case $n.CREATE_ELLIPSE:case $n.CREATE_FILL_ELLIPSE:n=ni("createEllipse");break;case $n.CREATE_POLYGON:n=ni("createPolygon");break;case $n.MOVE:n=ni("reMove");break;case $n.ROTATE:n=ni("rotate");break;case $n.EDIT_NODE:n=ni("editNode");break;case $n.ADD_NODE:n=ni("addNode");break;case $n.CLIP_LINE:n=ni("clipLine");break;default:n=""}e.style.cursor=n?"url("+n+"),crosshair":""},setMapDragging:function(t){t?(this._map.dragging.enable(),this._map.doubleClickZoom.enable()):(this._map.dragging.disable(),this._map.doubleClickZoom.disable())}}),ri=ii.extend({options:{style:{interactive:!1,color:"#ff0000",fillOpacity:0}},initialize:function(t,e){ii.prototype.initialize.call(this,t,e),this._enabled=!1,this._selectType="",this._clickPoints=null,this._feature=null},enable:function(t){switch(this.disable(),this._enabled=!0,this._selectType=t,this.setMapDragging(!1),this.setMouseStyle(t),t){case $n.SELECT_BY_POINT:this._map.on("click",this._onClick,this);break;case $n.IDENTIFY:case $n.SELECT_BY_RECT:case $n.SELECT_BY_CIRCLE:this._map.on("mousedown",this._onMouseDown,this),this._map.on("mousemove",this._onMouseMove,this),this._map.on("mouseup",this._onMouseUp,this);break;case $n.SELECT_BY_POLYGON:this._map.on("click",this._onClick,this),this._map.on("dblclick",this._onDblClick,this),this._map.on("mousemove",this._onMouseMove,this)}},disable:function(){this._enabled&&(this._enabled=!1,this._selectType="",this.setMapDragging(!0),this.setMouseStyle(),this._map.off("click",this._onClick,this),this._map.off("mousedown",this._onMouseDown,this),this._map.off("mousemove",this._onMouseMove,this),this._map.off("mouseup",this._onMouseUp,this),this._map.off("dblclick",this._onDblClick,this))},_onClick:function(t){var e=t.latlng;if(this._clickPoints||(this._clickPoints=[]),0<this._clickPoints.length){var n=this._clickPoints[this._clickPoints.length-1];if(e.equals(n))return}switch(this._clickPoints.push(e),this._selectType){case $n.SELECT_BY_POINT:this.fire("end",{selectType:this._selectType,points:[e]}),this._finish();break;case $n.SELECT_BY_POLYGON:var i=this._clickPoints.slice(0);this._feature?this._feature.setLatLngs(i):(this._feature=new G.Polygon(i,this.options.style),this._map.addLayer(this._feature))}},_onDblClick:function(){if(this._feature&&this._clickPoints&&0!==this._clickPoints.length)switch(this._selectType){case $n.SELECT_BY_POLYGON:var t=this._clickPoints.slice(0);if(t.length<=2)break;t.push(t[0]),this.fire("end",{selectType:this._selectType,points:t}),this._finish()}},_onMouseDown:function(t){var e=t.latlng;switch(this._clickPoints||(this._clickPoints=[]),this._clickPoints.push(e),this._selectType){case $n.IDENTIFY:case $n.SELECT_BY_RECT:this._feature||(this._feature=new G.Polygon([],this.options.style),this._map.addLayer(this._feature));break;case $n.SELECT_BY_CIRCLE:this._feature||(this._feature=new G.CircleMarker(e,this.options.style),this._feature.setRadius(0),this._map.addLayer(this._feature))}},_onMouseUp:function(t){if(this._feature){var e=t.latlng;switch(this._selectType){case $n.IDENTIFY:case $n.SELECT_BY_RECT:case $n.SELECT_BY_CIRCLE:var n=this._clickPoints[0];this.fire("end",{selectType:this._selectType,points:[n,e]}),this._finish()}}},_onMouseMove:function(t){if(this._feature){var e=t.latlng;switch(this._selectType){case $n.SELECT_BY_POLYGON:var n=this._clickPoints.slice(0);n.push(e),this._feature.setLatLngs(n);break;case $n.IDENTIFY:case $n.SELECT_BY_RECT:var i=this._clickPoints[0],r=this._toRect([i,e]);this._feature.setLatLngs(r);break;case $n.SELECT_BY_CIRCLE:var o=this._clickPoints[0];o=this._map.latLngToContainerPoint(o);var s=t.containerPoint,a=Math.sqrt((o.x-s.x)*(o.x-s.x)+(o.y-s.y)*(o.y-s.y));this._feature.setRadius(a)}}},_finish:function(){this._clickPoints=null,this._feature&&(this._map.removeLayer(this._feature),this._feature=null)},_toRect:function(t){if(!t||t.length<2)return[];var e=t[0],n=t[1],i=Math.min(e.lng,n.lng),r=Math.max(e.lng,n.lng),o=Math.min(e.lat,n.lat),s=Math.max(e.lat,n.lat);return[new G.LatLng(s,i),new G.LatLng(o,i),new G.LatLng(o,r),new G.LatLng(s,r),new G.LatLng(s,i)]}}),oi=G.Class.extend({options:{ids:null,layerId:""},initialize:function(t){G.setOptions(this,t)},setIds:function(t){this.options.ids=t},getIds:function(){return this.options.ids},getLayerId:function(){return this.options.layerId},setLayerId:function(t){this.options.layerId=t},hasId:function(t){var e=this.options.ids;return!(!e||0===e.length)&&-1!==e.indexOf(t)},addId:function(t){this.options.ids||(this.options.ids=[]),this.hasId(t)||this.options.ids.push(t)},getCount:function(){return this.options.ids?this.options.ids.length:0},isNull:function(){return!this.options.ids||0===this.options.ids.length}}),si=G.Evented.extend({options:{},initialize:function(t,e){G.setOptions(this,e),this._map=t},select:function(i,t,e){var r=this;if(i&&t&&t.length){e=e||{};var o=function(t){e.success&&e.success(t)},s=function(t){e.error&&e.error(t)},n=this._map.seManager,a=!0;i===$n.IDENTIFY&&(a=!1),a&&n.clearSelection();var u=this._getQueryLayerInfos();if(u&&u.length){var l=n.getSelectSetting(),h=l.tolerance,c=l.bQueryAll,p=this._getQueryDefine(i,t,h),f=1;c&&(f=u.length),lt({data:{dataset_list:u,query_define:p,effective_dataset_count:f},success:function(t){if(t.status===rt.SUCCESS){var e=t.result.dataset_list,n=r._handleResult(i,e);a&&r._addToSelection(n),i===$n.IDENTIFY&&r._handleIdentifyResult(n),o(n)}else s(t.message)},error:function(){s("select error")}})}else o()}},_handleResult:function(e,t){if(!t||0===t.length)return null;var n=[];return t.forEach(function(t){t&&t.feature_id_list&&0!==t.feature_id_list.length&&(e===$n.SELECT_BY_POINT&&1<t.feature_id_list.length&&(t.feature_id_list=[t.feature_id_list[0]]),n.push(t))}),n},_getQueryDefine:function(t,e,n){var i={};switch(t){case $n.IDENTIFY:var r=e[0],o=e[1];r.equals(o)?i.bbox=this._pointToRect(r,n):i.bbox=this._pointsToRect(e),i.type=at.BOUNDS;break;case $n.SELECT_BY_POINT:i.bbox=this._pointToRect(e[0],n),i.type=at.BOUNDS;break;case $n.SELECT_BY_RECT:i.bbox=this._pointsToRect(e),i.type=at.BOUNDS;break;case $n.SELECT_BY_CIRCLE:var s=e[0],a=e[1];i.center={x:s.lng,y:s.lat},i.radius=Math.sqrt((a.lng-s.lng)*(a.lng-s.lng)+(a.lat-s.lat)*(a.lat-s.lat)),i.type=at.CIRCLE;break;case $n.SELECT_BY_POLYGON:i.feature=this._pointsToFeature(e),i.type=at.INTERSECTS}return i},_pointsToFeature:function(t){var e=[];return t.forEach(function(t){e.push([t.lng,t.lat])}),{type:"Feature",geometry:{type:"Polygon",coordinates:[e]}}},_pointsToRect:function(t){var e=t[0],n=t[1];return{min_x:Math.min(e.lng,n.lng),min_y:Math.min(e.lat,n.lat),max_x:Math.max(e.lng,n.lng),max_y:Math.max(e.lat,n.lat)}},_pointToRect:function(t,e){var n=this._map.getBounds(),i=e*((n.getEast()-n.getWest())/this._map.getSize().x);return{min_x:t.lng-i,min_y:t.lat-i,max_x:t.lng+i,max_y:t.lat+i}},_getQueryLayerInfos:function(){var t=this._map.seManager.getVectorServiceList();if(!t||0===t.length)return null;var i=[];return t.forEach(function(t){if(t){var e=t.getLayers(!0);e&&0!==e.length&&e.forEach(function(t){if(t&&t.selected&&t.dataset&&t.dataset.hasFeatureData()){var e=t.dataset,n={layer_id:t.id,dataset_id:e.id,dataset_ver:e.version,filter:t.getFilter()};i.push(n)}})}}),i},_addToSelection:function(t){if(t&&0!==t.length){var o=this._map.seManager;t.forEach(function(t){if(t&&t.feature_id_list&&0!==t.feature_id_list.length){var e=t.feature_id_list,n=t.layer_id,i=o.getVectorServiceByLayerId(n);if(i){var r=new oi({layerId:n,ids:e});i.addSelection(r)}}}),o.drawSelection()}},_handleIdentifyResult:function(t){if(t&&0!==t.length){var r=this._map.seManager,o=[];t.forEach(function(t){if(t&&t.feature_id_list&&0!==t.feature_id_list.length){var e=t.feature_id_list,n=t.layer_id,i=r.getLayerById(n).getLocalFeaturesByIds(e);i&&0<i.length&&(o=o.concat(i))}}),0<o.length&&r.showIdentifyFeatures(o),r.fire("identify_end",{data:t})}}}),ai="没有可编辑图层",ui="编辑要素个数超过50个，无法编辑",li="当前没有可编辑要素，请选择编辑要素",hi="一次只能选择一个要素进行节点编辑",ci="一次只能选择一个面要素进行面分割",pi="锁定要素失败",fi="添加要素失败",di="删除要素失败",gi="修改图元失败",yi="分割要素失败",_i="请将分割点置于编辑要素容差范围内",mi="面分割失败",vi="请将节点置于编辑要素容差范围内",bi="同步数据集信息失败",xi={SMSCircle:"circle",SMSCross:"cross",SMSEclipse:"eclipse",SMSDiamond:"diamond",SMSSquare:"square",SMSStar:"star",SMSTriangle:"triangle",SMSX:"x",SMSGT:"gt"},Ei={angle:0,size:6,halo:null},wi=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Ei,t),e.type=Zt,e}return d(n,re),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.angle=t.angle,this.options.size=gt.poundToPixel(t.size),t.halo&&(this.options.halo=new Rn,this.options.halo.readJson(t.halo))}},{key:"toJson",value:function(t){if(t)if(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.angle=this.options.angle,t.size=gt.pixelToPound(this.options.size),this.options.halo){var e={};this.options.halo.toJson(e),t.halo=e}else t.halo=null}},{key:"setAngle",value:function(t){this.options.angle=t}},{key:"getAngle",value:function(){return this.options.angle}},{key:"setSize",value:function(t){this.options.size=t}},{key:"getSize",value:function(){return this.options.size}},{key:"getHalo",value:function(){return this.options.halo}},{key:"setHalo",value:function(t){this.options.halo=t}},{key:"draw",value:function(e,t){var n=this;e&&t&&t.length&&this.isVisible()&&t.forEach(function(t){t&&t.points&&t.points.length&&t.points.forEach(function(t){n.drawPoint(e,t)})})}},{key:"drawPoint",value:function(t,e){}},{key:"_drawHalo",value:function(t){var e=this.getHalo();if(e&&e.hasHalo()){var n=e.getColor().getStrColor(),i=e.getSize();t.save(),t.lineJoin="round",t.lineCap="round",t.strokeStyle=n,t.lineWidth=2*i,t.stroke(),t.restore()}}}]),n}(),Ii={locked:!1,visible:!0,xOffset:0,yOffset:0},Li=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Ii,t),e}return d(n,wi),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.locked=t.color_locked,this.options.visible=t.visible,this.options.xOffset=gt.poundToPixel(t.offset_x),this.options.yOffset=gt.poundToPixel(t.offset_y)}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.color_locked=this.options.locked,t.visible=this.options.visible,t.offset_x=gt.pixelToPound(this.options.xOffset),t.offset_y=gt.pixelToPound(this.options.yOffset))}},{key:"isLocked",value:function(){return this.options.locked}},{key:"setLocked",value:function(t){this.options.locked=t}},{key:"isVisible",value:function(){return this.options.visible}},{key:"setVisible",value:function(t){this.options.visible=t}},{key:"setOffsetX",value:function(t){this.options.xOffset=t}},{key:"getOffsetX",value:function(){return this.options.xOffset}},{key:"setOffsetY",value:function(t){this.options.yOffset=t}},{key:"getOffsetY",value:function(){return this.options.yOffset}}]),n}(),Si={drawArc:function(t,e,n){var i=n/2;t.beginPath(),t.arc(e.x,e.y,i,0,2*Math.PI)},eclipse:function(t,e,n,i){t.save();var r=i<n?n:i,o=n/r,s=i/r;t.scale(o,s),t.beginPath(),t.moveTo((e.x+n)/o,e.y/s),t.arc(e.x/o,e.y/s,r,0,2*Math.PI),t.closePath(),t.restore()},drawEclipse:function(t,e,n){var i=n/2,r=n/4;i&&r&&(i===r?this.drawArc(t,e,i):this.eclipse(t,e,i,r))},drawTriangle:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(0,-.5*n),t.lineTo(.5*n,.5*n),t.lineTo(-.5*n,.5*n),t.closePath(),t.restore()},drawSquare:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,.5*n),t.lineTo(.5*n,.5*n),t.lineTo(.5*n,-.5*n),t.lineTo(-.5*n,-.5*n),t.closePath(),t.restore()},drawStar:function(t,e,n,i){t.save(),t.translate(e.x,e.y);var r=i+53;t.rotate(r*Math.PI/180);var o=Math.cos(.4*Math.PI)/Math.cos(.2*Math.PI)*n*1.3;t.beginPath(),t.moveTo(o,0);for(var s=0;s<9;s++)t.rotate(Math.PI/5),s%2==0?t.lineTo(o/.525731*.200811,0):t.lineTo(o,0);t.closePath(),t.restore()},drawDiamond:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,0),t.lineTo(0,.5*n),t.lineTo(.5*n,0),t.lineTo(0,-.5*n),t.closePath(),t.restore()},drawCross:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,0),t.lineTo(.5*n,0),t.moveTo(0,.5*n),t.lineTo(0,-.5*n),t.restore()},drawX:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,-.5*n),t.lineTo(.5*n,.5*n),t.moveTo(-.5*n,.5*n),t.lineTo(.5*n,-.5*n),t.restore()},drawGT:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,0),t.lineTo(0,0),t.lineTo(0,-.5*n),t.lineTo(.5*n,-.5*n),t.lineTo(.5*n,0),t.restore()},drawImage:function(t,e,n,i,r){t.save();var o=Math.round(n)>>1;if(t.translate(e.x,e.y),t.rotate(i*Math.PI/180),r.width===r.height)t.drawImage(r,-o,-o,n,n);else if(r.width>r.height){var s=n*r.height/r.width;t.drawImage(r,-o,-s/2,n,s)}else{var a=n*r.width/r.height;t.drawImage(r,-a/2,-o,a,n)}t.restore()},drawArrow:function(t,e,n,i,r,o){r/=2,o/=2,t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.moveTo(-r,o),t.lineTo(r,0),t.lineTo(-r,-o),t.lineTo(-r,o),t.restore()},drawPath:function(t,e,n){if(e&&0!==e.length){n&&t.beginPath();for(var i=e.length,r=0;r<i;r++){var o=e[r];0===r?t.moveTo(o.x,o.y):t.lineTo(o.x,o.y)}}}},Mi={hasOutline:!1,outlineColor:null,outlineWidth:1,simpleMarkerStyle:xi.SMSCircle},Ci=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Mi,t),e.class=Rt,e.options.outlineColor||(e.options.outlineColor=ne.createRandom()),e}return d(n,Li),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.hasOutline=t.has_outline,this.options.outlineColor=ne.createFromArray(t.outline_color),this.options.outlineWidth=gt.poundToPixel(t.outline_width),this.options.simpleMarkerStyle=t.simple_marker_symbol_type}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.has_outline=this.options.hasOutline,this.options.outlineColor?t.outline_color=this.options.outlineColor.toArray():t.outline_color=null,t.outline_width=gt.pixelToPound(this.options.outlineWidth),t.simple_marker_symbol_type=this.options.simpleMarkerStyle)}},{key:"hasOutline",value:function(){return this.options.hasOutline}},{key:"setHasOutline",value:function(t){this.options.hasOutline=t}},{key:"getOutlineWidth",value:function(){return this.options.outlineWidth}},{key:"setOutlineWidth",value:function(t){this.options.outlineWidth=t}},{key:"getOutlineColor",value:function(){return this.options.outlineColor}},{key:"setOutlineColor",value:function(t){this.options.outlineColor=t}},{key:"getSimpleMarkerStyle",value:function(){return this.options.simpleMarkerStyle}},{key:"setSimpleMarkerStyle",value:function(t){this.options.simpleMarkerStyle=t}},{key:"drawPoint",value:function(t,e){if(t&&e&&this.isVisible()){var n=this.getSize(),i=this.getAngle(),r=this.getOffsetX(),o=this.getOffsetY(),s=this.getSimpleMarkerStyle();e.x+=r,e.y+=o;var a=!1;switch(s){case xi.SMSCircle:Si.drawArc(t,e,n);break;case xi.SMSCross:Si.drawCross(t,e,n,i),a=!0;break;case xi.SMSEclipse:Si.drawEclipse(t,e,n);break;case xi.SMSDiamond:Si.drawDiamond(t,e,n,i);break;case xi.SMSSquare:Si.drawSquare(t,e,n,i);break;case xi.SMSStar:Si.drawStar(t,e,n,i);break;case xi.SMSTriangle:Si.drawTriangle(t,e,n,i);break;case xi.SMSX:Si.drawX(t,e,n,i),a=!0;break;case xi.SMSGT:Si.drawGT(t,e,n,i),a=!0}var u=this.getHalo();u&&u.hasHalo()&&this._drawHalo(t);var l=this.getColor().getStrColor();t.strokeStyle=l,t.fillStyle=l,t.lineWidth=1,a?t.stroke():t.fill("evenodd"),this.hasOutline()&&!a&&(t.lineWidth=this.getOutlineWidth(),t.strokeStyle=this.getOutlineColor().getStrColor(),t.stroke())}}}]),n}(),Pi={width:1},Ni=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Pi,t),e.type=Qt,e}return d(n,re),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.width=gt.poundToPixel(t.width)}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.width=gt.pixelToPound(this.options.width))}},{key:"getWidth",value:function(){return this.options.width}},{key:"setWidth",value:function(t){this.options.width=t}},{key:"draw",value:function(u,t){var l=this;u&&t&&t.length&&this.isVisible()&&t.forEach(function(t){if(t){var e=t.points,n=t.polyCount,i=t.subCount;if(e&&e.length&&n&&i&&n.length===i)for(var r=0,o=0;o<i;o++){var s=n[o],a=e.slice(r,r+s);r+=s,l.drawLine(u,a)}}})}},{key:"drawLine",value:function(t,e){}}]),n}(),Oi={locked:!1,visible:!0},Ti=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Oi,t),e}return d(n,Ni),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.locked=t.color_locked,this.options.visible=t.visible}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.color_locked=this.options.locked,t.visible=this.options.visible)}},{key:"isLocked",value:function(){return this.options.locked}},{key:"setLocked",value:function(t){this.options.locked=t}},{key:"isVisible",value:function(){return this.options.visible}},{key:"setVisible",value:function(t){this.options.visible=t}}]),n}(),Ri="dashed",ki="dotted",Di="dashed_dot",Ai="dashed_dot_dot",Fi={linePenStyle:"solid"},Gi=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Fi,t),e.class=Gt,e}return d(n,Ti),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.linePenStyle=t.simple_line_symbol_type}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.simple_line_symbol_type=this.options.linePenStyle)}},{key:"getLinePenStyle",value:function(){return this.options.linePenStyle}},{key:"setLinePenStyle",value:function(t){this.options.linePenStyle=t}},{key:"draw",value:function(u,t){if(u&&t&&t.length&&this.isVisible()){u.beginPath(),t.forEach(function(t){if(t){var e=t.points,n=t.polyCount,i=t.subCount;if(e&&e.length&&n&&i&&n.length===i)for(var r=0,o=0;o<i;o++){var s=n[o],a=e.slice(r,r+s);r+=s,Si.drawPath(u,a,!1)}}}),u.strokeStyle=this.getColor().getStrColor(),u.lineWidth=this.getWidth();var e=this._createDashArray();e&&0<e.length&&u.setLineDash(e),u.stroke()}}},{key:"drawLine",value:function(t,e){if(t&&e&&!(e.length<2)&&this.isVisible()){Si.drawPath(t,e,!0),t.strokeStyle=this.getColor().getStrColor(),t.lineWidth=this.getWidth();var n=this._createDashArray();n&&0<n.length&&t.setLineDash(n),t.stroke()}}},{key:"_createDashArray",value:function(){var t=null;switch(this.getLinePenStyle()){case Ri:t=[5,10];break;case ki:t=[1,5];break;case Di:t=[1,5,5,5];break;case Ai:t=[1,5,1,5,5,5]}return t}}]),n}(),Bi={enable:!1,shadowAngle:90,shadowHeight:10,shadowColor:new ne(180,180,180),shadowLineColor:new ne(165,165,165)},Ui=function(){function e(t){h(this,e),this.options=gt.extend({},Bi,t)}return c(e,[{key:"readJson",value:function(t){this.options.enable=t.enable,this.options.shadowAngle=t.shadow_angle,this.options.shadowHeight=gt.poundToPixel(t.shadow_height),this.options.shadowColor=ne.createFromArray(t.shadow_color),this.options.shadowLineColor=ne.createFromArray(t.shadow_line_color)}},{key:"toJson",value:function(t){t&&(t.enable=this.options.enable,t.shadow_angle=this.options.shadowAngle,t.shadow_height=gt.pixelToPound(this.options.shadowHeight),this.options.shadowColor?t.shadow_color=this.options.shadowColor.toArray():t.shadow_color=null,this.options.shadowLineColor?t.shadow_line_color=this.options.shadowLineColor.toArray():t.shadow_line_color=null)}},{key:"enable",value:function(){return this.options.enable}},{key:"setEnable",value:function(t){this.options.enable=t}},{key:"setShadowAngle",value:function(t){this.options.shadowAngle=t}},{key:"getShadowAngle",value:function(){return this.options.shadowAngle}},{key:"setShadowHeight",value:function(t){this.options.shadowHeight=t}},{key:"getShadowHeight",value:function(){return this.options.shadowHeight}},{key:"getShadowColor",value:function(){return this.options.shadowColor}},{key:"setShadowColor",value:function(t){this.options.shadowColor=t}},{key:"getShadowLineColor",value:function(){return this.options.shadowLineColor}},{key:"setShadowLineColor",value:function(t){this.options.shadowLineColor=t}}]),e}(),qi={hasOutline:!1,outlineSymbol:null,shadow:null},ji=function(t){function i(t){h(this,i);var e=y(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.mergeOptions(qi,t),e.type=$t,e}return d(i,re),c(i,[{key:"readJson",value:function(t){f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"readJson",this).call(this,t),this.options.hasOutline=t.has_outline,t.outline_symbol&&(this.options.outlineSymbol=re.readFromJson(t.outline_symbol)),t.shadow&&(this.options.shadow=new Ui,this.options.shadow.readJson(t.shadow))}},{key:"toJson",value:function(t){if(t){if(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJson",this).call(this,t),t.has_outline=this.options.hasOutline,this.options.outlineSymbol){var e={};this.options.outlineSymbol.toJson(e),t.outline_symbol=e}else t.outline_symbol=null;if(this.options.shadow){var n={};this.options.shadow.toJson(n),t.shadow=n}else t.shadow=null}}},{key:"hasOutline",value:function(){return this.options.hasOutline}},{key:"setHasOutline",value:function(t){this.options.hasOutline=t}},{key:"getOutlineSymbol",value:function(){return this.options.outlineSymbol}},{key:"setOutlineSymbol",value:function(t){this.options.outlineSymbol=t}},{key:"getShadow",value:function(){return this.options.shadow}},{key:"setShadow",value:function(t){this.options.shadow=t}},{key:"setOutlineColor",value:function(t){this.options.outlineSymbol&&this.options.outlineSymbol.setColor(t)}},{key:"getOutlineColor",value:function(){return this.options.outlineSymbol?this.options.outlineSymbol.getColor():this.getColor()}},{key:"setOutlineWidth",value:function(t){this.options.outlineSymbol&&this.options.outlineSymbol.setWidth(t)}},{key:"getOutlineWidth",value:function(){return this.options.outlineSymbol?this.options.outlineSymbol.getWidth():0}},{key:"draw",value:function(e,t){var n=this;e&&t&&t.length&&this.isVisible()&&t.forEach(function(t){t&&n._drawGeometry(e,t)})}},{key:"drawPolygon",value:function(t,e){if(t&&e&&!(e.length<3)&&this.isVisible()){var n=new _t({points:e,polyCount:[e.length],subCount:1});this._drawGeometry(t,n)}}},{key:"_drawGeometry",value:function(t,e){}},{key:"setTranspercent",value:function(t){var e=this.getColor();e.alpha=t,this.setColor(e);var n=this.getOutlineColor();n.alpha=t,this.setOutlineColor(n)}}]),i}(),zi={locked:!1,visible:!0},Vi=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(zi,t),e}return d(n,ji),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.locked=t.color_locked,this.options.visible=t.visible}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.color_locked=this.options.locked,t.visible=this.options.visible)}},{key:"isLocked",value:function(){return this.options.locked}},{key:"setLocked",value:function(t){this.options.locked=t}},{key:"isVisible",value:function(){return this.options.visible}},{key:"setVisible",value:function(t){this.options.visible=t}}]),n}(),Yi={},Hi=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Yi,t),e.class=zt,e}return d(n,Vi),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t)}},{key:"toJson",value:function(t){t&&f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t)}},{key:"_drawGeometry",value:function(t,e){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){var o=0;t.beginPath();for(var s=0;s<i;s++){var a=r[s],u=n.slice(o,o+a);Si.drawPath(t,u),o+=a}t.fillStyle=this.getColor().getStrColor(),t.fill("evenodd");var l=this.getOutlineSymbol();this.hasOutline()&&l&&l.draw(t,[e])}}}]),n}(),Xi=G.Layer.extend({options:{pane:Vn,zIndex:0},initialize:function(t){G.setOptions(this,t),this.renderer=this._createRenderer(),this._features=null,this._symbol=null},_createRenderer:function(){var t=this.options.pane||Vn;return new C({pane:t,zIndex:this.options.zIndex})},onAdd:function(t){t.addLayer(this.renderer)},onRemove:function(){this._map&&this._map.removeLayer(this.renderer)},setSymbol:function(t){this._symbol=t},setZIndex:function(t){this.options.zIndex=t,this.renderer.setZIndex(t)},getEvents:function(){return{moveend:this.draw,viewreset:this.draw}},addFeature:function(t){this._features||(this._features=[]),this._features.push(t)},getFeatures:function(){return this._features},setFeatures:function(t){this._features=t},addGeoJSON:function(t){var e=G.Util.isArray(t)?t:t.features,n=void 0,i=void 0,r=null;if(e)for(n=0,i=e.length;n<i;n++)((r=e[n]).geometries||r.geometry||r.features||r.coordinates)&&this.addGeoJSON(r);(r=bt.createFeatureFromGeoJSON(t))&&this.addFeature(r)},clearRenderer:function(){this.renderer.clear()},clear:function(){this._features=null,this.clearRenderer()},draw:function(){var n=this;if(this.clearRenderer(),this._map&&this._features&&0!==this._features.length){var i=this.renderer.ctx,r=this._symbol;this._features.forEach(function(t){if(t)if(r||(r=t.getSymbol()),r||(r=n.getDefaultSymbol(t.getType())),t.getType()===xt.MULTIPOLYGON){t.getPolygons().forEach(function(t){var e=t.toPixelGeometry(n._map,!0);r.draw(i,[e])})}else{var e=t.toPixelGeometry(n._map,!0);r.draw(i,[e])}})}},getDefaultSymbol:function(t){var e=null;switch(t){case xt.POINT:e=new Ci({color:new ne(0,0,255,255)});break;case xt.LINE:e=new Gi({width:1,color:new ne(0,0,0,255)});break;case xt.POLYGON:case xt.MULTIPOLYGON:e=new Hi({color:new ne(203,220,245,255),hasOutline:!0,outlineSymbol:new Gi})}return e}}),Wi=6371008.8,Ji={meters:Wi,metres:Wi,millimeters:1e3*Wi,millimetres:1e3*Wi,centimeters:100*Wi,centimetres:100*Wi,kilometers:Wi/1e3,kilometres:Wi/1e3,miles:Wi/1609.344,nauticalmiles:Wi/1852,inches:39.37*Wi,yards:Wi/1.0936,feet:3.28084*Wi,radians:1,degrees:Wi/111325},Ki={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:.001,kilometres:.001,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/Wi,degrees:1/111325},Zi={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function Qi(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&Er(i),r&&wr(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function $i(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i,r=n.bbox;if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");switch(r&&Er(r),t){case"Point":i=tr(e).geometry;break;case"LineString":i=rr(e).geometry;break;case"Polygon":i=nr(e).geometry;break;case"MultiPoint":i=ur(e).geometry;break;case"MultiLineString":i=ar(e).geometry;break;case"MultiPolygon":i=lr(e).geometry;break;default:throw new Error(t+" is invalid")}return r&&(i.bbox=r),i}function tr(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!br(t[0])||!br(t[1]))throw new Error("coordinates must contain numbers");return Qi({type:"Point",coordinates:t},e,n)}function er(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return sr(t.map(function(t){return tr(t,e)}),n)}function nr(t,e,n){if(!t)throw new Error("coordinates is required");for(var i=0;i<t.length;i++){var r=t[i];if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<r[r.length-1].length;o++){if(0===i&&0===o&&!br(r[0][0])||!br(r[0][1]))throw new Error("coordinates must contain numbers");if(r[r.length-1][o]!==r[0][o])throw new Error("First and last Position are not equivalent.")}}return Qi({type:"Polygon",coordinates:t},e,n)}function ir(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return sr(t.map(function(t){return nr(t,e)}),n)}function rr(t,e,n){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!br(t[0][1])||!br(t[0][1]))throw new Error("coordinates must contain numbers");return Qi({type:"LineString",coordinates:t},e,n)}function or(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return sr(t.map(function(t){return rr(t,e)}),n)}function sr(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&Er(n),i&&wr(i);var r={type:"FeatureCollection"};return i&&(r.id=i),n&&(r.bbox=n),r.features=t,r}function ar(t,e,n){if(!t)throw new Error("coordinates is required");return Qi({type:"MultiLineString",coordinates:t},e,n)}function ur(t,e,n){if(!t)throw new Error("coordinates is required");return Qi({type:"MultiPoint",coordinates:t},e,n)}function lr(t,e,n){if(!t)throw new Error("coordinates is required");return Qi({type:"MultiPolygon",coordinates:t},e,n)}function hr(t,e,n){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return Qi({type:"GeometryCollection",geometries:t},e,n)}function cr(t,e){if(null==t||isNaN(t))throw new Error("num is required");if(e&&!(0<=e))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function pr(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=Ji[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t*n}function fr(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=Ji[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t/n}function dr(t,e){return yr(fr(t,e))}function gr(t){if(null==t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e}function yr(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function _r(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function mr(t,e,n){if(null==t)throw new Error("length is required");if(!(0<=t))throw new Error("length must be a positive number");return pr(fr(t,e),n||"kilometers")}function vr(t,e,n){if(null==t)throw new Error("area is required");if(!(0<=t))throw new Error("area must be a positive number");var i=Zi[e||"meters"];if(!i)throw new Error("invalid original units");var r=Zi[n||"kilometers"];if(!r)throw new Error("invalid final units");return t/i*r}function br(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function xr(t){return!!t&&t.constructor===Object}function Er(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!br(t))throw new Error("bbox must only contain numbers")})}function wr(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var Ir=Object.freeze({earthRadius:Wi,factors:Ji,unitsFactors:Ki,areaFactors:Zi,feature:Qi,geometry:$i,point:tr,points:er,polygon:nr,polygons:ir,lineString:rr,lineStrings:or,featureCollection:sr,multiLineString:ar,multiPoint:ur,multiPolygon:lr,geometryCollection:hr,round:cr,radiansToLength:pr,lengthToRadians:fr,lengthToDegrees:dr,bearingToAzimuth:gr,radiansToDegrees:yr,degreesToRadians:_r,convertLength:mr,convertArea:vr,isNumber:br,isObject:xr,validateBBox:Er,validateId:wr,radians2degrees:function(){throw new Error("method has been renamed to `radiansToDegrees`")},degrees2radians:function(){throw new Error("method has been renamed to `degreesToRadians`")},distanceToDegrees:function(){throw new Error("method has been renamed to `lengthToDegrees`")},distanceToRadians:function(){throw new Error("method has been renamed to `lengthToRadians`")},radiansToDistance:function(){throw new Error("method has been renamed to `radiansToLength`")},bearingToAngle:function(){throw new Error("method has been renamed to `bearingToAzimuth`")},convertDistance:function(){throw new Error("method has been renamed to `convertLength`")}});function Lr(t,e,n){if(null!==t)for(var i,r,o,s,a,u,l,h,c=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,y=d?t.features.length:1,_=0;_<y;_++){a=(h=!!(l=d?t.features[_].geometry:g?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var m=0;m<a;m++){var v=0,b=0;if(null!==(s=h?l.geometries[m]:l)){u=s.coordinates;var x=s.type;switch(c=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":e(u,p,_,v,b),p++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++)e(u[i],p,_,v,b),p++,"MultiPoint"===x&&v++;"LineString"===x&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(r=0;r<u[i].length-c;r++)e(u[i][r],p,_,v,b),p++;"MultiLineString"===x&&v++,"Polygon"===x&&b++}"Polygon"===x&&v++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for("MultiPolygon"===x&&(b=0),r=0;r<u[i].length;r++){for(o=0;o<u[i][r].length-c;o++)e(u[i][r][o],p,_,v,b),p++;b++}v++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)Lr(s.geometries[i],e,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function Sr(t,o,s,e){var a=s;return Lr(t,function(t,e,n,i,r){a=0===e&&void 0===s?t:o(a,t,e,n,i,r)},e),a}function Mr(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties,n);break;case"Feature":e(t.properties,0)}}function Cr(t,n,i){var r=i;return Mr(t,function(t,e){r=0===e&&void 0===i?t:n(r,t,e)}),r}function Pr(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n],n)}function Nr(t,n,i){var r=i;return Pr(t,function(t,e){r=0===e&&void 0===i?t:n(r,t,e)}),r}function Or(t){var e=[];return Lr(t,function(t){e.push(t)}),e}function Tr(t,e){var n,i,r,o,s,a,u,l,h,c,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:d?t.geometry:t,l=f?t.features[n].properties:d?t.properties:{},h=f?t.features[n].bbox:d?t.bbox:void 0,c=f?t.features[n].id:d?t.id:void 0,s=(u=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=u?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":e(o,p,l,h,c);break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)e(o.geometries[i],p,l,h,c);break;default:throw new Error("Unknown Geometry Type")}else e(null,p,l,h,c);p++}}function Rr(t,o,s){var a=s;return Tr(t,function(t,e,n,i,r){a=0===e&&void 0===s?t:o(a,t,e,n,i,r)}),a}function kr(t,a){Tr(t,function(t,n,i,e,r){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return void a(Qi(t,i,{bbox:e,id:r}),n,0)}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}t.coordinates.forEach(function(t,e){a(Qi({type:o,coordinates:t},i),n,e)})})}function Dr(t,i,r){var o=r;return kr(t,function(t,e,n){o=0===e&&0===n&&void 0===r?t:i(o,t,e,n)}),o}function Ar(t,c){kr(t,function(a,u,l){var h=0;if(a.geometry){var t=a.geometry.type;"Point"!==t&&"MultiPoint"!==t&&Sr(a,function(t,e,n,i,r,o){var s=rr([t,e],a.properties);return c(s,u,l,o,h),h++,e})}})}function Fr(t,o,s){var a=s,u=!1;return Ar(t,function(t,e,n,i,r){a=!1===u&&void 0===s?t:o(a,t,e,n,i,r),u=!0}),a}function Gr(t,s){if(!t)throw new Error("geojson is required");kr(t,function(t,e,n){if(null!==t.geometry){var i=t.geometry.type,r=t.geometry.coordinates;switch(i){case"LineString":s(t,e,n,0,0);break;case"Polygon":for(var o=0;o<r.length;o++)s(rr(r[o],t.properties),e,n,o)}}})}function Br(t,r,o){var s=o;return Gr(t,function(t,e,n,i){s=0===e&&void 0===o?t:r(s,t,e,n,i)}),s}var Ur=Object.freeze({coordEach:Lr,coordReduce:Sr,propEach:Mr,propReduce:Cr,featureEach:Pr,featureReduce:Nr,coordAll:Or,geomEach:Tr,geomReduce:Rr,flattenEach:kr,flattenReduce:Dr,segmentEach:Ar,segmentReduce:Fr,lineEach:Gr,lineReduce:Br});function qr(t){var e=[1/0,1/0,-1/0,-1/0];return Lr(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}function jr(t){if(!t)throw new Error("obj is required");var e=zr(t);if(1<e.length&&br(e[0])&&br(e[1]))return e;throw new Error("Coordinate is not a valid Point")}function zr(t){if(!t)throw new Error("obj is required");var e;if(t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates),e)return Vr(e),e;throw new Error("No valid coordinates")}function Vr(t){if(1<t.length&&br(t[0])&&br(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return Vr(t[0]);throw new Error("coordinates must only contain numbers")}function Yr(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function Hr(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function Xr(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0;i<t.features.length;i++){var r=t.features[i];if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}}function Wr(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")}function Jr(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")}function Kr(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")}var Zr=Object.freeze({getCoord:jr,getCoords:zr,containsNumber:Vr,geojsonType:Yr,featureOf:Hr,collectionOf:Xr,getGeom:Wr,getGeomType:Jr,getType:Kr}),Qr={successCallback:null,verbose:!1},$r={};function to(t,e,n){n=n||{};for(var i=Object.keys(Qr),r=0;r<i.length;r++){var o=i[r],s=n[o];s=null!=s?s:Qr[o],$r[o]=s}$r.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+e);var a=function(h){var c=[],p=0;h.rows,h.cols;return h.cells.forEach(function(t,l){t.forEach(function(t,e){if(void 0!==t&&5!==(u=t).cval&&10!==u.cval&&!no(t)){var n=function(t,e,n){var i,r,o,s=t.length,a=[],u=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],l=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],h=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],c=(t[e][n],t[e][n]),p=c.cval,f=ro(c,o=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][p]);a.push([n+f[0],e+f[1]]),f=ro(c,o=h[p]),a.push([n+f[0],e+f[1]]),io(c);for(var d=n+u[p],g=e+l[p],y=p;0<=d&&0<=g&&g<s&&(d!=n||g!=e)&&void 0!==(c=t[g][d]);){if(0===(p=c.cval)||15===p)return{path:a,info:"mergeable"};o=h[p],i=u[p],r=l[p],5!==p&&10!==p||(5===p?c.flipped?(i=-1===l[y]?(o="left",-1):(o="right",1),r=0):-1===u[y]&&(o="bottom",i=0,r=-1):10===p&&(c.flipped?r=-1===u[y]?(o="top",i=0,1):(o="bottom",i=0,-1):1===l[y]&&(o="left",i=-1,r=0))),f=ro(c,o),a.push([d+f[0],g+f[1]]),io(c),d+=i,g+=r,y=p}return{path:a,info:"closed"}}(h.cells,l,e),i=!1;if("mergeable"===n.info)for(var r=n.path[n.path.length-1][0],o=n.path[n.path.length-1][1],s=p-1;0<=s;s--)if(Math.abs(c[s][0][0]-r)<=1e-7&&Math.abs(c[s][0][1]-o)<=1e-7){for(var a=n.path.length-2;0<=a;--a)c[s].unshift(n.path[a]);i=!0;break}i||(c[p++]=n.path)}var u})}),c}(function(t,e){for(var n=t.length-1,i=t[0].length-1,r={rows:n,cols:i,cells:[]},o=0;o<n;++o){r.cells[o]=[];for(var s=0;s<i;++s){var a=0,u=t[o+1][s],l=t[o+1][s+1],h=t[o][s+1],c=t[o][s];if(!(isNaN(u)||isNaN(l)||isNaN(h)||isNaN(c))){a|=e<=u?8:0,a|=e<=l?4:0,a|=e<=h?2:0;var p,f,d,g,y=!1;if(5===(a|=e<=c?1:0)||10===a){var _=(u+l+h+c)/4;5===a&&_<e?(a=10,y=!0):10===a&&_<e&&(a=5,y=!0)}if(0!==a&&15!==a)p=f=d=g=.5,1===a?(d=1-eo(e,u,c),f=1-eo(e,h,c)):2===a?(f=eo(e,c,h),g=1-eo(e,l,h)):3===a?(d=1-eo(e,u,c),g=1-eo(e,l,h)):4===a?(p=eo(e,u,l),g=eo(e,h,l)):5===a?(p=eo(e,u,l),g=eo(e,h,l),f=1-eo(e,h,c),d=1-eo(e,u,c)):6===a?(f=eo(e,c,h),p=eo(e,u,l)):7===a?(d=1-eo(e,u,c),p=eo(e,u,l)):8===a?(d=eo(e,c,u),p=1-eo(e,l,u)):9===a?(f=1-eo(e,h,c),p=1-eo(e,l,u)):10===a?(p=1-eo(e,l,u),g=1-eo(e,l,h),f=eo(e,c,h),d=eo(e,c,u)):11===a?(p=1-eo(e,l,u),g=1-eo(e,l,h)):12===a?(d=eo(e,c,u),g=eo(e,h,l)):13===a?(f=1-eo(e,h,c),g=eo(e,h,l)):14===a?(d=eo(e,c,u),f=eo(e,c,h)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+a),r.cells[o][s]={cval:a,flipped:y,top:p,right:g,bottom:f,left:d}}}}return r}(t,e));return"function"==typeof $r.successCallback&&$r.successCallback(a),a}function eo(t,e,n){return(t-e)/(n-e)}function no(t){return 0===t.cval||15===t.cval}function io(t){no(t)||5===t.cval||10===t.cval||(t.cval=15)}function ro(t,e){return"top"===e?[t.top,1]:"bottom"===e?[t.bottom,0]:"right"===e?[1,t.right]:"left"===e?[0,t.left]:void 0}function oo(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",i=e.flip,r=e.flags;Xr(t,"Point","input must contain Points");for(var o,s,a=(o=i,s={},Pr(t,function(t){var e=zr(t)[1];s[e]||(s[e]=[]),s[e].push(t)}),Object.keys(s).map(function(t){return s[t].sort(function(t,e){return zr(t)[0]-zr(e)[0]})}).sort(function(t,e){return o?zr(t[0])[1]-zr(e[0])[1]:zr(e[0])[1]-zr(t[0])[1]})),u=[],l=0;l<a.length;l++){for(var h=a[l],c=[],p=0;p<h.length;p++){var f=h[p];f.properties[n]?c.push(f.properties[n]):c.push(0),!0===r&&(f.properties.matrixPosition=[l,p])}u.push(c)}return u}var so=function t(e,n,i,r,o){i=i||0;r=r||e.length-1;o=o||uo;for(;i<r;){if(600<r-i){var s=r-i+1,a=n-i+1,u=Math.log(s),l=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*l*(s-l)/s)*(a-s/2<0?-1:1),c=Math.max(i,Math.floor(n-a*l/s+h)),p=Math.min(r,Math.floor(n+(s-a)*l/s+h));t(e,n,c,p,o)}var f=e[n],d=i,g=r;for(ao(e,i,n),0<o(e[r],f)&&ao(e,i,r);d<g;){for(ao(e,d,g),d++,g--;o(e[d],f)<0;)d++;for(;0<o(e[g],f);)g--}0===o(e[i],f)?ao(e,i,g):ao(e,++g,r),g<=n&&(i=g+1),n<=g&&(r=g-1)}};function ao(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function uo(t,e){return t<e?-1:e<t?1:0}var lo=ho;function ho(t,e){if(!(this instanceof ho))return new ho(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function co(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function po(t,e){fo(t,0,t.children.length,e,t)}function fo(t,e,n,i,r){r||(r=Eo(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],go(r,t.leaf?i(o):o);return r}function go(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function yo(t,e){return t.minX-e.minX}function _o(t,e){return t.minY-e.minY}function mo(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function vo(t){return t.maxX-t.minX+(t.maxY-t.minY)}function bo(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function xo(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Eo(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function wo(t,e,n,i,r){for(var o,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(o=e+Math.ceil((n-e)/i/2)*i,so(t,o,e,n,r),s.push(e,o,o,n))}function Io(t,e){return t(e={exports:{}},e.exports),e.exports}ho.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!xo(t,e))return n;for(var r,o,s,a,u=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],xo(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):bo(t,a)?this._all(s,n):u.push(s));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!xo(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],xo(t,s=e.leaf?n(o):o)){if(e.leaf||bo(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Eo([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,s=this.data,a=this.toBBox(t),u=[],l=[];s||u.length;){if(s||(s=u.pop(),i=u[u.length-1],n=l.pop(),o=!0),s.leaf&&-1!==(r=co(t,s.children,e)))return s.children.splice(r,1),u.push(s),this._condense(u),this;o||s.leaf||!bo(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(u.push(s),l.push(n),n=0,s=(i=s).children[0])}return this},toBBox:function(t){return t},compareMinX:yo,compareMinY:_o,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return po(r=Eo(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=Eo([])).leaf=!1,r.height=i;var a,u,l,h,c=Math.ceil(o/s),p=c*Math.ceil(Math.sqrt(s));for(wo(t,e,n,p,this.compareMinX),a=e;a<=n;a+=p)for(wo(t,a,l=Math.min(a+p-1,n),c,this.compareMinY),u=a;u<=l;u+=c)h=Math.min(u+c-1,l),r.children.push(this._build(t,u,h,i-1));return po(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,u,l,h,c,p,f;i.push(e),!e.leaf&&i.length-1!==n;){for(h=c=1/0,r=0,o=e.children.length;r<o;r++)u=mo(s=e.children[r]),p=t,f=s,(l=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-u)<c?(c=l,h=u<h?u:h,a=s):l===c&&u<h&&(h=u,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),go(s,r);0<=e&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=Eo(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,po(n,this.toBBox),po(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=Eo([t,e]),this.data.height=t.height+1,this.data.leaf=!1,po(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,a,u,l,h,c,p,f,d,g,y;for(u=l=1/0,i=e;i<=n-e;i++)r=fo(t,0,i,this.toBBox),o=fo(t,i,n,this.toBBox),c=r,p=o,void 0,f=Math.max(c.minX,p.minX),d=Math.max(c.minY,p.minY),g=Math.min(c.maxX,p.maxX),y=Math.min(c.maxY,p.maxY),s=Math.max(0,g-f)*Math.max(0,y-d),a=mo(r)+mo(o),s<u?(u=s,h=i,l=a<l?a:l):s===u&&a<l&&(l=a,h=i);return h},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:yo,r=t.leaf?this.compareMinY:_o;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,a=fo(t,0,e,s),u=fo(t,n-e,n,s),l=vo(a)+vo(u);for(r=e;r<n-e;r++)o=t.children[r],go(a,t.leaf?s(o):o),l+=vo(a);for(r=n-e-1;e<=r;r--)o=t.children[r],go(u,t.leaf?s(o):o),l+=vo(u);return l},_adjustParentBBoxes:function(t,e,n){for(var i=n;0<=i;i--)go(e[i],t)},_condense:function(t){for(var e,n=t.length-1;0<=n;n--)0===t[n].children.length?0<n?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():po(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var Lo=function(t,e,n){var i=t*e,r=So*t,o=r-(r-t),s=t-o,a=So*e,u=a-(a-e),l=e-u,h=s*l-(i-o*u-s*u-o*l);if(n)return n[0]=h,n[1]=i,n;return[h,i]},So=+(Math.pow(2,27)+1);var Mo=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);if(r)return[r,n];return[n]}(t[0],e[0]);var r,o,s=new Array(n+i),a=0,u=0,l=0,h=Math.abs,c=t[u],p=h(c),f=e[l],d=h(f);p<d?(o=c,(u+=1)<n&&(c=t[u],p=h(c))):(o=f,(l+=1)<i&&(f=e[l],d=h(f)));u<n&&p<d||i<=l?(r=c,(u+=1)<n&&(c=t[u],p=h(c))):(r=f,(l+=1)<i&&(f=e[l],d=h(f)));var g,y,_=r+o,m=_-r,v=o-m,b=v,x=_;for(;u<n&&l<i;)p<d?(r=c,(u+=1)<n&&(c=t[u],p=h(c))):(r=f,(l+=1)<i&&(f=e[l],d=h(f))),(v=(o=b)-(m=(_=r+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g;for(;u<n;)(v=(o=b)-(m=(_=(r=c)+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g,(u+=1)<n&&(c=t[u]);for(;l<i;)(v=(o=b)-(m=(_=(r=f)+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g,(l+=1)<i&&(f=e[l]);b&&(s[a++]=b);x&&(s[a++]=x);a||(s[a++]=0);return s.length=a,s};var Co=function(t,e,n){var i=t+e,r=i-t,o=e-r,s=t-(i-r);if(n)return n[0]=s+o,n[1]=i,n;return[s+o,i]};var Po=function(t,e){var n=t.length;if(1===n){var i=Lo(t[0],e);return i[0]?i:[i[1]]}var r=new Array(2*n),o=[.1,.1],s=[.1,.1],a=0;Lo(t[0],e,o),o[0]&&(r[a++]=o[0]);for(var u=1;u<n;++u){Lo(t[u],e,s);var l=o[1];Co(l,s[0],o),o[0]&&(r[a++]=o[0]);var h=s[1],c=o[1],p=h+c,f=p-h,d=c-f;o[1]=p,d&&(r[a++]=d)}o[1]&&(r[a++]=o[1]);0===a&&(r[a++]=0);return r.length=a,r};var No=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);if(r)return[r,n];return[n]}(t[0],-e[0]);var r,o,s=new Array(n+i),a=0,u=0,l=0,h=Math.abs,c=t[u],p=h(c),f=-e[l],d=h(f);p<d?(o=c,(u+=1)<n&&(c=t[u],p=h(c))):(o=f,(l+=1)<i&&(f=-e[l],d=h(f)));u<n&&p<d||i<=l?(r=c,(u+=1)<n&&(c=t[u],p=h(c))):(r=f,(l+=1)<i&&(f=-e[l],d=h(f)));var g,y,_=r+o,m=_-r,v=o-m,b=v,x=_;for(;u<n&&l<i;)p<d?(r=c,(u+=1)<n&&(c=t[u],p=h(c))):(r=f,(l+=1)<i&&(f=-e[l],d=h(f))),(v=(o=b)-(m=(_=r+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g;for(;u<n;)(v=(o=b)-(m=(_=(r=c)+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g,(u+=1)<n&&(c=t[u]);for(;l<i;)(v=(o=b)-(m=(_=(r=f)+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g,(l+=1)<i&&(f=-e[l]);b&&(s[a++]=b);x&&(s[a++]=x);a||(s[a++]=0);return s.length=a,s};var Oo=Io(function(o){function h(t,e){for(var n=new Array(t.length-1),i=1;i<t.length;++i)for(var r=n[i-1]=new Array(t.length-1),o=0,s=0;o<t.length;++o)o!==e&&(r[s++]=t[i][o]);return n}function c(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",c(t.slice(0,e)),",",c(t.slice(e)),")"].join("")}function p(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var e=[],n=0;n<t.length;++n)e.push(["scale(",c(p(h(t,n))),",",(i=n,1&i?"-":""),t[0][n],")"].join(""));return e;var i}function s(t){for(var e=[],n=[],i=function(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var i=0;i<t;++i)e[n][i]=["m",i,"[",t-n-1,"]"].join("")}return e}(t),r=[],o=0;o<t;++o)0==(1&o)?e.push.apply(e,p(h(i,o))):n.push.apply(n,p(h(i,o))),r.push("m"+o);var s=c(e),a=c(n),u="orientation"+t+"Exact",l=["function ",u,"(",r.join(),"){var p=",s,",n=",a,",d=sub(p,n);return d[d.length-1];};return ",u].join("");return new Function("sum","prod","scale","sub",l)(Mo,Lo,Po,No)}var u=s(3),x=s(4),a=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var i,r=(t[1]-n[1])*(e[0]-n[0]),o=(t[0]-n[0])*(e[1]-n[1]),s=r-o;if(0<r){if(o<=0)return s;i=r+o}else{if(!(r<0))return s;if(0<=o)return s;i=-(r+o)}var a=33306690738754716e-32*i;return a<=s||s<=-a?s:u(t,e,n)},function(t,e,n,i){var r=t[0]-i[0],o=e[0]-i[0],s=n[0]-i[0],a=t[1]-i[1],u=e[1]-i[1],l=n[1]-i[1],h=t[2]-i[2],c=e[2]-i[2],p=n[2]-i[2],f=o*l,d=s*u,g=s*a,y=r*l,_=r*u,m=o*a,v=h*(f-d)+c*(g-y)+p*(_-m),b=7771561172376103e-31*((Math.abs(f)+Math.abs(d))*Math.abs(h)+(Math.abs(g)+Math.abs(y))*Math.abs(c)+(Math.abs(_)+Math.abs(m))*Math.abs(p));return b<v||b<-v?v:x(t,e,n,i)}];!function(){for(;a.length<=5;)a.push(s(a.length));for(var t=[],e=["slow"],n=0;n<=5;++n)t.push("a"+n),e.push("o"+n);var i=["function getOrientation(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(n=2;n<=5;++n)i.push("case ",n,":return o",n,"(",t.slice(0,n).join(),");");i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),e.push(i.join(""));var r=Function.apply(void 0,e);for(o.exports=r.apply(void 0,[function(t){var e=a[t.length];return e||(e=a[t.length]=s(t.length)),e.apply(void 0,t)}].concat(a)),n=0;n<=5;++n)o.exports[n]=a[n]}()}),To=function(i){var t=i.length;if(t<3){for(var e=new Array(t),n=0;n<t;++n)e[n]=n;return 2===t&&i[0][0]===i[1][0]&&i[0][1]===i[1][1]?[0]:e}for(var r=new Array(t),n=0;n<t;++n)r[n]=n;r.sort(function(t,e){var n=i[t][0]-i[e][0];return n||i[t][1]-i[e][1]});for(var o=[r[0],r[1]],s=[r[0],r[1]],n=2;n<t;++n){for(var a=r[n],u=i[a],l=o.length;1<l&&Ro(i[o[l-2]],i[o[l-1]],u)<=0;)l-=1,o.pop();for(o.push(a),l=s.length;1<l&&0<=Ro(i[s[l-2]],i[s[l-1]],u);)l-=1,s.pop();s.push(a)}for(var e=new Array(s.length+o.length-2),h=0,n=0,c=o.length;n<c;++n)e[h++]=o[n];for(var p=s.length-2;0<p;--p)e[h++]=s[p];return e},Ro=Oo[3];var ko=Ao,Do=Ao;function Ao(t,e){if(!(this instanceof Ao))return new Ao(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||Fo,0<this.length)for(var n=(this.length>>1)-1;0<=n;n--)this._down(n)}function Fo(t,e){return t<e?-1:e<t?1:0}Ao.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,i=e[t];0<t;){var r=t-1>>1,o=e[r];if(0<=n(i,o))break;e[t]=o,t=r}e[t]=i},_down:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&n(e[s],a)<0&&(a=e[o=s]),0<=n(a,r))break;e[t]=a,t=o}e[t]=r}},ko.default=Do;var Go=function(t,e){for(var n=t[0],i=t[1],r=!1,o=0,s=e.length-1;o<e.length;s=o++){var a=e[o][0],u=e[o][1],l=e[s][0],h=e[s][1];i<u!=i<h&&n<(l-a)*(i-u)/(h-u)+a&&(r=!r)}return r},Bo=Oo[3],Uo=jo,qo=jo;function jo(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;for(var i,r=function(t){for(var e=t[0],n=t[0],i=t[0],r=t[0],o=0;o<t.length;o++){var s=t[o];s[0]<e[0]&&(e=s),s[0]>i[0]&&(i=s),s[1]<n[1]&&(n=s),s[1]>r[1]&&(r=s)}var a=[e,n,i,r],u=a.slice();for(o=0;o<t.length;o++)Go(t[o],a)||u.push(t[o]);var l=To(u),h=[];for(o=0;o<l.length;o++)h.push(u[l[o]]);return h}(t),o=lo(16,["[0]","[1]","[0]","[1]"]).load(t),s=[],a=0;a<r.length;a++){var u=r[a];o.remove(u),i=Jo(u,i),s.push(i)}var l=lo(16);for(a=0;a<s.length;a++)l.insert(Wo(s[a]));for(var h=e*e,c=n*n;s.length;){var p=s.shift(),f=p.p,d=p.next.p,g=Ko(f,d);if(!(g<c)){var y=g/h;(u=zo(o,p.prev.p,f,d,p.next.next.p,y,l))&&Math.min(Ko(u,f),Ko(u,d))<=y&&(s.push(p),s.push(Jo(u,p)),o.remove(u),l.remove(p),l.insert(Wo(p)),l.insert(Wo(p.next)))}}p=i;for(var _=[];_.push(p.p),(p=p.next)!==i;);return _.push(p.p),_}function zo(t,e,n,i,r,o,s){for(var a=new ko(null,Vo),u=t.data;u;){for(var l=0;l<u.children.length;l++){var h=u.children[l],c=u.leaf?Zo(h,n,i):Yo(n,i,h);o<c||a.push({node:h,dist:c})}for(;a.length&&!a.peek().node.children;){var p=a.pop(),f=p.node,d=Zo(f,e,n),g=Zo(f,i,r);if(p.dist<d&&p.dist<g&&Xo(n,f,s)&&Xo(i,f,s))return f}(u=a.pop())&&(u=u.node)}return null}function Vo(t,e){return t.dist-e.dist}function Yo(t,e,n){if(Ho(t,n)||Ho(e,n))return 0;var i=Qo(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===i)return 0;var r=Qo(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===r)return 0;var o=Qo(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var s=Qo(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===s?0:Math.min(i,r,o,s)}function Ho(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function Xo(t,e,n){for(var i,r,o,s,a=Math.min(t[0],e[0]),u=Math.min(t[1],e[1]),l=Math.max(t[0],e[0]),h=Math.max(t[1],e[1]),c=n.search({minX:a,minY:u,maxX:l,maxY:h}),p=0;p<c.length;p++)if(i=c[p].p,r=c[p].next.p,o=t,i!==(s=e)&&r!==o&&0<Bo(i,r,o)!=0<Bo(i,r,s)&&0<Bo(o,s,i)!=0<Bo(o,s,r))return!1;return!0}function Wo(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function Jo(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,(n.prev=e).next.prev=n,e.next=n):(n.prev=n).next=n,n}function Ko(t,e){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function Zo(t,e,n){var i=e[0],r=e[1],o=n[0]-i,s=n[1]-r;if(0!==o||0!==s){var a=((t[0]-i)*o+(t[1]-r)*s)/(o*o+s*s);1<a?(i=n[0],r=n[1]):0<a&&(i+=o*a,r+=s*a)}return(o=t[0]-i)*o+(s=t[1]-r)*s}function Qo(t,e,n,i,r,o,s,a){var u,l,h,c,p=n-t,f=i-e,d=s-r,g=a-o,y=t-r,_=e-o,m=p*p+f*f,v=p*d+f*g,b=d*d+g*g,x=p*y+f*_,E=d*y+g*_,w=m*b-v*v,I=w,L=w;0===w?(l=0,I=1,c=E,L=b):(c=m*E-v*x,(l=v*E-b*x)<0?(l=0,c=E,L=b):I<l&&(l=I,c=E+v,L=b)),c<0?-x<(c=0)?l=0:m<-x?l=I:(l=-x,I=m):L<c&&(c=L,-x+v<0?l=0:m<-x+v?l=I:(l=-x+v,I=m));var S=(1-(h=0===c?0:c/L))*r+h*s-((1-(u=0===l?0:l/I))*t+u*n),M=(1-h)*o+h*a-((1-u)*e+u*i);return S*S+M*M}function $o(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.concavity||1/0,i=[];if(Lr(t,function(t){i.push([t[0],t[1]])}),!i.length)return null;var r=Uo(i,n);return 3<r.length?nr([r]):null}function ts(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.ignoreBoundary;if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r,o,s=jr(t),a=zr(e),u=e.geometry?e.geometry.type:e.type,l=e.bbox;if(l&&!1==(r=s,(o=l)[0]<=r[0]&&o[1]<=r[1]&&o[2]>=r[0]&&o[3]>=r[1]))return!1;"Polygon"===u&&(a=[a]);for(var h=0,c=!1;h<a.length&&!c;h++)if(es(s,a[h][0],i)){for(var p=!1,f=1;f<a[h].length&&!p;)es(s,a[h][f],!i)&&(p=!0),f++;p||(c=!0)}return c}function es(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],u=e[o][0],l=e[o][1];if(t[1]*(s-u)+a*(u-t[0])+l*(t[0]-s)==0&&(s-t[0])*(u-t[0])<=0&&(a-t[1])*(l-t[1])<=0)return!n;a>t[1]!=l>t[1]&&t[0]<(u-s)*(t[1]-a)/(l-a)+s&&(i=!i)}return i}function ns(t,e){var n=[];return Tr(e,function(e){Pr(t,function(t){ts(t,e)&&n.push(t)})}),sr(n)}function is(t,n){if("FeatureCollection"!==t.type)throw new Error("points must be a FeatureCollection");var o=!1;return sr(function(t){if(t.length<3)return[];t.sort(os);var e,n,i,r,o,s,a=t.length-1,u=t[a].x,l=t[0].x,h=t[a].y,c=h;for(;a--;)t[a].y<h&&(h=t[a].y),t[a].y>c&&(c=t[a].y);var p,f=l-u,d=c-h,g=d<f?f:d,y=.5*(l+u),_=.5*(c+h),m=[new rs({x:y-20*g,y:_-g,__sentinel:!0},{x:y,y:_+20*g,__sentinel:!0},{x:y+20*g,y:_-g,__sentinel:!0})],v=[],b=[];a=t.length;for(;a--;){for(b.length=0,p=m.length;p--;)0<(f=t[a].x-m[p].x)&&f*f>m[p].r?(v.push(m[p]),m.splice(p,1)):(d=t[a].y-m[p].y,f*f+d*d>m[p].r||(b.push(m[p].a,m[p].b,m[p].b,m[p].c,m[p].c,m[p].a),m.splice(p,1)));for(ss(b),p=b.length;p;)n=b[--p],e=b[--p],i=t[a],r=n.x-e.x,o=n.y-e.y,s=2*(r*(i.y-n.y)-o*(i.x-n.x)),1e-12<Math.abs(s)&&m.push(new rs(e,n,i))}Array.prototype.push.apply(v,m),a=v.length;for(;a--;)(v[a].a.__sentinel||v[a].b.__sentinel||v[a].c.__sentinel)&&v.splice(a,1);return v}(t.features.map(function(t){var e={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return n?e.z=t.properties[n]:3===t.geometry.coordinates.length&&(o=!0,e.z=t.geometry.coordinates[2]),e})).map(function(t){var e=[t.a.x,t.a.y],n=[t.b.x,t.b.y],i=[t.c.x,t.c.y],r={};return o?(e.push(t.a.z),n.push(t.b.z),i.push(t.c.z)):r={a:t.a.z,b:t.b.z,c:t.c.z},nr([[e,n,i,e]],r)}))}function rs(t,e,n){this.a=t,this.b=e,this.c=n;var i,r,o=e.x-t.x,s=e.y-t.y,a=n.x-t.x,u=n.y-t.y,l=o*(t.x+e.x)+s*(t.y+e.y),h=a*(t.x+n.x)+u*(t.y+n.y),c=2*(o*(n.y-e.y)-s*(n.x-e.x));this.x=(u*l-s*h)/c,this.y=(o*h-a*l)/c,i=this.x-t.x,r=this.y-t.y,this.r=i*i+r*r}function os(t,e){return e.x-t.x}function ss(t){var e,n,i,r,o,s=t.length;t:for(;s;)for(n=t[--s],e=t[--s],i=s;i;)if(o=t[--i],e===(r=t[--i])&&n===o||e===o&&n===r){t.splice(s,2),t.splice(i,2),s-=2;continue t}}function as(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.units,r=jr(t),o=jr(e),s=_r(o[1]-r[1]),a=_r(o[0]-r[0]),u=_r(r[1]),l=_r(o[1]),h=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(u)*Math.cos(l);return pr(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),i)}function us(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return ls(t);case"FeatureCollection":return e=t,n={type:"FeatureCollection"},Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:n[t]=e[t]}}),n.features=e.features.map(function(t){return ls(t)}),n;case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return hs(t);default:throw new Error("unknown GeoJSON type")}var e,n}function ls(e){var n={type:"Feature"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:n[t]=e[t]}}),n.properties=function n(i){var r={};if(!i)return r;Object.keys(i).forEach(function(t){var e=i[t];"object"==typeof e?null===e?r[t]=null:e.length?r[t]=e.map(function(t){return t}):r[t]=n(e):r[t]=e});return r}(e.properties),n.geometry=hs(e.geometry),n}function hs(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?e.geometries=t.geometries.map(function(t){return hs(t)}):e.coordinates=function e(t){if("object"!=typeof t[0])return t.slice();return t.map(function(t){return e(t)})}(t.coordinates),e}Uo.default=qo;var cs=function(t){return t},ps=function(t){if(null==t)return cs;var o,s,a=t.scale[0],u=t.scale[1],l=t.translate[0],h=t.translate[1];return function(t,e){e||(o=s=0);var n=2,i=t.length,r=new Array(i);for(r[0]=(o+=t[0])*a+l,r[1]=(s+=t[1])*u+h;n<i;)r[n]=t[n],++n;return r}},fs=function(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n};function ds(t,e){var o=ps(t.transform),s=t.arcs;function r(t,e){e.length&&e.pop();for(var n=s[t<0?~t:t],i=0,r=n.length;i<r;++i)e.push(o(n[i],i));t<0&&fs(e,r)}function a(t){return o(t)}function u(t){for(var e=[],n=0,i=t.length;n<i;++n)r(t[n],e);return e.length<2&&e.push(e[0]),e}function n(t){for(var e=u(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(n)}return function t(e){var n,i=e.type;switch(i){case"GeometryCollection":return{type:i,geometries:e.geometries.map(t)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=u(e.arcs);break;case"MultiLineString":n=e.arcs.map(u);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:i,coordinates:n}}(e)}var gs=function(u,r){var o={},l={},h={},s=[],a=-1;function t(t,e){for(var n in t){var i=t[n];delete e[i.start],delete i.start,delete i.end,i.forEach(function(t){o[t<0?~t:t]=1}),s.push(i)}}return r.forEach(function(t,e){var n,i=u.arcs[t<0?~t:t];i.length<3&&!i[1][0]&&!i[1][1]&&(n=r[++a],r[a]=t,r[e]=n)}),r.forEach(function(t){var e,n,i=function(t){var e,n=u.arcs[t<0?~t:t],i=n[0];u.transform?(e=[0,0],n.forEach(function(t){e[0]+=t[0],e[1]+=t[1]})):e=n[n.length-1];return t<0?[e,i]:[i,e]}(t),r=i[0],o=i[1];if(e=h[r])if(delete h[e.end],e.push(t),e.end=o,n=l[o]){delete l[n.start];var s=n===e?e:e.concat(n);l[s.start=e.start]=h[s.end=n.end]=s}else l[e.start]=h[e.end]=e;else if(e=l[o])if(delete l[e.start],e.unshift(t),e.start=r,n=h[r]){delete h[n.end];var a=n===e?e:n.concat(e);l[a.start=n.start]=h[a.end=e.end]=a}else l[e.start]=h[e.end]=e;else l[(e=[t]).start=r]=h[e.end=o]=e}),t(h,l),t(l,h),r.forEach(function(t){o[t<0?~t:t]||s.push([t])}),s};var ys=function(t){return ds(t,function(a,t){var u={},n=[],i=[];function r(e){e.forEach(function(t){t.forEach(function(t){(u[t=t<0?~t:t]||(u[t]=[])).push(e)})}),n.push(e)}function l(t){return function(t){for(var e,n=-1,i=t.length,r=t[i-1],o=0;++n<i;)e=r,r=t[n],o+=e[0]*r[1]-e[1]*r[0];return Math.abs(o)}(ds(a,{type:"Polygon",arcs:[t]}).coordinates[0])}return t.forEach(function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":r(e.arcs);break;case"MultiPolygon":e.arcs.forEach(r)}}),n.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,i.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){u[t<0?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),n.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:i.map(function(t){var e,n=[];if(t.forEach(function(t){t.forEach(function(t){t.forEach(function(t){u[t<0?~t:t].length<2&&n.push(t)})})}),1<(e=(n=gs(a,n)).length))for(var i,r,o=1,s=l(n[0]);o<e;++o)(i=l(n[o]))>s&&(r=n[0],n[0]=n[o],n[o]=r,s=i);return n})}}.apply(this,arguments))};var _s=function(o,s,a,t,u,e){3===arguments.length&&(t=e=Array,u=null);for(var l=new t(o=1<<Math.max(4,Math.ceil(Math.log(o)/Math.LN2))),h=new e(o),c=o-1,n=0;n<o;++n)l[n]=u;return{set:function(t,e){for(var n=s(t)&c,i=l[n],r=0;i!=u;){if(a(i,t))return h[n]=e;if(++r>=o)throw new Error("full hashmap");i=l[n=n+1&c]}return l[n]=t,h[n]=e},maybeSet:function(t,e){for(var n=s(t)&c,i=l[n],r=0;i!=u;){if(a(i,t))return h[n];if(++r>=o)throw new Error("full hashmap");i=l[n=n+1&c]}return l[n]=t,h[n]=e},get:function(t,e){for(var n=s(t)&c,i=l[n],r=0;i!=u;){if(a(i,t))return h[n];if(++r>=o)break;i=l[n=n+1&c]}return e},keys:function(){for(var t=[],e=0,n=l.length;e<n;++e){var i=l[e];i!=u&&t.push(i)}return t}}},ms=function(t,e){return t[0]===e[0]&&t[1]===e[1]},vs=new ArrayBuffer(16),bs=new Float64Array(vs),xs=new Uint32Array(vs),Es=function(t){bs[0]=t[0],bs[1]=t[1];var e=xs[0]^xs[1];return 2147483647&(e=e<<5^e>>7^xs[2]^xs[3])},ws=function(t){var e,n,i,r,o=t.coordinates,s=t.lines,a=t.rings,u=function(){for(var t=_s(1.4*o.length,x,E,Int32Array,-1,Int32Array),e=new Int32Array(o.length),n=0,i=o.length;n<i;++n)e[n]=t.maybeSet(n,n);return e}(),l=new Int32Array(o.length),h=new Int32Array(o.length),c=new Int32Array(o.length),p=new Int8Array(o.length),f=0;for(e=0,n=o.length;e<n;++e)l[e]=h[e]=c[e]=-1;for(e=0,n=s.length;e<n;++e){var d=s[e],g=d[0],y=d[1];for(i=u[g],r=u[++g],++f,p[i]=1;++g<=y;)b(e,i,i=r,r=u[g]);++f,p[r]=1}for(e=0,n=o.length;e<n;++e)l[e]=-1;for(e=0,n=a.length;e<n;++e){var _=a[e],m=_[0]+1,v=_[1];for(b(e,u[v-1],i=u[m-1],r=u[m]);++m<=v;)b(e,i,i=r,r=u[m])}function b(t,e,n,i){if(l[n]!==t){l[n]=t;var r=h[n];if(0<=r){var o=c[n];r===e&&o===i||r===i&&o===e||(++f,p[n]=1)}else h[n]=e,c[n]=i}}function x(t){return Es(o[t])}function E(t,e){return ms(o[t],o[e])}l=h=c=null;var w,I=function(r,o,s,t,a){3===arguments.length&&(t=Array,a=null);for(var u=new t(r=1<<Math.max(4,Math.ceil(Math.log(r)/Math.LN2))),l=r-1,e=0;e<r;++e)u[e]=a;return{add:function(t){for(var e=o(t)&l,n=u[e],i=0;n!=a;){if(s(n,t))return!0;if(++i>=r)throw new Error("full hashset");n=u[e=e+1&l]}return u[e]=t,!0},has:function(t){for(var e=o(t)&l,n=u[e],i=0;n!=a;){if(s(n,t))return!0;if(++i>=r)break;n=u[e=e+1&l]}return!1},values:function(){for(var t=[],e=0,n=u.length;e<n;++e){var i=u[e];i!=a&&t.push(i)}return t}}}(1.4*f,Es,ms);for(e=0,n=o.length;e<n;++e)p[w=u[e]]&&I.add(o[w]);return I};function Is(t,e,n){for(var i,r=e+(n---e>>1);e<r;++e,--n)i=t[e],t[e]=t[n],t[n]=i}function Ls(t){var e,n=Ss(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function Ss(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(Ss)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}var Ms=function(t,e){var n=function(t){var i=1/0,r=1/0,o=-1/0,s=-1/0;function e(t){null!=t&&n.hasOwnProperty(t.type)&&n[t.type](t)}var n={GeometryCollection:function(t){t.geometries.forEach(e)},Point:function(t){a(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(a)},LineString:function(t){u(t.arcs)},MultiLineString:function(t){t.arcs.forEach(u)},Polygon:function(t){t.arcs.forEach(u)},MultiPolygon:function(t){t.arcs.forEach(l)}};function a(t){var e=t[0],n=t[1];e<i&&(i=e),o<e&&(o=e),n<r&&(r=n),s<n&&(s=n)}function u(t){t.forEach(a)}function l(t){t.forEach(u)}for(var h in t)e(t[h]);return i<=o&&r<=s?[i,r,o,s]:void 0}(t=function(t){var e,n,i={};for(e in t)i[e]=null==(n=t[e])?{type:null}:("FeatureCollection"===n.type?function(t){var e={type:"GeometryCollection",geometries:t.features.map(Ls)};return null!=t.bbox&&(e.bbox=t.bbox),e}:"Feature"===n.type?Ls:Ss)(n);return i}(t)),i=0<e&&n&&function(t,e,n){var c=e[0],p=e[1],i=e[2],r=e[3],f=i-c?(n-1)/(i-c):1,d=r-p?(n-1)/(r-p):1;function o(t){return[Math.round((t[0]-c)*f),Math.round((t[1]-p)*d)]}function s(t,e){for(var n,i,r,o,s,a=-1,u=0,l=t.length,h=new Array(l);++a<l;)n=t[a],o=Math.round((n[0]-c)*f),s=Math.round((n[1]-p)*d),o===i&&s===r||(h[u++]=[i=o,r=s]);for(h.length=u;u<e;)u=h.push([h[0][0],h[0][1]]);return h}function a(t){return s(t,2)}function u(t){return s(t,4)}function l(t){return t.map(u)}function h(t){null!=t&&g.hasOwnProperty(t.type)&&g[t.type](t)}var g={GeometryCollection:function(t){t.geometries.forEach(h)},Point:function(t){t.coordinates=o(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(o)},LineString:function(t){t.arcs=a(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(a)},Polygon:function(t){t.arcs=l(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(l)}};for(var y in t)h(t[y]);return{scale:[1/f,1/d],translate:[c,p]}}(t,n,e),r=function(t){var e,n,i,r,h=t.coordinates,o=t.lines,s=t.rings,a=o.length+s.length;for(delete t.lines,delete t.rings,i=0,r=o.length;i<r;++i)for(e=o[i];e=e.next;)++a;for(i=0,r=s.length;i<r;++i)for(n=s[i];n=n.next;)++a;var l=_s(2*a*1.4,Es,ms),c=t.arcs=[];for(i=0,r=o.length;i<r;++i)for(e=o[i];u(e),e=e.next;);for(i=0,r=s.length;i<r;++i)if((n=s[i]).next)for(;u(n),n=n.next;);else p(n);function u(t){var e,n,i,r,o,s,a,u;if(i=l.get(e=h[t[0]]))for(a=0,u=i.length;a<u;++a)if(f(r=i[a],t))return t[0]=r[0],void(t[1]=r[1]);if(o=l.get(n=h[t[1]]))for(a=0,u=o.length;a<u;++a)if(d(s=o[a],t))return t[1]=s[0],void(t[0]=s[1]);i?i.push(t):l.set(e,[t]),o?o.push(t):l.set(n,[t]),c.push(t)}function p(t){var e,n,i,r,o;if(n=l.get(h[t[0]]))for(r=0,o=n.length;r<o;++r){if(g(i=n[r],t))return t[0]=i[0],void(t[1]=i[1]);if(y(i,t))return t[0]=i[1],void(t[1]=i[0])}if(n=l.get(e=h[t[0]+_(t)]))for(r=0,o=n.length;r<o;++r){if(g(i=n[r],t))return t[0]=i[0],void(t[1]=i[1]);if(y(i,t))return t[0]=i[1],void(t[1]=i[0])}n?n.push(t):l.set(e,[t]),c.push(t)}function f(t,e){var n=t[0],i=e[0],r=t[1];if(n-r!=i-e[1])return!1;for(;n<=r;++n,++i)if(!ms(h[n],h[i]))return!1;return!0}function d(t,e){var n=t[0],i=e[0],r=t[1],o=e[1];if(n-r!=i-o)return!1;for(;n<=r;++n,--o)if(!ms(h[n],h[o]))return!1;return!0}function g(t,e){var n=t[0],i=e[0],r=t[1]-n;if(r!==e[1]-i)return!1;for(var o=_(t),s=_(e),a=0;a<r;++a)if(!ms(h[n+(a+o)%r],h[i+(a+s)%r]))return!1;return!0}function y(t,e){var n=t[0],i=e[0],r=t[1],o=e[1],s=r-n;if(s!==o-i)return!1;for(var a=_(t),u=s-_(e),l=0;l<s;++l)if(!ms(h[n+(l+a)%s],h[o-(l+u)%s]))return!1;return!0}function _(t){for(var e=t[0],n=t[1],i=e,r=i,o=h[i];++i<n;){var s=h[i];(s[0]<o[0]||s[0]===o[0]&&s[1]<o[1])&&(r=i,o=s)}return r-e}return t}(function(t){var e,n,i,r=ws(t),o=t.coordinates,s=t.lines,a=t.rings;for(n=0,i=s.length;n<i;++n)for(var u=s[n],l=u[0],h=u[1];++l<h;)r.has(o[l])&&(e={0:l,1:u[1]},u[1]=l,u=u.next=e);for(n=0,i=a.length;n<i;++n)for(var c=a[n],p=c[0],f=p,d=c[1],g=r.has(o[p]);++f<d;)r.has(o[f])&&(g?(e={0:f,1:c[1]},c[1]=f,c=c.next=e):(y=o,_=p,m=d,v=d-f,Is(y,_,m),Is(y,_,_+v),Is(y,_+v,m),o[d]=o[p],g=!0,f=p));var y,_,m,v;return t}(function(t){var r=-1,o=[],s=[],a=[];function e(t){t&&n.hasOwnProperty(t.type)&&n[t.type](t)}var n={GeometryCollection:function(t){t.geometries.forEach(e)},LineString:function(t){t.arcs=i(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(i)},Polygon:function(t){t.arcs=t.arcs.map(u)},MultiPolygon:function(t){t.arcs=t.arcs.map(l)}};function i(t){for(var e=0,n=t.length;e<n;++e)a[++r]=t[e];var i={0:r-n+1,1:r};return o.push(i),i}function u(t){for(var e=0,n=t.length;e<n;++e)a[++r]=t[e];var i={0:r-n+1,1:r};return s.push(i),i}function l(t){return t.map(u)}for(var h in t)e(t[h]);return{type:"Topology",coordinates:a,lines:o,rings:s,objects:t}}(t))),o=r.coordinates,s=_s(1.4*r.arcs.length,Cs,Ps);function a(t){t&&u.hasOwnProperty(t.type)&&u[t.type](t)}t=r.objects,r.bbox=n,r.arcs=r.arcs.map(function(t,e){return s.set(t,e),o.slice(t[0],t[1]+1)}),delete r.coordinates,o=null;var u={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=l(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(l)},Polygon:function(t){t.arcs=t.arcs.map(l)},MultiPolygon:function(t){t.arcs=t.arcs.map(h)}};function l(t){var e=[];do{var n=s.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function h(t){return t.map(l)}for(var c in t)a(t[c]);return i&&(r.transform=i,r.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var i,r,o=t[e],s=0,a=1,u=o.length,l=o[0],h=l[0],c=l[1];++s<u;)i=(l=o[s])[0],r=l[1],i===h&&r===c||(o[a++]=[i-h,r-c],h=i,c=r);1===a&&(o[a++]=[0,0]),o.length=a}return t}(r.arcs)),r};function Cs(t){var e,n=t[0],i=t[1];return i<n&&(e=n,n=i,i=e),n+31*i}function Ps(t,e){var n,i=t[0],r=t[1],o=e[0],s=e[1];return r<i&&(n=i,i=r,r=n),s<o&&(n=o,o=s,s=n),i===o&&r===s}function Ns(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==Kr(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=us(t));var i=[],r=Br(t,function(t,e){var n=function(t,e){var n,i=t.geometry.coordinates,r=e.geometry.coordinates,o=Os(i[0]),s=Os(i[i.length-1]),a=Os(r[0]),u=Os(r[r.length-1]);if(o===u)n=r.concat(i.slice(1));else if(a===s)n=i.concat(r.slice(1));else if(o===a)n=i.slice(1).reverse().concat(r);else{if(s!==u)return null;n=i.concat(r.reverse().slice(1))}return rr(n)}(t,e);return n||(i.push(t),e)});return r&&i.push(r),i.length?1===i.length?i[0]:ar(i.map(function(t){return t.coordinates})):null}function Os(t){return t[0].toString()+","+t[1].toString()}function Ts(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==Kr(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=us(t));var i=function(t){var e={};kr(t,function(t){e[t.geometry.type]=!0});var n=Object.keys(e);return 1===n.length?n[0]:null}(t);if(!i)throw new Error("geojson must be homogenous");switch(i){case"LineString":return Ns(t,e);case"Polygon":return function(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==Kr(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=us(t));var i=[];kr(t,function(t){i.push(t.geometry)});var r=Ms({geoms:hr(i).geometry});return ys(r,r.objects.geoms.geometries)}(t,e);default:throw new Error(i+" is not supported")}}function Rs(t,e){var n="object"==typeof e?e.mutate:e;if(!t)throw new Error("geojson is required");var i=Kr(t),r=[];switch(i){case"LineString":r=ks(t);break;case"MultiLineString":case"Polygon":zr(t).forEach(function(t){r.push(ks(t))});break;case"MultiPolygon":zr(t).forEach(function(t){var e=[];t.forEach(function(t){e.push(ks(t))}),r.push(e)});break;case"Point":return t;case"MultiPoint":var o={};zr(t).forEach(function(t){var e=t.join("-");o.hasOwnProperty(e)||(r.push(t),o[e]=!0)});break;default:throw new Error(i+" geometry not supported")}return t.coordinates?!0===n?(t.coordinates=r,t):{type:i,coordinates:r}:!0===n?(t.geometry.coordinates=r,t):Qi({type:i,coordinates:r},t.properties,t.bbox,t.id)}function ks(t){var e,n,i,r,o,s=zr(t);if(2===s.length&&(e=s[0],n=s[1],e[0]!==n[0]||e[1]!==n[1]))return s;var a=[],u=s.length-1;a.push(s[0]);for(var l=1;l<u;l++)i=s[l-1],r=s[l],Ds(i,o=s[l+1],r)||a.push(r);return a.push(o),a}function Ds(t,e,n){var i=n[0],r=n[1],o=t[0],s=t[1],a=e[0],u=e[1],l=a-o,h=u-s;return 0===(i-o)*h-(r-s)*l&&(Math.abs(l)>=Math.abs(h)?0<l?o<=i&&i<=a:a<=i&&i<=o:0<h?s<=r&&r<=u:u<=r&&r<=s)}function As(t,e,n){var i=e.x,r=e.y,o=n.x-i,s=n.y-r;if(0!==o||0!==s){var a=((t.x-i)*o+(t.y-r)*s)/(o*o+s*s);1<a?(i=n.x,r=n.y):0<a&&(i+=o*a,r+=s*a)}return(o=t.x-i)*o+(s=t.y-r)*s}function Fs(t,e){var n=t.length-1,i=[t[0]];return function t(e,n,i,r,o){for(var s,a=r,u=n+1;u<i;u++){var l=As(e[u],e[n],e[i]);a<l&&(s=u,a=l)}r<a&&(1<s-n&&t(e,n,s,r,o),o.push(e[s]),1<i-s&&t(e,s,i,r,o))}(t,0,n,e,i),i.push(t[n]),i}function Gs(t,e,n){if(t.length<=2)return t;var i=void 0!==e?e*e:1;return t=Fs(t=n?t:function(t,e){for(var n,i,r,o,s,a=t[0],u=[a],l=1,h=t.length;l<h;l++)n=t[l],r=a,o=(i=n).x-r.x,s=i.y-r.y,e<o*o+s*s&&(u.push(n),a=n);return a!==n&&u.push(n),u}(t,i),i)}function Bs(t,e,n){return Gs(t.map(function(t){return{x:t[0],y:t[1],z:t[2]}}),e,n).map(function(t){return t.z?[t.x,t.y,t.z]:[t.x,t.y]})}function Us(t,i,r){return t.map(function(t){var e=t.map(function(t){return{x:t[0],y:t[1]}});if(e.length<4)throw new Error("invalid polygon");for(var n=Gs(e,i,r).map(function(t){return[t.x,t.y]});!qs(n);)n=Gs(e,i-=.01*i,r).map(function(t){return[t.x,t.y]});return n[n.length-1][0]===n[0][0]&&n[n.length-1][1]===n[0][1]||n.push(n[0]),n})}function qs(t){return!(t.length<3)&&!(3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}var js=function(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length;for(var e=this.delay=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],i=this.points[e+1];this.centers.push({x:(n.x+i.x)/2,y:(n.y+i.y)/2,z:(n.z+i.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(e=0;e<this.centers.length-1;e++){n=this.centers[e],i=this.centers[e+1];var r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};function zs(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.resolution||1e4,i=e.sharpness||.85;if(!t)throw new Error("line is required");if(!br(n))throw new Error("resolution must be an number");if(!br(i))throw new Error("sharpness must be an number");for(var r=[],o=new js({points:Wr(t).coordinates.map(function(t){return{x:t[0],y:t[1]}}),duration:n,sharpness:i}),s=0;s<o.duration;s+=10){var a=o.pos(s);Math.floor(s/100)%2==0&&r.push([a.x,a.y])}return rr(r,t.properties)}function Vs(t){Er(t);var e=Number(t[0]),n=Number(t[1]),i=Number(t[2]),r=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[e,n];return nr([[o,[i,n],[i,r],[e,r],o]])}function Ys(t){return Vs(qr(t))}function Hs(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=as(t.slice(0,2),[i,n]);if(as(t.slice(0,2),[e,r])<=o){var s=(n+r)/2;return[e,s-(i-e)/2,i,s+(i-e)/2]}var a=(e+i)/2;return[a-(r-n)/2,n,a+(r-n)/2,r]}function Xs(t,e,n,i){if(!xr(i=i||{}))throw new Error("options is invalid");var r=i.units,o=i.properties,s=jr(t),a=_r(s[0]),u=_r(s[1]),l=_r(n),h=fr(e,r),c=Math.asin(Math.sin(u)*Math.cos(h)+Math.cos(u)*Math.sin(h)*Math.cos(l));return tr([yr(a+Math.atan2(Math.sin(l)*Math.sin(h)*Math.cos(u),Math.cos(h)-Math.sin(u)*Math.sin(c))),yr(c)],o)}function Ws(t,e,n){var i=(n=n||{}).steps||64,r=n.properties;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be a number");i=i||64,r=r||t.properties||{};for(var o=[],s=0;s<i;s++)o.push(Xs(t,e,-360*s/i,n).geometry.coordinates);return o.push(o[0]),nr([o],r)}function Js(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");if(!0===n.final)return(Js(e,t)+180)%360;var i=jr(t),r=jr(e),o=_r(i[0]),s=_r(r[0]),a=_r(i[1]),u=_r(r[1]),l=Math.sin(s-o)*Math.cos(u),h=Math.cos(a)*Math.sin(u)-Math.sin(a)*Math.cos(u)*Math.cos(s-o);return yr(Math.atan2(l,h))}function Ks(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.properties;if(!t)throw new Error("geojson is required");var i=qr(t);return tr([(i[0]+i[2])/2,(i[1]+i[3])/2],n)}function Zs(t,e){var n=0,i=0,r=0;return Lr(t,function(t){n+=t[0],i+=t[1],r++},!0),tr([n/r,i/r],e)}function Qs(e){var n=[];return"FeatureCollection"===e.type?Pr(e,function(e){Lr(e,function(t){n.push(tr(t,e.properties))})}):Lr(e,function(t){n.push(tr(t,e.properties))}),sr(n)}js.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var i=0;i<this.duration;i+=10){var r=this.pos(i);t<Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))&&(e.push(i),n=r)}return e},js.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},js.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(1<=n)return this.points[this.length-1];var i,r,o,s,a,u,l,h,c=Math.floor((this.points.length-1)*n),p=(this.length-1)*n-c;return i=p,r=this.points[c],o=this.controls[c][1],s=this.controls[c+1][0],a=this.points[c+1],h=[(l=(u=i)*u)*u,3*l*(1-u),3*u*(1-u)*(1-u),(1-u)*(1-u)*(1-u)],{x:a.x*h[0]+s.x*h[1]+o.x*h[2]+r.x*h[3],y:a.y*h[0]+s.y*h[1]+o.y*h[2]+r.y*h[3],z:a.z*h[0]+s.z*h[1]+o.z*h[2]+r.z*h[3]}};var $s=ea,ta=ea;function ea(t,e,n){n=n||2;var i,r,o,s,a,u,l,h=e&&e.length,c=h?e[0]*n:t.length,p=na(t,0,c,n,!0),f=[];if(!p)return f;if(h&&(p=function(t,e,n,i){var r,o,s,a,u,l=[];for(r=0,o=e.length;r<o;r++)s=e[r]*i,a=r<o-1?e[r+1]*i:t.length,(u=na(t,s,a,i,!1))===u.next&&(u.steiner=!0),l.push(pa(u));for(l.sort(la),r=0;r<l.length;r++)ha(l[r],n),n=ia(n,n.next);return n}(t,e,p,n)),t.length>80*n){i=o=t[0],r=s=t[1];for(var d=n;d<c;d+=n)(a=t[d])<i&&(i=a),(u=t[d+1])<r&&(r=u),o<a&&(o=a),s<u&&(s=u);l=0!==(l=Math.max(o-i,s-r))?1/l:0}return ra(p,f,n,i,r,l),f}function na(t,e,n,i,r){var o,s;if(r===0<Ea(t,e,n,i))for(o=e;o<n;o+=i)s=va(o,t[o],t[o+1],s);else for(o=n-i;e<=o;o-=i)s=va(o,t[o],t[o+1],s);return s&&ga(s,s.next)&&(ba(s),s=s.next),s}function ia(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!ga(i,i.next)&&0!==da(i.prev,i,i.next))i=i.next;else{if(ba(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function ra(t,e,n,i,r,o,s){if(t){!s&&o&&function(t,e,n,i){var r=t;for(;null===r.z&&(r.z=ca(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next,r!==t;);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,u,l=1;do{for(n=t,o=t=null,s=0;n;){for(s++,i=n,e=a=0;e<l&&(a++,i=i.nextZ);e++);for(u=l;0<a||0<u&&i;)0!==a&&(0===u||!i||n.z<=i.z)?(n=(r=n).nextZ,a--):(i=(r=i).nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(1<s)}(r)}(t,i,r,o);for(var a,u,l=t;t.prev!==t.next;)if(a=t.prev,u=t.next,o?sa(t,i,r,o):oa(t))e.push(a.i/n),e.push(t.i/n),e.push(u.i/n),ba(t),t=u.next,l=u.next;else if((t=u)===l){s?1===s?ra(t=aa(t,e,n),e,n,i,r,o,2):2===s&&ua(t,e,n,i,r,o):ra(ia(t),e,n,i,r,o,1);break}}}function oa(t){var e=t.prev,n=t,i=t.next;if(0<=da(e,n,i))return!1;for(var r=t.next.next;r!==t.prev;){if(fa(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=da(r.prev,r,r.next))return!1;r=r.next}return!0}function sa(t,e,n,i){var r=t.prev,o=t,s=t.next;if(0<=da(r,o,s))return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,u=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,l=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,h=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,c=ca(a,u,e,n,i),p=ca(l,h,e,n,i),f=t.nextZ;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&fa(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=da(f.prev,f,f.next))return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&fa(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=da(f.prev,f,f.next))return!1;f=f.prevZ}return!0}function aa(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!ga(r,o)&&ya(r,i,i.next,o)&&_a(r,o)&&_a(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),ba(i),ba(i.next),i=t=o),i=i.next}while(i!==t);return i}function ua(t,e,n,i,r,o){var s,a,u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&(a=l,(s=u).next.i!==a.i&&s.prev.i!==a.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&ya(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(s,a)&&_a(s,a)&&_a(a,s)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;for(;n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next,n!==t;);return i}(s,a))){var h=ma(u,l);return u=ia(u,u.next),h=ia(h,h.next),ra(u,e,n,i,r,o),void ra(h,e,n,i,r,o)}l=l.next}u=u.next}while(u!==t)}function la(t,e){return t.x-e.x}function ha(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&s<a){if((s=a)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===s)return n.prev;var u,l=n,h=n.x,c=n.y,p=1/0;i=n.next;for(;i!==l;)r>=i.x&&i.x>=h&&r!==i.x&&fa(o<c?r:s,o,h,c,o<c?s:r,o,i.x,i.y)&&((u=Math.abs(o-i.y)/(r-i.x))<p||u===p&&i.x>n.x)&&_a(i,t)&&(n=i,p=u),i=i.next;return n}(t,e)){var n=ma(e,t);ia(n,n.next)}}function ca(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function pa(t){for(var e=t,n=t;e.x<n.x&&(n=e),(e=e.next)!==t;);return n}function fa(t,e,n,i,r,o,s,a){return 0<=(r-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(i-a)-(n-s)*(e-a)&&0<=(n-s)*(o-a)-(r-s)*(i-a)}function da(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ga(t,e){return t.x===e.x&&t.y===e.y}function ya(t,e,n,i){return!!(ga(t,e)&&ga(n,i)||ga(t,i)&&ga(n,e))||0<da(t,e,n)!=0<da(t,e,i)&&0<da(n,i,t)!=0<da(n,i,e)}function _a(t,e){return da(t.prev,t,t.next)<0?0<=da(t,e,t.next)&&0<=da(t,t.prev,e):da(t,e,t.prev)<0||da(t,t.next,e)<0}function ma(t,e){var n=new xa(t.i,t.x,t.y),i=new xa(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function va(t,e,n,i){var r=new xa(t,e,n);return i?(r.next=i.next,(r.prev=i).next.prev=r,i.next=r):(r.prev=r).next=r,r}function ba(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function xa(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ea(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}function wa(t){var i=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);0<r&&(i+=t[r-1].length,n.holes.push(i))}return n}(t),r=$s(i.vertices,i.holes,2),e=[],o=[];r.forEach(function(t,e){var n=r[e];o.push([i.vertices[2*n],i.vertices[2*n+1]])});for(var n=0;n<o.length;n+=3){var s=o.slice(n,n+3);s.push(o[n]),e.push(nr([s]))}return e}function Ia(i,t){if(!i)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var r,o=1/0;return Pr(t,function(t,e){var n=as(i,t);n<o&&((r=us(t)).properties.featureIndex=e,r.properties.distanceToPoint=n,o=n)}),r}function La(t,e,n,i,r){!function t(e,n,i,r,o){for(;i<r;){if(600<r-i){var s=r-i+1,a=n-i+1,u=Math.log(s),l=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*l*(s-l)/s)*(a-s/2<0?-1:1),c=Math.max(i,Math.floor(n-a*l/s+h)),p=Math.min(r,Math.floor(n+(s-a)*l/s+h));t(e,n,c,p,o)}var f=e[n],d=i,g=r;for(Sa(e,i,n),0<o(e[r],f)&&Sa(e,i,r);d<g;){for(Sa(e,d,g),d++,g--;o(e[d],f)<0;)d++;for(;0<o(e[g],f);)g--}0===o(e[i],f)?Sa(e,i,g):Sa(e,++g,r),g<=n&&(i=g+1),n<=g&&(r=g-1)}}(t,e,n||0,i||t.length-1,r||Ma)}function Sa(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function Ma(t,e){return t<e?-1:e<t?1:0}function Ca(t,e){if(!(this instanceof Ca))return new Ca(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function Pa(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function Na(t,e){Oa(t,0,t.children.length,e,t)}function Oa(t,e,n,i,r){r||(r=Ba(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],Ta(r,t.leaf?i(o):o);return r}function Ta(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Ra(t,e){return t.minX-e.minX}function ka(t,e){return t.minY-e.minY}function Da(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Aa(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Fa(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Ga(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Ba(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ua(t,e,n,i,r){for(var o,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(La(t,o=e+Math.ceil((n-e)/i/2)*i,e,n,r),s.push(e,o,o,n))}function qa(t){var e=Ca(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=ja(e)).bbox=e}else t.bbox=t.bbox?t.bbox:za(t);return Ca.prototype.insert.call(this,t)},e.load=function(t){var n=[];return Array.isArray(t)?t.forEach(function(t){var e=ja(t);e.bbox=t,n.push(e)}):Pr(t,function(t){t.bbox=t.bbox?t.bbox:za(t),n.push(t)}),Ca.prototype.load.call(this,n)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=ja(e)).bbox=e}return Ca.prototype.remove.call(this,t)},e.clear=function(){return Ca.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:Ca.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return Ca.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:Ca.prototype.all.call(this)}},e.toJSON=function(){return Ca.prototype.toJSON.call(this)},e.fromJSON=function(t){return Ca.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return{minX:(e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:za(t))[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}function ja(t){var e=[t[0],t[1]],n=[t[0],t[3]],i=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],i,n,e]]}}}function za(t){var e=[1/0,1/0,-1/0,-1/0];return Lr(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}function Va(t){if(!t)throw new Error("geojson is required");var e=[];return kr(t,function(t){!function(i,r){var t=[],e=i.geometry;switch(e.type){case"Polygon":t=zr(e);break;case"LineString":t=[zr(e)]}t.forEach(function(t){var e,l,h,n=(e=t,l=i.properties,h=[],e.reduce(function(t,e){var n,i,r,o,s,a,u=rr([t,e],l);return u.bbox=(i=e,r=(n=t)[0],o=n[1],s=i[0],a=i[1],[r<s?r:s,o<a?o:a,s<r?r:s,a<o?o:a]),h.push(u),e}),h);n.forEach(function(t){t.id=r.length,r.push(t)})})}(t,e)}),sr(e)}function Ya(t,e){var r={},o=[];if("LineString"===t.type&&(t=Qi(t)),"LineString"===e.type&&(e=Qi(e)),"Feature"===t.type&&"Feature"===e.type&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var n=Ha(t,e);return n&&o.push(n),sr(o)}var s=qa();return s.load(Va(e)),Pr(Va(t),function(i){Pr(s.search(i),function(t){var e=Ha(i,t);if(e){var n=zr(e).join(",");r[n]||(r[n]=!0,o.push(e))}})}),sr(o)}function Ha(t,e){var n=zr(t),i=zr(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=n[0][0],o=n[0][1],s=n[1][0],a=n[1][1],u=i[0][0],l=i[0][1],h=i[1][0],c=i[1][1],p=(c-l)*(s-r)-(h-u)*(a-o),f=(h-u)*(o-l)-(c-l)*(r-u),d=(s-r)*(o-l)-(a-o)*(r-u);if(0===p)return null;var g=f/p,y=d/p;return 0<=g&&g<=1&&0<=y&&y<=1?tr([r+g*(s-r),o+g*(a-o)]):null}function Xa(t,p,f){if(!xr(f=f||{}))throw new Error("options is invalid");var e=t.geometry?t.geometry.type:t.type;if("LineString"!==e&&"MultiLineString"!==e)throw new Error("lines must be LineString or MultiLineString");var d=tr([1/0,1/0],{dist:1/0}),g=0;return kr(t,function(t){for(var e=zr(t),n=0;n<e.length-1;n++){var i=tr(e[n]);i.properties.dist=as(p,i,f);var r=tr(e[n+1]);r.properties.dist=as(p,r,f);var o=as(i,r,f),s=Math.max(i.properties.dist,r.properties.dist),a=Js(i,r),u=Xs(p,s,a+90,f),l=Xs(p,s,a-90,f),h=Ya(rr([u.geometry.coordinates,l.geometry.coordinates]),rr([i.geometry.coordinates,r.geometry.coordinates])),c=null;0<h.features.length&&((c=h.features[0]).properties.dist=as(p,c,f),c.properties.location=g+as(i,c,f)),i.properties.dist<d.properties.dist&&((d=i).properties.index=n,d.properties.location=g),r.properties.dist<d.properties.dist&&((d=r).properties.index=n+1,d.properties.location=g+o),c&&c.properties.dist<d.properties.dist&&((d=c).properties.index=n),g+=o}}),d}function Wa(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i,r=n.final;if(!t)throw new Error("start point is required");if(!e)throw new Error("end point is required");return 180<(i=r?Ja(jr(e),jr(t)):Ja(jr(t),jr(e)))?-(360-i):i}function Ja(t,e){var n=_r(t[1]),i=_r(e[1]),r=_r(e[0]-t[0]);r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI);var o=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(yr(Math.atan2(r,o))+360)%360}function Ka(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.units;if(!t)throw new Error("from point is required");if(!e)throw new Error("to point is required");var r=jr(t),o=jr(e);return o[0]+=180<o[0]-r[0]?-360:180<r[0]-o[0]?360:0,mr(function(t,e,n){var i=n=void 0===n?Wi:Number(n),r=t[1]*Math.PI/180,o=e[1]*Math.PI/180,s=o-r,a=Math.abs(e[0]-t[0])*Math.PI/180;a>Math.PI&&(a-=2*Math.PI);var u=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(r/2+Math.PI/4)),l=1e-11<Math.abs(u)?s/u:Math.cos(r);return Math.sqrt(s*s+l*l*a*a)*i}(r,o),"meters",i)}function Za(t,e){return $a(t,"mercator",e)}function Qa(t,e){return $a(t,"wgs84",e)}function $a(t,n,e){if(!xr(e=e||{}))throw new Error("options is invalid");var i=e.mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&br(t[0])?t="mercator"===n?tu(t):eu(t):(!0!==i&&(t=us(t)),Lr(t,function(t){var e="mercator"===n?tu(t):eu(t);t[0]=e[0],t[1]=e[1]})),t}function tu(t){var e,n=Math.PI/180,i=20037508.342789244,r=[6378137*(Math.abs(t[0])<=180?t[0]:t[0]-360*((e=t[0])<0?-1:0<e?1:0))*n,6378137*Math.log(Math.tan(.25*Math.PI+.5*t[1]*n))];return r[0]>i&&(r[0]=i),r[0]<-i&&(r[0]=-i),r[1]>i&&(r[1]=i),r[1]<-i&&(r[1]=-i),r}function eu(t){var e=180/Math.PI;return[t[0]*e/6378137,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/6378137)))*e]}ea.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(Ea(t,0,o,n));if(r)for(var a=0,u=e.length;a<u;a++){var l=e[a]*n,h=a<u-1?e[a+1]*n:t.length;s-=Math.abs(Ea(t,l,h,n))}var c=0;for(a=0;a<i.length;a+=3){var p=i[a]*n,f=i[a+1]*n,d=i[a+2]*n;c+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},ea.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);0<r&&(i+=t[r-1].length,n.holes.push(i))}return n},$s.default=ta,Ca.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!Ga(t,e))return n;for(var r,o,s,a,u=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],Ga(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):Fa(t,a)?this._all(s,n):u.push(s));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!Ga(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],Ga(t,s=e.leaf?n(o):o)){if(e.leaf||Fa(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Ba([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,s=this.data,a=this.toBBox(t),u=[],l=[];s||u.length;){if(s||(s=u.pop(),i=u[u.length-1],n=l.pop(),o=!0),s.leaf&&-1!==(r=Pa(t,s.children,e)))return s.children.splice(r,1),u.push(s),this._condense(u),this;o||s.leaf||!Fa(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(u.push(s),l.push(n),n=0,s=(i=s).children[0])}return this},toBBox:function(t){return t},compareMinX:Ra,compareMinY:ka,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return Na(r=Ba(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=Ba([])).leaf=!1,r.height=i;var a,u,l,h,c=Math.ceil(o/s),p=c*Math.ceil(Math.sqrt(s));for(Ua(t,e,n,p,this.compareMinX),a=e;a<=n;a+=p)for(Ua(t,a,l=Math.min(a+p-1,n),c,this.compareMinY),u=a;u<=l;u+=c)h=Math.min(u+c-1,l),r.children.push(this._build(t,u,h,i-1));return Na(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,u,l,h,c,p,f;i.push(e),!e.leaf&&i.length-1!==n;){for(h=c=1/0,r=0,o=e.children.length;r<o;r++)u=Da(s=e.children[r]),p=t,f=s,(l=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-u)<c?(c=l,h=u<h?u:h,a=s):l===c&&u<h&&(h=u,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),Ta(s,r);0<=e&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=Ba(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,Na(n,this.toBBox),Na(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=Ba([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Na(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,a,u,l,h,c,p,f,d,g,y;for(u=l=1/0,i=e;i<=n-e;i++)r=Oa(t,0,i,this.toBBox),o=Oa(t,i,n,this.toBBox),c=r,p=o,void 0,f=Math.max(c.minX,p.minX),d=Math.max(c.minY,p.minY),g=Math.min(c.maxX,p.maxX),y=Math.min(c.maxY,p.maxY),s=Math.max(0,g-f)*Math.max(0,y-d),a=Da(r)+Da(o),s<u?(u=s,h=i,l=a<l?a:l):s===u&&a<l&&(l=a,h=i);return h},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:Ra,r=t.leaf?this.compareMinY:ka;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,a=Oa(t,0,e,s),u=Oa(t,n-e,n,s),l=Aa(a)+Aa(u);for(r=e;r<n-e;r++)o=t.children[r],Ta(a,t.leaf?s(o):o),l+=Aa(a);for(r=n-e-1;e<=r;r--)o=t.children[r],Ta(u,t.leaf?s(o):o),l+=Aa(u);return l},_adjustParentBBoxes:function(t,e,n){for(var i=n;0<=i;i--)Ta(e[i],t)},_condense:function(t){for(var e,n=t.length-1;0<=n;n--)0===t[n].children.length?0<n?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():Na(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var nu=Object.freeze({toMercator:Za,toWgs84:Qa});function iu(t,e,r){if(!xr(r=r||{}))throw new Error("options is invalid");if(!t)throw new Error("pt is required");if(Array.isArray(t)?t=tr(t):"Point"===t.type?t=Qi(t):Hr(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=rr(e):"LineString"===e.type?e=Qi(e):Hr(e,"LineString","line");var o=1/0,s=t.geometry.coordinates;return Ar(e,function(t){var e=t.geometry.coordinates[0],n=t.geometry.coordinates[1],i=function(t,e,n,i){var r=i.mercator,o=!0!==r?as(e,t,i):ru(e,t,i),s=gr(!0!==r?Js(e,t):Wa(e,t)),a=gr(!0!==r?Js(e,n):Wa(e,n)),u=Math.abs(s-a);if(90<u)return o;var l=(a+180)%360,h=gr(!0!==r?Js(n,t):Wa(n,t)),c=Math.abs(h-l);180<c&&(c=Math.abs(c-360));return 90<c?!0!==r?as(t,n,i):ru(t,n,i):!0!==r?o*Math.sin(_r(u)):function(t,e,n,i){var r=0;(180<=Math.abs(t[0])||180<=Math.abs(e[0])||180<=Math.abs(n[0]))&&(r=0<t[0]||0<e[0]||0<n[0]?-180:180);var o,s,a,u,l,h,c,p,f,d,g,y,_=tr(n),m=Za([t[0]+r,t[1]]),v=Za([e[0]+r,e[1]]),b=Za([n[0]+r,n[1]]),x=Qa((s=v,a=b,u=(o=m)[0],l=o[1],h=s[0],c=s[1],p=a[0],f=a[1],[u+(y=((p-u)*(d=h-u)+(f-l)*(g=c-l))/(d*d+g*g))*d,l+y*g]));return 0!==r&&(x[0]-=r),Ka(_,x,i)}(e,n,t,i)}(s,e,n,r);i<o&&(o=i)}),o}function ru(t,e,n){var i=n.units,r=0;180<=Math.abs(t[0])&&(r=0<t[0]?-180:180),180<=Math.abs(e[0])&&(r=0<e[0]?-180:180);var o=Za([t[0]+r,t[1]]),s=Za([e[0]+r,e[1]]),a=function(t){return t*t},u=a(o[0]-s[0])+a(o[1]-s[1]);return mr(Math.sqrt(u),"meters",i)}function ou(t){for(var e,n="FeatureCollection"===(e=t).type?e:"Feature"===e.type?sr([e]):sr([Qi(e)]),i=Ks(n),r=!1,o=0;!r&&o<n.features.length;){var s,a=n.features[o].geometry,u=!1;if("Point"===a.type)i.geometry.coordinates[0]===a.coordinates[0]&&i.geometry.coordinates[1]===a.coordinates[1]&&(r=!0);else if("MultiPoint"===a.type){var l=!1;for(s=0;!l&&s<a.coordinates.length;)i.geometry.coordinates[0]===a.coordinates[s][0]&&i.geometry.coordinates[1]===a.coordinates[s][1]&&(l=r=!0),s++}else if("LineString"===a.type)for(s=0;!u&&s<a.coordinates.length-1;)su(i.geometry.coordinates[0],i.geometry.coordinates[1],a.coordinates[s][0],a.coordinates[s][1],a.coordinates[s+1][0],a.coordinates[s+1][1])&&(r=u=!0),s++;else if("MultiLineString"===a.type)for(var h=0;h<a.coordinates.length;){u=!1,s=0;for(var c=a.coordinates[h];!u&&s<c.length-1;)su(i.geometry.coordinates[0],i.geometry.coordinates[1],c[s][0],c[s][1],c[s+1][0],c[s+1][1])&&(r=u=!0),s++;h++}else"Polygon"!==a.type&&"MultiPolygon"!==a.type||ts(i,a)&&(r=!0);o++}if(r)return i;var p=sr([]);for(o=0;o<n.features.length;o++)p.features=p.features.concat(Qs(n.features[o]).features);return tr(Ia(i,p).geometry.coordinates)}function su(t,e,n,i,r,o){return Math.sqrt((r-n)*(r-n)+(o-i)*(o-i))===Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))+Math.sqrt((r-t)*(r-t)+(o-e)*(o-e))}function au(t){return Rr(t,function(t,e){return t+function t(e){var n,i=0;switch(e.type){case"Polygon":return lu(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=lu(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}}(e)},0)}var uu=6378137;function lu(t){var e=0;if(t&&0<t.length){e+=Math.abs(hu(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(hu(t[n]))}return e}function hu(t){var e,n,i,r,o,s,a=0,u=t.length;if(2<u){for(s=0;s<u;s++)o=s===u-2?(i=u-2,r=u-1,0):s===u-1?(i=u-1,r=0,1):(r=(i=s)+1,s+2),e=t[i],n=t[r],a+=(cu(t[o][0])-cu(e[0]))*Math.sin(cu(n[1]));a=a*uu*uu/2}return a}function cu(t){return t*Math.PI/180}function pu(t,i){if(!xr(i=i||{}))throw new Error("options is invalid");if(!t)throw new Error("geojson is required");return Fr(t,function(t,e){var n=e.geometry.coordinates;return t+as(n[0],n[1],i)},0)}function fu(t,e,n,i){if(!xr(i=i||{}))throw new Error("options is invalid");var r,o=[];if("Feature"===t.type)r=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");r=t.coordinates}for(var s,a,u,l=0,h=0;h<r.length&&!(l<=e&&h===r.length-1);h++){if(e<l&&0===o.length){if(!(s=e-l))return o.push(r[h]),rr(o);a=Js(r[h],r[h-1])-180,u=Xs(r[h],s,a,i),o.push(u.geometry.coordinates)}if(n<=l)return(s=n-l)?(a=Js(r[h],r[h-1])-180,u=Xs(r[h],s,a,i),o.push(u.geometry.coordinates)):o.push(r[h]),rr(o);if(e<=l&&o.push(r[h]),h===r.length-1)return rr(o);l+=as(r[h],r[h+1],i)}return rr(r[r.length-1])}function du(t,e,n){var i=(n=n||{}).ignoreEndVertices;if(!xr(n))throw new Error("invalid options");if(!t)throw new Error("pt is required");if(!e)throw new Error("line is required");for(var r=jr(t),o=zr(e),s=0;s<o.length-1;s++){var a=!1;if(i&&(0===s&&(a="start"),s===o.length-2&&(a="end"),0===s&&s+1===o.length-1&&(a="both")),gu(o[s],o[s+1],r,a))return!0}return!1}function gu(t,e,n,i){var r=n[0],o=n[1],s=t[0],a=t[1],u=e[0],l=e[1],h=u-s,c=l-a;return 0==(n[0]-s)*c-(n[1]-a)*h&&(i?"start"===i?Math.abs(h)>=Math.abs(c)?0<h?s<r&&r<=u:u<=r&&r<s:0<c?a<o&&o<=l:l<=o&&o<a:"end"===i?Math.abs(h)>=Math.abs(c)?0<h?s<=r&&r<u:u<r&&r<=s:0<c?a<=o&&o<l:l<o&&o<=a:"both"===i?Math.abs(h)>=Math.abs(c)?0<h?s<r&&r<u:u<r&&r<s:0<c?a<o&&o<l:l<o&&o<a:void 0:Math.abs(h)>=Math.abs(c)?0<h?s<=r&&r<=u:u<=r&&r<=s:0<c?a<=o&&o<=l:l<=o&&o<=a)}function yu(t,e){var n=Kr(t),i=Kr(e),r=Wr(t),o=Wr(e);switch(n){case"Point":switch(i){case"MultiPoint":return function(t,e){var n,i=!1;for(n=0;n<e.coordinates.length;n++)if(mu(e.coordinates[n],t.coordinates)){i=!0;break}return i}(r,o);case"LineString":return du(r,o,{ignoreEndVertices:!0});case"Polygon":return ts(r,o,{ignoreBoundary:!0});default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"MultiPoint":return function(t,e){for(var n=0;n<t.coordinates.length;n++){for(var i=!1,r=0;r<e.coordinates.length;r++)mu(t.coordinates[n],e.coordinates[r])&&(i=!0);if(!i)return!1}return!0}(r,o);case"LineString":return function(t,e){for(var n=!1,i=0;i<t.coordinates.length;i++){if(!du(t.coordinates[i],e))return!1;n||(n=du(t.coordinates[i],e,{ignoreEndVertices:!0}))}return n}(r,o);case"Polygon":return function(t,e){for(var n=!0,i=0;i<t.coordinates.length;i++){var r=ts(t.coordinates[1],e);if(!r){n=!1;break}r=ts(t.coordinates[1],e,{ignoreBoundary:!0})}return n&&r}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"LineString":return function(t,e){for(var n=0;n<t.coordinates.length;n++)if(!du(t.coordinates[n],e))return!1;return!0}(r,o);case"Polygon":return function(t,e){var n=qr(e),i=qr(t);if(!_u(n,i))return!1;for(var r=!1,o=0;o<t.coordinates.length-1;o++){if(!ts(t.coordinates[o],e))return!1;if(r||(r=ts(t.coordinates[o],e,{ignoreBoundary:!0})),!r){var s=(a=t.coordinates[o],u=t.coordinates[o+1],[(a[0]+u[0])/2,(a[1]+u[1])/2]);r=ts(s,e,{ignoreBoundary:!0})}}var a,u;return r}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Polygon":return function(t,e){var n=qr(t);if(!_u(qr(e),n))return!1;for(var i=0;i<t.coordinates[0].length;i++)if(!ts(t.coordinates[0][i],e))return!1;return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function _u(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function mu(t,e){return t[0]===e[0]&&t[1]===e[1]}function vu(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.mask,r=n.properties,o=[];if(null==e)throw new Error("cellSide is required");if(!br(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(i&&-1===["Polygon","MultiPolygon"].indexOf(Kr(i)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=t[0],a=t[1],u=t[2],l=t[3],h=e/as([s,a],[u,a],n)*(u-s),c=e/as([s,a],[s,l],n)*(l-a),p=u-s,f=l-a,d=Math.floor(p/h),g=(f-Math.floor(f/c)*c)/2,y=s+(p-d*h)/2;y<=u;){for(var _=a+g;_<=l;){var m=tr([y,_],r);i?yu(m,i)&&o.push(m):o.push(m),_+=c}y+=h}return sr(o)}function bu(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.precision,i=e.coordinates,r=e.mutate;if(n=null==n||isNaN(n)?6:n,i=null==i||isNaN(i)?3:i,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof i)throw new Error("<coordinates> must be a number");!1!==r&&void 0!==r||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,n);return Lr(t,function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var i=0;i<t.length;i++)t[i]=Math.round(t[i]*e)/e}(t,o,i)}),t}var xu=function(t,f,e){if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===e&&(e=1);var d=t.geometry.coordinates,g=[],y={};if(e){for(var n=[],i=0;i<d.length;i++)for(var r=0;r<d[i].length-1;r++)n.push(c(i,r));var o=lo();o.load(n)}for(var s=0;s<d.length;s++)for(var a=0;a<d[s].length-1;a++){if(e)o.search(c(s,a)).forEach(function(t){var e=t.ring,n=t.edge;h(s,a,e,n)});else for(var u=0;u<d.length;u++)for(var l=0;l<d[u].length-1;l++)h(s,a,u,l)}return f||(g={type:"Feature",geometry:{type:"MultiPoint",coordinates:g}}),g;function h(t,e,n,i){var r,o,s=d[t][e],a=d[t][e+1],u=d[n][i],l=d[n][i+1],h=function(t,e,n,i){if(Eu(t,n)||Eu(t,i)||Eu(e,n)||Eu(i,n))return null;var r=t[0],o=t[1],s=e[0],a=e[1],u=n[0],l=n[1],h=i[0],c=i[1],p=(r-s)*(l-c)-(o-a)*(u-h);return 0===p?null:[((r*a-o*s)*(u-h)-(r-s)*(u*c-l*h))/p,((r*a-o*s)*(l-c)-(o-a)*(u*c-l*h))/p]}(s,a,u,l);if(null!==h&&(r=a[0]!==s[0]?(h[0]-s[0])/(a[0]-s[0]):(h[1]-s[1])/(a[1]-s[1]),o=l[0]!==u[0]?(h[0]-u[0])/(l[0]-u[0]):(h[1]-u[1])/(l[1]-u[1]),!(1<=r||r<=0||1<=o||o<=0))){var c=h,p=!y[c];p&&(y[c]=!0),f?g.push(f(h,t,e,s,a,r,n,i,u,l,o,p)):g.push(h)}}function c(t,e){var n,i,r,o,s=d[t][e],a=d[t][e+1];return i=s[0]<a[0]?(n=s[0],a[0]):(n=a[0],s[0]),o=s[1]<a[1]?(r=s[1],a[1]):(r=a[1],s[1]),{minX:n,minY:r,maxX:i,maxY:o,ring:t,edge:e}}};function Eu(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!Eu(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}var wu=function(t,e,n,i,r){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=i,this.nxtIsectAlongEdgeIn=r},Iu=function(t,e,n,i,r,o,s){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=i,this.nxtIsectAlongRingAndEdge2=r,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=s};function Lu(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return 0<=(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])==e}function Su(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(Lu([t[(e-1).modulo(t.length-1)],t[e],t[(e+1).modulo(t.length-1)]],!0))var i=1;else i=-1;return i}function Mu(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!Mu(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}Number.prototype.modulo=function(t){return(this%t+t)%t};var Cu=Math.PI/180,Pu=180/Math.PI,Nu=function(t,e){this.lon=t,this.lat=e,this.x=Cu*t,this.y=Cu*e};Nu.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Nu.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new Nu(e,t)};var Ou=function(){this.coords=[],this.length=0};Ou.prototype.move_to=function(t){this.length++,this.coords.push(t)};var Tu=function(t){this.properties=t||{},this.geometries=[]};Tu.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},Tu.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},i=0;i<this.geometries.length;i++){if(0===this.geometries[i].coords.length)return"LINESTRING(empty)";this.geometries[i].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var Ru=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Nu(t.x,t.y),this.end=new Nu(e.x,e.y),this.properties=n||{};var i=this.start.x-this.end.x,r=this.start.y-this.end.y,o=Math.pow(Math.sin(r/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(i/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};function ku(i,t){var r=[],o=qa();return kr(t,function(t){if(r.forEach(function(t,e){t.id=e}),r.length){var e=o.search(t);if(e.features.length){var n=Au(t,e);r=r.filter(function(t){return t.id!==n.id}),o.remove(n),Pr(Du(n,t),function(t){r.push(t),o.insert(t)})}}else(r=Du(i,t).features).forEach(function(t){t.bbox||(t.bbox=Hs(qr(t)))}),o.load(sr(r))}),sr(r)}function Du(t,o){var s=[],e=zr(t)[0],n=zr(t)[t.geometry.coordinates.length-1];if(Fu(e,jr(o))||Fu(n,jr(o)))return sr([t]);var i=qa(),r=Va(t);i.load(r);var a=i.search(o);if(!a.features.length)return sr([t]);var u=Au(o,a),l=Nr(r,function(t,e,n){var i=zr(e)[1],r=jr(o);return n===u.id?(t.push(r),s.push(rr(t)),Fu(r,i)?[r]:[r,i]):(t.push(i),t)},[e]);return 1<l.length&&s.push(rr(l)),sr(s)}function Au(n,t){if(!t.features.length)throw new Error("lines must contain features");if(1===t.features.length)return t.features[0];var i,r=1/0;return Pr(t,function(t){var e=Xa(t,n).properties.dist;e<r&&(i=t,r=e)}),i}function Fu(t,e){return t[0]===e[0]&&t[1]===e[1]}function Gu(t,e,n,i,r){if(!xr(r=r||{}))throw new Error("options is invalid");var o=r.steps,s=r.units;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if(null==n)throw new Error("bearing1 is required");if(null==i)throw new Error("bearing2 is required");if("object"!=typeof r)throw new Error("options must be an object");o=o||64;var a=Bu(n),u=Bu(i),l=t.properties;if(a===u)return rr(Ws(t,e,r).geometry.coordinates[0],l);for(var h=a,c=a<u?u:u+360,p=h,f=[],d=0;p<c;)f.push(Xs(t,e,p,s).geometry.coordinates),p=h+360*++d/o;return c<p&&f.push(Xs(t,e,c,s).geometry.coordinates),rr(f,l)}function Bu(t){var e=t%360;return e<0&&(e+=360),e}function Uu(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.properties,i=Kr(t),r=zr(t);if(n=n||t.properties||{},!r.length)throw new Error("polygon must contain coordinates");switch(i){case"Polygon":return qu(r,n);case"MultiPolygon":var o=[];return r.forEach(function(t){o.push(qu(t,n))}),sr(o);default:throw new Error("geom "+i+" not supported")}}function qu(t,e){return 1<t.length?ar(t,e):rr(t[0],e)}function ju(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.properties,i=e.autoComplete,r=e.orderCoords;if(!t)throw new Error("lines is required");switch(i=void 0===i||i,r=void 0===r||r,Kr(t)){case"FeatureCollection":case"GeometryCollection":var o=[];return(t.features?t.features:t.geometries).forEach(function(t){o.push(zr(zu(t,{},i,r)))}),lr(o,n)}return zu(t,n,i,r)}function zu(t,e,a,u){e=e||t.properties||{};var n=zr(t),i=Kr(t);if(!n.length)throw new Error("line must contain coordinates");switch(i){case"LineString":return a&&(n=Vu(n)),nr([n],e);case"MultiLineString":var l=[],h=0;return n.forEach(function(t){if(a&&(t=Vu(t)),u){var e=(n=qr(rr(t)),i=n[0],r=n[1],o=n[2],s=n[3],Math.abs(i-o)*Math.abs(r-s));h<e?(l.unshift(t),h=e):l.push(t)}else l.push(t);var n,i,r,o,s}),nr(l,e);default:throw new Error("geometry type "+i+" is not supported")}}function Vu(t){var e=t[0],n=e[0],i=e[1],r=t[t.length-1],o=r[0],s=r[1];return n===o&&i===s||t.push(e),t}Ru.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),i=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),r=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=Pu*Math.atan2(o,Math.sqrt(Math.pow(i,2)+Math.pow(r,2)));return[Pu*Math.atan2(r,i),s]},Ru.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var i=1/(t-1),r=0;r<t;++r){var o=i*r,s=this.interpolate(o);n.push(s)}for(var a=!1,u=0,l=e&&e.offset?e.offset:10,h=180-l,c=-180+l,p=360-l,f=1;f<n.length;++f){var d=n[f-1][0],g=n[f][0],y=Math.abs(g-d);p<y&&(h<g&&d<c||h<d&&g<c)?a=!0:u<y&&(u=y)}var _=[];if(a&&u<l){var m=[];_.push(m);for(var v=0;v<n.length;++v){var b=parseFloat(n[v][0]);if(0<v&&Math.abs(b-n[v-1][0])>p){var x=parseFloat(n[v-1][0]),E=parseFloat(n[v-1][1]),w=parseFloat(n[v][0]),I=parseFloat(n[v][1]);if(-180<x&&x<c&&180===w&&v+1<n.length&&-180<n[v-1][0]&&n[v-1][0]<c){m.push([-180,n[v][1]]),v++,m.push([n[v][0],n[v][1]]);continue}if(h<x&&x<180&&-180===w&&v+1<n.length&&n[v-1][0]>h&&n[v-1][0]<180){m.push([180,n[v][1]]),v++,m.push([n[v][0],n[v][1]]);continue}if(x<c&&h<w){var L=x;x=w,w=L;var S=E;E=I,I=S}if(h<x&&w<c&&(w+=360),x<=180&&180<=w&&x<w){var M=(180-x)/(w-x),C=M*I+(1-M)*E;m.push([n[v-1][0]>h?180:-180,C]),(m=[]).push([n[v-1][0]>h?-180:180,C]),_.push(m)}else m=[],_.push(m);m.push([b,n[v][1]])}else m.push([n[v][0],n[v][1]])}}else{var P=[];_.push(P);for(var N=0;N<n.length;++N)P.push([n[N][0],n[N][1]])}for(var O=new Tu(this.properties),T=0;T<_.length;++T){var R=new Ou;O.geometries.push(R);for(var k=_[T],D=0;D<k.length;++D)R.move_to(k[D])}return O};var Yu=Hu;function Hu(t,e,n){var i,r,o,s,a,u=t.length,l=Wu(t[0],e),h=[];for(n||(n=[]),i=1;i<u;i++){for(r=t[i-1],s=a=Wu(o=t[i],e);;){if(!(l|s)){h.push(r),s!==a?(h.push(o),i<u-1&&(n.push(h),h=[])):i===u-1&&h.push(o);break}if(l&s)break;l?l=Wu(r=Xu(r,o,l,e),e):s=Wu(o=Xu(r,o,s,e),e)}l=a}return h.length&&n.push(h),n}function Xu(t,e,n,i){return 8&n?[t[0]+(e[0]-t[0])*(i[3]-t[1])/(e[1]-t[1]),i[3]]:4&n?[t[0]+(e[0]-t[0])*(i[1]-t[1])/(e[1]-t[1]),i[1]]:2&n?[i[2],t[1]+(e[1]-t[1])*(i[2]-t[0])/(e[0]-t[0])]:1&n?[i[0],t[1]+(e[1]-t[1])*(i[0]-t[0])/(e[0]-t[0])]:null}function Wu(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Ju(t,e){for(var n=[],i=0;i<t.length;i++){var r=Yu.polygon(t[i],e);0<r.length&&(r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]||r.push(r[0]),4<=r.length&&n.push(r))}return n}(Hu.polyline=Hu).polygon=function(t,e){var n,i,r,o,s,a,u;for(i=1;i<=8;i*=2){for(n=[],r=t[t.length-1],o=!(Wu(r,e)&i),s=0;s<t.length;s++)a=t[s],(u=!(Wu(a,e)&i))!==o&&n.push(Xu(r,a,i,e)),u&&n.push(a),r=a,o=u;if(!(t=n).length)break}return n};var Ku=Array.prototype.slice;function Zu(t){return"[object Arguments]"===Object.prototype.toString.call(t)}function Qu(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?(n.strict,t===e):function(t,e,n){var i,r;if($u(t)||$u(e))return!1;if(t.prototype!==e.prototype)return!1;if(Zu(t))return!!Zu(e)&&(t=Ku.call(t),e=Ku.call(e),Qu(t,e,n));if(tl(t)){if(!tl(e))return!1;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}try{var o=Object.keys(t),s=Object.keys(e)}catch(t){return!1}if(o.length!==s.length)return!1;for(o.sort(),s.sort(),i=o.length-1;0<=i;i--)if(o[i]!==s[i])return!1;for(i=o.length-1;0<=i;i--)if(r=o[i],!Qu(t[r],e[r],n))return!1;return typeof t==typeof e}(t,e,n))}function $u(t){return null==t}function tl(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(0<t.length&&"number"!=typeof t[0]))}function el(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var o,s=n.tolerance||0,a=[],u=qa();return u.load(Va(t)),Ar(e,function(i){var r=!1;Pr(u.search(i),function(t){if(!1===r){var e=zr(i).sort(),n=zr(t).sort();Qu(e,n)?(r=!0,o=o?nl(o,i):i):(0===s?du(e[0],t)&&du(e[1],t):Xa(t,e[0]).properties.dist<=s&&Xa(t,e[1]).properties.dist<=s)?(r=!0,o=o?nl(o,i):i):(0===s?du(n[0],i)&&du(n[1],i):Xa(i,n[0]).properties.dist<=s&&Xa(i,n[1]).properties.dist<=s)&&(o=o?nl(o,t):t)}}),!1===r&&o&&(a.push(o),o=void 0)}),o&&a.push(o),sr(a)}function nl(t,e){var n=zr(e),i=zr(t),r=i[0],o=i[i.length-1],s=t.geometry.coordinates;return Qu(n[0],r)?s.unshift(n[1]):Qu(n[0],o)?s.push(n[1]):Qu(n[1],r)?s.unshift(n[0]):Qu(n[1],o)&&s.push(n[0]),t}function il(t){var e=t%360;return e<0&&(e+=360),e}function rl(t,e,n,i){if(!xr(i=i||{}))throw new Error("options is invalid");var r=i.units,o=i.properties;if(!t)throw new Error("origin is required");if(null==e)throw new Error("distance is required");if(null==n)throw new Error("bearing is required");if(!(0<=e))throw new Error("distance must be greater than 0");var s=mr(e,r,"meters"),a=jr(t),u=function(t,e,n,i){i=void 0===i?Wi:Number(i);var r=e/i,o=t[0]*Math.PI/180,s=_r(t[1]),a=_r(n),u=r*Math.cos(a),l=s+u;Math.abs(l)>Math.PI/2&&(l=0<l?Math.PI-l:-Math.PI-l);var h=Math.log(Math.tan(l/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),c=1e-11<Math.abs(h)?u/h:Math.cos(s),p=r*Math.sin(a)/c;return[(180*(o+p)/Math.PI+540)%360-180,180*l/Math.PI]}(a,s,n);return u[0]+=180<u[0]-a[0]?-360:180<a[0]-u[0]?360:0,tr(u,o)}function ol(t,e,n,i,r,o){for(var s=0;s<t.length;s++){var a=t[s],u=t[s+1];s===t.length-1&&(u=t[0]),i=sl(a,u,e),n<=0&&0<i?sl(e,a,r)<0||(r=a):0<n&&i<=0&&(0<sl(e,a,o)||(o=a)),n=i}return[r,o]}function sl(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function al(t){if(!t)throw new Error("line is required");var e=t.geometry?t.geometry.type:t.type;if(!Array.isArray(t)&&"LineString"!==e)throw new Error("geometry must be a LineString");for(var n,i,r=zr(t),o=0,s=1;s<r.length;)n=i||r[0],o+=((i=r[s])[0]-n[0])*(i[1]+n[1]),s++;return 0<o}function ul(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return Tr(t,function(t){ul(t,e)}),t;case"LineString":return ll(zr(t),e),t;case"Polygon":return hl(zr(t),e),t;case"MultiLineString":return zr(t).forEach(function(t){ll(t,e)}),t;case"MultiPolygon":return zr(t).forEach(function(t){hl(t,e)}),t;case"Point":case"MultiPoint":return t}}function ll(t,e){al(t)===e&&t.reverse()}function hl(t,e){al(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)al(t[n])===e&&t[n].reverse()}function cl(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",i=e.flip,r=e.flags;Xr(t,"Point","input must contain Points");for(var o,s,a=(o=i,s={},Pr(t,function(t){var e=zr(t)[1];s[e]||(s[e]=[]),s[e].push(t)}),Object.keys(s).map(function(t){return s[t].sort(function(t,e){return zr(t)[0]-zr(e)[0]})}).sort(function(t,e){return o?zr(t[0])[1]-zr(e[0])[1]:zr(e[0])[1]-zr(t[0])[1]})),u=[],l=0;l<a.length;l++){for(var h=a[l],c=[],p=0;p<h.length;p++){var f=h[p];f.properties[n]?c.push(f.properties[n]):c.push(0),!0===r&&(f.properties.matrixPosition=[l,p])}u.push(c)}return u}var pl={successCallback:null,verbose:!1,polygons:!1},fl={};function dl(t,e,n,i){i=i||{};for(var r=Object.keys(pl),o=0;o<r.length;o++){var s=r[o],a=i[s];a=null!=a?a:pl[s],fl[s]=a}fl.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+e+":"+(e+n)+"]");var u,l,h,c=function(t,e,n){for(var i=t.length-1,r=t[0].length-1,o={rows:i,cols:r,cells:[]},s=e+Math.abs(n),a=0;a<i;++a){o.cells[a]=[];for(var u=0;u<r;++u){var l=0,h=t[a+1][u],c=t[a+1][u+1],p=t[a][u+1],f=t[a][u];if(!(isNaN(h)||isNaN(c)||isNaN(p)||isNaN(f))){l|=h<e?0:s<h?128:64,l|=c<e?0:s<c?32:16,l|=p<e?0:s<p?8:4;var d=+(l|=f<e?0:s<f?2:1),g=0;if(17===l||18===l||33===l||34===l||38===l||68===l||72===l||98===l||102===l||132===l||136===l||137===l||152===l||153===l){var y=(h+c+p+f)/4;g=s<y?2:y<e?0:1,34===l?1===g?l=35:0===g&&(l=136):136===l?1===g?(l=35,g=4):0===g&&(l=34):17===l?1===g?(l=155,g=4):0===g&&(l=153):68===l?1===g?(l=103,g=4):0===g&&(l=102):153===l?1===g&&(l=155):102===l?1===g&&(l=103):152===l?g<2&&(l=156,g=1):137===l?g<2&&(l=139,g=1):98===l?g<2&&(l=99,g=1):38===l?g<2&&(l=39,g=1):18===l?0<g?(l=156,g=4):l=152:33===l?0<g?(l=139,g=4):l=137:72===l?0<g?(l=99,g=4):l=98:132===l&&(0<g?(l=39,g=4):l=38)}if(0!=l&&170!=l){var _,m,v,b,x,E,w,I;_=m=v=b=x=E=w=I=.5;var L=[];1===l?(v=1-sh(e,p,f),I=1-sh(e,h,f),L.push(th[l])):169===l?(v=sh(s,f,p),I=sh(s,f,h),L.push(th[l])):4===l?(E=1-sh(e,c,p),b=sh(e,f,p),L.push(Ql[l])):166===l?(E=sh(s,p,c),b=1-sh(s,p,f),L.push(Ql[l])):16===l?(x=sh(e,p,c),m=sh(e,h,c),L.push(Zl[l])):154===l?(x=1-sh(s,c,p),m=1-sh(s,c,h),L.push(Zl[l])):64===l?(w=sh(e,f,h),_=1-sh(e,c,h),L.push(nh[l])):106===l?(w=1-sh(s,h,f),_=sh(s,h,c),L.push(nh[l])):168===l?(b=sh(s,f,p),v=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),L.push($l[l]),L.push(th[l])):2===l?(b=1-sh(e,p,f),v=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),L.push($l[l]),L.push(th[l])):162===l?(x=sh(s,p,c),E=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),L.push($l[l]),L.push(th[l])):8===l?(x=1-sh(e,c,p),E=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),L.push(Zl[l]),L.push(Ql[l])):138===l?(x=1-sh(e,c,p),E=1-sh(s,c,p),_=1-sh(s,c,h),m=1-sh(e,c,h),L.push(Zl[l]),L.push(Ql[l])):32===l?(x=sh(s,p,c),E=sh(e,p,c),_=sh(e,h,c),m=sh(s,h,c),L.push(Zl[l]),L.push(Ql[l])):42===l?(I=1-sh(s,h,f),w=1-sh(e,h,f),_=sh(e,h,c),m=sh(s,h,c),L.push(eh[l]),L.push(nh[l])):128===l&&(I=sh(e,f,h),w=sh(s,f,h),_=1-sh(s,c,h),m=1-sh(e,c,h),L.push(eh[l]),L.push(nh[l])),5===l?(E=1-sh(e,c,p),I=1-sh(e,h,f),L.push(Ql[l])):165===l?(E=sh(s,p,c),I=sh(s,f,h),L.push(Ql[l])):20===l?(b=sh(e,f,p),m=sh(e,h,c),L.push($l[l])):150===l?(b=1-sh(s,p,f),m=1-sh(s,c,h),L.push($l[l])):80===l?(x=sh(e,p,c),w=sh(e,f,h),L.push(Zl[l])):90===l?(x=1-sh(s,c,p),w=1-sh(s,h,f),L.push(Zl[l])):65===l?(v=1-sh(e,p,f),_=1-sh(e,c,h),L.push(th[l])):105===l?(v=sh(s,f,p),_=sh(s,h,c),L.push(th[l])):160===l?(x=sh(s,p,c),E=sh(e,p,c),I=sh(e,f,h),w=sh(s,f,h),L.push(Zl[l]),L.push(Ql[l])):10===l?(x=1-sh(e,c,p),E=1-sh(s,c,p),I=1-sh(s,h,f),w=1-sh(e,h,f),L.push(Zl[l]),L.push(Ql[l])):130===l?(b=1-sh(e,p,f),v=1-sh(s,p,f),_=1-sh(s,c,h),m=1-sh(e,c,h),L.push($l[l]),L.push(th[l])):40===l?(b=sh(s,f,p),v=sh(e,f,p),_=sh(e,h,c),m=sh(s,h,c),L.push($l[l]),L.push(th[l])):101===l?(E=sh(s,p,c),_=sh(s,h,c),L.push(Ql[l])):69===l?(E=1-sh(e,c,p),_=1-sh(e,c,h),L.push(Ql[l])):149===l?(I=sh(s,f,h),m=1-sh(s,c,h),L.push(eh[l])):21===l?(I=1-sh(e,h,f),m=sh(e,h,c),L.push(eh[l])):86===l?(b=1-sh(s,p,f),w=1-sh(s,h,f),L.push($l[l])):84===l?(b=sh(e,f,p),w=sh(e,f,h),L.push($l[l])):89===l?(x=1-sh(s,c,p),v=sh(s,f,p),L.push(th[l])):81===l?(x=sh(e,p,c),v=1-sh(e,p,f),L.push(th[l])):96===l?(x=sh(s,p,c),E=sh(e,p,c),w=sh(e,f,h),_=sh(s,h,c),L.push(Zl[l]),L.push(Ql[l])):74===l?(x=1-sh(e,c,p),E=1-sh(s,c,p),w=1-sh(s,h,f),_=1-sh(e,c,h),L.push(Zl[l]),L.push(Ql[l])):24===l?(x=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),m=sh(e,h,c),L.push(Zl[l]),L.push(th[l])):146===l?(x=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),m=1-sh(s,c,h),L.push(Zl[l]),L.push(th[l])):6===l?(E=1-sh(e,c,p),b=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),L.push(Ql[l]),L.push($l[l])):164===l?(E=sh(s,p,c),b=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),L.push(Ql[l]),L.push($l[l])):129===l?(v=1-sh(e,p,f),I=sh(s,f,h),_=1-sh(s,c,h),m=1-sh(e,c,h),L.push(th[l]),L.push(eh[l])):41===l?(v=sh(s,f,p),I=1-sh(e,h,f),_=sh(e,h,c),m=sh(s,h,c),L.push(th[l]),L.push(eh[l])):66===l?(b=1-sh(e,p,f),v=1-sh(s,p,f),w=1-sh(s,h,f),_=1-sh(e,c,h),L.push($l[l]),L.push(th[l])):104===l?(b=sh(s,f,p),v=sh(e,f,p),w=sh(e,f,h),_=sh(s,h,c),L.push(th[l]),L.push(ih[l])):144===l?(x=sh(e,p,c),I=sh(e,f,h),w=sh(s,f,h),m=1-sh(s,c,h),L.push(Zl[l]),L.push(nh[l])):26===l?(x=1-sh(s,c,p),I=1-sh(s,h,f),w=1-sh(e,h,f),m=sh(e,h,c),L.push(Zl[l]),L.push(nh[l])):36===l?(E=sh(s,p,c),b=sh(e,f,p),_=sh(e,h,c),m=sh(s,h,c),L.push(Ql[l]),L.push($l[l])):134===l?(E=1-sh(e,c,p),b=1-sh(s,p,f),_=1-sh(s,c,h),m=1-sh(e,c,h),L.push(Ql[l]),L.push($l[l])):9===l?(x=1-sh(e,c,p),E=1-sh(s,c,p),v=sh(s,f,p),I=1-sh(e,h,f),L.push(Zl[l]),L.push(Ql[l])):161===l?(x=sh(s,p,c),E=sh(e,p,c),v=1-sh(e,p,f),I=sh(s,f,h),L.push(Zl[l]),L.push(Ql[l])):37===l?(E=sh(s,p,c),I=1-sh(e,h,f),_=sh(e,h,c),m=sh(s,h,c),L.push(Ql[l]),L.push(eh[l])):133===l?(E=1-sh(e,c,p),I=sh(s,f,h),_=1-sh(s,c,h),m=1-sh(e,c,h),L.push(Ql[l]),L.push(eh[l])):148===l?(b=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),m=1-sh(s,c,h),L.push($l[l]),L.push(nh[l])):22===l?(b=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),m=sh(e,h,c),L.push($l[l]),L.push(nh[l])):82===l?(x=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),w=1-sh(s,h,f),L.push(Zl[l]),L.push(th[l])):88===l?(x=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),w=sh(e,f,h),L.push(Zl[l]),L.push(th[l])):73===l?(x=1-sh(e,c,p),E=1-sh(s,c,p),v=sh(s,f,p),_=1-sh(e,c,h),L.push(Zl[l]),L.push(Ql[l])):97===l?(x=sh(s,p,c),E=sh(e,p,c),v=1-sh(e,p,f),_=sh(s,h,c),L.push(Zl[l]),L.push(Ql[l])):145===l?(x=sh(e,p,c),v=1-sh(e,p,f),I=sh(s,f,h),m=1-sh(s,c,h),L.push(Zl[l]),L.push(eh[l])):25===l?(x=1-sh(s,c,p),v=sh(s,f,p),I=1-sh(e,h,f),m=sh(e,h,c),L.push(Zl[l]),L.push(eh[l])):70===l?(E=1-sh(e,c,p),b=1-sh(s,p,f),w=1-sh(s,h,f),_=1-sh(e,c,h),L.push(Ql[l]),L.push($l[l])):100===l?(E=sh(s,p,c),b=sh(e,f,p),w=sh(e,f,h),_=sh(s,h,c),L.push(Ql[l]),L.push($l[l])):34===l?(m=0===g?(x=1-sh(e,c,p),E=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),_=1-sh(s,c,h),1-sh(e,c,h)):(x=sh(s,p,c),E=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),_=sh(e,h,c),sh(s,h,c)),L.push(Zl[l]),L.push(Ql[l]),L.push(eh[l]),L.push(nh[l])):35===l?(m=4===g?(x=1-sh(e,c,p),E=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),_=1-sh(s,c,h),1-sh(e,c,h)):(x=sh(s,p,c),E=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),_=sh(e,h,c),sh(s,h,c)),L.push(Zl[l]),L.push(Ql[l]),L.push(th[l]),L.push(nh[l])):136===l?(m=0===g?(x=sh(s,p,c),E=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),_=sh(e,h,c),sh(s,h,c)):(x=1-sh(e,c,p),E=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),_=1-sh(s,c,h),1-sh(e,c,h)),L.push(Zl[l]),L.push(Ql[l]),L.push(eh[l]),L.push(nh[l])):153===l?(m=0===g?(x=sh(e,p,c),v=1-sh(e,p,f),I=1-sh(e,h,f),sh(e,h,c)):(x=1-sh(s,c,p),v=sh(s,f,p),I=sh(s,f,h),1-sh(s,c,h)),L.push(Zl[l]),L.push(th[l])):102===l?(_=0===g?(E=1-sh(e,c,p),b=sh(e,f,p),w=sh(e,f,h),1-sh(e,c,h)):(E=sh(s,p,c),b=1-sh(s,p,f),w=1-sh(s,h,f),sh(s,h,c)),L.push(Ql[l]),L.push(nh[l])):155===l?(m=4===g?(x=sh(e,p,c),v=1-sh(e,p,f),I=1-sh(e,h,f),sh(e,h,c)):(x=1-sh(s,c,p),v=sh(s,f,p),I=sh(s,f,h),1-sh(s,c,h)),L.push(Zl[l]),L.push(eh[l])):103===l?(_=4===g?(E=1-sh(e,c,p),b=sh(e,f,p),w=sh(e,f,h),1-sh(e,c,h)):(E=sh(s,p,c),b=1-sh(s,p,f),w=1-sh(s,h,f),sh(s,h,c)),L.push(Ql[l]),L.push($l[l])):152===l?(m=0===g?(x=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),sh(e,h,c)):(x=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),1-sh(s,c,h)),L.push(Zl[l]),L.push($l[l]),L.push(th[l])):156===l?(m=4===g?(x=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),sh(e,h,c)):(x=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),1-sh(s,c,h)),L.push(Zl[l]),L.push(th[l]),L.push(nh[l])):137===l?(m=0===g?(x=sh(s,p,c),E=sh(e,p,c),v=1-sh(e,p,f),I=1-sh(e,h,f),_=sh(e,h,c),sh(s,h,c)):(x=1-sh(e,c,p),E=1-sh(s,c,p),v=sh(s,f,p),I=sh(s,f,h),_=1-sh(s,c,h),1-sh(e,c,h)),L.push(Zl[l]),L.push(Ql[l]),L.push(th[l])):139===l?(m=4===g?(x=sh(s,p,c),E=sh(e,p,c),v=1-sh(e,p,f),I=1-sh(e,h,f),_=sh(e,h,c),sh(s,h,c)):(x=1-sh(e,c,p),E=1-sh(s,c,p),v=sh(s,f,p),I=sh(s,f,h),_=1-sh(s,c,h),1-sh(e,c,h)),L.push(Zl[l]),L.push(Ql[l]),L.push(eh[l])):98===l?(_=0===g?(x=1-sh(e,c,p),E=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),w=sh(e,f,h),1-sh(e,c,h)):(x=sh(s,p,c),E=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),w=1-sh(s,h,f),sh(s,h,c)),L.push(Zl[l]),L.push(Ql[l]),L.push(nh[l])):99===l?(_=4===g?(x=1-sh(e,c,p),E=1-sh(s,c,p),b=sh(s,f,p),v=sh(e,f,p),w=sh(e,f,h),1-sh(e,c,h)):(x=sh(s,p,c),E=sh(e,p,c),b=1-sh(e,p,f),v=1-sh(s,p,f),w=1-sh(s,h,f),sh(s,h,c)),L.push(Zl[l]),L.push(Ql[l]),L.push(th[l])):38===l?(m=0===g?(E=1-sh(e,c,p),b=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),_=1-sh(s,c,h),1-sh(e,c,h)):(E=sh(s,p,c),b=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),_=sh(e,h,c),sh(s,h,c)),L.push(Ql[l]),L.push(eh[l]),L.push(nh[l])):39===l?(m=4===g?(E=1-sh(e,c,p),b=sh(e,f,p),I=sh(e,f,h),w=sh(s,f,h),_=1-sh(s,c,h),1-sh(e,c,h)):(E=sh(s,p,c),b=1-sh(s,p,f),I=1-sh(s,h,f),w=1-sh(e,h,f),_=sh(e,h,c),sh(s,h,c)),L.push(Ql[l]),L.push($l[l]),L.push(nh[l])):85===l&&(_=I=v=E=0,m=w=b=x=1),(_<0||1<_||m<0||1<m||x<0||1<x||b<0||1<b||I<0||1<I||w<0||1<w)&&console.log("MarchingSquaresJS-isoBands: "+l+" "+d+" "+h+","+c+","+p+","+f+" "+g+" "+_+" "+m+" "+x+" "+E+" "+b+" "+v+" "+I+" "+w),o.cells[a][u]={cval:l,cval_real:d,flipped:g,topleft:_,topright:m,righttop:x,rightbottom:E,bottomright:b,bottomleft:v,leftbottom:I,lefttop:w,edges:L}}}}}return o}(t,e,n);return u=fl.polygons?(fl.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),l=[],h=0,c.cells.forEach(function(t,i){t.forEach(function(t,e){if(void 0!==t){var n=oh[t.cval](t);"object"==typeof n&&ah(n)?"object"==typeof n[0]&&ah(n[0])?"object"==typeof n[0][0]&&ah(n[0][0])?n.forEach(function(t){t.forEach(function(t){t[0]+=e,t[1]+=i}),l[h++]=t}):(n.forEach(function(t){t[0]+=e,t[1]+=i}),l[h++]=n):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),l):(fl.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),function(t){for(var e=[],n=t.rows,i=t.cols,r=[],o=0;o<n;o++)for(var s=0;s<i;s++)if(void 0!==t.cells[o][s]&&0<t.cells[o][s].edges.length){var a=t.cells[o][s],u=lh(a),l=null,h=s,c=o;null!==u&&r.push([u.p[0]+h,u.p[1]+c]);do{if(null===(l=hh(t.cells[c][h],u.x,u.y,u.o)))break;if(r.push([l.p[0]+h,l.p[1]+c]),h+=l.x,c+=l.y,u=l,c<0||n<=c||h<0||i<=h||void 0===t.cells[c][h]){h-=l.x,c-=l.y;var p=uh(t,h,c,l.x,l.y,l.o);if(null===p)break;p.path.forEach(function(t){r.push(t)}),h=p.i,c=p.j,u=p}}while(void 0!==t.cells[c][h]&&0<t.cells[c][h].edges.length);e.push(r),r=[],0<t.cells[o][s].edges.length&&s--}return e}(c)),"function"==typeof fl.successCallback&&fl.successCallback(u),u}var gl=64,yl=16,_l=4,ml=1,vl=[],bl=[],xl=[],El=[],wl=[],Il=[],Ll=[],Sl=[],Ml=[],Cl=[],Pl=[],Nl=[],Ol=[],Tl=[],Rl=[],kl=[],Dl=[],Al=[],Fl=[],Gl=[],Bl=[],Ul=[],ql=[],jl=[];Ll[85]=Cl[85]=-1,Sl[85]=Pl[85]=0,Ml[85]=Nl[85]=1,Fl[85]=Ul[85]=1,Gl[85]=ql[85]=0,Bl[85]=jl[85]=1,vl[85]=El[85]=0,bl[85]=wl[85]=-1,xl[85]=Rl[85]=0,kl[85]=Ol[85]=0,Dl[85]=Tl[85]=1,Il[85]=Al[85]=1,Ul[1]=Ul[169]=0,ql[1]=ql[169]=-1,jl[1]=jl[169]=0,Ol[1]=Ol[169]=-1,Tl[1]=Tl[169]=0,Rl[1]=Rl[169]=0,Cl[4]=Cl[166]=0,Pl[4]=Pl[166]=-1,Nl[4]=Nl[166]=1,kl[4]=kl[166]=1,Dl[4]=Dl[166]=0,Al[4]=Al[166]=0,Ll[16]=Ll[154]=0,Sl[16]=Sl[154]=1,Ml[16]=Ml[154]=1,El[16]=El[154]=1,wl[16]=wl[154]=0,Il[16]=Il[154]=1,Fl[64]=Fl[106]=0,Gl[64]=Gl[106]=1,Bl[64]=Bl[106]=0,vl[64]=vl[106]=-1,bl[64]=bl[106]=0,xl[64]=xl[106]=1,Fl[2]=Fl[168]=0,Gl[2]=Gl[168]=-1,Bl[2]=Bl[168]=1,Ul[2]=Ul[168]=0,ql[2]=ql[168]=-1,jl[2]=jl[168]=0,Ol[2]=Ol[168]=-1,Tl[2]=Tl[168]=0,Rl[2]=Rl[168]=0,kl[2]=kl[168]=-1,Dl[2]=Dl[168]=0,Al[2]=Al[168]=1,Ll[8]=Ll[162]=0,Sl[8]=Sl[162]=-1,Ml[8]=Ml[162]=0,Cl[8]=Cl[162]=0,Pl[8]=Pl[162]=-1,Nl[8]=Nl[162]=1,Ol[8]=Ol[162]=1,Tl[8]=Tl[162]=0,Rl[8]=Rl[162]=1,kl[8]=kl[162]=1,Dl[8]=Dl[162]=0,Al[8]=Al[162]=0,Ll[32]=Ll[138]=0,Sl[32]=Sl[138]=1,Ml[32]=Ml[138]=1,Cl[32]=Cl[138]=0,Pl[32]=Pl[138]=1,Nl[32]=Nl[138]=0,vl[32]=vl[138]=1,bl[32]=bl[138]=0,xl[32]=xl[138]=0,El[32]=El[138]=1,wl[32]=wl[138]=0,Il[32]=Il[138]=1,Ul[128]=Ul[42]=0,ql[128]=ql[42]=1,jl[128]=jl[42]=1,Fl[128]=Fl[42]=0,Gl[128]=Gl[42]=1,Bl[128]=Bl[42]=0,vl[128]=vl[42]=-1,bl[128]=bl[42]=0,xl[128]=xl[42]=1,El[128]=El[42]=-1,wl[128]=wl[42]=0,Il[128]=Il[42]=0,Cl[5]=Cl[165]=-1,Pl[5]=Pl[165]=0,Nl[5]=Nl[165]=0,Ul[5]=Ul[165]=1,ql[5]=ql[165]=0,jl[5]=jl[165]=0,kl[20]=kl[150]=0,Dl[20]=Dl[150]=1,Al[20]=Al[150]=1,El[20]=El[150]=0,wl[20]=wl[150]=-1,Il[20]=Il[150]=1,Ll[80]=Ll[90]=-1,Sl[80]=Sl[90]=0,Ml[80]=Ml[90]=1,Fl[80]=Fl[90]=1,Gl[80]=Gl[90]=0,Bl[80]=Bl[90]=1,Ol[65]=Ol[105]=0,Tl[65]=Tl[105]=1,Rl[65]=Rl[105]=0,vl[65]=vl[105]=0,bl[65]=bl[105]=-1,xl[65]=xl[105]=0,Ll[160]=Ll[10]=-1,Sl[160]=Sl[10]=0,Ml[160]=Ml[10]=1,Cl[160]=Cl[10]=-1,Pl[160]=Pl[10]=0,Nl[160]=Nl[10]=0,Ul[160]=Ul[10]=1,ql[160]=ql[10]=0,jl[160]=jl[10]=0,Fl[160]=Fl[10]=1,Gl[160]=Gl[10]=0,Bl[160]=Bl[10]=1,kl[130]=kl[40]=0,Dl[130]=Dl[40]=1,Al[130]=Al[40]=1,Ol[130]=Ol[40]=0,Tl[130]=Tl[40]=1,Rl[130]=Rl[40]=0,vl[130]=vl[40]=0,bl[130]=bl[40]=-1,xl[130]=xl[40]=0,El[130]=El[40]=0,wl[130]=wl[40]=-1,Il[130]=Il[40]=1,Cl[37]=Cl[133]=0,Pl[37]=Pl[133]=1,Nl[37]=Nl[133]=1,Ul[37]=Ul[133]=0,ql[37]=ql[133]=1,jl[37]=jl[133]=0,vl[37]=vl[133]=-1,bl[37]=bl[133]=0,xl[37]=xl[133]=0,El[37]=El[133]=1,wl[37]=wl[133]=0,Il[37]=Il[133]=0,kl[148]=kl[22]=-1,Dl[148]=Dl[22]=0,Al[148]=Al[22]=0,Ul[148]=Ul[22]=0,ql[148]=ql[22]=-1,jl[148]=jl[22]=1,Fl[148]=Fl[22]=0,Gl[148]=Gl[22]=1,Bl[148]=Bl[22]=1,El[148]=El[22]=-1,wl[148]=wl[22]=0,Il[148]=Il[22]=1,Ll[82]=Ll[88]=0,Sl[82]=Sl[88]=-1,Ml[82]=Ml[88]=1,kl[82]=kl[88]=1,Dl[82]=Dl[88]=0,Al[82]=Al[88]=1,Ol[82]=Ol[88]=-1,Tl[82]=Tl[88]=0,Rl[82]=Rl[88]=1,Fl[82]=Fl[88]=0,Gl[82]=Gl[88]=-1,Bl[82]=Bl[88]=0,Ll[73]=Ll[97]=0,Sl[73]=Sl[97]=1,Ml[73]=Ml[97]=0,Cl[73]=Cl[97]=0,Pl[73]=Pl[97]=-1,Nl[73]=Nl[97]=0,Ol[73]=Ol[97]=1,Tl[73]=Tl[97]=0,Rl[73]=Rl[97]=0,vl[73]=vl[97]=1,bl[73]=bl[97]=0,xl[73]=xl[97]=1,Ll[145]=Ll[25]=0,Sl[145]=Sl[25]=-1,Ml[145]=Ml[25]=0,Ol[145]=Ol[25]=1,Tl[145]=Tl[25]=0,Rl[145]=Rl[25]=1,Ul[145]=Ul[25]=0,ql[145]=ql[25]=1,jl[145]=jl[25]=1,El[145]=El[25]=-1,wl[145]=wl[25]=0,Il[145]=Il[25]=0,Cl[70]=Cl[100]=0,Pl[70]=Pl[100]=1,Nl[70]=Nl[100]=0,kl[70]=kl[100]=-1,Dl[70]=Dl[100]=0,Al[70]=Al[100]=1,Fl[70]=Fl[100]=0,Gl[70]=Gl[100]=-1,Bl[70]=Bl[100]=1,vl[70]=vl[100]=1,bl[70]=bl[100]=0,xl[70]=xl[100]=0,Cl[101]=Cl[69]=0,Pl[101]=Pl[69]=1,Nl[101]=Nl[69]=0,vl[101]=vl[69]=1,bl[101]=bl[69]=0,xl[101]=xl[69]=0,Ul[149]=Ul[21]=0,ql[149]=ql[21]=1,jl[149]=jl[21]=1,El[149]=El[21]=-1,wl[149]=wl[21]=0,Il[149]=Il[21]=0,kl[86]=kl[84]=-1,Dl[86]=Dl[84]=0,Al[86]=Al[84]=1,Fl[86]=Fl[84]=0,Gl[86]=Gl[84]=-1,Bl[86]=Bl[84]=1,Ll[89]=Ll[81]=0,Sl[89]=Sl[81]=-1,Ml[89]=Ml[81]=0,Ol[89]=Ol[81]=1,Tl[89]=Tl[81]=0,Rl[89]=Rl[81]=1,Ll[96]=Ll[74]=0,Sl[96]=Sl[74]=1,Ml[96]=Ml[74]=0,Cl[96]=Cl[74]=-1,Pl[96]=Pl[74]=0,Nl[96]=Nl[74]=1,Fl[96]=Fl[74]=1,Gl[96]=Gl[74]=0,Bl[96]=Bl[74]=0,vl[96]=vl[74]=1,bl[96]=bl[74]=0,xl[96]=xl[74]=1,Ll[24]=Ll[146]=0,Sl[24]=Sl[146]=-1,Ml[24]=Ml[146]=1,kl[24]=kl[146]=1,Dl[24]=Dl[146]=0,Al[24]=Al[146]=1,Ol[24]=Ol[146]=0,Tl[24]=Tl[146]=1,Rl[24]=Rl[146]=1,El[24]=El[146]=0,wl[24]=wl[146]=-1,Il[24]=Il[146]=0,Cl[6]=Cl[164]=-1,Pl[6]=Pl[164]=0,Nl[6]=Nl[164]=1,kl[6]=kl[164]=-1,Dl[6]=Dl[164]=0,Al[6]=Al[164]=0,Ul[6]=Ul[164]=0,ql[6]=ql[164]=-1,jl[6]=jl[164]=1,Fl[6]=Fl[164]=1,Gl[6]=Gl[164]=0,Bl[6]=Bl[164]=0,Ol[129]=Ol[41]=0,Tl[129]=Tl[41]=1,Rl[129]=Rl[41]=1,Ul[129]=Ul[41]=0,ql[129]=ql[41]=1,jl[129]=jl[41]=0,vl[129]=vl[41]=-1,bl[129]=bl[41]=0,xl[129]=xl[41]=0,El[129]=El[41]=0,wl[129]=wl[41]=-1,Il[129]=Il[41]=0,kl[66]=kl[104]=0,Dl[66]=Dl[104]=1,Al[66]=Al[104]=0,Ol[66]=Ol[104]=-1,Tl[66]=Tl[104]=0,Rl[66]=Rl[104]=1,Fl[66]=Fl[104]=0,Gl[66]=Gl[104]=-1,Bl[66]=Bl[104]=0,vl[66]=vl[104]=0,bl[66]=bl[104]=-1,xl[66]=xl[104]=1,Ll[144]=Ll[26]=-1,Sl[144]=Sl[26]=0,Ml[144]=Ml[26]=0,Ul[144]=Ul[26]=1,ql[144]=ql[26]=0,jl[144]=jl[26]=1,Fl[144]=Fl[26]=0,Gl[144]=Gl[26]=1,Bl[144]=Bl[26]=1,El[144]=El[26]=-1,wl[144]=wl[26]=0,Il[144]=Il[26]=1,Cl[36]=Cl[134]=0,Pl[36]=Pl[134]=1,Nl[36]=Nl[134]=1,kl[36]=kl[134]=0,Dl[36]=Dl[134]=1,Al[36]=Al[134]=0,vl[36]=vl[134]=0,bl[36]=bl[134]=-1,xl[36]=xl[134]=1,El[36]=El[134]=1,wl[36]=wl[134]=0,Il[36]=Il[134]=0,Ll[9]=Ll[161]=-1,Sl[9]=Sl[161]=0,Ml[9]=Ml[161]=0,Cl[9]=Cl[161]=0,Pl[9]=Pl[161]=-1,Nl[9]=Nl[161]=0,Ol[9]=Ol[161]=1,Tl[9]=Tl[161]=0,Rl[9]=Rl[161]=0,Ul[9]=Ul[161]=1,ql[9]=ql[161]=0,jl[9]=jl[161]=1,Ll[136]=0,Sl[136]=1,Ml[136]=1,Cl[136]=0,Pl[136]=1,Nl[136]=0,kl[136]=-1,Dl[136]=0,Al[136]=1,Ol[136]=-1,Tl[136]=0,Rl[136]=0,Ul[136]=0,ql[136]=-1,jl[136]=0,Fl[136]=0,Gl[136]=-1,Bl[136]=1,vl[136]=1,bl[136]=0,xl[136]=0,El[136]=1,wl[136]=0,Il[136]=1,Ll[34]=0,Sl[34]=-1,Ml[34]=0,Cl[34]=0,Pl[34]=-1,Nl[34]=1,kl[34]=1,Dl[34]=0,Al[34]=0,Ol[34]=1,Tl[34]=0,Rl[34]=1,Ul[34]=0,ql[34]=1,jl[34]=1,Fl[34]=0,Gl[34]=1,Bl[34]=0,vl[34]=-1,bl[34]=0,xl[34]=1,El[34]=-1,wl[34]=0,Il[34]=0,Ll[35]=0,Sl[35]=1,Ml[35]=1,Cl[35]=0,Pl[35]=-1,Nl[35]=1,kl[35]=1,Dl[35]=0,Al[35]=0,Ol[35]=-1,Tl[35]=0,Rl[35]=0,Ul[35]=0,ql[35]=-1,jl[35]=0,Fl[35]=0,Gl[35]=1,Bl[35]=0,vl[35]=-1,bl[35]=0,xl[35]=1,El[35]=1,wl[35]=0,Il[35]=1,Ll[153]=0,Sl[153]=1,Ml[153]=1,Ol[153]=-1,Tl[153]=0,Rl[153]=0,Ul[153]=0,ql[153]=-1,jl[153]=0,El[153]=1,wl[153]=0,Il[153]=1,Cl[102]=0,Pl[102]=-1,Nl[102]=1,kl[102]=1,Dl[102]=0,Al[102]=0,Fl[102]=0,Gl[102]=1,Bl[102]=0,vl[102]=-1,bl[102]=0,xl[102]=1,Ll[155]=0,Sl[155]=-1,Ml[155]=0,Ol[155]=1,Tl[155]=0,Rl[155]=1,Ul[155]=0,ql[155]=1,jl[155]=1,El[155]=-1,wl[155]=0,Il[155]=0,Cl[103]=0,Pl[103]=1,Nl[103]=0,kl[103]=-1,Dl[103]=0,Al[103]=1,Fl[103]=0,Gl[103]=-1,Bl[103]=1,vl[103]=1,bl[103]=0,xl[103]=0,Ll[152]=0,Sl[152]=1,Ml[152]=1,kl[152]=-1,Dl[152]=0,Al[152]=1,Ol[152]=-1,Tl[152]=0,Rl[152]=0,Ul[152]=0,ql[152]=-1,jl[152]=0,Fl[152]=0,Gl[152]=-1,Bl[152]=1,El[152]=1,wl[152]=0,Il[152]=1,Ll[156]=0,Sl[156]=-1,Ml[156]=1,kl[156]=1,Dl[156]=0,Al[156]=1,Ol[156]=-1,Tl[156]=0,Rl[156]=0,Ul[156]=0,ql[156]=-1,jl[156]=0,Fl[156]=0,Gl[156]=1,Bl[156]=1,El[156]=-1,wl[156]=0,Il[156]=1,Ll[137]=0,Sl[137]=1,Ml[137]=1,Cl[137]=0,Pl[137]=1,Nl[137]=0,Ol[137]=-1,Tl[137]=0,Rl[137]=0,Ul[137]=0,ql[137]=-1,jl[137]=0,vl[137]=1,bl[137]=0,xl[137]=0,El[137]=1,wl[137]=0,Il[137]=1,Ll[139]=0,Sl[139]=1,Ml[139]=1,Cl[139]=0,Pl[139]=-1,Nl[139]=0,Ol[139]=1,Tl[139]=0,Rl[139]=0,Ul[139]=0,ql[139]=1,jl[139]=0,vl[139]=-1,bl[139]=0,xl[139]=0,El[139]=1,wl[139]=0,Il[139]=1,Ll[98]=0,Sl[98]=-1,Ml[98]=0,Cl[98]=0,Pl[98]=-1,Nl[98]=1,kl[98]=1,Dl[98]=0,Al[98]=0,Ol[98]=1,Tl[98]=0,Rl[98]=1,Fl[98]=0,Gl[98]=1,Bl[98]=0,vl[98]=-1,bl[98]=0,xl[98]=1,Ll[99]=0,Sl[99]=1,Ml[99]=0,Cl[99]=0,Pl[99]=-1,Nl[99]=1,kl[99]=1,Dl[99]=0,Al[99]=0,Ol[99]=-1,Tl[99]=0,Rl[99]=1,Fl[99]=0,Gl[99]=-1,Bl[99]=0,vl[99]=1,bl[99]=0,xl[99]=1,Cl[38]=0,Pl[38]=-1,Nl[38]=1,kl[38]=1,Dl[38]=0,Al[38]=0,Ul[38]=0,ql[38]=1,jl[38]=1,Fl[38]=0,Gl[38]=1,Bl[38]=0,vl[38]=-1,bl[38]=0,xl[38]=1,El[38]=-1,wl[38]=0,Il[38]=0,Cl[39]=0,Pl[39]=1,Nl[39]=1,kl[39]=-1,Dl[39]=0,Al[39]=0,Ul[39]=0,ql[39]=-1,jl[39]=1,Fl[39]=0,Gl[39]=1,Bl[39]=0,vl[39]=-1,bl[39]=0,xl[39]=1,El[39]=1,wl[39]=0,Il[39]=0;var zl=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},Vl=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},Yl=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},Hl=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},Xl=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},Wl=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},Jl=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},Kl=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},Zl=[],Ql=[],$l=[],th=[],eh=[],nh=[],ih=[],rh=[];th[1]=eh[1]=18,th[169]=eh[169]=18,$l[4]=Ql[4]=12,$l[166]=Ql[166]=12,Zl[16]=rh[16]=4,Zl[154]=rh[154]=4,nh[64]=ih[64]=22,nh[106]=ih[106]=22,$l[2]=nh[2]=17,th[2]=eh[2]=18,$l[168]=nh[168]=17,th[168]=eh[168]=18,Zl[8]=th[8]=9,Ql[8]=$l[8]=12,Zl[162]=th[162]=9,Ql[162]=$l[162]=12,Zl[32]=rh[32]=4,Ql[32]=ih[32]=1,Zl[138]=rh[138]=4,Ql[138]=ih[138]=1,eh[128]=rh[128]=21,nh[128]=ih[128]=22,eh[42]=rh[42]=21,nh[42]=ih[42]=22,Ql[5]=eh[5]=14,Ql[165]=eh[165]=14,$l[20]=rh[20]=6,$l[150]=rh[150]=6,Zl[80]=nh[80]=11,Zl[90]=nh[90]=11,th[65]=ih[65]=3,th[105]=ih[105]=3,Zl[160]=nh[160]=11,Ql[160]=eh[160]=14,Zl[10]=nh[10]=11,Ql[10]=eh[10]=14,$l[130]=rh[130]=6,th[130]=ih[130]=3,$l[40]=rh[40]=6,th[40]=ih[40]=3,Ql[101]=ih[101]=1,Ql[69]=ih[69]=1,eh[149]=rh[149]=21,eh[21]=rh[21]=21,$l[86]=nh[86]=17,$l[84]=nh[84]=17,Zl[89]=th[89]=9,Zl[81]=th[81]=9,Zl[96]=ih[96]=0,Ql[96]=nh[96]=15,Zl[74]=ih[74]=0,Ql[74]=nh[74]=15,Zl[24]=$l[24]=8,th[24]=rh[24]=7,Zl[146]=$l[146]=8,th[146]=rh[146]=7,Ql[6]=nh[6]=15,$l[6]=eh[6]=16,Ql[164]=nh[164]=15,$l[164]=eh[164]=16,th[129]=rh[129]=7,eh[129]=ih[129]=20,th[41]=rh[41]=7,eh[41]=ih[41]=20,$l[66]=ih[66]=2,th[66]=nh[66]=19,$l[104]=ih[104]=2,th[104]=nh[104]=19,Zl[144]=eh[144]=10,nh[144]=rh[144]=23,Zl[26]=eh[26]=10,nh[26]=rh[26]=23,Ql[36]=rh[36]=5,$l[36]=ih[36]=2,Ql[134]=rh[134]=5,$l[134]=ih[134]=2,Zl[9]=eh[9]=10,Ql[9]=th[9]=13,Zl[161]=eh[161]=10,Ql[161]=th[161]=13,Ql[37]=rh[37]=5,eh[37]=ih[37]=20,Ql[133]=rh[133]=5,eh[133]=ih[133]=20,$l[148]=eh[148]=16,nh[148]=rh[148]=23,$l[22]=eh[22]=16,nh[22]=rh[22]=23,Zl[82]=$l[82]=8,th[82]=nh[82]=19,Zl[88]=$l[88]=8,th[88]=nh[88]=19,Zl[73]=ih[73]=0,Ql[73]=th[73]=13,Zl[97]=ih[97]=0,Ql[97]=th[97]=13,Zl[145]=th[145]=9,eh[145]=rh[145]=21,Zl[25]=th[25]=9,eh[25]=rh[25]=21,Ql[70]=ih[70]=1,$l[70]=nh[70]=17,Ql[100]=ih[100]=1,$l[100]=nh[100]=17,Zl[34]=th[34]=9,Ql[34]=$l[34]=12,eh[34]=rh[34]=21,nh[34]=ih[34]=22,Zl[136]=rh[136]=4,Ql[136]=ih[136]=1,$l[136]=nh[136]=17,th[136]=eh[136]=18,Zl[35]=rh[35]=4,Ql[35]=$l[35]=12,th[35]=eh[35]=18,nh[35]=ih[35]=22,Zl[153]=rh[153]=4,th[153]=eh[153]=18,Ql[102]=$l[102]=12,nh[102]=ih[102]=22,Zl[155]=th[155]=9,eh[155]=rh[155]=23,Ql[103]=ih[103]=1,$l[103]=nh[103]=17,Zl[152]=rh[152]=4,$l[152]=nh[152]=17,th[152]=eh[152]=18,Zl[156]=$l[156]=8,th[156]=eh[156]=18,nh[156]=rh[156]=23,Zl[137]=rh[137]=4,Ql[137]=ih[137]=1,th[137]=eh[137]=18,Zl[139]=rh[139]=4,Ql[139]=th[139]=13,eh[139]=ih[139]=20,Zl[98]=th[98]=9,Ql[98]=$l[98]=12,nh[98]=ih[98]=22,Zl[99]=ih[99]=0,Ql[99]=$l[99]=12,th[99]=nh[99]=19,Ql[38]=$l[38]=12,eh[38]=rh[38]=21,nh[38]=ih[38]=22,Ql[39]=rh[39]=5,$l[39]=eh[39]=16,nh[39]=ih[39]=22;var oh=[];function sh(t,e,n){return(t-e)/(n-e)}function ah(t){return-1<t.constructor.toString().indexOf("Array")}function uh(t,e,n,i,r,o){for(var s=t.cells[n][e],a=s.cval_real,u=e+i,l=n+r,h=[],c=!1;!c;){if(void 0===t.cells[l]||void 0===t.cells[l][u])if(l-=r,u-=i,a=(s=t.cells[l][u]).cval_real,-1===r)if(0===o)if(a&ml)h.push([u,l]),i=-1,o=r=0;else{if(!(a&_l)){h.push([u+s.bottomright,l]),o=r=1,c=!(i=0);break}h.push([u+1,l]),i=1,o=r=0}else{if(!(a&ml)){if(a&_l){h.push([u+s.bottomright,l]),o=r=1,c=!(i=0);break}h.push([u+s.bottomleft,l]),r=1,c=!(o=i=0);break}h.push([u,l]),i=-1,o=r=0}else if(1===r)if(0===o){if(!(a&yl)){if(a&gl){h.push([u+s.topleft,l+1]),r=-1,c=!(o=i=0);break}h.push([u+s.topright,l+1]),r=-1,o=1,c=!(i=0);break}h.push([u+1,l+1]),r=0,o=i=1}else o=i=(h.push([u+1,l+1]),r=0,1);else if(-1===i)if(0===o){if(!(a&gl)){if(a&ml){h.push([u,l+s.leftbottom]),i=1,c=!(o=r=0);break}h.push([u,l+s.lefttop]),o=i=1,c=!(r=0);break}h.push([u,l+1]),r=1,o=i=0}else{if(!(a&gl)){console.log("MarchingSquaresJS-isoBands: wtf");break}h.push([u,l+1]),r=1,o=i=0}else{if(1!==i){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===o){if(!(a&_l)){h.push([u+1,l+s.rightbottom]),i=-1,c=!(o=r=0);break}h.push([u+1,l]),i=0,r=-1,o=1}else{if(!(a&_l)){if(a&yl){h.push([u+1,l+s.righttop]),i=-1,r=0,o=1;break}h.push([u+1,l+s.rightbottom]),i=-1,c=!(o=r=0);break}h.push([u+1,l]),i=0,r=-1,o=1}}else if(a=(s=t.cells[l][u]).cval_real,-1===i)if(0===o)if(void 0!==t.cells[l-1]&&void 0!==t.cells[l-1][u])i=0,r=-1,o=1;else{if(!(a&ml)){h.push([u+s.bottomright,l]),o=r=1,c=!(i=0);break}h.push([u,l])}else{if(!(a&gl)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+u+","+l);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===i){if(0===o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l+1]&&void 0!==t.cells[l+1][u])r=1,o=i=0;else{if(!(a&yl)){h.push([u+s.topleft,l+1]),r=-1,c=!(o=i=0);break}h.push([u+1,l+1]),r=0,o=i=1}}else if(-1===r){if(1!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l][u+1])r=0,o=i=1;else{if(!(a&_l)){h.push([u+1,l+s.righttop]),i=-1,o=1,c=!(r=0);break}h.push([u+1,l]),i=0,r=-1,o=1}}else{if(1!==r){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l][u-1])i=-1,o=r=0;else{if(!(a&gl)){h.push([u,l+s.leftbottom]),i=1,c=!(o=r=0);break}h.push([u,l+1]),r=1,o=i=0}}if(l+=r,(u+=i)===e&&l===n)break}return{path:h,i:u,j:l,x:i,y:r,o:o}}function lh(t){if(0<t.edges.length){var e=t.edges[t.edges.length-1],n=t.cval_real;switch(e){case 0:return n&yl?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 1:return n&_l?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 2:return n&_l?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 3:return n&ml?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 4:return n&yl?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 5:return n&_l?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 6:return n&_l?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 7:return n&ml?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 8:return n&_l?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.righttop],x:-1,y:0,o:1};case 9:return n&ml?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 10:return n&ml?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.righttop],x:-1,y:0,o:1};case 11:return n&gl?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 12:return n&_l?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 13:return n&ml?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 14:return n&ml?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 15:return n&gl?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 16:return n&_l?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 17:return n&gl?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 18:return n&ml?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 19:return n&gl?{p:[t.bottomleft,0],x:0,y:1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 20:return n&gl?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 21:return n&yl?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.topright,1],x:0,y:-1,o:1};case 22:return n&gl?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 23:return n&yl?{p:[0,t.lefttop],x:1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t)}}return null}function hh(t,e,n,i){var r,o,s,a,u,l=t.cval;switch(e){case-1:switch(i){case 0:r=Ql[l],s=Cl[l],a=Pl[l],u=Nl[l];break;default:r=Zl[l],s=Ll[l],a=Sl[l],u=Ml[l]}break;case 1:switch(i){case 0:r=eh[l],s=Ul[l],a=ql[l],u=jl[l];break;default:r=nh[l],s=Fl[l],a=Gl[l],u=Bl[l]}break;default:switch(n){case-1:switch(i){case 0:r=ih[l],s=vl[l],a=bl[l],u=xl[l];break;default:r=rh[l],s=El[l],a=wl[l],u=Il[l]}break;case 1:switch(i){case 0:r=th[l],s=Ol[l],a=Tl[l],u=Rl[l];break;default:r=$l[l],s=kl[l],a=Dl[l],u=Al[l]}}}if(o=t.edges.indexOf(r),void 0===t.edges[o])return null;switch(function(t,e){delete t.edges[e];for(var n=e+1;n<t.edges.length;n++)t.edges[n-1]=t.edges[n];t.edges.pop()}(t,o),l=t.cval_real,r){case 0:n=l&yl?(e=t.topleft,1):(e=1,t.righttop);break;case 1:n=l&_l?(e=1,t.rightbottom):(e=t.topleft,1);break;case 2:n=l&_l?(e=t.topleft,1):(e=t.bottomright,0);break;case 3:n=l&ml?(e=t.bottomleft,0):(e=t.topleft,1);break;case 4:n=l&yl?(e=t.topright,1):(e=1,t.righttop);break;case 5:n=l&_l?(e=1,t.rightbottom):(e=t.topright,1);break;case 6:n=l&_l?(e=t.topright,1):(e=t.bottomright,0);break;case 7:n=l&ml?(e=t.bottomleft,0):(e=t.topright,1);break;case 8:n=l&_l?(e=1,t.righttop):(e=t.bottomright,0);break;case 9:n=l&ml?(e=t.bottomleft,0):(e=1,t.righttop);break;case 10:n=l&ml?(e=1,t.righttop):(e=0,t.leftbottom);break;case 11:n=l&gl?(e=0,t.lefttop):(e=1,t.righttop);break;case 12:n=l&_l?(e=1,t.rightbottom):(e=t.bottomright,0);break;case 13:n=l&ml?(e=t.bottomleft,0):(e=1,t.rightbottom);break;case 14:n=l&ml?(e=1,t.rightbottom):(e=0,t.leftbottom);break;case 15:n=l&gl?(e=0,t.lefttop):(e=1,t.rightbottom);break;case 16:n=l&_l?(e=0,t.leftbottom):(e=t.bottomright,0);break;case 17:n=l&gl?(e=0,t.lefttop):(e=t.bottomright,0);break;case 18:n=l&ml?(e=t.bottomleft,0):(e=0,t.leftbottom);break;case 19:n=l&gl?(e=0,t.lefttop):(e=t.bottomleft,0);break;case 20:n=l&gl?(e=0,t.leftbottom):(e=t.topleft,1);break;case 21:n=l&yl?(e=t.topright,1):(e=0,t.leftbottom);break;case 22:n=l&gl?(e=0,t.lefttop):(e=t.topleft,1);break;case 23:n=l&yl?(e=t.topright,1):(e=0,t.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t),null}return void 0!==e&&void 0!==n&&void 0!==s&&void 0!==a&&void 0!==u||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(t),console.log(e+" "+n+" "+s+" "+a+" "+u)),{p:[e,n],x:s,y:a,o:u}}function ch(t){var n=[],i=[];t.forEach(function(t){var e=au(nr([t]));i.push(e),n.push({ring:t,area:e})}),i.sort(function(t,e){return e-t});var r=[];return i.forEach(function(t){for(var e=0;e<n.length;e++)if(n[e].area===t){r.push(n[e].ring),n.splice(e,1);break}}),r}function ph(t){for(var e=t.map(function(t){return{lrCoordinates:t,grouped:!1}}),n=[];!dh(e);)for(var i=0;i<e.length;i++)if(!e[i].grouped){var r=[];r.push(e[i].lrCoordinates),e[i].grouped=!0;for(var o=nr([e[i].lrCoordinates]),s=i+1;s<e.length;s++){if(!e[s].grouped)fh(nr([e[s].lrCoordinates]),o)&&(r.push(e[s].lrCoordinates),e[s].grouped=!0)}n.push(r)}return n}function fh(t,e){for(var n=Qs(t),i=0;i<n.features.length;i++)if(!ts(n.features[i],e))return!1;return!0}function dh(t){for(var e=0;e<t.length;e++)if(!1===t[e].grouped)return!1;return!0}function gh(t,r,e){if(!xr(e=e||{}))throw new Error("options is invalid");var o=e.pivot,n=e.mutate;if(!t)throw new Error("geojson is required");if(null==r||isNaN(r))throw new Error("angle is required");return 0===r||(o||(o=Zs(t)),!1!==n&&void 0!==n||(t=us(t)),Lr(t,function(t){var e=Wa(o,t)+r,n=Ka(o,t),i=zr(rl(o,n,e));t[0]=i[0],t[1]=i[1]})),t}function yh(n,i,t){if(!xr(t=t||{}))throw new Error("options is invalid");var r=t.origin,e=t.mutate;if(!n)throw new Error("geojson required");if("number"!=typeof i||0===i)throw new Error("invalid factor");var o=Array.isArray(r)||"object"==typeof r;return!0!==e&&(n=us(n)),"FeatureCollection"!==n.type||o?_h(n,i,r):(Pr(n,function(t,e){n.features[e]=_h(t,i,r)}),n)}function _h(t,r,o){var e="Point"===Kr(t);return o=function(t,e){null==e&&(e="centroid");if(Array.isArray(e)||"object"==typeof e)return jr(e);var n=t.bbox?t.bbox:qr(t),i=n[0],r=n[1],o=n[2],s=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return tr([i,r]);case"se":case"southeast":case"eastsouth":case"bottomright":return tr([o,r]);case"nw":case"northwest":case"westnorth":case"topleft":return tr([i,s]);case"ne":case"northeast":case"eastnorth":case"topright":return tr([o,s]);case"center":return Ks(t);case void 0:case null:case"centroid":return Zs(t);default:throw new Error("invalid origin")}}(t,o),1===r||e||Lr(t,function(t){var e=Ka(o,t),n=Wa(o,t),i=zr(rl(o,e*r,n));t[0]=i[0],t[1]=i[1],3===t.length&&(t[2]*=r)}),t}function mh(t){var e=t[0],n=t[1];return[n[0]-e[0],n[1]-e[1]]}function vh(t,e){return t[0]*e[1]-e[0]*t[1]}function bh(t,e){return n=e,0!==vh(mh(t),mh(n))&&(r=e,c=(i=t)[0],p=mh(i),f=r[0],d=mh(r),g=vh(p,d),y=vh((s=c,[(o=f)[0]-s[0],o[1]-s[1]]),d),a=c,u=[(l=y/g)*(h=p)[0],l*h[1]],[a[0]+u[0],a[1]+u[1]]);var n,i,r,o,s,a,u,l,h,c,p,f,d,g,y}function xh(t,e,n){var f=[],d=dr(e,n),g=zr(t),y=[];return g.forEach(function(t,e){if(e!==g.length-1){var n=(o=t,s=g[e+1],a=d,u=Math.sqrt((o[0]-s[0])*(o[0]-s[0])+(o[1]-s[1])*(o[1]-s[1])),l=o[0]+a*(s[1]-o[1])/u,h=s[0]+a*(s[1]-o[1])/u,c=o[1]+a*(o[0]-s[0])/u,p=s[1]+a*(o[0]-s[0])/u,[[l,c],[h,p]]);if(f.push(n),0<e){var i=f[e-1],r=bh(n,i);!1!==r&&(i[1]=r,n[0]=r),y.push(i[0]),e===g.length-2&&(y.push(n[0]),y.push(n[1]))}2===g.length&&(y.push(n[0]),y.push(n[1]))}var o,s,a,u,l,h,c,p}),rr(y,t.properties)}function Eh(t,e,n){var i=e[0]-t[0],r=e[1]-t[1],o=n[0]-e[0],s=n[1]-e[1];return Math.sign(i*s-o*r)}function wh(e,t){return t.geometry.coordinates[0].every(function(t){return ts(tr(t),e)})}oh[1]=oh[169]=zl,oh[4]=oh[166]=Vl,oh[16]=oh[154]=Yl,oh[64]=oh[106]=Hl,oh[168]=oh[2]=Xl,oh[162]=oh[8]=Wl,oh[138]=oh[32]=Jl,oh[42]=oh[128]=Kl,oh[5]=oh[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},oh[20]=oh[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},oh[80]=oh[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},oh[65]=oh[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},oh[160]=oh[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},oh[130]=oh[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},oh[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},oh[101]=oh[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},oh[149]=oh[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},oh[86]=oh[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},oh[89]=oh[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},oh[96]=oh[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},oh[24]=oh[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},oh[6]=oh[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},oh[129]=oh[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},oh[66]=oh[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},oh[144]=oh[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},oh[36]=oh[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},oh[9]=oh[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},oh[37]=oh[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},oh[148]=oh[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},oh[82]=oh[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},oh[73]=oh[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},oh[145]=oh[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},oh[70]=oh[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},oh[34]=function(t){return[Kl(t),Wl(t)]},oh[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},oh[136]=function(t){return[Jl(t),Xl(t)]},oh[153]=function(t){return[Yl(t),zl(t)]},oh[102]=function(t){return[Vl(t),Hl(t)]},oh[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},oh[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},oh[152]=function(t){return[Yl(t),Xl(t)]},oh[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},oh[137]=function(t){return[Jl(t),zl(t)]},oh[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},oh[98]=function(t){return[Wl(t),Hl(t)]},oh[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},oh[38]=function(t){return[Vl(t),Kl(t)]},oh[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};var Ih=function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1};Ih.buildId=function(t){return t.join(",")},Ih.prototype.removeInnerEdge=function(e){this.innerEdges=this.innerEdges.filter(function(t){return t.from.id!==e.from.id})},Ih.prototype.removeOuterEdge=function(e){this.outerEdges=this.outerEdges.filter(function(t){return t.to.id!==e.to.id})},Ih.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},Ih.prototype.sortOuterEdges=function(){var o=this;this.outerEdgesSorted||(this.outerEdges.sort(function(t,e){var n=t.to,i=e.to;if(0<=n.coordinates[0]-o.coordinates[0]&&i.coordinates[0]-o.coordinates[0]<0)return 1;if(n.coordinates[0]-o.coordinates[0]<0&&0<=i.coordinates[0]-o.coordinates[0])return-1;if(n.coordinates[0]-o.coordinates[0]==0&&i.coordinates[0]-o.coordinates[0]==0)return 0<=n.coordinates[1]-o.coordinates[1]||0<=i.coordinates[1]-o.coordinates[1]?n.coordinates[1]-i.coordinates[1]:i.coordinates[1]-n.coordinates[1];var r=Eh(o.coordinates,n.coordinates,i.coordinates);return r<0?1:0<r?-1:Math.pow(n.coordinates[0]-o.coordinates[0],2)+Math.pow(n.coordinates[1]-o.coordinates[1],2)-(Math.pow(i.coordinates[0]-o.coordinates[0],2)+Math.pow(i.coordinates[1]-o.coordinates[1],2))}),this.outerEdgesSorted=!0)},Ih.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},Ih.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},Ih.prototype.addInnerEdge=function(t){this.innerEdges.push(t)};var Lh=function(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)};Lh.prototype.getSymetric=function(){return this.symetric||(this.symetric=new Lh(this.to,this.from),this.symetric.symetric=this),this.symetric},Lh.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},Lh.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},Lh.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},Lh.prototype.toLineString=function(){return rr([this.from.coordinates,this.to.coordinates])},Lh.prototype.compareTo=function(t){return Eh(t.from.coordinates,t.to.coordinates,this.to.coordinates)};var Sh=function(){this.edges=[],this.polygon=void 0,this.envelope=void 0},Mh={length:{configurable:!0}};Sh.prototype.push=function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0},Sh.prototype.get=function(t){return this.edges[t]},Mh.length.get=function(){return this.edges.length},Sh.prototype.forEach=function(t){this.edges.forEach(t)},Sh.prototype.map=function(t){return this.edges.map(t)},Sh.prototype.some=function(t){return this.edges.some(t)},Sh.prototype.isValid=function(){return!0},Sh.prototype.isHole=function(){var i=this,t=this.edges.reduce(function(t,e,n){return e.from.coordinates[1]>i.edges[t].from.coordinates[1]&&(t=n),t},0),e=(0===t?this.length:t)-1,n=(t+1)%this.length,r=Eh(this.edges[e].from.coordinates,this.edges[t].from.coordinates,this.edges[n].from.coordinates);return 0===r?this.edges[e].from.coordinates[0]>this.edges[n].from.coordinates[0]:0<r},Sh.prototype.toMultiPoint=function(){return ur(this.edges.map(function(t){return t.from.coordinates}))},Sh.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map(function(t){return t.from.coordinates});return t.push(this.edges[0].from.coordinates),this.polygon=nr([t])},Sh.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=Ys(this.toPolygon())},Sh.findEdgeRingContaining=function(l,t){var h,c,p=l.getEnvelope();return t.forEach(function(t){var e,n,i,r,o,s,a=t.getEnvelope();if((c&&(h=c.getEnvelope()),n=p,i=(e=a).geometry.coordinates.map(function(t){return t[0]}),r=e.geometry.coordinates.map(function(t){return t[1]}),o=n.geometry.coordinates.map(function(t){return t[0]}),s=n.geometry.coordinates.map(function(t){return t[1]}),Math.max(null,i)!==Math.max(null,o)||Math.max(null,r)!==Math.max(null,s)||Math.min(null,i)!==Math.min(null,o)||Math.min(null,r)!==Math.min(null,s))&&wh(a,p)){var u=l.map(function(t){return t.from.coordinates}).find(function(i){return!t.some(function(t){return e=i,n=t.from.coordinates,e[0]===n[0]&&e[1]===n[1];var e,n})});u&&t.inside(tr(u))&&(c&&!wh(h,a)||(c=t))}}),c},Sh.prototype.inside=function(t){return ts(t,this.toPolygon())},Object.defineProperties(Sh.prototype,Mh);var Ch=function(){this.edges=[],this.nodes={}};function Ph(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(Oh(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function Nh(t,e){return 0<Ya(e,Uu(t)).features.length}function Oh(t,e,n){var i=n[0]-t[0],r=n[1]-t[1],o=e[0]-t[0],s=e[1]-t[1];return 0==i*s-r*o&&(Math.abs(o)>=Math.abs(s)?0<o?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:0<s?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}function Th(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function Rh(t,e){return t[0]===e[0]&&t[1]===e[1]}function kh(t,e){for(var n=!1,i=!1,r=t.coordinates.length,o=0;o<r&&!n&&!i;){for(var s=0;s<e.coordinates.length-1;s++){var a=!0;0!==s&&s!==e.coordinates.length-2||(a=!1),Fh(e.coordinates[s],e.coordinates[s+1],t.coordinates[o],a)?n=!0:i=!0}o++}return n&&i}function Dh(t,e){return 0<Ya(t,Uu(e)).features.length}function Ah(t,e){for(var n=!1,i=!1,r=t.coordinates[0].length,o=0;o<r&&n&&i;)ts(tr(t.coordinates[0][o]),e)?n=!0:i=!0,o++;return i&&i}function Fh(t,e,n,i){var r=n[0]-t[0],o=n[1]-t[1],s=e[0]-t[0],a=e[1]-t[1];return 0==r*a-o*s&&(i?Math.abs(s)>=Math.abs(a)?0<s?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:0<a?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]:Math.abs(s)>=Math.abs(a)?0<s?t[0]<n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<t[0]:0<a?t[1]<n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<t[1])}Ch.fromGeoJson=function(t){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(t);var r=new Ch;return kr(t,function(t){Hr(t,"LineString","Graph::fromGeoJson"),Sr(t,function(t,e){if(t){var n=r.getNode(t),i=r.getNode(e);r.addEdge(n,i)}return e})}),r},Ch.prototype.getNode=function(t){var e=Ih.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new Ih(t)),n},Ch.prototype.addEdge=function(t,e){var n=new Lh(t,e),i=n.getSymetric();this.edges.push(n),this.edges.push(i)},Ch.prototype.deleteDangles=function(){var e=this;Object.keys(this.nodes).map(function(t){return e.nodes[t]}).forEach(function(t){return e._removeIfDangle(t)})},Ch.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map(function(t){return t.to});this.removeNode(t),n.forEach(function(t){return e._removeIfDangle(t)})}},Ch.prototype.deleteCutEdges=function(){var e=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(t){t.label===t.symetric.label&&(e.removeEdge(t.symetric),e.removeEdge(t))})},Ch.prototype._computeNextCWEdges=function(n){var e=this;void 0===n?Object.keys(this.nodes).forEach(function(t){return e._computeNextCWEdges(e.nodes[t])}):n.getOuterEdges().forEach(function(t,e){n.getOuterEdge((0===e?n.getOuterEdges().length:e)-1).symetric.next=t})},Ch.prototype._computeNextCCWEdges=function(t,e){for(var n,i,r=t.getOuterEdges(),o=r.length-1;0<=o;--o){var s=r[o],a=s.symetric,u=void 0,l=void 0;s.label===e&&(u=s),a.label===e&&(l=a),u&&l&&(l&&(i=l),u&&(i&&(i.next=u,i=void 0),n||(n=u)))}i&&(i.next=n)},Ch.prototype._findLabeledEdgeRings=function(){var n=[],i=0;return this.edges.forEach(function(t){if(!(0<=t.label)){n.push(t);for(var e=t;e.label=i,e=e.next,!t.isEqual(e););i++}}),n},Ch.prototype.getEdgeRings=function(){var n=this;this._computeNextCWEdges(),this.edges.forEach(function(t){t.label=void 0}),this._findLabeledEdgeRings().forEach(function(e){n._findIntersectionNodes(e).forEach(function(t){n._computeNextCCWEdges(t,e.label)})});var e=[];return this.edges.forEach(function(t){t.ring||e.push(n._findEdgeRing(t))}),e},Ch.prototype._findIntersectionNodes=function(n){for(var t=[],i=n,e=function(){var e=0;i.from.getOuterEdges().forEach(function(t){t.label===n.label&&++e}),1<e&&t.push(i.from),i=i.next};e(),!n.isEqual(i););return t},Ch.prototype._findEdgeRing=function(t){for(var e=t,n=new Sh;n.push(e),e.ring=n,e=e.next,!t.isEqual(e););return n},Ch.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach(function(t){return e.removeEdge(t)}),t.innerEdges.forEach(function(t){return e.removeEdge(t)}),delete this.nodes[t.id]},Ch.prototype.removeEdge=function(e){this.edges=this.edges.filter(function(t){return!t.isEqual(e)}),e.deleteEdge()};var Gh=Io(function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n}),Bh=(Gh.shim,Io(function(t,e){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function i(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function r(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=n?i:r).supported=i,e.unsupported=r})),Uh=(Bh.supported,Bh.unsupported,Io(function(t){var a=Array.prototype.slice,u=t.exports=function(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?n.strict?t===e:t==e:function(t,e,n){var i,r;if(l(t)||l(e))return!1;if(t.prototype!==e.prototype)return!1;if(Bh(t))return!!Bh(e)&&(t=a.call(t),e=a.call(e),u(t,e,n));if(h(t)){if(!h(e))return!1;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}try{var o=Gh(t),s=Gh(e)}catch(t){return!1}if(o.length!=s.length)return!1;for(o.sort(),s.sort(),i=o.length-1;0<=i;i--)if(o[i]!=s[i])return!1;for(i=o.length-1;0<=i;i--)if(r=o[i],!u(t[r],e[r],n))return!1;return typeof t==typeof e}(t,e,n))};function l(t){return null==t}function h(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(0<t.length&&"number"!=typeof t[0]))}})),qh=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:Vh};function jh(e){return e.coordinates.map(function(t){return{type:e.type.replace("Multi",""),coordinates:t}})}function zh(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function Vh(t,e){return Uh(t,e,{strict:!0})}qh.prototype.compare=function(t,e){if(t.type!==e.type||!zh(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,i=jh(t),r=jh(e);return i.every(function(e){return this.some(function(t){return n.compare(e,t)})},r)}}return!1},qh.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},qh.prototype.compareLine=function(t,e,n,i){if(!zh(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!i||this.compareCoord(r[0],o[0])||(o=this.fixStartIndex(o,r))){var s=this.compareCoord(r[n],o[n]);return this.direction||s?this.comparePath(r,o):!!this.compareCoord(r[n],o[o.length-(1+n)])&&this.comparePath(r.slice().reverse(),o)}},qh.prototype.fixStartIndex=function(t,e){for(var n,i=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){i=r;break}return 0<=i&&(n=[].concat(t.slice(i,t.length),t.slice(1,i+1))),n},qh.prototype.comparePath=function(t,e){var n=this;return t.every(function(t,e){return n.compareCoord(t,this[e])},e)},qh.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),i=e.coordinates.slice(1,e.coordinates.length),r=this;return n.every(function(e){return this.some(function(t){return r.compareLine(e,t,1,!0)})},i)}return!1},qh.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},qh.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},qh.prototype.removePseudo=function(t){return t};var Yh=qh;function Hh(t,n){if(!t)throw new Error("feature1 is required");if(!n)throw new Error("feature2 is required");var e=Kr(t);if(e!==Kr(n))throw new Error("features must be of the same type");if("Point"===e)throw new Error("Point geometry not supported");if(new Yh({precision:6}).compare(t,n))return!1;var i=0;switch(e){case"MultiPoint":var r=Or(t),o=Or(n);r.forEach(function(e){o.forEach(function(t){e[0]===t[0]&&e[1]===t[1]&&i++})});break;case"LineString":case"MultiLineString":Ar(t,function(e){Ar(n,function(t){el(e,t).features.length&&i++})});break;case"Polygon":case"MultiPolygon":Ar(t,function(e){Ar(n,function(t){Ya(e,t).features.length&&i++})})}return 0<i}var Xh=Io(function(t){function e(t,e,n,i){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,i)}e.prototype.run=function(t,e,n,i){this._init(t,e,n,i);for(var r=0;r<this._datasetLength;r++)if(1!==this._visited[r]){this._visited[r]=1;var o=this._regionQuery(r);if(o.length<this.minPts)this.noise.push(r);else{var s=this.clusters.length;this.clusters.push([]),this._addToCluster(r,s),this._expandCluster(s,o)}}return this.clusters},e.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(1!==this._visited[i]){this._visited[i]=1;var r=this._regionQuery(i);r.length>=this.minPts&&(e=this._mergeArrays(e,r))}1!==this._assigned[i]&&this._addToCluster(i,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++){this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n)}return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,i=0;i<n;i++){var r=e[i];t.indexOf(r)<0&&t.push(r)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=e)}),Wh=Io(function(t){function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],void 0!==t&&(this.dataset=t),void 0!==e&&(this.k=e),void 0!==n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,i=0;i<this.k;i++)this.centroids[i]=this.randomCentroid();for(var r=!0;r;){r=this.assign();for(var o=0;o<this.k;o++){for(var s=new Array(h),a=0,u=0;u<h;u++)s[u]=0;for(var l=0;l<n;l++){var h=this.dataset[l].length;if(o===this.assignments[l]){for(u=0;u<h;u++)s[u]+=this.dataset[l][u];a++}}if(0<a){for(u=0;u<h;u++)s[u]/=a;this.centroids[o]=s}else this.centroids[o]=this.randomCentroid(),r=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){for(var t,e,n=this.dataset.length-1;e=Math.round(Math.random()*n),t=this.dataset[e],0<=this.centroids.indexOf(t););return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,i=0;i<n;i++)(t=this.argmin(this.dataset[i],this.centroids,this.distance))!=this.assignments[i]&&(this.assignments[i]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)void 0===e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var i,r=Number.MAX_VALUE,o=0,s=e.length,a=0;a<s;a++)(i=n(t,e[a]))<r&&(r=i,o=a);return o},e.prototype.distance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;){var r=t[i]-e[i];n+=r*r}return Math.sqrt(n)},t.exports&&(t.exports=e)}),Jh=Io(function(t){function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,i=n;i--;){var r=this._priorities[i];"desc"===this._sorting?r<e&&(n=i):e<r&&(n=i)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;){if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var i=0;i<t.length;i++)this.insert(t[i],e[i])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)}),Kh=Io(function(t){if(t.exports)var l=Jh;function e(t,e,n,i){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,i)}e.prototype.run=function(t,e,n,i){this._init(t,e,n,i);for(var r=0,o=this.dataset.length;r<o;r++)if(1!==this._processed[r]){this._processed[r]=1,this.clusters.push([r]);var s=this.clusters.length-1;this._orderedList.push(r);var a=new l(null,null,"asc"),u=this._regionQuery(r);void 0!==this._distanceToCore(r)&&(this._updateQueue(r,u,a),this._expandCluster(s,a))}return this.clusters},e.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var i=this._orderedList[e],r=this._reachability[i];t.push([i,r])}return t},e.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},e.prototype._updateQueue=function(i,t,r){var o=this;this._coreDistance=this._distanceToCore(i),t.forEach(function(t){if(void 0===o._processed[t]){var e=o.distance(o.dataset[i],o.dataset[t]),n=Math.max(o._coreDistance,e);void 0===o._reachability[t]?(o._reachability[t]=n,r.insert(t,n)):n<o._reachability[t]&&(o._reachability[t]=n,r.remove(t),r.insert(t,n))}})},e.prototype._expandCluster=function(t,e){for(var n=e.getElements(),i=0,r=n.length;i<r;i++){var o=n[i];if(void 0===this._processed[o]){var s=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,s,e),this._expandCluster(t,e))}}},e.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++){if(this._regionQuery(t,n).length>=this.minPts)return n}},e.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],i=0,r=this.dataset.length;i<r;i++)this.distance(this.dataset[t],this.dataset[i])<e&&n.push(i);return n},e.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=e)}),Zh=Io(function(t){t.exports&&(t.exports={DBSCAN:Xh,KMEANS:Wh,OPTICS:Kh,PriorityQueue:Jh})});Zh.DBSCAN,Zh.KMEANS,Zh.OPTICS,Zh.PriorityQueue;var Qh=function(t,e,n){for(var i=t.length,r=0,o=0;o<i;o++){var s=(t[o]||0)-(e[o]||0);r+=s*s}return n?Math.sqrt(r):r},$h=Qh,tc=function(t,e,n){var i=Math.abs(t-e);return n?i:i*i},ec=Qh,nc=function(t,e){for(var n={},i=[],r=e<<2,o=t.length,s=0<t[0].length;i.length<e&&0<r--;){var a=t[Math.floor(Math.random()*o)],u=s?a.join("_"):""+a;n[u]||(n[u]=!0,i.push(a))}if(i.length<e)throw new Error("Error initializating clusters");return i},ic=function(t,e){var n=t[0].length?$h:tc,i=[],r=t.length,o=0<t[0].length,s=t[Math.floor(Math.random()*r)];o&&s.join("_");for(i.push(s);i.length<e;){for(var a=[],u=i.length,l=0,h=[],c=0;c<r;c++){for(var p=1/0,f=0;f<u;f++){var d=n(t[c],i[f]);d<=p&&(p=d)}a[c]=p}for(var g=0;g<r;g++)l+=a[g];for(var y=0;y<r;y++)h[y]={i:y,v:t[y],pr:a[y]/l,cs:0};h.sort(function(t,e){return t.pr-e.pr}),h[0].cs=h[0].pr;for(var _=1;_<r;_++)h[_].cs=h[_-1].cs+h[_].pr;for(var m=Math.random(),v=0;v<r-1&&h[v++].cs<m;);i.push(h[v-1].v)}return i};function rc(t,e,n){n=n||[];for(var i=0;i<t;i++)n[i]=e;return n}var oc=function(t,e,n,i){var r=[],o=[],s=[],a=[],u=!1,l=i||1e4,h=t.length,c=t[0].length,p=0<c,f=[];if(n)r="kmrand"==n?nc(t,e):"kmpp"==n?ic(t,e):n;else for(var d={};r.length<e;){var g=Math.floor(Math.random()*h);d[g]||(d[g]=!0,r.push(t[g]))}do{rc(e,0,f);for(var y=0;y<h;y++){for(var _=1/0,m=0,v=0;v<e;v++)(a=p?ec(t[y],r[v]):Math.abs(t[y]-r[v]))<=_&&(_=a,m=v);f[s[y]=m]++}for(var b=[],x=(o=[],0);x<e;x++)b[x]=p?rc(c,0,b[x]):0,o[x]=r[x];if(p){for(var E=0;E<e;E++)r[E]=[];for(var w=0;w<h;w++)for(var I=b[s[w]],L=t[w],S=0;S<c;S++)I[S]+=L[S];u=!0;for(var M=0;M<e;M++){for(var C=r[M],P=b[M],N=o[M],O=f[M],T=0;T<c;T++)C[T]=P[T]/O||0;if(u)for(var R=0;R<c;R++)if(N[R]!=C[R]){u=!1;break}}}else{for(var k=0;k<h;k++)b[s[k]]+=t[k];for(var D=0;D<e;D++)r[D]=b[D]/f[D]||0;u=!0;for(var A=0;A<e;A++)if(o[A]!=r[A]){u=!1;break}}u=u||--l<=0}while(!u);return{it:1e4-l,k:e,idxs:s,centroids:r}};function sc(t,e){if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error("Invalid GeoJSON object for "+e)}function ac(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}var uc={search:function(t,e,n,i){t.cleanDirty();var r=(i=i||{}).heuristic||uc.heuristics.manhattan,o=i.closest||!1,s=new cc(function(t){return t.f}),a=e;for(e.h=r(e,n),s.push(e);0<s.size();){var u=s.pop();if(u===n)return ac(u);u.closed=!0;for(var l=t.neighbors(u),h=0,c=l.length;h<c;++h){var p=l[h];if(!p.closed&&!p.isWall()){var f=u.g+p.getCost(u),d=p.visited;(!d||f<p.g)&&(p.visited=!0,p.parent=u,p.h=p.h||r(p,n),p.g=f,p.f=p.g+p.h,t.markDirty(p),o&&(p.h<a.h||p.h===a.h&&p.g<a.g)&&(a=p),d?s.rescoreElement(p):s.push(p))}}}return o?ac(a):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return 1*(i+r)+(n-2)*Math.min(i,r)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function lc(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var i=0,r=t[n];i<r.length;i++){var o=new hc(n,i,r[i]);this.grid[n][i]=o,this.nodes.push(o)}}this.init()}function hc(t,e,n){this.x=t,this.y=e,this.weight=n}function cc(t){this.content=[],this.scoreFunction=t}function pc(t,e){for(var n=0;n<e.features.length;n++)if(ts(t,e.features[n]))return!0;return!1}lc.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)uc.cleanNode(this.nodes[t])},lc.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)uc.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},lc.prototype.markDirty=function(t){this.dirtyNodes.push(t)},lc.prototype.neighbors=function(t){var e=[],n=t.x,i=t.y,r=this.grid;return r[n-1]&&r[n-1][i]&&e.push(r[n-1][i]),r[n+1]&&r[n+1][i]&&e.push(r[n+1][i]),r[n]&&r[n][i-1]&&e.push(r[n][i-1]),r[n]&&r[n][i+1]&&e.push(r[n][i+1]),this.diagonal&&(r[n-1]&&r[n-1][i-1]&&e.push(r[n-1][i-1]),r[n+1]&&r[n+1][i-1]&&e.push(r[n+1][i-1]),r[n-1]&&r[n-1][i+1]&&e.push(r[n-1][i+1]),r[n+1]&&r[n+1][i+1]&&e.push(r[n+1][i+1])),e},lc.prototype.toString=function(){for(var t,e,n,i,r=[],o=this.grid,s=0,a=o.length;s<a;s++){for(t=[],n=0,i=(e=o[s]).length;n<i;n++)t.push(e[n].weight);r.push(t.join(" "))}return r.join("\n")},hc.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},hc.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},hc.prototype.isWall=function(){return 0===this.weight},cc.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return 0<this.content.length&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];0<t;){var n=(t+1>>1)-1,i=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(i)))break;this.content[n]=e,this.content[t]=i,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],i=this.scoreFunction(n);;){var r,o=t+1<<1,s=o-1,a=null;if(s<e){var u=this.content[s];(r=this.scoreFunction(u))<i&&(a=s)}if(o<e){var l=this.content[o];this.scoreFunction(l)<(null===a?i:r)&&(a=o)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}};var fc=function(t){return function(){return t}};function dc(t){return t[0]}function gc(t){return t[1]}function yc(){this._=null}function _c(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function mc(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function vc(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function bc(t){for(;t.L;)t=t.L;return t}function xc(t,e,n,i){var r=[null,null],o=zc.push(r)-1;return r.left=t,r.right=e,n&&wc(r,t,e,n),i&&wc(r,e,t,i),qc[t.index].halfedges.push(o),qc[e.index].halfedges.push(o),r}function Ec(t,e,n){var i=[e,n];return i.left=t,i}function wc(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function Ic(t,e,n,i,r){var o,s=t[0],a=t[1],u=s[0],l=s[1],h=0,c=1,p=a[0]-u,f=a[1]-l;if(o=e-u,p||!(0<o)){if(o/=p,p<0){if(o<h)return;o<c&&(c=o)}else if(0<p){if(c<o)return;h<o&&(h=o)}if(o=i-u,p||!(o<0)){if(o/=p,p<0){if(c<o)return;h<o&&(h=o)}else if(0<p){if(o<h)return;o<c&&(c=o)}if(o=n-l,f||!(0<o)){if(o/=f,f<0){if(o<h)return;o<c&&(c=o)}else if(0<f){if(c<o)return;h<o&&(h=o)}if(o=r-l,f||!(o<0)){if(o/=f,f<0){if(c<o)return;h<o&&(h=o)}else if(0<f){if(o<h)return;o<c&&(c=o)}return(0<h||c<1)&&(0<h&&(t[0]=[u+h*p,l+h*f]),c<1&&(t[1]=[u+c*p,l+c*f])),!0}}}}}function Lc(t,e,n,i,r){var o=t[1];if(o)return!0;var s,a,u=t[0],l=t.left,h=t.right,c=l[0],p=l[1],f=h[0],d=h[1],g=(c+f)/2,y=(p+d)/2;if(d===p){if(g<e||i<=g)return;if(f<c){if(u){if(u[1]>=r)return}else u=[g,n];o=[g,r]}else{if(u){if(u[1]<n)return}else u=[g,r];o=[g,n]}}else if(a=y-(s=(c-f)/(d-p))*g,s<-1||1<s)if(f<c){if(u){if(u[1]>=r)return}else u=[(n-a)/s,n];o=[(r-a)/s,r]}else{if(u){if(u[1]<n)return}else u=[(r-a)/s,r];o=[(n-a)/s,n]}else if(p<d){if(u){if(u[0]>=i)return}else u=[e,s*e+a];o=[i,s*i+a]}else{if(u){if(u[0]<e)return}else u=[i,s*i+a];o=[e,s*e+a]}return t[0]=u,t[1]=o,!0}function Sc(t,e){return e[+(e.left!==t.site)]}yc.prototype={constructor:yc,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else n=this._?(t=bc(this._),e.P=null,(e.N=t).P=t.L=e,t):(e.P=e.N=null,this._=e,null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(mc(this,n),n=(t=n).U),n.C=!1,i.C=!0,vc(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(vc(this,n),n=(t=n).U),n.C=!1,i.C=!0,mc(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,s=t.R;if(n=o?s?bc(s):o:s,r?r.L===t?r.L=n:r.R=n:this._=n,o&&s?(i=n.C,n.C=t.C,((n.L=o).U=n)!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,(n.R=s).U=n):(n.U=r,t=(r=n).R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,mc(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,vc(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,mc(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,vc(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,mc(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,vc(this,r),t=this._;break}e.C=!0,r=(t=r).U}while(!t.C);t&&(t.C=!1)}}};var Mc,Cc=[];function Pc(){_c(this),this.x=this.y=this.arc=this.site=this.cy=null}function Nc(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var s=r[0],a=r[1],u=i[0]-s,l=i[1]-a,h=o[0]-s,c=o[1]-a,p=2*(u*c-l*h);if(!(-Yc<=p)){var f=u*u+l*l,d=h*h+c*c,g=(c*f-l*d)/p,y=(u*d-h*f)/p,_=Cc.pop()||new Pc;_.arc=t,_.site=r,_.x=g+s,_.y=(_.cy=y+a)+Math.sqrt(g*g+y*y),t.circle=_;for(var m=null,v=jc._;v;)if(_.y<v.y||_.y===v.y&&_.x<=v.x){if(!v.L){m=v.P;break}v=v.L}else{if(!v.R){m=v;break}v=v.R}jc.insert(m,_),m||(Mc=_)}}}}function Oc(t){var e=t.circle;e&&(e.P||(Mc=e.N),jc.remove(e),Cc.push(e),_c(e),t.circle=null)}var Tc=[];function Rc(){_c(this),this.edge=this.site=this.circle=null}function kc(t){var e=Tc.pop()||new Rc;return e.site=t,e}function Dc(t){Oc(t),Uc.remove(t),Tc.push(t),_c(t)}function Ac(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,s=t.N,a=[t];Dc(t);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<Vc&&Math.abs(i-u.circle.cy)<Vc;)o=u.P,a.unshift(u),Dc(u),u=o;a.unshift(u),Oc(u);for(var l=s;l.circle&&Math.abs(n-l.circle.x)<Vc&&Math.abs(i-l.circle.cy)<Vc;)s=l.N,a.push(l),Dc(l),l=s;a.push(l),Oc(l);var h,c=a.length;for(h=1;h<c;++h)l=a[h],u=a[h-1],wc(l.edge,u.site,l.site,r);u=a[0],(l=a[c-1]).edge=xc(u.site,l.site,null,r),Nc(u),Nc(l)}function Fc(t){for(var e,n,i,r,o,s=t[0],a=t[1],u=Uc._;u;)if(i=Gc(u,a)-s,Vc<i)u=u.L;else{if(r=s-Bc(u,a),!(Vc<r)){-Vc<i?(e=u.P,n=u):-Vc<r?n=(e=u).N:e=n=u;break}if(!u.R){e=u;break}u=u.R}qc[(o=t).index]={site:o,halfedges:[]};var l=kc(t);if(Uc.insert(e,l),e||n){if(e===n)return Oc(e),n=kc(e.site),Uc.insert(l,n),l.edge=n.edge=xc(e.site,l.site),Nc(e),void Nc(n);if(n){Oc(e),Oc(n);var h=e.site,c=h[0],p=h[1],f=t[0]-c,d=t[1]-p,g=n.site,y=g[0]-c,_=g[1]-p,m=2*(f*_-d*y),v=f*f+d*d,b=y*y+_*_,x=[(_*v-d*b)/m+c,(f*b-y*v)/m+p];wc(n.edge,h,g,x),l.edge=xc(h,t,null,x),n.edge=xc(t,g,null,x),Nc(e),Nc(n)}else l.edge=xc(e.site,l.site)}}function Gc(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],u=n[1],l=u-e;if(!l)return a;var h=a-i,c=1/o-1/l,p=h/l;return c?(-p+Math.sqrt(p*p-2*c*(h*h/(-2*l)-u+l/2+r-o/2)))/c+i:(i+a)/2}function Bc(t,e){var n=t.N;if(n)return Gc(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var Uc,qc,jc,zc,Vc=1e-6,Yc=1e-12;function Hc(t,e){return e[1]-t[1]||e[0]-t[0]}function Xc(t,e){var n,i,r,o=t.sort(Hc).pop();for(zc=[],qc=new Array(t.length),Uc=new yc,jc=new yc;;)if(r=Mc,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===n&&o[1]===i||(Fc(o),n=o[0],i=o[1]),o=t.pop();else{if(!r)break;Ac(r.arc)}if(function(){for(var t,e,n,i,r=0,o=qc.length;r<o;++r)if((t=qc[r])&&(i=(e=t.halfedges).length)){var s=new Array(i),a=new Array(i);for(n=0;n<i;++n)s[n]=n,a[n]=(u=t,l=zc[e[n]],p=c=void 0,h=u.site,c=l.left,p=l.right,h===p&&(p=c,c=h),p?Math.atan2(p[1]-c[1],p[0]-c[0]):(p=h===c?(c=l[1],l[0]):(c=l[0],l[1]),Math.atan2(c[0]-p[0],p[1]-c[1])));for(s.sort(function(t,e){return a[e]-a[t]}),n=0;n<i;++n)a[n]=e[s[n]];for(n=0;n<i;++n)e[n]=a[n]}var u,l,h,c,p}(),e){var s=+e[0][0],a=+e[0][1],u=+e[1][0],l=+e[1][1];!function(t,e,n,i){for(var r,o=zc.length;o--;)Lc(r=zc[o],t,e,n,i)&&Ic(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>Vc||Math.abs(r[0][1]-r[1][1])>Vc)||delete zc[o]}(s,a,u,l),function(t,e,n,i){var r,o,s,a,u,l,h,c,p,f,d,g,y,_,m=qc.length,v=!0;for(r=0;r<m;++r)if(o=qc[r]){for(s=o.site,a=(u=o.halfedges).length;a--;)zc[u[a]]||u.splice(a,1);for(a=0,l=u.length;a<l;)y=o,d=(f=(_=zc[u[a]])[+(_.left===y.site)])[0],g=f[1],c=(h=Sc(o,zc[u[++a%l]]))[0],p=h[1],(Math.abs(d-c)>Vc||Math.abs(g-p)>Vc)&&(u.splice(a,0,zc.push(Ec(s,f,Math.abs(d-t)<Vc&&Vc<i-g?[t,Math.abs(c-t)<Vc?p:i]:Math.abs(g-i)<Vc&&Vc<n-d?[Math.abs(p-i)<Vc?c:n,i]:Math.abs(d-n)<Vc&&Vc<g-e?[n,Math.abs(c-n)<Vc?p:e]:Math.abs(g-e)<Vc&&Vc<d-t?[Math.abs(p-e)<Vc?c:t,e]:null))-1),++l);l&&(v=!1)}if(v){var b,x,E,w=1/0;for(r=0,v=null;r<m;++r)(o=qc[r])&&(E=(b=(s=o.site)[0]-t)*b+(x=s[1]-e)*x)<w&&(w=E,v=o);if(v){var I=[t,e],L=[t,i],S=[n,i],M=[n,e];v.halfedges.push(zc.push(Ec(s=v.site,I,L))-1,zc.push(Ec(s,L,S))-1,zc.push(Ec(s,S,M))-1,zc.push(Ec(s,M,I))-1)}}for(r=0;r<m;++r)(o=qc[r])&&(o.halfedges.length||delete qc[r])}(s,a,u,l)}this.edges=zc,this.cells=qc,Uc=jc=zc=qc=null}Xc.prototype={constructor:Xc,polygons:function(){var n=this.edges;return this.cells.map(function(e){var t=e.halfedges.map(function(t){return Sc(e,n[t])});return t.data=e.site.data,t})},triangles:function(){var p=[],f=this.edges;return this.cells.forEach(function(t,e){if(i=(n=t.halfedges).length)for(var n,i,r,o,s,a,u=t.site,l=-1,h=f[n[i-1]],c=h.left===u?h.right:h.left;++l<i;)r=c,c=(h=f[n[l]]).left===u?h.right:h.left,r&&c&&e<r.index&&e<c.index&&(s=r,a=c,((o=u)[0]-a[0])*(s[1]-o[1])-(o[0]-s[0])*(a[1]-o[1])<0)&&p.push([u.data,r.data,c.data])}),p},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(s,a,t){for(var e,u,l=this,h=l._found||0,n=l.cells.length;!(u=l.cells[h]);)if(++h>=n)return null;for(var i=s-u.site[0],r=a-u.site[1],c=i*i+r*r;u=l.cells[e=h],h=null,u.halfedges.forEach(function(t){var e=l.edges[t],n=e.left;if(n!==u.site&&n||(n=e.right)){var i=s-n[0],r=a-n[1],o=i*i+r*r;o<c&&(c=o,h=n.index)}}),null!==h;);return l._found=e,null==t||c<=t*t?u.site:null}};function Wc(t){return(t=t.slice()).push(t[0]),nr([t])}function Jc(t,e,n,i){var r=(i=i||{}).steps||64,o=i.units||"kilometers",s=i.angle||0,a=i.pivot||t,u=i.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!xr(i))throw new Error("options must be an object");if(!br(r))throw new Error("steps must be a number");if(!br(s))throw new Error("angle must be a number");var l=jr(t);if("degrees"===o)var h=_r(s);else e=rl(t,e,90,{units:o}),n=rl(t,n,0,{units:o}),e=jr(e)[0]-l[0],n=jr(n)[1]-l[1];for(var c=[],p=0;p<r;p+=1){var f=-360*p/r,d=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(Kc(f),2)),g=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(Kc(f),2));if(f<-90&&-270<=f&&(d=-d),f<-180&&-360<=f&&(g=-g),"degrees"===o){var y=d*Math.cos(h)+g*Math.sin(h),_=g*Math.cos(h)-d*Math.sin(h);d=y,g=_}c.push([d+l[0],g+l[1]])}return c.push(c[0]),"degrees"===o?nr([c],u):gh(nr([c],u),s,{pivot:a})}function Kc(t){var e=t*Math.PI/180;return Math.tan(e)}function Zc(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.properties,r=e.weight;if(!t)throw new Error("geojson is required");var o=0,s=0,a=0;return Tr(t,function(t,e,n){var i=n[r];if(!br(i=null==i?1:i))throw new Error("weight value must be a number for feature index "+e);0<(i=Number(i))&&Lr(t,function(t){o+=t[0]*i,s+=t[1]*i,a+=i})}),tr([o/a,s/a],n)}function Qc(t,e){return{x:t[0]-e[0],y:t[1]-e[1]}}function $c(t){if(xr(t)&&(t=t.bbox),t&&!Array.isArray(t))throw new Error("bbox is invalid");return t?(e=t,[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]):[360*rp(),180*rp()];var e}function tp(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.bbox;null==t&&(t=1);for(var i=[],r=0;r<t;r++)i.push(tr($c(n)));return sr(i)}function ep(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.num_vertices,r=e.max_radial_length;null==t&&(t=1),br(i)||(i=10),br(r)||(r=10);for(var o=[],s=0;s<t;s++){var a=[],u=Array.apply(null,new Array(i+1)).map(Math.random);u.forEach(l),u.forEach(h),a[a.length-1]=a[0],a=a.map(ip($c(n))),o.push(nr([a]))}function l(t,e,n){n[e]=0<e?t+n[e-1]:t}function h(t){t=2*t*Math.PI/u[u.length-1];var e=Math.random();a.push([e*r*Math.sin(t),e*r*Math.cos(t)])}return sr(o)}function np(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.num_vertices,r=e.max_length,o=e.max_rotation;null==t&&(t=1),(!br(i)||i<2)&&(i=10),br(r)||(r=1e-4),br(o)||(o=Math.PI/8);for(var s=[],a=0;a<t;a++){for(var u=[$c(n)],l=0;l<i-1;l++){var h=(0===l?2*Math.random()*Math.PI:Math.tan((u[l][1]-u[l-1][1])/(u[l][0]-u[l-1][0])))+(Math.random()-.5)*o*2,c=Math.random()*r;u.push([u[l][0]+c*Math.cos(h),u[l][1]+c*Math.sin(h)])}s.push(rr(u))}return sr(s)}function ip(e){return function(t){return[t[0]+e[0],t[1]+e[1]]}}function rp(){return Math.random()-.5}var op=Object.freeze({randomPosition:$c,randomPoint:tp,randomPolygon:ep,randomLineString:np});function sp(t,e){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("filter is required");var n=[];return Pr(t,function(t){hp(t.properties,e)&&n.push(t)}),sr(n)}function ap(t,e,n){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("property is required");for(var i=lp(t,e),r=Object.keys(i),o=0;o<r.length;o++){for(var s=r[o],a=i[s],u=[],l=0;l<a.length;l++)u.push(t.features[a[l]]);n(sr(u),s,o)}}function up(t,e,i,r){var o=r;return ap(t,e,function(t,e,n){o=0===n&&void 0===r?t:i(o,t,e,n)}),o}function lp(t,r){var o={};return Pr(t,function(t,e){var n=t.properties||{};if(n.hasOwnProperty(r)){var i=n[r];o.hasOwnProperty(i)?o[i].push(e):o[i]=[e]}}),o}function hp(t,e){if(void 0===t)return!1;var n=typeof e;if("number"===n||"string"===n)return t.hasOwnProperty(e);if(Array.isArray(e)){for(var i=0;i<e.length;i++)if(!hp(t,e[i]))return!1;return!0}return cp(t,e)}function cp(t,e){for(var n=Object.keys(e),i=0;i<n.length;i++){var r=n[i];if(t[r]!==e[r])return!1}return!0}function pp(t,e){if(!e)return{};if(!e.length)return{};for(var n={},i=0;i<e.length;i++){var r=e[i];t.hasOwnProperty(r)&&(n[r]=t[r])}return n}var fp=Object.freeze({getCluster:sp,clusterEach:ap,clusterReduce:up,createBins:lp,applyFilter:hp,propertiesContainsFilter:cp,filterProperties:pp});"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=1 in arguments&&parseInt(Number(arguments[1]),10)||0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)e[i]=t,++i;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var dp=function(){};dp.prototype.interfaces_=function(){return[]},dp.prototype.getClass=function(){return dp},dp.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var gp=function(){},yp=function(){},_p={MAX_VALUE:{configurable:!0}};yp.isNaN=function(t){return Number.isNaN(t)},yp.doubleToLongBits=function(t){return t},yp.longBitsToDouble=function(t){return t},yp.isInfinite=function(t){return!Number.isFinite(t)},_p.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(yp,_p);var mp=function(){},vp=function(){},bp=function(){};function xp(){}var Ep=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},wp={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};Ep.prototype.setOrdinate=function(t,e){switch(t){case Ep.X:this.x=e;break;case Ep.Y:this.y=e;break;case Ep.Z:this.z=e;break;default:throw new gp("Invalid ordinate index: "+t)}},Ep.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!dp.equalsWithTolerance(this.x,e.x,n)&&!!dp.equalsWithTolerance(this.y,e.y,n)}},Ep.prototype.getOrdinate=function(t){switch(t){case Ep.X:return this.x;case Ep.Y:return this.y;case Ep.Z:return this.z}throw new gp("Invalid ordinate index: "+t)},Ep.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||yp.isNaN(this.z))&&yp.isNaN(t.z)},Ep.prototype.equals=function(t){return t instanceof Ep&&this.equals2D(t)},Ep.prototype.equalInZ=function(t,e){return dp.equalsWithTolerance(this.z,t.z,e)},Ep.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},Ep.prototype.clone=function(){},Ep.prototype.copy=function(){return new Ep(this)},Ep.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},Ep.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},Ep.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},Ep.prototype.hashCode=function(){var t=17;return t=37*(t=37*t+Ep.hashCode(this.x))+Ep.hashCode(this.y)},Ep.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},Ep.prototype.interfaces_=function(){return[mp,vp,xp]},Ep.prototype.getClass=function(){return Ep},Ep.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=yp.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},wp.DimensionalComparator.get=function(){return Ip},wp.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},wp.NULL_ORDINATE.get=function(){return yp.NaN},wp.X.get=function(){return 0},wp.Y.get=function(){return 1},wp.Z.get=function(){return 2},Object.defineProperties(Ep,wp);var Ip=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=t;if(2!==e&&3!==e)throw new gp("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};Ip.prototype.compare=function(t,e){var n=t,i=e,r=Ip.compare(n.x,i.x);if(0!==r)return r;var o=Ip.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:Ip.compare(n.z,i.z)},Ip.prototype.interfaces_=function(){return[bp]},Ip.prototype.getClass=function(){return Ip},Ip.compare=function(t,e){return t<e?-1:e<t?1:yp.isNaN(t)?yp.isNaN(e)?0:-1:yp.isNaN(e)?1:0};var Lp=function(){};Lp.prototype.create=function(){},Lp.prototype.interfaces_=function(){return[]},Lp.prototype.getClass=function(){return Lp};var Sp=function(){},Mp={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};Sp.prototype.interfaces_=function(){return[]},Sp.prototype.getClass=function(){return Sp},Sp.toLocationSymbol=function(t){switch(t){case Sp.EXTERIOR:return"e";case Sp.BOUNDARY:return"b";case Sp.INTERIOR:return"i";case Sp.NONE:return"-"}throw new gp("Unknown location value: "+t)},Mp.INTERIOR.get=function(){return 0},Mp.BOUNDARY.get=function(){return 1},Mp.EXTERIOR.get=function(){return 2},Mp.NONE.get=function(){return-1},Object.defineProperties(Sp,Mp);var Cp=function(t,e){return t.interfaces_&&-1<t.interfaces_().indexOf(e)},Pp=function(){},Np={LOG_10:{configurable:!0}};Pp.prototype.interfaces_=function(){return[]},Pp.prototype.getClass=function(){return Pp},Pp.log10=function(t){var e=Math.log(t);return yp.isInfinite(e)?e:yp.isNaN(e)?e:e/Pp.LOG_10},Pp.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},Pp.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:n<t?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return i<r?r:o<i?o:i}},Pp.wrap=function(t,e){return t<0?e- -t%e:t%e},Pp.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=t;return i<e&&(i=e),i<n&&(i=n),i}if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],u=r;return u<o&&(u=o),u<s&&(u=s),u<a&&(u=a),u}},Pp.average=function(t,e){return(t+e)/2},Np.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Pp,Np);var Op=function(t){this.str=t};Op.prototype.append=function(t){this.str+=t},Op.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},Op.prototype.toString=function(t){return this.str};var Tp=function(t){this.value=t};Tp.prototype.intValue=function(){return this.value},Tp.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},Tp.isNaN=function(t){return Number.isNaN(t)};var Rp=function(){};Rp.isWhitespace=function(t){return t<=32&&0<=t||127===t},Rp.toUpperCase=function(t){return t.toUpperCase()};var kp=function t(){if(this._hi=0,(this._lo=0)===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var i=arguments[0];t.call(this,t.parse(i))}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.init(r,o)}},Dp={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};kp.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},kp.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=kp.magnitude(n._hi),r=kp.TEN.pow(i);(n=n.divide(r)).gt(kp.TEN)?(n=n.divide(kp.TEN),i+=1):n.lt(kp.ONE)&&(n=n.multiply(kp.TEN),i-=1);for(var o=i+1,s=new Op,a=kp.MAX_PRINT_DIGITS-1,u=0;u<=a;u++){t&&u===o&&s.append(".");var l=Math.trunc(n._hi);if(l<0)break;var h=!1,c=0;c=9<l?(h=!0,"9"):"0"+l,s.append(c),n=n.subtract(kp.valueOf(l)).multiply(kp.TEN),h&&n.selfAdd(kp.TEN);var p=!0,f=kp.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-u&&(p=!1),!p)break}return e[0]=i,s.toString()},kp.prototype.sqr=function(){return this.multiply(this)},kp.prototype.doubleValue=function(){return this._hi+this._lo},kp.prototype.subtract=function(){if(arguments[0]instanceof kp){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},kp.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},kp.prototype.isZero=function(){return 0===this._hi&&0===this._lo},kp.prototype.selfSubtract=function(){if(arguments[0]instanceof kp){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},kp.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},kp.prototype.min=function(t){return this.le(t)?this:t},kp.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof kp){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n,i,r,o,s=arguments[0],a=arguments[1],u=null,l=null,h=null,c=null;return r=this._hi/s,c=(u=(h=kp.SPLIT*r)-(u=h-r))*(l=(c=kp.SPLIT*s)-(l=c-s))-(o=r*s)+u*(i=s-l)+(n=r-u)*l+n*i,c=r+(h=(this._hi-o-c+this._lo-r*a)/s),this._hi=c,this._lo=r-c+h,this}},kp.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},kp.prototype.divide=function(){if(arguments[0]instanceof kp){var t,e,n,i,r=arguments[0],o=null,s=null,a=null,u=null;return t=(n=this._hi/r._hi)-(o=(a=kp.SPLIT*n)-(o=a-n)),u=o*(s=(u=kp.SPLIT*r._hi)-(s=u-r._hi))-(i=n*r._hi)+o*(e=r._hi-s)+t*s+t*e,a=(this._hi-i-u+this._lo-n*r._lo)/r._hi,new kp(u=n+a,n-u+a)}if("number"==typeof arguments[0]){var l=arguments[0];return yp.isNaN(l)?kp.createNaN():kp.copy(this).selfDivide(l,0)}},kp.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},kp.prototype.pow=function(t){if(0===t)return kp.valueOf(1);var e=new kp(this),n=kp.valueOf(1),i=Math.abs(t);if(1<i)for(;0<i;)i%2==1&&n.selfMultiply(e),0<(i/=2)&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},kp.prototype.ceil=function(){if(this.isNaN())return kp.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new kp(t,e)},kp.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},kp.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},kp.prototype.setValue=function(){if(arguments[0]instanceof kp){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},kp.prototype.max=function(t){return this.ge(t)?this:t},kp.prototype.sqrt=function(){if(this.isZero())return kp.valueOf(0);if(this.isNegative())return kp.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=kp.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},kp.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof kp){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e,n,i,r,o,s=arguments[0],a=null;return a=(i=this._hi+s)-(r=i-this._hi),n=(o=(a=s-r+(this._hi-a))+this._lo)+(i-(e=i+o)),this._hi=e+n,this._lo=n+(e-this._hi),this}}else if(2===arguments.length){var u,l,h,c,p=arguments[0],f=arguments[1],d=null,g=null,y=null;h=this._hi+p,l=this._lo+f,g=h-(y=h-this._hi),d=l-(c=l-this._lo);var _=(u=h+(y=(g=p-y+(this._hi-g))+l))+(y=(d=f-c+(this._lo-d))+(y+(h-u))),m=y+(u-_);return this._hi=_,this._lo=m,this}},kp.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof kp){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n,i,r=arguments[0],o=arguments[1],s=null,a=null,u=null,l=null;s=(u=kp.SPLIT*this._hi)-this._hi,l=kp.SPLIT*r,s=u-s,n=this._hi-s,a=l-r;var h=(u=this._hi*r)+(l=s*(a=l-a)-u+s*(i=r-a)+n*a+n*i+(this._hi*o+this._lo*r)),c=l+(s=u-h);return this._hi=h,this._lo=c,this}},kp.prototype.selfSqr=function(){return this.selfMultiply(this)},kp.prototype.floor=function(){if(this.isNaN())return kp.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new kp(t,e)},kp.prototype.negate=function(){return this.isNaN()?this:new kp(-this._hi,-this._lo)},kp.prototype.clone=function(){},kp.prototype.multiply=function(){if(arguments[0]instanceof kp){var t=arguments[0];return t.isNaN()?kp.createNaN():kp.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return yp.isNaN(e)?kp.createNaN():kp.copy(this).selfMultiply(e,0)}},kp.prototype.isNaN=function(){return yp.isNaN(this._hi)},kp.prototype.intValue=function(){return Math.trunc(this._hi)},kp.prototype.toString=function(){var t=kp.magnitude(this._hi);return-3<=t&&t<=20?this.toStandardNotation():this.toSciNotation()},kp.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+kp.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+kp.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},kp.prototype.reciprocal=function(){var t,e,n,i,r=null,o=null,s=null,a=null;t=(n=1/this._hi)-(r=(s=kp.SPLIT*n)-(r=s-n)),o=(a=kp.SPLIT*this._hi)-this._hi;var u=n+(s=(1-(i=n*this._hi)-(a=r*(o=a-o)-i+r*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new kp(u,n-u+s)},kp.prototype.toSciNotation=function(){if(this.isZero())return kp.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=kp.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";1<n.length&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},kp.prototype.abs=function(){return this.isNaN()?kp.NaN:this.isNegative()?this.negate():new kp(this)},kp.prototype.isPositive=function(){return(0<this._hi||0===this._hi)&&0<this._lo},kp.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},kp.prototype.add=function(){if(arguments[0]instanceof kp){var t=arguments[0];return kp.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return kp.copy(this).selfAdd(e)}},kp.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof kp){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}},kp.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},kp.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},kp.prototype.trunc=function(){return this.isNaN()?kp.NaN:this.isPositive()?this.floor():this.ceil()},kp.prototype.signum=function(){return 0<this._hi?1:this._hi<0?-1:0<this._lo?1:this._lo<0?-1:0},kp.prototype.interfaces_=function(){return[xp,mp,vp]},kp.prototype.getClass=function(){return kp},kp.sqr=function(t){return kp.valueOf(t).selfMultiply(t)},kp.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return kp.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new kp(e)}},kp.sqrt=function(t){return kp.valueOf(t).sqrt()},kp.parse=function(e){for(var t=0,n=e.length;Rp.isWhitespace(e.charAt(t));)t++;var i=!1;if(t<n){var r=e.charAt(t);"-"!==r&&"+"!==r||(t++,"-"===r&&(i=!0))}for(var o=new kp,s=0,a=0,u=0;!(n<=t);){var l=e.charAt(t);if(t++,Rp.isDigit(l)){var h=l-"0";o.selfMultiply(kp.TEN),o.selfAdd(h),s++}else{if("."!==l){if("e"!==l&&"E"!==l)throw new Error("Unexpected character '"+l+"' at position "+t+" in string "+e);var c=e.substring(t);try{u=Tp.parseInt(c)}catch(t){throw t instanceof Error?new Error("Invalid exponent "+c+" in string "+e):t}break}a=s}}var p=o,f=s-a-u;if(0===f)p=o;else if(0<f){var d=kp.TEN.pow(f);p=o.divide(d)}else if(f<0){var g=kp.TEN.pow(-f);p=o.multiply(g)}return i?p.negate():p},kp.createNaN=function(){return new kp(yp.NaN,yp.NaN)},kp.copy=function(t){return new kp(t)},kp.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},kp.stringOfChar=function(t,e){for(var n=new Op,i=0;i<e;i++)n.append(t);return n.toString()},Dp.PI.get=function(){return new kp(3.141592653589793,12246467991473532e-32)},Dp.TWO_PI.get=function(){return new kp(6.283185307179586,24492935982947064e-32)},Dp.PI_2.get=function(){return new kp(1.5707963267948966,6123233995736766e-32)},Dp.E.get=function(){return new kp(2.718281828459045,14456468917292502e-32)},Dp.NaN.get=function(){return new kp(yp.NaN,yp.NaN)},Dp.EPS.get=function(){return 123259516440783e-46},Dp.SPLIT.get=function(){return 134217729},Dp.MAX_PRINT_DIGITS.get=function(){return 32},Dp.TEN.get=function(){return kp.valueOf(10)},Dp.ONE.get=function(){return kp.valueOf(1)},Dp.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Dp.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(kp,Dp);var Ap=function(){},Fp={DP_SAFE_EPSILON:{configurable:!0}};Ap.prototype.interfaces_=function(){return[]},Ap.prototype.getClass=function(){return Ap},Ap.orientationIndex=function(t,e,n){var i=Ap.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=kp.valueOf(e.x).selfAdd(-t.x),o=kp.valueOf(e.y).selfAdd(-t.y),s=kp.valueOf(n.x).selfAdd(-e.x),a=kp.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},Ap.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},Ap.intersection=function(t,e,n,i){var r=kp.valueOf(i.y).selfSubtract(n.y).selfMultiply(kp.valueOf(e.x).selfSubtract(t.x)),o=kp.valueOf(i.x).selfSubtract(n.x).selfMultiply(kp.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=kp.valueOf(i.x).selfSubtract(n.x).selfMultiply(kp.valueOf(t.y).selfSubtract(n.y)),u=kp.valueOf(i.y).selfSubtract(n.y).selfMultiply(kp.valueOf(t.x).selfSubtract(n.x)),l=a.subtract(u).selfDivide(s).doubleValue(),h=kp.valueOf(t.x).selfAdd(kp.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),c=kp.valueOf(e.x).selfSubtract(t.x).selfMultiply(kp.valueOf(t.y).selfSubtract(n.y)),p=kp.valueOf(e.y).selfSubtract(t.y).selfMultiply(kp.valueOf(t.x).selfSubtract(n.x)),f=c.subtract(p).selfDivide(s).doubleValue(),d=kp.valueOf(n.y).selfAdd(kp.valueOf(i.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new Ep(h,d)},Ap.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(0<r){if(o<=0)return Ap.signum(s);i=r+o}else{if(!(r<0))return Ap.signum(s);if(0<=o)return Ap.signum(s);i=-r-o}var a=Ap.DP_SAFE_EPSILON*i;return a<=s||a<=-s?Ap.signum(s):2},Ap.signum=function(t){return 0<t?1:t<0?-1:0},Fp.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(Ap,Fp);var Gp=function(){},Bp={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Bp.X.get=function(){return 0},Bp.Y.get=function(){return 1},Bp.Z.get=function(){return 2},Bp.M.get=function(){return 3},Gp.prototype.setOrdinate=function(t,e,n){},Gp.prototype.size=function(){},Gp.prototype.getOrdinate=function(t,e){},Gp.prototype.getCoordinate=function(){},Gp.prototype.getCoordinateCopy=function(t){},Gp.prototype.getDimension=function(){},Gp.prototype.getX=function(t){},Gp.prototype.clone=function(){},Gp.prototype.expandEnvelope=function(t){},Gp.prototype.copy=function(){},Gp.prototype.getY=function(t){},Gp.prototype.toCoordinateArray=function(){},Gp.prototype.interfaces_=function(){return[vp]},Gp.prototype.getClass=function(){return Gp},Object.defineProperties(Gp,Bp);var Up=function(){},qp=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Up),jp=function(){};jp.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;s<e+r;s++)n[i+o]=t[s],o++},jp.getProperty=function(t){return{"line.separator":"\n"}[t]};var zp=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.x=n,this.y=i,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof Ep&&arguments[1]instanceof Ep){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var u=arguments[0],l=arguments[1],h=arguments[2];this.x=u,this.y=l,this.w=h}else if(4===arguments.length){var c=arguments[0],p=arguments[1],f=arguments[2],d=arguments[3],g=c.y-p.y,y=p.x-c.x,_=c.x*p.y-p.x*c.y,m=f.y-d.y,v=d.x-f.x,b=f.x*d.y-d.x*f.y;this.x=y*b-v*_,this.y=m*_-g*b,this.w=g*v-m*y}};zp.prototype.getY=function(){var t=this.y/this.w;if(yp.isNaN(t)||yp.isInfinite(t))throw new qp;return t},zp.prototype.getX=function(){var t=this.x/this.w;if(yp.isNaN(t)||yp.isInfinite(t))throw new qp;return t},zp.prototype.getCoordinate=function(){var t=new Ep;return t.x=this.getX(),t.y=this.getY(),t},zp.prototype.interfaces_=function(){return[]},zp.prototype.getClass=function(){return zp},zp.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,u=i.x-n.x,l=n.x*i.y-i.x*n.y,h=r*u-a*o,c=(o*l-u*s)/h,p=(a*s-r*l)/h;if(yp.isNaN(c)||yp.isInfinite(c)||yp.isNaN(p)||yp.isInfinite(p))throw new qp;return new Ep(c,p)};var Vp=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof Ep){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],u=arguments[3];this.init(o,s,a,u)}},Yp={serialVersionUID:{configurable:!0}};Vp.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Vp.prototype.equals=function(t){if(!(t instanceof Vp))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},Vp.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Vp;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new Vp(e,i,n,r)},Vp.prototype.isNull=function(){return this._maxx<this._minx},Vp.prototype.getMaxX=function(){return this._maxx},Vp.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof Ep){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof Vp){var e=arguments[0];return!this.isNull()&&!e.isNull()&&(e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&(n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy)}},Vp.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Vp){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof Ep){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||i>this._maxy||i<this._miny)}},Vp.prototype.getMinY=function(){return this._miny},Vp.prototype.getMinX=function(){return this._minx},Vp.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof Ep){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Vp){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}},Vp.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},Vp.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Vp.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},Vp.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},Vp.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Vp.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Vp.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Vp.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return e<t?t:e},Vp.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Vp.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof Vp){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof Ep){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},Vp.prototype.centre=function(){return this.isNull()?null:new Ep((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Vp.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof Ep){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Vp){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._maxx=r<o?(this._minx=r,o):(this._minx=o,r),this._maxy=s<a?(this._miny=s,a):(this._miny=a,s)}},Vp.prototype.getMaxY=function(){return this._maxy},Vp.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},Vp.prototype.hashCode=function(){var t=17;return t=37*(t=37*(t=37*(t=37*t+Ep.hashCode(this._minx))+Ep.hashCode(this._maxx))+Ep.hashCode(this._miny))+Ep.hashCode(this._maxy)},Vp.prototype.interfaces_=function(){return[mp,xp]},Vp.prototype.getClass=function(){return Vp},Vp.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),u=Math.max(o.x,s.x),l=Math.min(i.x,r.x),h=Math.max(i.x,r.x);return!(u<l)&&(!(h<a)&&(a=Math.min(o.y,s.y),u=Math.max(o.y,s.y),l=Math.min(i.y,r.y),h=Math.max(i.y,r.y),!(u<l)&&!(h<a)))}},Yp.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Vp,Yp);var Hp={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Xp=function(t){this.geometryFactory=t||new kd};Xp.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=Hp.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=Hp.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],Jp[n]&&(e=Jp[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Xp.prototype.write=function(t){return this.extractGeometry(t)},Xp.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Wp[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Wp[e].apply(this,[t])+")"};var Wp={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Wp.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Wp.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Wp.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Wp.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Wp.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Wp.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+Wp.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Wp.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},Jp={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Hp.spaces);return this.geometryFactory.createPoint(new Ep(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPoint();for(var n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Hp.trimParens,"$1"),i.push(Jp.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Hp.spaces),i.push(new Ep(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Hp.spaces),i.push(new Ep(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiLineString();for(var n=t.trim().split(Hp.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Hp.trimParens,"$1"),i.push(Jp.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){var e,n,i;if(void 0===t)return this.geometryFactory.createPolygon();for(var r,o=t.trim().split(Hp.parenComma),s=[],a=0,u=o.length;a<u;++a)e=o[a].replace(Hp.trimParens,"$1"),n=Jp.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var n=t.trim().split(Hp.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Hp.trimParens,"$1"),i.push(Jp.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}},Kp=function(t){this.parser=new Xp(t)};Kp.prototype.write=function(t){return this.parser.write(t)},Kp.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var Zp=function(e){function t(t){e.call(this,t),this.name="RuntimeException",this.message=t,this.stack=(new e).stack}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(Error),Qp=function(e){function t(){if(e.call(this),0===arguments.length)e.call(this);else if(1===arguments.length){var t=arguments[0];e.call(this,t)}}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Zp),$p=function(){};$p.prototype.interfaces_=function(){return[]},$p.prototype.getClass=function(){return $p},$p.shouldNeverReachHere=function(){if(0===arguments.length)$p.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new Qp("Should never reach here"+(null!==t?": "+t:""))}},$p.isTrue=function(){var t,e;if(1===arguments.length)t=arguments[0],$p.isTrue(t,null);else if(2===arguments.length&&(t=arguments[0],e=arguments[1],!t))throw null===e?new Qp:new Qp(e)},$p.equals=function(){var t,e,n;if(2===arguments.length)t=arguments[0],e=arguments[1],$p.equals(t,e,null);else if(3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],!e.equals(t)))throw new Qp("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var tf=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Ep,this._intPt[1]=new Ep,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},ef={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};tf.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},tf.prototype.getTopologySummary=function(){var t=new Op;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},tf.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},tf.prototype.getIntersectionNum=function(){return this._result},tf.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0],e=this.getEdgeDistance(t,0),n=this.getEdgeDistance(t,1);this._intLineIndex[t][1]=n<e?(this._intLineIndex[t][0]=0,1):(this._intLineIndex[t][0]=1,0)}},tf.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},tf.prototype.setPrecisionModel=function(t){this._precisionModel=t},tf.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},tf.prototype.getIntersection=function(t){return this._intPt[t]},tf.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},tf.prototype.hasIntersection=function(){return this._result!==tf.NO_INTERSECTION},tf.prototype.getEdgeDistance=function(t,e){return tf.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},tf.prototype.isCollinear=function(){return this._result===tf.COLLINEAR_INTERSECTION},tf.prototype.toString=function(){return Kp.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Kp.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},tf.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},tf.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},tf.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},tf.prototype.interfaces_=function(){return[]},tf.prototype.getClass=function(){return tf},tf.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r<i?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=r<i?s:a)||t.equals(e)||(o=Math.max(s,a))}return $p.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},tf.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return $p.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},ef.DONT_INTERSECT.get=function(){return 0},ef.DO_INTERSECT.get=function(){return 1},ef.COLLINEAR.get=function(){return 2},ef.NO_INTERSECTION.get=function(){return 0},ef.POINT_INTERSECTION.get=function(){return 1},ef.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(tf,ef);var nf=function(u){function s(){u.apply(this,arguments)}return u&&(s.__proto__=u),((s.prototype=Object.create(u&&u.prototype)).constructor=s).prototype.isInSegmentEnvelopes=function(t){var e=new Vp(this._inputLines[0][0],this._inputLines[0][1]),n=new Vp(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},s.prototype.computeIntersection=function(){if(3!==arguments.length)return u.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2];if(this._isProper=!1,Vp.intersects(e,n,t)&&0===sf.orientationIndex(e,n,t)&&0===sf.orientationIndex(n,e,t))return this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this._result=u.POINT_INTERSECTION,null;this._result=u.NO_INTERSECTION},s.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},s.prototype.safeHCoordinateIntersection=function(e,n,i,r){var o=null;try{o=zp.intersection(e,n,i,r)}catch(t){if(!(t instanceof qp))throw t;o=s.nearestEndpoint(e,n,i,r)}return o},s.prototype.intersection=function(t,e,n,i){var r=this.intersectionWithNormalization(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new Ep(s.nearestEndpoint(t,e,n,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(r),r},s.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},s.prototype.checkDD=function(t,e,n,i,r){var o=Ap.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);jp.out.println("DD in env = "+s+"  --------------------- "+o),1e-4<r.distance(o)&&jp.out.println("Distance = "+r.distance(o))},s.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new Ep(t),o=new Ep(e),s=new Ep(n),a=new Ep(i),u=new Ep;this.normalizeToEnvCentre(r,o,s,a,u);var l=this.safeHCoordinateIntersection(r,o,s,a);return l.x+=u.x,l.y+=u.y,l},s.prototype.computeCollinearIntersection=function(t,e,n,i){var r=Vp.intersects(t,e,n),o=Vp.intersects(t,e,i),s=Vp.intersects(n,i,t),a=Vp.intersects(n,i,e);return r&&o?(this._intPt[0]=n,this._intPt[1]=i,u.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=t,this._intPt[1]=e,u.COLLINEAR_INTERSECTION):r&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||o||a?u.COLLINEAR_INTERSECTION:u.POINT_INTERSECTION):r&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||o||s?u.COLLINEAR_INTERSECTION:u.POINT_INTERSECTION):o&&s?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||r||a?u.COLLINEAR_INTERSECTION:u.POINT_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||r||s?u.COLLINEAR_INTERSECTION:u.POINT_INTERSECTION):u.NO_INTERSECTION},s.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,h=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,p=n.y>i.y?n.y:i.y,f=((l<o?o:l)+(a<c?a:c))/2,d=((h<s?s:h)+(u<p?u:p))/2;r.x=f,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},s.prototype.computeIntersect=function(t,e,n,i){if(this._isProper=!1,!Vp.intersects(t,e,n,i))return u.NO_INTERSECTION;var r=sf.orientationIndex(t,e,n),o=sf.orientationIndex(t,e,i);if(0<r&&0<o||r<0&&o<0)return u.NO_INTERSECTION;var s=sf.orientationIndex(n,i,t),a=sf.orientationIndex(n,i,e);return 0<s&&0<a||s<0&&a<0?u.NO_INTERSECTION:0===r&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this._intPt[0]=e:0===r?this._intPt[0]=new Ep(n):0===o?this._intPt[0]=new Ep(i):0===s?this._intPt[0]=new Ep(t):0===a&&(this._intPt[0]=new Ep(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,i)),u.POINT_INTERSECTION)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.nearestEndpoint=function(t,e,n,i){var r=t,o=sf.distancePointLine(t,n,i),s=sf.distancePointLine(e,n,i);return s<o&&(o=s,r=e),(s=sf.distancePointLine(n,t,e))<o&&(o=s,r=n),(s=sf.distancePointLine(i,t,e))<o&&(o=s,r=i),r},s}(tf),rf=function(){};rf.prototype.interfaces_=function(){return[]},rf.prototype.getClass=function(){return rf},rf.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return rf.signOfDet2x2(i,r,o,s)},rf.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:0<e?0<n?-r:r:0<n?r:-r;if(0===e||0===n)return 0<i?0<t?r:-r:0<t?-r:r;if(0<e?0<i?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):i=e<=-i?(r=-r,n=-n,-i):(o=t,t=-n,n=o,o=e,e=-i,o):0<i?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):i=i<=e?(t=-t,e=-e,n=-n,-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,o),0<t){if(!(0<n))return r;if(!(t<=n))return r}else{if(0<n)return-r;if(!(n<=t))return-r;r=-r,t=-t,n=-n}for(;;){if((i-=(s=Math.floor(n/t))*e)<0)return-r;if(e<i)return r;if((n-=s*t)+n<t){if(e<i+i)return r}else{if(i+i<e)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if((e-=(s=Math.floor(t/n))*i)<0)return r;if(i<e)return-r;if((t-=s*n)+t<n){if(i<e+e)return-r}else{if(e+e<i)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var of=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};of.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return i<n&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,u=rf.signOfDet2x2(r,o,s,a);if(0===u)return this._isPointOnSegment=!0,null;a<o&&(u=-u),0<u&&this._crossingCount++}},of.prototype.isPointInPolygon=function(){return this.getLocation()!==Sp.EXTERIOR},of.prototype.getLocation=function(){return this._isPointOnSegment?Sp.BOUNDARY:this._crossingCount%2==1?Sp.INTERIOR:Sp.EXTERIOR},of.prototype.isOnSegment=function(){return this._isPointOnSegment},of.prototype.interfaces_=function(){return[]},of.prototype.getClass=function(){return of},of.locatePointInRing=function(){if(arguments[0]instanceof Ep&&Cp(arguments[1],Gp)){for(var t=arguments[0],e=arguments[1],n=new of(t),i=new Ep,r=new Ep,o=1;o<e.size();o++)if(e.getCoordinate(o,i),e.getCoordinate(o-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof Ep&&arguments[1]instanceof Array){for(var s=arguments[0],a=arguments[1],u=new of(s),l=1;l<a.length;l++){var h=a[l],c=a[l-1];if(u.countSegment(h,c),u.isOnSegment())return u.getLocation()}return u.getLocation()}};var sf=function(){},af={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};sf.prototype.interfaces_=function(){return[]},sf.prototype.getClass=function(){return sf},sf.orientationIndex=function(t,e,n){return Ap.orientationIndex(t,e,n)},sf.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(Cp(arguments[0],Gp)){var s=arguments[0],a=s.size();if(a<3)return 0;var u=new Ep,l=new Ep,h=new Ep;s.getCoordinate(0,l),s.getCoordinate(1,h);var c=l.x;h.x-=c;for(var p=0,f=1;f<a-1;f++)u.y=l.y,l.x=h.x,l.y=h.y,s.getCoordinate(f+1,h),h.x-=c,p+=l.x*(u.y-h.y);return p/2}},sf.distanceLineLine=function(t,e,n,i){if(t.equals(e))return sf.distancePointLine(t,n,i);if(n.equals(i))return sf.distancePointLine(i,t,e);var r=!1;if(Vp.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,u=s/o;(u<0||1<u||a<0||1<a)&&(r=!0)}}else r=!0;return r?Pp.min(sf.distancePointLine(t,n,i),sf.distancePointLine(e,n,i),sf.distancePointLine(n,t,e),sf.distancePointLine(i,t,e)):0},sf.isPointInRing=function(t,e){return sf.locatePointInRing(t,e)!==Sp.EXTERIOR},sf.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new Ep;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;s<e;s++){t.getCoordinate(s,i);var a=i.x,u=i.y,l=a-r,h=u-o;n+=Math.sqrt(l*l+h*h),r=a,o=u}return n},sf.isCCW=function(t){var e=t.length-1;if(e<3)throw new gp("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}for(var s=i;(s-=1)<0&&(s=e),t[s].equals2D(n)&&s!==i;);for(var a=i;t[a=(a+1)%e].equals2D(n)&&a!==i;);var u=t[s],l=t[a];if(u.equals2D(n)||l.equals2D(n)||u.equals2D(l))return!1;var h=sf.computeOrientation(u,n,l),c=!1;return c=0===h?u.x>l.x:0<h,c},sf.locatePointInRing=function(t,e){return of.locatePointInRing(t,e)},sf.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},sf.computeOrientation=function(t,e,n){return sf.orientationIndex(t,e,n)},sf.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new gp("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var r=sf.distancePointLine(t,e[i],e[i+1]);r<n&&(n=r)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var u=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),l=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/u;if(l<=0)return o.distance(s);if(1<=l)return o.distance(a);var h=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/u;return Math.abs(h)*Math.sqrt(u)}},sf.isOnLine=function(t,e){for(var n=new nf,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},af.CLOCKWISE.get=function(){return-1},af.RIGHT.get=function(){return sf.CLOCKWISE},af.COUNTERCLOCKWISE.get=function(){return 1},af.LEFT.get=function(){return sf.COUNTERCLOCKWISE},af.COLLINEAR.get=function(){return 0},af.STRAIGHT.get=function(){return sf.COLLINEAR},Object.defineProperties(sf,af);var uf=function(){};uf.prototype.filter=function(t){},uf.prototype.interfaces_=function(){return[]},uf.prototype.getClass=function(){return uf};var lf=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},hf={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};lf.prototype.isGeometryCollection=function(){return this.getSortIndex()===lf.SORTINDEX_GEOMETRYCOLLECTION},lf.prototype.getFactory=function(){return this._factory},lf.prototype.getGeometryN=function(t){return this},lf.prototype.getArea=function(){return 0},lf.prototype.isRectangle=function(){return!1},lf.prototype.equals=function(){if(arguments[0]instanceof lf){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof lf))return!1;var n=e;return this.equalsExact(n)}},lf.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},lf.prototype.geometryChanged=function(){this.apply(lf.geometryChangedFilter)},lf.prototype.geometryChangedAction=function(){this._envelope=null},lf.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},lf.prototype.getLength=function(){return 0},lf.prototype.getNumGeometries=function(){return 1},lf.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}},lf.prototype.getUserData=function(){return this._userData},lf.prototype.getSRID=function(){return this._SRID},lf.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},lf.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===lf.SORTINDEX_GEOMETRYCOLLECTION)throw new gp("This method does not support GeometryCollection arguments")},lf.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},lf.prototype.norm=function(){var t=this.copy();return t.normalize(),t},lf.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},lf.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Vp(this._envelope)},lf.prototype.setSRID=function(t){this._SRID=t},lf.prototype.setUserData=function(t){this._userData=t},lf.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},lf.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},lf.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===lf.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===lf.SORTINDEX_MULTIPOINT||this.getSortIndex()===lf.SORTINDEX_MULTILINESTRING||this.getSortIndex()===lf.SORTINDEX_MULTIPOLYGON},lf.prototype.interfaces_=function(){return[vp,mp,xp]},lf.prototype.getClass=function(){return lf},lf.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},lf.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},hf.serialVersionUID.get=function(){return 0x799ea46522854c00},hf.SORTINDEX_POINT.get=function(){return 0},hf.SORTINDEX_MULTIPOINT.get=function(){return 1},hf.SORTINDEX_LINESTRING.get=function(){return 2},hf.SORTINDEX_LINEARRING.get=function(){return 3},hf.SORTINDEX_MULTILINESTRING.get=function(){return 4},hf.SORTINDEX_POLYGON.get=function(){return 5},hf.SORTINDEX_MULTIPOLYGON.get=function(){return 6},hf.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},hf.geometryChangedFilter.get=function(){return cf},Object.defineProperties(lf,hf);var cf=function(){};cf.interfaces_=function(){return[uf]},cf.filter=function(t){t.geometryChangedAction()};var pf=function(){};pf.prototype.filter=function(t){},pf.prototype.interfaces_=function(){return[]},pf.prototype.getClass=function(){return pf};var ff=function(){},df={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};ff.prototype.isInBoundary=function(t){},ff.prototype.interfaces_=function(){return[]},ff.prototype.getClass=function(){return ff},df.Mod2BoundaryNodeRule.get=function(){return gf},df.EndPointBoundaryNodeRule.get=function(){return yf},df.MultiValentEndPointBoundaryNodeRule.get=function(){return _f},df.MonoValentEndPointBoundaryNodeRule.get=function(){return mf},df.MOD2_BOUNDARY_RULE.get=function(){return new gf},df.ENDPOINT_BOUNDARY_RULE.get=function(){return new yf},df.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new _f},df.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new mf},df.OGC_SFS_BOUNDARY_RULE.get=function(){return ff.MOD2_BOUNDARY_RULE},Object.defineProperties(ff,df);var gf=function(){};gf.prototype.isInBoundary=function(t){return t%2==1},gf.prototype.interfaces_=function(){return[ff]},gf.prototype.getClass=function(){return gf};var yf=function(){};yf.prototype.isInBoundary=function(t){return 0<t},yf.prototype.interfaces_=function(){return[ff]},yf.prototype.getClass=function(){return yf};var _f=function(){};_f.prototype.isInBoundary=function(t){return 1<t},_f.prototype.interfaces_=function(){return[ff]},_f.prototype.getClass=function(){return _f};var mf=function(){};mf.prototype.isInBoundary=function(t){return 1===t},mf.prototype.interfaces_=function(){return[ff]},mf.prototype.getClass=function(){return mf};var vf=function(){};vf.prototype.add=function(){},vf.prototype.addAll=function(){},vf.prototype.isEmpty=function(){},vf.prototype.iterator=function(){},vf.prototype.size=function(){},vf.prototype.toArray=function(){},vf.prototype.remove=function(){};var bf=function(e){function t(t){e.call(this),this.message=t||""}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={name:{configurable:!0}};return n.name.get=function(){return"IndexOutOfBoundsException"},Object.defineProperties(t,n),t}(Error),xf=function(){};xf.prototype.hasNext=function(){},xf.prototype.next=function(){},xf.prototype.remove=function(){};var Ef=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(vf);function wf(t){this.message=t||""}(wf.prototype=new Error).name="NoSuchElementException";var If=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof vf&&this.addAll(arguments[0])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,vf]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(t,arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new Lf(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new bf;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(Ef),Lf=function(e){function t(t){e.call(this),this.arrayList_=t,this.position_=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.next=function(){if(this.position_===this.arrayList_.size())throw new wf;return this.arrayList_.get(this.position_++)},t.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},t.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},t.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},t}(xf),Sf=function(v){function t(){if(v.call(this),0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}v&&(t.__proto__=v),(t.prototype=Object.create(v&&v.prototype)).constructor=t;var e={coordArrayType:{configurable:!0}};return e.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(t){return this.get(t)},t.prototype.addAll=function(){if(2!==arguments.length)return v.prototype.addAll.apply(this,arguments);for(var t=arguments[0],e=arguments[1],n=!1,i=t.iterator();i.hasNext();)this.add(i.next(),e),n=!0;return n},t.prototype.clone=function(){for(var t=v.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){if(1===arguments.length){var t=arguments[0];v.prototype.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}if(arguments[0]instanceof Ep&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1])if(1<=this.size())if(this.get(this.size()-1).equals2D(i))return null;v.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var r=arguments[0],o=arguments[1];return this.add(r,o),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var s=arguments[0],a=arguments[1];if(arguments[2])for(var u=0;u<s.length;u++)this.add(s[u],a);else for(var l=s.length-1;0<=l;l--)this.add(s[l],a);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof Ep){var h=arguments[0],c=arguments[1];if(!arguments[2]){var p=this.size();if(0<p){if(0<h)if(this.get(h-1).equals2D(c))return null;if(h<p)if(this.get(h).equals2D(c))return null}}v.prototype.add.call(this,h,c)}}else if(4===arguments.length){var f=arguments[0],d=arguments[1],g=arguments[2],y=arguments[3],_=1;y<g&&(_=-1);for(var m=g;m!==y;m+=_)this.add(f[m],d);return!0}},t.prototype.closeRing=function(){0<this.size()&&this.add(new Ep(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,e),t}(If),Mf=function(){},Cf={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Cf.ForwardComparator.get=function(){return Pf},Cf.BidirectionalComparator.get=function(){return Nf},Cf.coordArrayType.get=function(){return new Array(0).fill(null)},Mf.prototype.interfaces_=function(){return[]},Mf.prototype.getClass=function(){return Mf},Mf.isRing=function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])},Mf.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Mf.indexOf(i,e)<0)return i}return null},Mf.scroll=function(t,e){var n=Mf.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);jp.arraycopy(t,n,i,0,t.length-n),jp.arraycopy(t,0,i,t.length-n,n),jp.arraycopy(i,0,t,0,t.length)},Mf.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var s=0;s<i.length;s++)if(0!==o.compare(i[s],r[s]))return!1;return!0}},Mf.intersection=function(t,e){for(var n=new Sf,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Mf.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Mf.removeRepeatedPoints=function(t){return Mf.hasRepeatedPoints(t)?new Sf(t,!1).toCoordinateArray():t},Mf.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Mf.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},Mf.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new Ep(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],u=0;u<a;u++)o[s+u]=new Ep(i[r+u])},Mf.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Mf.envelope=function(t){for(var e=new Vp,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Mf.toCoordinateArray=function(t){return t.toArray(Mf.coordArrayType)},Mf.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Mf.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Mf.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Mf.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Mf.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||0<e.compareTo(t[n]))&&(e=t[n]);return e},Mf.extract=function(t,e,n){e=Pp.clamp(e,0,t.length);var i=(n=Pp.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;s<=n;s++)r[o++]=t[s];return r},Object.defineProperties(Mf,Cf);var Pf=function(){};Pf.prototype.compare=function(t,e){return Mf.compare(t,e)},Pf.prototype.interfaces_=function(){return[bp]},Pf.prototype.getClass=function(){return Pf};var Nf=function(){};Nf.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Mf.compare(n,i);return Mf.isEqualReversed(n,i)?0:r},Nf.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Mf.increasingDirection(n),o=Mf.increasingDirection(i),s=0<r?0:n.length-1,a=0<o?0:n.length-1,u=0;u<n.length;u++){var l=n[s].compareTo(i[a]);if(0!==l)return l;s+=r,a+=o}return 0},Nf.prototype.interfaces_=function(){return[bp]},Nf.prototype.getClass=function(){return Nf};var Of=function(){};Of.prototype.get=function(){},Of.prototype.put=function(){},Of.prototype.size=function(){},Of.prototype.values=function(){},Of.prototype.entrySet=function(){};var Tf=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(Of);function Rf(t){this.message=t||""}function kf(){}(Rf.prototype=new Error).name="OperationNotSupported",(kf.prototype=new vf).contains=function(){};var Df=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof vf&&this.addAll(arguments[0])}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++){if(this.array_[e]===t)return!0}return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Af(this)},e}(kf),Af=function(e){function t(t){e.call(this),this.hashSet_=t,this.position_=0}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.next=function(){if(this.position_===this.hashSet_.size())throw new wf;return this.hashSet_.array_[this.position_++]},t.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},t.prototype.remove=function(){throw new Rf},t}(xf),Ff=0;function Gf(t){return null===t?Ff:t.color}function Bf(t){return null===t?null:t.parent}function Uf(t,e){null!==t&&(t.color=e)}function qf(t){return null===t?null:t.left}function jf(t){return null===t?null:t.right}function zf(){this.root_=null,this.size_=0}(zf.prototype=new Tf).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(0<n))return e.value;e=e.right}}return null},zf.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Ff,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(0<i)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:Ff,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},zf.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(Bf(t)===qf(Bf(Bf(t)))){var e=jf(Bf(Bf(t)));1===Gf(e)?(Uf(Bf(t),Ff),Uf(e,Ff),Uf(Bf(Bf(t)),1),t=Bf(Bf(t))):(t===jf(Bf(t))&&(t=Bf(t),this.rotateLeft(t)),Uf(Bf(t),Ff),Uf(Bf(Bf(t)),1),this.rotateRight(Bf(Bf(t))))}else{var n=qf(Bf(Bf(t)));1===Gf(n)?(Uf(Bf(t),Ff),Uf(n,Ff),Uf(Bf(Bf(t)),1),t=Bf(Bf(t))):(t===qf(Bf(t))&&(t=Bf(t),this.rotateRight(t)),Uf(Bf(t),Ff),Uf(Bf(Bf(t)),1),this.rotateLeft(Bf(Bf(t))))}this.root_.color=Ff},zf.prototype.values=function(){var t=new If,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=zf.successor(e));)t.add(e.value);return t},zf.prototype.entrySet=function(){var t=new Df,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=zf.successor(e));)t.add(e);return t},zf.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,(e.left=t).parent=e}},zf.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,(e.right=t).parent=e}},zf.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},zf.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)n=(i=n).parent;return n},zf.prototype.size=function(){return this.size_};var Vf=function(){};function Yf(){}function Hf(){this.array_=[],arguments[0]instanceof vf&&this.addAll(arguments[0])}Vf.prototype.interfaces_=function(){return[]},Vf.prototype.getClass=function(){return Vf},Yf.prototype=new kf,(Hf.prototype=new Yf).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++){if(0===this.array_[e].compareTo(t))return!0}return!1},Hf.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++){if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0}return this.array_.push(t),!0},Hf.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Hf.prototype.remove=function(t){throw new Rf},Hf.prototype.size=function(){return this.array_.length},Hf.prototype.isEmpty=function(){return 0===this.array_.length},Hf.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},Hf.prototype.iterator=function(){return new Xf(this)};var Xf=function(t){this.treeSet_=t,this.position_=0};Xf.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new wf;return this.treeSet_.array_[this.position_++]},Xf.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Xf.prototype.remove=function(){throw new Rf};var Wf=function(){};Wf.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},Wf.asList=function(t){for(var e=new If,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};var Jf=function(){},Kf={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Kf.P.get=function(){return 0},Kf.L.get=function(){return 1},Kf.A.get=function(){return 2},Kf.FALSE.get=function(){return-1},Kf.TRUE.get=function(){return-2},Kf.DONTCARE.get=function(){return-3},Kf.SYM_FALSE.get=function(){return"F"},Kf.SYM_TRUE.get=function(){return"T"},Kf.SYM_DONTCARE.get=function(){return"*"},Kf.SYM_P.get=function(){return"0"},Kf.SYM_L.get=function(){return"1"},Kf.SYM_A.get=function(){return"2"},Jf.prototype.interfaces_=function(){return[]},Jf.prototype.getClass=function(){return Jf},Jf.toDimensionSymbol=function(t){switch(t){case Jf.FALSE:return Jf.SYM_FALSE;case Jf.TRUE:return Jf.SYM_TRUE;case Jf.DONTCARE:return Jf.SYM_DONTCARE;case Jf.P:return Jf.SYM_P;case Jf.L:return Jf.SYM_L;case Jf.A:return Jf.SYM_A}throw new gp("Unknown dimension value: "+t)},Jf.toDimensionValue=function(t){switch(Rp.toUpperCase(t)){case Jf.SYM_FALSE:return Jf.FALSE;case Jf.SYM_TRUE:return Jf.TRUE;case Jf.SYM_DONTCARE:return Jf.DONTCARE;case Jf.SYM_P:return Jf.P;case Jf.SYM_L:return Jf.L;case Jf.SYM_A:return Jf.A}throw new gp("Unknown dimension symbol: "+t)},Object.defineProperties(Jf,Kf);var Zf=function(){};Zf.prototype.filter=function(t){},Zf.prototype.interfaces_=function(){return[]},Zf.prototype.getClass=function(){return Zf};var Qf=function(){};Qf.prototype.filter=function(t,e){},Qf.prototype.isDone=function(){},Qf.prototype.isGeometryChanged=function(){},Qf.prototype.interfaces_=function(){return[]},Qf.prototype.getClass=function(){return Qf};var $f=function(r){function n(t,e){if(r.call(this,e),this._geometries=t||[],r.hasNullElements(this._geometries))throw new gp("geometries must not contain null elements")}r&&(n.__proto__=r);var t={serialVersionUID:{configurable:!0}};return((n.prototype=Object.create(r&&r.prototype)).constructor=n).prototype.computeEnvelopeInternal=function(){for(var t=new Vp,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},n.prototype.getGeometryN=function(t){return this._geometries[t]},n.prototype.getSortIndex=function(){return r.SORTINDEX_GEOMETRYCOLLECTION},n.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},n.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},n.prototype.equalsExact=function(){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._geometries.length!==n._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!this._geometries[i].equalsExact(n._geometries[i],e))return!1;return!0},n.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Wf.sort(this._geometries)},n.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},n.prototype.getBoundaryDimension=function(){for(var t=Jf.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},n.prototype.getDimension=function(){for(var t=Jf.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},n.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},n.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},n.prototype.getNumGeometries=function(){return this._geometries.length},n.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},n.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new Hf(Wf.asList(this._geometries)),n=new Hf(Wf.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o=i,s=this.getNumGeometries(),a=o.getNumGeometries(),u=0;u<s&&u<a;){var l=this.getGeometryN(u),h=o.getGeometryN(u),c=l.compareToSameClass(h,r);if(0!==c)return c;u++}return u<s?1:u<a?-1:0}},n.prototype.apply=function(){if(Cp(arguments[0],pf))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(Cp(arguments[0],Qf)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(Cp(arguments[0],Zf)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(Cp(arguments[0],uf)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},n.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),$p.shouldNeverReachHere(),null},n.prototype.clone=function(){var t=r.prototype.clone.call(this);t._geometries=new Array(this._geometries.length).fill(null);for(var e=0;e<this._geometries.length;e++)t._geometries[e]=this._geometries[e].clone();return t},n.prototype.getGeometryType=function(){return"GeometryCollection"},n.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)},n.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},t.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(n,t),n}(lf),td=function(n){function i(){n.apply(this,arguments)}n&&(i.__proto__=n);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getSortIndex=function(){return lf.SORTINDEX_MULTILINESTRING},i.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&n.prototype.equalsExact.call(this,t,e)},i.prototype.getBoundaryDimension=function(){return this.isClosed()?Jf.FALSE:0},i.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},i.prototype.getDimension=function(){return 1},i.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},i.prototype.getBoundary=function(){return new ed(this).getBoundary()},i.prototype.getGeometryType=function(){return"MultiLineString"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.interfaces_=function(){return[Vf]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(i,t),i}($f),ed=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=ff.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}};ed.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},ed.prototype.getBoundary=function(){return this._geom instanceof pd?this.boundaryLineString(this._geom):this._geom instanceof td?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},ed.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},ed.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},ed.prototype.computeBoundaryCoordinates=function(t){var e=new If;this._endpointMap=new zf;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Mf.toCoordinateArray(e)},ed.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new nd,this._endpointMap.put(t,e)),e.count++},ed.prototype.interfaces_=function(){return[]},ed.prototype.getClass=function(){return ed},ed.getBoundary=function(){if(1===arguments.length){var t=arguments[0];return new ed(t).getBoundary()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new ed(e,n).getBoundary()}};var nd=function(){this.count=null};function id(){}function rd(){}nd.prototype.interfaces_=function(){return[]},nd.prototype.getClass=function(){return nd};var od=function(){};function sd(){}function ad(){}function ud(){}var ld=function(){},hd={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};ld.prototype.interfaces_=function(){return[]},ld.prototype.getClass=function(){return ld},ld.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},ld.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new sd,n=new id(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",s=new ud(new rd(ld.getStackTrace(i))),a=0;a<r;a++)try{o+=s.readLine()+ld.NEWLINE}catch(t){if(!(t instanceof ad))throw t;$p.shouldNeverReachHere()}return o}},ld.split=function(t,e){for(var n=e.length,i=new If,r=""+t,o=r.indexOf(e);0<=o;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}0<r.length&&i.add(r);for(var a=new Array(i.size()).fill(null),u=0;u<a.length;u++)a[u]=i.get(u);return a},ld.toString=function(){if(1===arguments.length){var t=arguments[0];return ld.SIMPLE_ORDINATE_FORMAT.format(t)}},ld.spaces=function(t){return ld.chars(" ",t)},hd.NEWLINE.get=function(){return jp.getProperty("line.separator")},hd.SIMPLE_ORDINATE_FORMAT.get=function(){return new od("0.#")},Object.defineProperties(ld,hd);var cd=function(){};cd.prototype.interfaces_=function(){return[]},cd.prototype.getClass=function(){return cd},cd.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},cd.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&(t.getOrdinate(0,Gp.X)===t.getOrdinate(e-1,Gp.X)&&t.getOrdinate(0,Gp.Y)===t.getOrdinate(e-1,Gp.Y))},cd.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(t.getOrdinate(r,o)!==e.getOrdinate(r,o)&&(!yp.isNaN(s)||!yp.isNaN(a)))return!1}return!0},cd.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(cd.copy(e,0,i,0,r),0<r)for(var o=r;o<n;o++)cd.copy(e,r-1,i,o,1);return i},cd.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)cd.swap(t,i,e-i)},cd.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},cd.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)cd.copyCoord(t,e+o,n,i+o)},cd.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new Op;i.append("(");for(var r=0;r<e;r++){0<r&&i.append(" ");for(var o=0;o<n;o++)0<o&&i.append(","),i.append(ld.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},cd.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?cd.createClosedRing(t,e,4):e.getOrdinate(0,Gp.X)===e.getOrdinate(n-1,Gp.X)&&e.getOrdinate(0,Gp.Y)===e.getOrdinate(n-1,Gp.Y)?e:cd.createClosedRing(t,e,n+1)},cd.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();cd.copy(e,0,i,0,r);for(var o=r;o<n;o++)cd.copy(e,0,i,o,1);return i};var pd=function(r){function e(t,e){r.call(this,e),this._points=null,this.init(t)}r&&(e.__proto__=r);var t={serialVersionUID:{configurable:!0}};return((e.prototype=Object.create(r&&r.prototype)).constructor=e).prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Vp:this._points.expandEnvelope(new Vp)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return r.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._points.size()!==n._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!this.equal(this._points.getCoordinate(i),n._points.getCoordinate(i),e))return!1;return!0},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return 0<this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))&&cd.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Jf.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return sf.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return cd.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(Cp(arguments[0],pf))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(Cp(arguments[0],Qf)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(Cp(arguments[0],Zf)){arguments[0].filter(this)}else if(Cp(arguments[0],uf)){arguments[0].filter(this)}},e.prototype.getBoundary=function(){return new ed(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var t=r.prototype.clone.call(this);return t._points=this._points.clone(),t},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new gp("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Vf]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,t),e}(lf),fd=function(){};fd.prototype.interfaces_=function(){return[]},fd.prototype.getClass=function(){return fd};var dd=function(n){function t(t,e){n.call(this,e),this._coordinates=t||null,this.init(this._coordinates)}n&&(t.__proto__=n);var e={serialVersionUID:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Vp;var t=new Vp;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},t.prototype.getSortIndex=function(){return n.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return Jf.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},t.prototype.apply=function(){if(Cp(arguments[0],pf)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(Cp(arguments[0],Qf)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else if(Cp(arguments[0],Zf)){arguments[0].filter(this)}else if(Cp(arguments[0],uf)){arguments[0].filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var t=n.prototype.clone.call(this);return t._coordinates=this._coordinates.clone(),t},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return 0===this._coordinates.size()},t.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),$p.isTrue(t.size()<=1),this._coordinates=t},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[fd]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(t,e),t}(lf),gd=function(){};gd.prototype.interfaces_=function(){return[]},gd.prototype.getClass=function(){return gd};var yd=function(s){function i(t,e,n){if(s.call(this,n),this._shell=null,(this._holes=null)===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),s.hasNullElements(e))throw new gp("holes must not contain null elements");if(t.isEmpty()&&s.hasNonEmptyElements(e))throw new gp("shell is empty but holes are not");this._shell=t,this._holes=e}s&&(i.__proto__=s);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(s&&s.prototype)).constructor=i).prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},i.prototype.getSortIndex=function(){return s.SORTINDEX_POLYGON},i.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},i.prototype.getArea=function(){var t=0;t+=Math.abs(sf.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(sf.signedArea(this._holes[e].getCoordinateSequence()));return t},i.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var u=t.getX(a),l=t.getY(a);if(u!==o===(l!==s))return!1;o=u,s=l}return!0},i.prototype.equalsExact=function(){if(2!==arguments.length)return s.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,i=this._shell,r=n._shell;if(!i.equalsExact(r,e))return!1;if(this._holes.length!==n._holes.length)return!1;for(var o=0;o<this._holes.length;o++)if(!this._holes[o].equalsExact(n._holes[o],e))return!1;return!0},i.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);Wf.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);jp.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=Mf.minCoordinate(e.getCoordinates());Mf.scroll(i,r),jp.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],sf.isCCW(e.getCoordinates())===n&&Mf.reverse(e.getCoordinates())}},i.prototype.getCoordinate=function(){return this._shell.getCoordinate()},i.prototype.getNumInteriorRing=function(){return this._holes.length},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},i.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},i.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},i.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},i.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],o=i,s=this._shell,a=o._shell,u=s.compareToSameClass(a,r);if(0!==u)return u;for(var l=this.getNumInteriorRing(),h=o.getNumInteriorRing(),c=0;c<l&&c<h;){var p=this.getInteriorRingN(c),f=o.getInteriorRingN(c),d=p.compareToSameClass(f,r);if(0!==d)return d;c++}return c<l?1:c<h?-1:0}},i.prototype.apply=function(t){if(Cp(t,pf)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(Cp(t,Qf)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(Cp(t,Zf))t.filter(this);else if(Cp(t,uf)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},i.prototype.clone=function(){var t=s.prototype.clone.call(this);t._shell=this._shell.clone(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].clone();return t},i.prototype.getGeometryType=function(){return"Polygon"},i.prototype.copy=function(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),n=0;n<e.length;n++)e[n]=this._holes[n].copy();return new i(t,e,this._factory)},i.prototype.getExteriorRing=function(){return this._shell},i.prototype.isEmpty=function(){return this._shell.isEmpty()},i.prototype.getInteriorRingN=function(t){return this._holes[t]},i.prototype.interfaces_=function(){return[gd]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(i,t),i}(lf),_d=function(n){function i(){n.apply(this,arguments)}n&&(i.__proto__=n);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getSortIndex=function(){return lf.SORTINDEX_MULTIPOINT},i.prototype.isValid=function(){return!0},i.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&n.prototype.equalsExact.call(this,t,e)},i.prototype.getCoordinate=function(){if(1!==arguments.length)return n.prototype.getCoordinate.apply(this,arguments);var t=arguments[0];return this._geometries[t].getCoordinate()},i.prototype.getBoundaryDimension=function(){return Jf.FALSE},i.prototype.getDimension=function(){return 0},i.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},i.prototype.getGeometryType=function(){return"MultiPoint"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.interfaces_=function(){return[fd]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(i,t),i}($f),md=function(n){function t(t,e){t instanceof Ep&&e instanceof kd&&(t=e.getCoordinateSequenceFactory().create(t)),n.call(this,t,e),this.validateConstruction()}n&&(t.__proto__=n);var e={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.getSortIndex=function(){return lf.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return Jf.FALSE},t.prototype.isClosed=function(){return!!this.isEmpty()||n.prototype.isClosed.call(this)},t.prototype.reverse=function(){var t=this._points.copy();return cd.reverse(t),this.getFactory().createLinearRing(t)},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!n.prototype.isClosed.call(this))throw new gp("Points of LinearRing do not form a closed linestring");if(1<=this.getCoordinateSequence().size()&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new gp("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.MINIMUM_VALID_SIZE.get=function(){return 4},e.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,e),t}(pd),vd=function(n){function i(){n.apply(this,arguments)}n&&(i.__proto__=n);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getSortIndex=function(){return lf.SORTINDEX_MULTIPOLYGON},i.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&n.prototype.equalsExact.call(this,t,e)},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new If,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},i.prototype.getGeometryType=function(){return"MultiPolygon"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.interfaces_=function(){return[gd]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(i,t),i}($f),bd=function(t){this._factory=t||null,this._isUserDataCopied=!1},xd={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};bd.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},bd.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},bd.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof $f?this.editGeometryCollection(t,e):t instanceof yd?this.editPolygon(t,e):t instanceof dd?e.edit(t,this._factory):t instanceof pd?e.edit(t,this._factory):($p.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},bd.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new If,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===_d?this._factory.createMultiPoint(i.toArray([])):n.getClass()===td?this._factory.createMultiLineString(i.toArray([])):n.getClass()===vd?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},bd.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new If,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(i,r.toArray([]))},bd.prototype.interfaces_=function(){return[]},bd.prototype.getClass=function(){return bd},bd.GeometryEditorOperation=function(){},xd.NoOpGeometryOperation.get=function(){return Ed},xd.CoordinateOperation.get=function(){return wd},xd.CoordinateSequenceOperation.get=function(){return Id},Object.defineProperties(bd,xd);var Ed=function(){};Ed.prototype.edit=function(t,e){return t},Ed.prototype.interfaces_=function(){return[bd.GeometryEditorOperation]},Ed.prototype.getClass=function(){return Ed};var wd=function(){};wd.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof md?e.createLinearRing(n):t instanceof pd?e.createLineString(n):t instanceof dd?0<n.length?e.createPoint(n[0]):e.createPoint():t},wd.prototype.interfaces_=function(){return[bd.GeometryEditorOperation]},wd.prototype.getClass=function(){return wd};var Id=function(){};Id.prototype.edit=function(t,e){return t instanceof md?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof pd?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof dd?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},Id.prototype.interfaces_=function(){return[bd.GeometryEditorOperation]},Id.prototype.getClass=function(){return Id};var Ld=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new Ep}else if(Cp(arguments[0],Gp)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var i=0;i<this._coordinates.length;i++)this._coordinates[i]=n.getCoordinateCopy(i)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this._coordinates=r,this._dimension=o,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var u=0;u<s;u++)this._coordinates[u]=new Ep}},Sd={serialVersionUID:{configurable:!0}};Ld.prototype.setOrdinate=function(t,e,n){switch(e){case Gp.X:this._coordinates[t].x=n;break;case Gp.Y:this._coordinates[t].y=n;break;case Gp.Z:this._coordinates[t].z=n;break;default:throw new gp("invalid ordinateIndex")}},Ld.prototype.size=function(){return this._coordinates.length},Ld.prototype.getOrdinate=function(t,e){switch(e){case Gp.X:return this._coordinates[t].x;case Gp.Y:return this._coordinates[t].y;case Gp.Z:return this._coordinates[t].z}return yp.NaN},Ld.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},Ld.prototype.getCoordinateCopy=function(t){return new Ep(this._coordinates[t])},Ld.prototype.getDimension=function(){return this._dimension},Ld.prototype.getX=function(t){return this._coordinates[t].x},Ld.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new Ld(t,this._dimension)},Ld.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},Ld.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Ld(t,this._dimension)},Ld.prototype.toString=function(){if(0<this._coordinates.length){var t=new Op(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},Ld.prototype.getY=function(t){return this._coordinates[t].y},Ld.prototype.toCoordinateArray=function(){return this._coordinates},Ld.prototype.interfaces_=function(){return[Gp,xp]},Ld.prototype.getClass=function(){return Ld},Sd.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Ld,Sd);var Md=function(){},Cd={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Md.prototype.readResolve=function(){return Md.instance()},Md.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new Ld(t)}if(Cp(arguments[0],Gp)){var e=arguments[0];return new Ld(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return 3<i&&(i=3),i<2?new Ld(n):new Ld(n,i)}},Md.prototype.interfaces_=function(){return[Lp,xp]},Md.prototype.getClass=function(){return Md},Md.instance=function(){return Md.instanceObject},Cd.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},Cd.instanceObject.get=function(){return new Md},Object.defineProperties(Md,Cd);var Pd=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new If,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var e=new Df;return this.map_.entries().forEach(function(t){return e.add(t)}),e},e.prototype.size=function(){return this.map_.size()},e}(Of),Nd=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Td){var e=arguments[0];(this._modelType=e)===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}},Od={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Nd.prototype.equals=function(t){if(!(t instanceof Nd))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},Nd.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new Tp(n).compareTo(new Tp(i))},Nd.prototype.getScale=function(){return this._scale},Nd.prototype.isFloating=function(){return this._modelType===Nd.FLOATING||this._modelType===Nd.FLOATING_SINGLE},Nd.prototype.getType=function(){return this._modelType},Nd.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Nd.FLOATING?t="Floating":this._modelType===Nd.FLOATING_SINGLE?t="Floating-Single":this._modelType===Nd.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},Nd.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return yp.isNaN(t)?t:this._modelType!==Nd.FLOATING_SINGLE&&this._modelType===Nd.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof Ep){var e=arguments[0];if(this._modelType===Nd.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},Nd.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Nd.FLOATING?t=16:this._modelType===Nd.FLOATING_SINGLE?t=6:this._modelType===Nd.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},Nd.prototype.setScale=function(t){this._scale=Math.abs(t)},Nd.prototype.interfaces_=function(){return[xp,mp]},Nd.prototype.getClass=function(){return Nd},Nd.mostPrecise=function(t,e){return 0<=t.compareTo(e)?t:e},Od.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Od.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Nd,Od);var Td=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},Rd={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Td.prototype.readResolve=function(){return Td.nameToTypeMap.get(this._name)},Td.prototype.toString=function(){return this._name},Td.prototype.interfaces_=function(){return[xp]},Td.prototype.getClass=function(){return Td},Rd.serialVersionUID.get=function(){return-552860263173159e4},Rd.nameToTypeMap.get=function(){return new Pd},Object.defineProperties(Td,Rd),Nd.Type=Td,Nd.FIXED=new Td("FIXED"),Nd.FLOATING=new Td("FLOATING"),Nd.FLOATING_SINGLE=new Td("FLOATING SINGLE");var kd=function t(){this._precisionModel=new Nd,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Cp(arguments[0],Lp)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Nd&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Dd={serialVersionUID:{configurable:!0}};kd.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new Ep(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new Ep(t.getMinX(),t.getMinY()),new Ep(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new Ep(t.getMinX(),t.getMinY()),new Ep(t.getMinX(),t.getMaxY()),new Ep(t.getMaxX(),t.getMaxY()),new Ep(t.getMaxX(),t.getMinY()),new Ep(t.getMinX(),t.getMinY())]),null)},kd.prototype.createLineString=function(t){return t?t instanceof Array?new pd(this.getCoordinateSequenceFactory().create(t),this):Cp(t,Gp)?new pd(t,this):void 0:new pd(this.getCoordinateSequenceFactory().create([]),this)},kd.prototype.createMultiLineString=function(){if(0===arguments.length)return new td(null,this);if(1===arguments.length){var t=arguments[0];return new td(t,this)}},kd.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(kd.toGeometryArray(t));var a=t.iterator().next();if(1<t.size()){if(a instanceof yd)return this.createMultiPolygon(kd.toPolygonArray(t));if(a instanceof pd)return this.createMultiLineString(kd.toLineStringArray(t));if(a instanceof dd)return this.createMultiPoint(kd.toPointArray(t));$p.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},kd.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},kd.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Ep){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(Cp(arguments[0],Gp)){var e=arguments[0];return new dd(e,this)}}},kd.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},kd.prototype.createPolygon=function(){if(0===arguments.length)return new yd(null,null,this);if(1===arguments.length){if(Cp(arguments[0],Gp)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof md){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return new yd(i,r,this)}},kd.prototype.getSRID=function(){return this._SRID},kd.prototype.createGeometryCollection=function(){if(0===arguments.length)return new $f(null,this);if(1===arguments.length){var t=arguments[0];return new $f(t,this)}},kd.prototype.createGeometry=function(t){return new bd(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},kd.prototype.getPrecisionModel=function(){return this._precisionModel},kd.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(Cp(arguments[0],Gp)){var e=arguments[0];return new md(e,this)}}},kd.prototype.createMultiPolygon=function(){if(0===arguments.length)return new vd(null,this);if(1===arguments.length){var t=arguments[0];return new vd(t,this)}},kd.prototype.createMultiPoint=function(){if(0===arguments.length)return new _d(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new _d(t,this)}if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(Cp(arguments[0],Gp)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var i=new Array(n.size()).fill(null),r=0;r<n.size();r++){var o=this.getCoordinateSequenceFactory().create(1,n.getDimension());cd.copy(n,r,o,0,1),i[r]=this.createPoint(o)}return this.createMultiPoint(i)}}},kd.prototype.interfaces_=function(){return[xp]},kd.prototype.getClass=function(){return kd},kd.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},kd.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},kd.getDefaultCoordinateSequenceFactory=function(){return Md.instance()},kd.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},kd.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},kd.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},kd.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},kd.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},kd.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},kd.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},Dd.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(kd,Dd);var Ad=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Fd=function(t){this.geometryFactory=t||new kd};Fd.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!Gd[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Ad.indexOf(n)?Gd[n].apply(this,[e.coordinates]):"GeometryCollection"===n?Gd[n].apply(this,[e.geometries]):Gd[n].apply(this,[e])},Fd.prototype.write=function(t){var e=t.getGeometryType();if(!Bd[e])throw new Error("Geometry is not supported");return Bd[e].apply(this,[t])};var Gd={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!Gd[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=Gd.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new Ep(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new Ep(t[0],t[1]),new Ep(t[2],t[1]),new Ep(t[2],t[3]),new Ep(t[0],t[3]),new Ep(t[0],t[1])])},Point:function(t){var e=new Ep(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Gd.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=Gd.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Gd.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=Gd.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=Gd.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(Gd.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},Bd={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:Bd.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Bd.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(Bd.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Bd.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=Bd.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=Bd.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Bd.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(Bd[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}},Ud=function(t){this.geometryFactory=t||new kd,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Fd(this.geometryFactory)};Ud.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Nd.FIXED&&this.reducePrecision(e),e},Ud.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var qd=function(){this.parser=new Fd(this.geometryFactory)};qd.prototype.write=function(t){return this.parser.write(t)};var jd=function(){},zd={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};function Vd(t){this.message=t||""}function Yd(){this.array_=[]}jd.prototype.interfaces_=function(){return[]},jd.prototype.getClass=function(){return jd},jd.opposite=function(t){return t===jd.LEFT?jd.RIGHT:t===jd.RIGHT?jd.LEFT:t},zd.ON.get=function(){return 0},zd.LEFT.get=function(){return 1},zd.RIGHT.get=function(){return 2},Object.defineProperties(jd,zd),(Vd.prototype=new Error).name="EmptyStackException",(Yd.prototype=new Ef).add=function(t){return this.array_.push(t),!0},Yd.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},Yd.prototype.push=function(t){return this.array_.push(t),t},Yd.prototype.pop=function(t){if(0===this.array_.length)throw new Vd;return this.array_.pop()},Yd.prototype.peek=function(){if(0===this.array_.length)throw new Vd;return this.array_[this.array_.length-1]},Yd.prototype.empty=function(){return 0===this.array_.length},Yd.prototype.isEmpty=function(){return this.empty()},Yd.prototype.search=function(t){return this.array_.indexOf(t)},Yd.prototype.size=function(){return this.array_.length},Yd.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Hd=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Hd.prototype.getCoordinate=function(){return this._minCoord},Hd.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Hd.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();$p.isTrue(0<this._minIndex&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=sf.computeOrientation(this._minCoord,n,e),r=!1;e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===sf.COUNTERCLOCKWISE?r=!0:e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===sf.CLOCKWISE&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Hd.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=jd.LEFT;return n[e].y<n[e+1].y&&(i=jd.RIGHT),i},Hd.prototype.getEdge=function(){return this._orientedDe},Hd.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Hd.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Hd.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}$p.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===jd.LEFT&&(this._orientedDe=this._minDe.getSym())},Hd.prototype.interfaces_=function(){return[]},Hd.prototype.getClass=function(){return Hd};var Xd=function(n){function i(t,e){n.call(this,i.msgWithCoord(t,e)),this.pt=e?new Ep(e):null,this.name="TopologyException"}return n&&(i.__proto__=n),((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getCoordinate=function(){return this.pt},i.prototype.interfaces_=function(){return[]},i.prototype.getClass=function(){return i},i.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},i}(Zp),Wd=function(){this.array_=[]};Wd.prototype.addLast=function(t){this.array_.push(t)},Wd.prototype.removeFirst=function(){return this.array_.shift()},Wd.prototype.isEmpty=function(){return 0===this.array_.length};var Jd=function(){this._finder=null,this._dirEdgeList=new If,this._nodes=new If,this._rightMostCoord=null,this._env=null,this._finder=new Hd};Jd.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){t.next().setVisited(!1)}},Jd.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Jd.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new Xd("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},Jd.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(jd.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Jd.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Jd.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();1<=e.getDepth(jd.RIGHT)&&e.getDepth(jd.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Jd.prototype.computeDepths=function(t){var e=new Df,n=new Wd,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},Jd.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Jd.prototype.getEnvelope=function(){if(null===this._env){for(var t=new Vp,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},Jd.prototype.addReachable=function(t){var e=new Yd;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Jd.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(jd.LEFT,t.getDepth(jd.RIGHT)),e.setDepth(jd.RIGHT,t.getDepth(jd.LEFT))},Jd.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},Jd.prototype.getNodes=function(){return this._nodes},Jd.prototype.getDirectedEdges=function(){return this._dirEdgeList},Jd.prototype.interfaces_=function(){return[mp]},Jd.prototype.getClass=function(){return Jd};var Kd=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[jd.ON]=n}else if(arguments[0]instanceof t){var i=arguments[0];if(this.init(i.location.length),null!==i)for(var r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[jd.ON]=o,this.location[jd.LEFT]=s,this.location[jd.RIGHT]=a}};Kd.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Kd.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==Sp.NONE)return!1;return!0},Kd.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===Sp.NONE&&(this.location[e]=t)},Kd.prototype.isLine=function(){return 1===this.location.length},Kd.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[jd.ON]=this.location[jd.ON],e[jd.LEFT]=Sp.NONE,e[jd.RIGHT]=Sp.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===Sp.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Kd.prototype.getLocations=function(){return this.location},Kd.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[jd.LEFT];this.location[jd.LEFT]=this.location[jd.RIGHT],this.location[jd.RIGHT]=t},Kd.prototype.toString=function(){var t=new Op;return 1<this.location.length&&t.append(Sp.toLocationSymbol(this.location[jd.LEFT])),t.append(Sp.toLocationSymbol(this.location[jd.ON])),1<this.location.length&&t.append(Sp.toLocationSymbol(this.location[jd.RIGHT])),t.toString()},Kd.prototype.setLocations=function(t,e,n){this.location[jd.ON]=t,this.location[jd.LEFT]=e,this.location[jd.RIGHT]=n},Kd.prototype.get=function(t){return t<this.location.length?this.location[t]:Sp.NONE},Kd.prototype.isArea=function(){return 1<this.location.length},Kd.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===Sp.NONE)return!0;return!1},Kd.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(jd.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Kd.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(Sp.NONE)},Kd.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Kd.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Kd.prototype.interfaces_=function(){return[]},Kd.prototype.getClass=function(){return Kd};var Zd=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Kd(e),this.elt[1]=new Kd(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Kd(n.elt[0]),this.elt[1]=new Kd(n.elt[1])}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.elt[0]=new Kd(Sp.NONE),this.elt[1]=new Kd(Sp.NONE),this.elt[i].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Kd(o,s,a),this.elt[1]=new Kd(o,s,a)}else if(4===arguments.length){var u=arguments[0],l=arguments[1],h=arguments[2],c=arguments[3];this.elt[0]=new Kd(Sp.NONE,Sp.NONE,Sp.NONE),this.elt[1]=new Kd(Sp.NONE,Sp.NONE,Sp.NONE),this.elt[u].setLocations(l,h,c)}};Zd.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Zd.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Zd.prototype.isNull=function(t){return this.elt[t].isNull()},Zd.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},Zd.prototype.isLine=function(t){return this.elt[t].isLine()},Zd.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Kd(t.elt[e]):this.elt[e].merge(t.elt[e])},Zd.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Zd.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(jd.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},Zd.prototype.toString=function(){var t=new Op;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Zd.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Zd.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Zd.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(jd.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},Zd.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Zd.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Zd.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Kd(this.elt[t].location[0]))},Zd.prototype.interfaces_=function(){return[]},Zd.prototype.getClass=function(){return Zd},Zd.toLineLabel=function(t){for(var e=new Zd(Sp.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Qd=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new If,this._pts=new If,this._label=new Zd(Sp.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new If,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Qd.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=sf.isCCW(this._ring.getCoordinates())},Qd.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Qd.prototype.computePoints=function(t){var e=this._startDe=t,n=!0;do{if(null===e)throw new Xd("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Xd("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();$p.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Qd.prototype.getLinearRing=function(){return this._ring},Qd.prototype.getCoordinate=function(t){return this._pts.get(t)},Qd.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Qd.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var s=i.length-2;n&&(s=i.length-1);for(var a=s;0<=a;a--)this._pts.add(i[a])}},Qd.prototype.isHole=function(){return this._isHole},Qd.prototype.setInResult=function(){for(var t=this._startDe;t.getEdge().setInResult(!0),(t=t.getNext())!==this._startDe;);},Qd.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!sf.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();){if(n.next().containsPoint(t))return!1}return!0},Qd.prototype.addHole=function(t){this._holes.add(t)},Qd.prototype.isShell=function(){return null===this._shell},Qd.prototype.getLabel=function(){return this._label},Qd.prototype.getEdges=function(){return this._edges},Qd.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Qd.prototype.getShell=function(){return this._shell},Qd.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e.getLocation(n,jd.RIGHT);if(i===Sp.NONE)return null;if(this._label.getLocation(n)===Sp.NONE)return this._label.setLocation(n,i),null}},Qd.prototype.setShell=function(t){null!==(this._shell=t)&&t.addHole(this)},Qd.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Qd.prototype.interfaces_=function(){return[]},Qd.prototype.getClass=function(){return Qd};var $d=function(n){function t(){var t=arguments[0],e=arguments[1];n.call(this,t,e)}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},t.prototype.getNext=function(t){return t.getNextMin()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Qd),tg=function(n){function t(){var t=arguments[0],e=arguments[1];n.call(this,t,e)}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.buildMinimalRings=function(){var t=new If,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new $d(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},t.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},t.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},t.prototype.getNext=function(t){return t.getNext()},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Qd),eg=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};eg.prototype.setVisited=function(t){this._isVisited=t},eg.prototype.setInResult=function(t){this._isInResult=t},eg.prototype.isCovered=function(){return this._isCovered},eg.prototype.isCoveredSet=function(){return this._isCoveredSet},eg.prototype.setLabel=function(t){this._label=t},eg.prototype.getLabel=function(){return this._label},eg.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},eg.prototype.updateIM=function(t){$p.isTrue(2<=this._label.getGeometryCount(),"found partial label"),this.computeIM(t)},eg.prototype.isInResult=function(){return this._isInResult},eg.prototype.isVisited=function(){return this._isVisited},eg.prototype.interfaces_=function(){return[]},eg.prototype.getClass=function(){return eg};var ng=function(n){function r(){n.call(this),this._coord=null,this._edges=null;var t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new Zd(0,Sp.NONE)}return n&&(r.__proto__=n),((r.prototype=Object.create(n&&n.prototype)).constructor=r).prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();){if(t.next().getEdge().isInResult())return!0}return!1},r.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},r.prototype.getCoordinate=function(){return this._coord},r.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},r.prototype.computeIM=function(t){},r.prototype.computeMergedLocation=function(t,e){var n=Sp.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==Sp.BOUNDARY&&(n=i)}return n},r.prototype.setLabel=function(){if(2!==arguments.length)return n.prototype.setLabel.apply(this,arguments);var t=arguments[0],e=arguments[1];null===this._label?this._label=new Zd(t,e):this._label.setLocation(t,e)},r.prototype.getEdges=function(){return this._edges},r.prototype.mergeLabel=function(){if(arguments[0]instanceof r){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Zd)for(var e=arguments[0],n=0;n<2;n++){var i=this.computeMergedLocation(e,n);this._label.getLocation(n)===Sp.NONE&&this._label.setLocation(n,i)}},r.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},r.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=Sp.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case Sp.BOUNDARY:n=Sp.INTERIOR;break;case Sp.INTERIOR:default:n=Sp.BOUNDARY}this._label.setLocation(t,n)},r.prototype.interfaces_=function(){return[]},r.prototype.getClass=function(){return r},r}(eg),ig=function(){this.nodeMap=new zf,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};ig.prototype.find=function(t){return this.nodeMap.get(t)},ig.prototype.addNode=function(){if(arguments[0]instanceof Ep){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof ng){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}},ig.prototype.print=function(t){for(var e=this.iterator();e.hasNext();){e.next().print(t)}},ig.prototype.iterator=function(){return this.nodeMap.values().iterator()},ig.prototype.values=function(){return this.nodeMap.values()},ig.prototype.getBoundaryNodes=function(t){for(var e=new If,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===Sp.BOUNDARY&&e.add(i)}return e},ig.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},ig.prototype.interfaces_=function(){return[]},ig.prototype.getClass=function(){return ig};var rg=function(){},og={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};rg.prototype.interfaces_=function(){return[]},rg.prototype.getClass=function(){return rg},rg.isNorthern=function(t){return t===rg.NE||t===rg.NW},rg.isOpposite=function(t,e){return t!==e&&2===(t-e+4)%4},rg.commonHalfPlane=function(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(e<t?t:e)?3:n},rg.isInHalfPlane=function(t,e){return e===rg.SE?t===rg.SE||t===rg.SW:t===e||t===e+1},rg.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new gp("Cannot compute the quadrant for point ( "+t+", "+e+" )");return 0<=t?0<=e?rg.NE:rg.SE:0<=e?rg.NW:rg.SW}if(arguments[0]instanceof Ep&&arguments[1]instanceof Ep){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new gp("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?rg.NE:rg.SE:i.y>=n.y?rg.NW:rg.SW}},og.NE.get=function(){return 0},og.NW.get=function(){return 1},og.SW.get=function(){return 2},og.SE.get=function(){return 3},Object.defineProperties(rg,og);var sg=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._edge=e,this.init(n,i),this._label=null}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=r,this.init(o,s),this._label=a}};sg.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:sf.computeOrientation(t._p0,t._p1,this._p1)},sg.prototype.getDy=function(){return this._dy},sg.prototype.getCoordinate=function(){return this._p0},sg.prototype.setNode=function(t){this._node=t},sg.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},sg.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},sg.prototype.getDirectedCoordinate=function(){return this._p1},sg.prototype.getDx=function(){return this._dx},sg.prototype.getLabel=function(){return this._label},sg.prototype.getEdge=function(){return this._edge},sg.prototype.getQuadrant=function(){return this._quadrant},sg.prototype.getNode=function(){return this._node},sg.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},sg.prototype.computeLabel=function(t){},sg.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=rg.quadrant(this._dx,this._dy),$p.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},sg.prototype.interfaces_=function(){return[mp]},sg.prototype.getClass=function(){return sg};var ag=function(i){function t(){var t=arguments[0],e=arguments[1];if(i.call(this,t),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.getNextMin=function(){return this._nextMin},t.prototype.getDepth=function(t){return this._depth[t]},t.prototype.setVisited=function(t){this._isVisited=t},t.prototype.computeDirectedLabel=function(){this._label=new Zd(this._edge.getLabel()),this._isForward||this._label.flip()},t.prototype.getNext=function(){return this._next},t.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Xd("assigned depths do not match",this.getCoordinate());this._depth[t]=e},t.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,jd.LEFT)===Sp.INTERIOR&&this._label.getLocation(e,jd.RIGHT)===Sp.INTERIOR||(t=!1);return t},t.prototype.setNextMin=function(t){this._nextMin=t},t.prototype.print=function(t){i.prototype.print.call(this,t),t.print(" "+this._depth[jd.LEFT]+"/"+this._depth[jd.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},t.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},t.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,Sp.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,Sp.EXTERIOR);return t&&e&&n},t.prototype.setEdgeRing=function(t){this._edgeRing=t},t.prototype.getMinEdgeRing=function(){return this._minEdgeRing},t.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},t.prototype.setInResult=function(t){this._isInResult=t},t.prototype.getSym=function(){return this._sym},t.prototype.isForward=function(){return this._isForward},t.prototype.getEdge=function(){return this._edge},t.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},t.prototype.setSym=function(t){this._sym=t},t.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},t.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===jd.LEFT&&(i=-1);var r=jd.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},t.prototype.getEdgeRing=function(){return this._edgeRing},t.prototype.isInResult=function(){return this._isInResult},t.prototype.setNext=function(t){this._next=t},t.prototype.isVisited=function(){return this._isVisited},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t.depthFactor=function(t,e){return t===Sp.EXTERIOR&&e===Sp.INTERIOR?1:t===Sp.INTERIOR&&e===Sp.EXTERIOR?-1:0},t}(sg),ug=function(){};ug.prototype.createNode=function(t){return new ng(t,null)},ug.prototype.interfaces_=function(){return[]},ug.prototype.getClass=function(){return ug};var lg=function(){if(this._edges=new If,this._nodes=null,this._edgeEndList=new If,0===arguments.length)this._nodes=new ig(new ug);else if(1===arguments.length){var t=arguments[0];this._nodes=new ig(t)}};lg.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},lg.prototype.find=function(t){return this._nodes.find(t)},lg.prototype.addNode=function(){if(arguments[0]instanceof ng){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof Ep){var e=arguments[0];return this._nodes.addNode(e)}},lg.prototype.getNodeIterator=function(){return this._nodes.iterator()},lg.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}},lg.prototype.debugPrintln=function(t){jp.out.println(t)},lg.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===Sp.BOUNDARY},lg.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkAllDirectedEdges()}},lg.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&(sf.computeOrientation(t,e,i)===sf.COLLINEAR&&rg.quadrant(t,e)===rg.quadrant(n,i))},lg.prototype.getEdgeEnds=function(){return this._edgeEndList},lg.prototype.debugPrint=function(t){jp.out.print(t)},lg.prototype.getEdgeIterator=function(){return this._edges.iterator()},lg.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},lg.prototype.insertEdge=function(t){this._edges.add(t)},lg.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},lg.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new ag(n,!0),r=new ag(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},lg.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},lg.prototype.getNodes=function(){return this._nodes.values()},lg.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},lg.prototype.interfaces_=function(){return[]},lg.prototype.getClass=function(){return lg},lg.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}};var hg=function(){this._geometryFactory=null,this._shellList=new If;var t=arguments[0];this._geometryFactory=t};hg.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},hg.prototype.computePolygons=function(t){for(var e=new If,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},hg.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new Xd("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},hg.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new If,r=t.iterator();r.hasNext();){var o=r.next();if(2<o.getMaxNodeDegree()){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},hg.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();){if(e.next().containsPoint(t))return!0}return!1},hg.prototype.buildMaximalEdgeRings=function(t){for(var e=new If,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new tg(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},hg.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},hg.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},hg.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getLinearRing(),h=l.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var c=!1;h.contains(i)&&sf.isPointInRing(r,l.getCoordinates())&&(c=!0),c&&(null===o||s.contains(h))&&(o=u)}return o},hg.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return $p.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},hg.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];lg.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new If,o=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},hg.prototype.interfaces_=function(){return[]},hg.prototype.getClass=function(){return hg};var cg=function(){};cg.prototype.getBounds=function(){},cg.prototype.interfaces_=function(){return[]},cg.prototype.getClass=function(){return cg};var pg=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};pg.prototype.getItem=function(){return this._item},pg.prototype.getBounds=function(){return this._bounds},pg.prototype.interfaces_=function(){return[cg,xp]},pg.prototype.getClass=function(){return pg};var fg=function(){this._size=null,this._items=null,this._size=0,this._items=new If,this._items.add(null)};fg.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},fg.prototype.size=function(){return this._size},fg.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},fg.prototype.clear=function(){this._size=0,this._items.clear()},fg.prototype.isEmpty=function(){return 0===this._size},fg.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},fg.prototype.interfaces_=function(){return[]},fg.prototype.getClass=function(){return fg};var dg=function(){};dg.prototype.visitItem=function(t){},dg.prototype.interfaces_=function(){return[]},dg.prototype.getClass=function(){return dg};var gg=function(){};gg.prototype.insert=function(t,e){},gg.prototype.remove=function(t,e){},gg.prototype.query=function(){},gg.prototype.interfaces_=function(){return[]},gg.prototype.getClass=function(){return gg};var yg=function(){if(this._childBoundables=new If,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},_g={serialVersionUID:{configurable:!0}};yg.prototype.getLevel=function(){return this._level},yg.prototype.size=function(){return this._childBoundables.size()},yg.prototype.getChildBoundables=function(){return this._childBoundables},yg.prototype.addChildBoundable=function(t){$p.isTrue(null===this._bounds),this._childBoundables.add(t)},yg.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},yg.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},yg.prototype.interfaces_=function(){return[cg,xp]},yg.prototype.getClass=function(){return yg},_g.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(yg,_g);var mg=function(){};mg.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},mg.min=function(t){return mg.sort(t),t.get(0)},mg.sort=function(t,e){var n=t.toArray();e?Wf.sort(n,e):Wf.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},mg.singletonList=function(t){var e=new If;return e.add(t),e};var vg=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};vg.prototype.expandToQueue=function(t,e){var n=vg.isComposite(this._boundable1),i=vg.isComposite(this._boundable2);if(n&&i)return vg.area(this._boundable1)>vg.area(this._boundable2)?this.expand(this._boundable1,this._boundable2,t,e):this.expand(this._boundable2,this._boundable1,t,e),null;if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new gp("neither boundable is composite")},vg.prototype.isLeaves=function(){return!(vg.isComposite(this._boundable1)||vg.isComposite(this._boundable2))},vg.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},vg.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new vg(o,e,this._itemDistance);s.getDistance()<i&&n.add(s)}},vg.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},vg.prototype.getDistance=function(){return this._distance},vg.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},vg.prototype.interfaces_=function(){return[mp]},vg.prototype.getClass=function(){return vg},vg.area=function(t){return t.getBounds().getArea()},vg.isComposite=function(t){return t instanceof yg};var bg=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new If,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];$p.isTrue(1<n,"Node capacity must be greater than 1"),this._nodeCapacity=n}},xg={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};bg.prototype.getNodeCapacity=function(){return this._nodeCapacity},bg.prototype.lastNode=function(t){return t.get(t.size()-1)},bg.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof yg?t+=this.size(n):n instanceof pg&&(t+=1)}return t}},bg.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof pg&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},bg.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new If:t}if(1===arguments.length){for(var e=arguments[0],n=new If,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof yg){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof pg?n.add(r.getItem()):$p.shouldNeverReachHere()}return n.size()<=0?null:n}},bg.prototype.insert=function(t,e){$p.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new pg(t,e))},bg.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new If;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if($p.isTrue(-2<n),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof yg?this.boundablesAtLevel(n,s,r):($p.isTrue(s instanceof pg),-1===n&&r.add(s))}return null}},bg.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new If;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(Cp(arguments[2],dg)&&arguments[0]instanceof Object&&arguments[1]instanceof yg)for(var r=arguments[0],o=arguments[1],s=arguments[2],a=o.getChildBoundables(),u=0;u<a.size();u++){var l=a.get(u);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof yg?this.query(r,l,s):l instanceof pg?s.visitItem(l.getItem()):$p.shouldNeverReachHere())}else if(Cp(arguments[2],Ef)&&arguments[0]instanceof Object&&arguments[1]instanceof yg)for(var h=arguments[0],c=arguments[1],p=arguments[2],f=c.getChildBoundables(),d=0;d<f.size();d++){var g=f.get(d);this.getIntersectsOp().intersects(g.getBounds(),h)&&(g instanceof yg?this.query(h,g,p):g instanceof pg?p.add(g.getItem()):$p.shouldNeverReachHere())}},bg.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},bg.prototype.getRoot=function(){return this.build(),this._root},bg.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var u=a.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&(u instanceof yg&&(o=this.remove(n,u,r)))){s=u;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},bg.prototype.createHigherLevels=function(t,e){$p.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},bg.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof yg){var i=this.depth(n);t<i&&(t=i)}}return t+1}},bg.prototype.createParentBoundables=function(t,e){$p.isTrue(!t.isEmpty());var n=new If;n.add(this.createNode(e));var i=new If(t);mg.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},bg.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},bg.prototype.interfaces_=function(){return[xp]},bg.prototype.getClass=function(){return bg},bg.compareDoubles=function(t,e){return e<t?1:t<e?-1:0},xg.IntersectsOp.get=function(){return Eg},xg.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},xg.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(bg,xg);var Eg=function(){},wg=function(){};wg.prototype.distance=function(t,e){},wg.prototype.interfaces_=function(){return[]},wg.prototype.getClass=function(){return wg};var Ig=function(l){function _(t){t=t||_.DEFAULT_NODE_CAPACITY,l.call(this,t)}l&&(_.__proto__=l);var t={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return((_.prototype=Object.create(l&&l.prototype)).constructor=_).prototype.createParentBoundablesFromVerticalSlices=function(t,e){$p.isTrue(0<t.length);for(var n=new If,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},_.prototype.createNode=function(t){return new Lg(t)},_.prototype.size=function(){return 0===arguments.length?l.prototype.size.call(this):l.prototype.size.apply(this,arguments)},_.prototype.insert=function(){if(2!==arguments.length)return l.prototype.insert.apply(this,arguments);var t=arguments[0],e=arguments[1];if(t.isNull())return null;l.prototype.insert.call(this,t,e)},_.prototype.getIntersectsOp=function(){return _.intersectsOp},_.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new If;for(var s=0;r.hasNext()&&s<n;){var a=r.next();i[o].add(a),s++}}return i},_.prototype.query=function(){if(1===arguments.length){var t=arguments[0];return l.prototype.query.call(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];l.prototype.query.call(this,e,n)}else if(3===arguments.length)if(Cp(arguments[2],dg)&&arguments[0]instanceof Object&&arguments[1]instanceof yg){var i=arguments[0],r=arguments[1],o=arguments[2];l.prototype.query.call(this,i,r,o)}else if(Cp(arguments[2],Ef)&&arguments[0]instanceof Object&&arguments[1]instanceof yg){var s=arguments[0],a=arguments[1],u=arguments[2];l.prototype.query.call(this,s,a,u)}},_.prototype.getComparator=function(){return _.yComparator},_.prototype.createParentBoundablesFromVerticalSlice=function(t,e){return l.prototype.createParentBoundables.call(this,t,e)},_.prototype.remove=function(){if(2!==arguments.length)return l.prototype.remove.apply(this,arguments);var t=arguments[0],e=arguments[1];return l.prototype.remove.call(this,t,e)},_.prototype.depth=function(){return 0===arguments.length?l.prototype.depth.call(this):l.prototype.depth.apply(this,arguments)},_.prototype.createParentBoundables=function(t,e){$p.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new If(t);mg.sort(i,_.xComparator);var r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)},_.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Cp(arguments[0],wg)){var t=arguments[0],e=new vg(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof vg){var n=arguments[0];return this.nearestNeighbour(n,yp.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof _&&Cp(arguments[1],wg)){var i=arguments[0],r=arguments[1],o=new vg(this.getRoot(),i.getRoot(),r);return this.nearestNeighbour(o)}if(arguments[0]instanceof vg&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],u=null,l=new fg;for(l.add(s);!l.isEmpty()&&0<a;){var h=l.poll(),c=h.getDistance();if(a<=c)break;h.isLeaves()?(a=c,u=h):h.expandToQueue(l,a)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var p=arguments[0],f=arguments[1],d=arguments[2],g=new pg(p,f),y=new vg(this.getRoot(),g,d);return this.nearestNeighbour(y)[0]}},_.prototype.interfaces_=function(){return[gg,xp]},_.prototype.getClass=function(){return _},_.centreX=function(t){return _.avg(t.getMinX(),t.getMaxX())},_.avg=function(t,e){return(t+e)/2},_.centreY=function(t){return _.avg(t.getMinY(),t.getMaxY())},t.STRtreeNode.get=function(){return Lg},t.serialVersionUID.get=function(){return 0x39920f7d5f261e0},t.xComparator.get=function(){return{interfaces_:function(){return[bp]},compare:function(t,e){return l.compareDoubles(_.centreX(t.getBounds()),_.centreX(e.getBounds()))}}},t.yComparator.get=function(){return{interfaces_:function(){return[bp]},compare:function(t,e){return l.compareDoubles(_.centreY(t.getBounds()),_.centreY(e.getBounds()))}}},t.intersectsOp.get=function(){return{interfaces_:function(){return[l.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},t.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(_,t),_}(bg),Lg=function(e){function t(){var t=arguments[0];e.call(this,t)}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new Vp(n.getBounds()):t.expandToInclude(n.getBounds())}return t},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(yg),Sg=function(){};Sg.prototype.interfaces_=function(){return[]},Sg.prototype.getClass=function(){return Sg},Sg.relativeSign=function(t,e){return t<e?-1:e<t?1:0},Sg.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=Sg.relativeSign(e.x,n.x),r=Sg.relativeSign(e.y,n.y);switch(t){case 0:return Sg.compareValue(i,r);case 1:return Sg.compareValue(r,i);case 2:return Sg.compareValue(r,-i);case 3:return Sg.compareValue(-i,r);case 4:return Sg.compareValue(-i,-r);case 5:return Sg.compareValue(-r,-i);case 6:return Sg.compareValue(-r,i);case 7:return Sg.compareValue(i,-r)}return $p.shouldNeverReachHere("invalid octant value"),0},Sg.compareValue=function(t,e){return t<0?-1:0<t?1:e<0?-1:0<e?1:0};var Mg=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new Ep(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))};Mg.prototype.getCoordinate=function(){return this.coord},Mg.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},Mg.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Sg.compare(this._segmentOctant,this.coord,e.coord)},Mg.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},Mg.prototype.isInterior=function(){return this._isInterior},Mg.prototype.interfaces_=function(){return[mp]},Mg.prototype.getClass=function(){return Mg};var Cg=function(){this._nodeMap=new zf,this._edge=null;var t=arguments[0];this._edge=t};Cg.prototype.getSplitCoordinates=function(){var t=new Sf;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},Cg.prototype.addCollapsedNodes=function(){var t=new If;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},Cg.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},Cg.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new Tp(e+1))}},Cg.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new Ep(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new Ep(e.coord))},Cg.prototype.iterator=function(){return this._nodeMap.values().iterator()},Cg.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Cg.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},Cg.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new Tp(e[0])),i=r}},Cg.prototype.getEdge=function(){return this._edge},Cg.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},Cg.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new Ep(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new Ep(e.coord)),new Tg(o,this._edge.getData())},Cg.prototype.add=function(t,e){var n=new Mg(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?($p.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},Cg.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new Zp("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new Zp("bad split edge end point at "+r)},Cg.prototype.interfaces_=function(){return[]},Cg.prototype.getClass=function(){return Cg};var Pg=function(){};Pg.prototype.interfaces_=function(){return[]},Pg.prototype.getClass=function(){return Pg},Pg.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new gp("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return 0<=t?0<=e?i<=n?0:1:i<=n?7:6:0<=e?i<=n?3:2:i<=n?4:5}if(arguments[0]instanceof Ep&&arguments[1]instanceof Ep){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new gp("Cannot compute the octant for two identical points "+r);return Pg.octant(s,a)}};var Ng=function(){};Ng.prototype.getCoordinates=function(){},Ng.prototype.size=function(){},Ng.prototype.getCoordinate=function(t){},Ng.prototype.isClosed=function(){},Ng.prototype.setData=function(t){},Ng.prototype.getData=function(){},Ng.prototype.interfaces_=function(){return[]},Ng.prototype.getClass=function(){return Ng};var Og=function(){};Og.prototype.addIntersection=function(t,e){},Og.prototype.interfaces_=function(){return[Ng]},Og.prototype.getClass=function(){return Og};var Tg=function(){this._nodeList=new Cg(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Tg.prototype.getCoordinates=function(){return this._pts},Tg.prototype.size=function(){return this._pts.length},Tg.prototype.getCoordinate=function(t){return this._pts[t]},Tg.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Tg.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},Tg.prototype.setData=function(t){this._data=t},Tg.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:Pg.octant(t,e)},Tg.prototype.getData=function(){return this._data},Tg.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[3],o=new Ep(n.getIntersection(r));this.addIntersection(o,i)}},Tg.prototype.toString=function(){return Kp.toLineString(new Ld(this._pts))},Tg.prototype.getNodeList=function(){return this._nodeList},Tg.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},Tg.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},Tg.prototype.interfaces_=function(){return[Og]},Tg.prototype.getClass=function(){return Tg},Tg.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new If;return Tg.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){r.next().getNodeList().addSplitEdges(i)}};var Rg=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new Ep,this.p1=new Ep;else if(1===arguments.length){var t=arguments[0];this.p0=new Ep(t.p0),this.p1=new Ep(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this.p0=new Ep(e,n),this.p1=new Ep(i,r)}},kg={serialVersionUID:{configurable:!0}};Rg.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Rg.prototype.orientationIndex=function(){if(arguments[0]instanceof Rg){var t=arguments[0],e=sf.orientationIndex(this.p0,this.p1,t.p0),n=sf.orientationIndex(this.p0,this.p1,t.p1);return 0<=e&&0<=n?Math.max(e,n):e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof Ep){var i=arguments[0];return sf.orientationIndex(this.p0,this.p1,i)}},Rg.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},Rg.prototype.isVertical=function(){return this.p0.x===this.p1.x},Rg.prototype.equals=function(t){if(!(t instanceof Rg))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},Rg.prototype.intersection=function(t){var e=new nf;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},Rg.prototype.project=function(){if(arguments[0]instanceof Ep){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new Ep(t);var e=this.projectionFactor(t),n=new Ep;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof Rg){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(1<=r&&1<=o)return null;if(r<=0&&o<=0)return null;var s=this.project(i.p0);r<0&&(s=this.p0),1<r&&(s=this.p1);var a=this.project(i.p1);return o<0&&(a=this.p0),1<o&&(a=this.p1),new Rg(s,a)}},Rg.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Rg.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Rg.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},Rg.prototype.distancePerpendicular=function(t){return sf.distancePointLinePerpendicular(t,this.p0,this.p1)},Rg.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Rg.prototype.midPoint=function(){return Rg.midPoint(this.p0,this.p1)},Rg.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?yp.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},Rg.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=yp.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<i&&(i=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var u=t.closestPoint(this.p1);return(r=u.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=u),n},Rg.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return 0<e&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},Rg.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Rg.prototype.getLength=function(){return this.p0.distance(this.p1)},Rg.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},Rg.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},Rg.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},Rg.prototype.lineIntersection=function(t){try{return zp.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof qp))throw t}return null},Rg.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Rg.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,u=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,u=e*o/s}return new Ep(n-u,i+a)},Rg.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},Rg.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(1<e||yp.isNaN(e))&&(e=1),e},Rg.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Rg.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Rg.prototype.distance=function(){if(arguments[0]instanceof Rg){var t=arguments[0];return sf.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof Ep){var e=arguments[0];return sf.distancePointLine(e,this.p0,this.p1)}},Rg.prototype.pointAlong=function(t){var e=new Ep;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},Rg.prototype.hashCode=function(){var t=yp.doubleToLongBits(this.p0.x);t^=31*yp.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=yp.doubleToLongBits(this.p1.x);return n^=31*yp.doubleToLongBits(this.p1.y),e^(Math.trunc(n)^Math.trunc(n>>32))},Rg.prototype.interfaces_=function(){return[mp,xp]},Rg.prototype.getClass=function(){return Rg},Rg.midPoint=function(t,e){return new Ep((t.x+e.x)/2,(t.y+e.y)/2)},kg.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Rg,kg);var Dg=function(){this.tempEnv1=new Vp,this.tempEnv2=new Vp,this._overlapSeg1=new Rg,this._overlapSeg2=new Rg};Dg.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Dg.prototype.interfaces_=function(){return[]},Dg.prototype.getClass=function(){return Dg};var Ag=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i};Ag.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},Ag.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)},Ag.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},Ag.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},Ag.prototype.setId=function(t){this._id=t},Ag.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},Ag.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new Vp(t,e)}return this._env},Ag.prototype.getEndIndex=function(){return this._end},Ag.prototype.getStartIndex=function(){return this._start},Ag.prototype.getContext=function(){return this._context},Ag.prototype.getId=function(){return this._id},Ag.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var s=this._pts[t],a=this._pts[e],u=n._pts[i],l=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(u,l),!o.tempEnv1.intersects(o.tempEnv2))return null;var h=Math.trunc((t+e)/2),c=Math.trunc((i+r)/2);t<h&&(i<c&&this.computeOverlapsInternal(t,h,n,i,c,o),c<r&&this.computeOverlapsInternal(t,h,n,c,r,o)),h<e&&(i<c&&this.computeOverlapsInternal(h,e,n,i,c,o),c<r&&this.computeOverlapsInternal(h,e,n,c,r,o))},Ag.prototype.interfaces_=function(){return[]},Ag.prototype.getClass=function(){return Ag};var Fg=function(){};Fg.prototype.interfaces_=function(){return[]},Fg.prototype.getClass=function(){return Fg},Fg.getChainStartIndices=function(t){var e=0,n=new If;n.add(new Tp(e));do{var i=Fg.findChainEnd(t,e);n.add(new Tp(i)),e=i}while(e<t.length-1);return Fg.toIntArray(n)},Fg.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=rg.quadrant(t[n],t[n+1]),r=e+1;r<t.length;){if(!t[r-1].equals2D(t[r]))if(rg.quadrant(t[r-1],t[r])!==i)break;r++}return r-1},Fg.getChains=function(){if(1===arguments.length){var t=arguments[0];return Fg.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new If,r=Fg.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new Ag(e,r[o],r[o+1],n);i.add(s)}return i}},Fg.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Gg=function(){};Gg.prototype.computeNodes=function(t){},Gg.prototype.getNodedSubstrings=function(){},Gg.prototype.interfaces_=function(){return[]},Gg.prototype.getClass=function(){return Gg};var Bg=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};Bg.prototype.setSegmentIntersector=function(t){this._segInt=t},Bg.prototype.interfaces_=function(){return[Gg]},Bg.prototype.getClass=function(){return Bg};var Ug=function(e){function t(t){t?e.call(this,t):e.call(this),this._monoChains=new If,this._index=new Ig,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e);var n={SegmentOverlapAction:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return Tg.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(t){for(var e=Fg.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},t.prototype.computeNodes=function(t){for(var e=(this._nodedSegStrings=t).iterator();e.hasNext();)this.add(e.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var t=new qg(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.SegmentOverlapAction.get=function(){return qg},Object.defineProperties(t,n),t}(Bg),qg=function(s){function t(){s.call(this),this._si=null;var t=arguments[0];this._si=t}return s&&(t.__proto__=s),((t.prototype=Object.create(s&&s.prototype)).constructor=t).prototype.overlap=function(){if(4!==arguments.length)return s.prototype.overlap.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=t.getContext(),o=n.getContext();this._si.processIntersections(r,e,o,i)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(Dg),jg=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(i)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},zg={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};jg.prototype.getEndCapStyle=function(){return this._endCapStyle},jg.prototype.isSingleSided=function(){return this._isSingleSided},jg.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=jg.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=jg.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==jg.JOIN_ROUND&&(this._quadrantSegments=jg.DEFAULT_QUADRANT_SEGMENTS)},jg.prototype.getJoinStyle=function(){return this._joinStyle},jg.prototype.setJoinStyle=function(t){this._joinStyle=t},jg.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},jg.prototype.getSimplifyFactor=function(){return this._simplifyFactor},jg.prototype.getQuadrantSegments=function(){return this._quadrantSegments},jg.prototype.setEndCapStyle=function(t){this._endCapStyle=t},jg.prototype.getMitreLimit=function(){return this._mitreLimit},jg.prototype.setMitreLimit=function(t){this._mitreLimit=t},jg.prototype.setSingleSided=function(t){this._isSingleSided=t},jg.prototype.interfaces_=function(){return[]},jg.prototype.getClass=function(){return jg},jg.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},zg.CAP_ROUND.get=function(){return 1},zg.CAP_FLAT.get=function(){return 2},zg.CAP_SQUARE.get=function(){return 3},zg.JOIN_ROUND.get=function(){return 1},zg.JOIN_MITRE.get=function(){return 2},zg.JOIN_BEVEL.get=function(){return 3},zg.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},zg.DEFAULT_MITRE_LIMIT.get=function(){return 5},zg.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(jg,zg);var Vg=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=sf.COUNTERCLOCKWISE,this._inputLine=t||null},Yg={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Vg.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&(!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i))},Vg.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Vg.DELETE,i=r=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},Vg.prototype.isShallowConcavity=function(t,e,n,i){return sf.computeOrientation(t,e,n)===this._angleOrientation&&sf.distancePointLine(e,t,n)<i},Vg.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/Vg.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Vg.prototype.isConcave=function(t,e,n){var i=sf.computeOrientation(t,e,n)===this._angleOrientation;return i},Vg.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=sf.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);for(;this.deleteShallowConcavities(););return this.collapseLine()},Vg.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Vg.DELETE;)e++;return e},Vg.prototype.isShallow=function(t,e,n,i){return sf.distancePointLine(e,t,n)<i},Vg.prototype.collapseLine=function(){for(var t=new Sf,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Vg.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Vg.prototype.interfaces_=function(){return[]},Vg.prototype.getClass=function(){return Vg},Vg.simplify=function(t,e){return new Vg(t).simplify(e)},Yg.INIT.get=function(){return 0},Yg.DELETE.get=function(){return 1},Yg.KEEP.get=function(){return 1},Yg.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Vg,Yg);var Hg=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new If},Xg={COORDINATE_ARRAY_TYPE:{configurable:!0}};Hg.prototype.getCoordinates=function(){return this._ptList.toArray(Hg.COORDINATE_ARRAY_TYPE)},Hg.prototype.setPrecisionModel=function(t){this._precisionModel=t},Hg.prototype.addPt=function(t){var e=new Ep(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Hg.prototype.revere=function(){},Hg.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;0<=i;i--)this.addPt(t[i])},Hg.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Hg.prototype.toString=function(){return(new kd).createLineString(this.getCoordinates()).toString()},Hg.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new Ep(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Hg.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Hg.prototype.interfaces_=function(){return[]},Hg.prototype.getClass=function(){return Hg},Xg.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Hg,Xg);var Wg=function(){},Jg={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Wg.prototype.interfaces_=function(){return[]},Wg.prototype.getClass=function(){return Wg},Wg.toDegrees=function(t){return 180*t/Math.PI},Wg.normalize=function(t){for(;t>Math.PI;)t-=Wg.PI_TIMES_2;for(;t<=-Math.PI;)t+=Wg.PI_TIMES_2;return t},Wg.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},Wg.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return 0<i*(n.x-e.x)+r*(n.y-e.y)},Wg.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},Wg.interiorAngle=function(t,e,n){var i=Wg.angle(e,t),r=Wg.angle(e,n);return Math.abs(r-i)},Wg.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Wg.PI_TIMES_2;Wg.PI_TIMES_2<=t&&(t=0)}else{for(;Wg.PI_TIMES_2<=t;)t-=Wg.PI_TIMES_2;t<0&&(t=0)}return t},Wg.angleBetween=function(t,e,n){var i=Wg.angle(e,t),r=Wg.angle(e,n);return Wg.diff(i,r)},Wg.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Wg.toRadians=function(t){return t*Math.PI/180},Wg.getTurn=function(t,e){var n=Math.sin(e-t);return 0<n?Wg.COUNTERCLOCKWISE:n<0?Wg.CLOCKWISE:Wg.NONE},Wg.angleBetweenOriented=function(t,e,n){var i=Wg.angle(e,t),r=Wg.angle(e,n)-i;return r<=-Math.PI?r+Wg.PI_TIMES_2:r>Math.PI?r-Wg.PI_TIMES_2:r},Jg.PI_TIMES_2.get=function(){return 2*Math.PI},Jg.PI_OVER_2.get=function(){return Math.PI/2},Jg.PI_OVER_4.get=function(){return Math.PI/4},Jg.COUNTERCLOCKWISE.get=function(){return sf.COUNTERCLOCKWISE},Jg.CLOCKWISE.get=function(){return sf.CLOCKWISE},Jg.NONE.get=function(){return sf.COLLINEAR},Object.defineProperties(Wg,Jg);var Kg=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Rg,this._seg1=new Rg,this._offset0=new Rg,this._offset1=new Rg,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new nf,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),8<=n.getQuadrantSegments()&&n.getJoinStyle()===jg.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},Zg={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Kg.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=sf.computeOrientation(this._s0,this._s1,this._s2),i=n===sf.CLOCKWISE&&this._side===jd.LEFT||n===sf.COUNTERCLOCKWISE&&this._side===jd.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},Kg.prototype.addLineEndCap=function(t,e){var n=new Rg(t,e),i=new Rg;this.computeOffsetSegment(n,jd.LEFT,this._distance,i);var r=new Rg;this.computeOffsetSegment(n,jd.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case jg.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,sf.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case jg.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case jg.CAP_SQUARE:var u=new Ep;u.x=Math.abs(this._distance)*Math.cos(a),u.y=Math.abs(this._distance)*Math.sin(a);var l=new Ep(i.p1.x+u.x,i.p1.y+u.y),h=new Ep(r.p1.x+u.x,r.p1.y+u.y);this._segList.addPt(l),this._segList.addPt(h)}},Kg.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Kg.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=zp.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof qp))throw t;o=new Ep(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},Kg.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),u=n.x-t.x,l=n.y-t.y,h=Math.atan2(l,u);i===sf.CLOCKWISE?a<=h&&(a+=2*Math.PI):h<=a&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,h,i,r),this._segList.addPt(n)},Kg.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Kg.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===jg.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===jg.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Kg.prototype.createSquare=function(t){this._segList.addPt(new Ep(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new Ep(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new Ep(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new Ep(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Kg.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Kg.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Kg.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Kg.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},Kg.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=Wg.angle(r,this._seg0.p0),s=Wg.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Wg.normalize(o+s),u=Wg.normalize(a+Math.PI),l=i*n,h=n-l*Math.abs(Math.sin(s)),c=r.x+l*Math.cos(u),p=r.y+l*Math.sin(u),f=new Ep(c,p),d=new Rg(r,f),g=d.pointAlongOffset(1,h),y=d.pointAlongOffset(1,-h);this._side===jd.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))},Kg.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===jd.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),u=r*n*o/a,l=r*n*s/a;i.p0.x=t.p0.x-l,i.p0.y=t.p0.y+u,i.p1.x=t.p1.x-l,i.p1.y=t.p1.y+u},Kg.prototype.addFilletArc=function(t,e,n,i,r){var o=i===sf.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var u=s/a,l=0,h=new Ep;l<s;){var c=e+o*l;h.x=t.x+r*Math.cos(c),h.y=t.y+r*Math.sin(c),this._segList.addPt(h),l+=u}},Kg.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Kg.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),0<this._closingSegLengthFactor){var n=new Ep((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new Ep((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Kg.prototype.createCircle=function(t){var e=new Ep(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Kg.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Kg.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Hg,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Kg.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Kg.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),2<=this._li.getIntersectionNum()&&(this._bufParams.getJoinStyle()===jg.JOIN_BEVEL||this._bufParams.getJoinStyle()===jg.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,sf.CLOCKWISE,this._distance))},Kg.prototype.closeRing=function(){this._segList.closeRing()},Kg.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Kg.prototype.interfaces_=function(){return[]},Kg.prototype.getClass=function(){return Kg},Zg.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Zg.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Zg.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Zg.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Kg,Zg);var Qg=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Qg.prototype.getOffsetCurve=function(t,e){if(0===(this._distance=e))return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&Mf.reverse(o),o},Qg.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=Vg.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],jd.LEFT),n.addFirstSegment();for(var s=o-2;0<=s;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=Vg.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],jd.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment(),n.closeRing()},Qg.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===jd.RIGHT&&(i=-i);var r=Vg.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},Qg.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=Vg.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],jd.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=Vg.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],jd.LEFT);for(var u=a-2;0<=u;u--)e.addNextSegment(s[u],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},Qg.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case jg.CAP_ROUND:e.createCircle(t);break;case jg.CAP_SQUARE:e.createSquare(t)}},Qg.prototype.getLineCurve=function(t,e){if((this._distance=e)<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},Qg.prototype.getBufferParameters=function(){return this._bufParams},Qg.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Qg.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Qg.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},Qg.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=Vg.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],jd.LEFT),n.addFirstSegment();for(var s=o-2;0<=s;s--)n.addNextSegment(r[s],!0)}else{var a=Vg.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],jd.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment()},Qg.prototype.getSegGen=function(t){return new Kg(this._precisionModel,this._bufParams,t)},Qg.prototype.interfaces_=function(){return[]},Qg.prototype.getClass=function(){return Qg},Qg.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new Ep(t[n]);return e};var $g=function(){this._subgraphs=null,this._seg=new Rg,this._cga=new sf;var t=arguments[0];this._subgraphs=t},ty={DepthSegment:{configurable:!0}};$g.prototype.findStabbedSegments=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],n=new If,i=this._subgraphs.iterator();i.hasNext();){var r=i.next(),o=r.getEnvelope();e.y<o.getMinY()||e.y>o.getMaxY()||t.findStabbedSegments(e,r.getDirectedEdges(),n)}return n}if(3===arguments.length)if(Cp(arguments[2],Ef)&&arguments[0]instanceof Ep&&arguments[1]instanceof ag)for(var s=arguments[0],a=arguments[1],u=arguments[2],l=a.getEdge().getCoordinates(),h=0;h<l.length-1;h++){if(t._seg.p0=l[h],t._seg.p1=l[h+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse(),!(Math.max(t._seg.p0.x,t._seg.p1.x)<s.x||t._seg.isHorizontal()||s.y<t._seg.p0.y||s.y>t._seg.p1.y||sf.computeOrientation(t._seg.p0,t._seg.p1,s)===sf.RIGHT)){var c=a.getDepth(jd.LEFT);t._seg.p0.equals(l[h])||(c=a.getDepth(jd.RIGHT));var p=new ey(t._seg,c);u.add(p)}}else if(Cp(arguments[2],Ef)&&arguments[0]instanceof Ep&&Cp(arguments[1],Ef))for(var f=arguments[0],d=arguments[1],g=arguments[2],y=d.iterator();y.hasNext();){var _=y.next();_.isForward()&&t.findStabbedSegments(f,_,g)}},$g.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:mg.min(e)._leftDepth},$g.prototype.interfaces_=function(){return[]},$g.prototype.getClass=function(){return $g},ty.DepthSegment.get=function(){return ey},Object.defineProperties($g,ty);var ey=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new Rg(t),this._leftDepth=e};ey.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:0!==(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},ey.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},ey.prototype.toString=function(){return this._upwardSeg.toString()},ey.prototype.interfaces_=function(){return[mp]},ey.prototype.getClass=function(){return ey};var ny=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};ny.prototype.area=function(){return ny.area(this.p0,this.p1,this.p2)},ny.prototype.signedArea=function(){return ny.signedArea(this.p0,this.p1,this.p2)},ny.prototype.interpolateZ=function(t){if(null===t)throw new gp("Supplied point is null.");return ny.interpolateZ(t,this.p0,this.p1,this.p2)},ny.prototype.longestSideLength=function(){return ny.longestSideLength(this.p0,this.p1,this.p2)},ny.prototype.isAcute=function(){return ny.isAcute(this.p0,this.p1,this.p2)},ny.prototype.circumcentre=function(){return ny.circumcentre(this.p0,this.p1,this.p2)},ny.prototype.area3D=function(){return ny.area3D(this.p0,this.p1,this.p2)},ny.prototype.centroid=function(){return ny.centroid(this.p0,this.p1,this.p2)},ny.prototype.inCentre=function(){return ny.inCentre(this.p0,this.p1,this.p2)},ny.prototype.interfaces_=function(){return[]},ny.prototype.getClass=function(){return ny},ny.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},ny.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},ny.det=function(t,e,n,i){return t*i-e*n},ny.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,u=n.y-o,l=i.y-o,h=s*l-a*u,c=t.x-r,p=t.y-o,f=(l*c-a*p)/h,d=(-u*c+s*p)/h;return e.z+f*(n.z-e.z)+d*(i.z-e.z)},ny.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return s<r&&(s=r),s<o&&(s=o),s},ny.isAcute=function(t,e,n){return!!Wg.isAcute(t,e,n)&&(!!Wg.isAcute(e,n,t)&&!!Wg.isAcute(n,t,e))},ny.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,u=e.y-r,l=2*ny.det(o,s,a,u),h=ny.det(s,o*o+s*s,u,a*a+u*u),c=ny.det(o,o*o+s*s,a,a*a+u*u);return new Ep(i-h/l,r+c/l)},ny.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new zp(t.x+n/2,t.y+i/2,1),o=new zp(t.x-i+n/2,t.y+n+i/2,1);return new zp(r,o)},ny.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new Ep(t.x+r*o,t.y+r*s)},ny.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,u=n.z-t.z,l=r*u-o*a,h=o*s-i*u,c=i*a-r*s,p=l*l+h*h+c*c,f=Math.sqrt(p)/2;return f},ny.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new Ep(i,r)},ny.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,u=(i*t.y+r*e.y+o*n.y)/s;return new Ep(a,u)};var iy=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new If;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};iy.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,Sp.EXTERIOR,Sp.INTERIOR)},iy.prototype.addPolygon=function(t){var e=this._distance,n=jd.LEFT;this._distance<0&&(e=-this._distance,n=jd.RIGHT);var i=t.getExteriorRing(),r=Mf.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,Sp.EXTERIOR,Sp.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Mf.removeRepeatedPoints(s.getCoordinates());0<this._distance&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,jd.opposite(n),Sp.INTERIOR,Sp.EXTERIOR)}},iy.prototype.isTriangleErodedCompletely=function(t,e){var n=new ny(t[0],t[1],t[2]),i=n.inCentre();return sf.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},iy.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Mf.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,Sp.EXTERIOR,Sp.INTERIOR)},iy.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new Tg(t,new Zd(0,Sp.BOUNDARY,e,n));this._curveList.add(i)},iy.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},iy.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<md.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=md.MINIMUM_VALID_SIZE&&sf.isCCW(t)&&(o=r,s=i,n=jd.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},iy.prototype.add=function(t){if(t.isEmpty())return null;t instanceof yd?this.addPolygon(t):t instanceof pd?this.addLineString(t):t instanceof dd?this.addPoint(t):t instanceof _d?this.addCollection(t):t instanceof td?this.addCollection(t):t instanceof vd?this.addCollection(t):t instanceof $f&&this.addCollection(t)},iy.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},iy.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},iy.prototype.interfaces_=function(){return[]},iy.prototype.getClass=function(){return iy};var ry=function(){};ry.prototype.locate=function(t){},ry.prototype.interfaces_=function(){return[]},ry.prototype.getClass=function(){return ry};var oy=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};oy.prototype.next=function(){if(this._atStart)return this._atStart=!1,oy.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new wf;var t=this._parent.getGeometryN(this._index++);return t instanceof $f?(this._subcollectionIterator=new oy(t),this._subcollectionIterator.next()):t},oy.prototype.remove=function(){throw new Error(this.getClass().getName())},oy.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},oy.prototype.interfaces_=function(){return[xf]},oy.prototype.getClass=function(){return oy},oy.isAtomic=function(t){return!(t instanceof $f)};var sy=function(){this._geom=null;var t=arguments[0];this._geom=t};sy.prototype.locate=function(t){return sy.locate(t,this._geom)},sy.prototype.interfaces_=function(){return[ry]},sy.prototype.getClass=function(){return sy},sy.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&sf.isPointInRing(t,e.getCoordinates())},sy.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!sy.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(sy.isPointInRing(t,r))return!1}return!0},sy.containsPoint=function(t,e){if(e instanceof yd)return sy.containsPointInPolygon(t,e);if(e instanceof $f)for(var n=new oy(e);n.hasNext();){var i=n.next();if(i!==e&&sy.containsPoint(t,i))return!0}return!1},sy.locate=function(t,e){return e.isEmpty()?Sp.EXTERIOR:sy.containsPoint(t,e)?Sp.INTERIOR:Sp.EXTERIOR};var ay=function(){this._edgeMap=new zf,this._edgeList=null,this._ptInAreaLocation=[Sp.NONE,Sp.NONE]};ay.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},ay.prototype.propagateSideLabels=function(t){for(var e=Sp.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,jd.LEFT)!==Sp.NONE&&(e=i.getLocation(t,jd.LEFT))}if(e===Sp.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,jd.ON)===Sp.NONE&&a.setLocation(t,jd.ON,r),a.isArea(t)){var u=a.getLocation(t,jd.LEFT),l=a.getLocation(t,jd.RIGHT);if(l!==Sp.NONE){if(l!==r)throw new Xd("side location conflict",s.getCoordinate());u===Sp.NONE&&$p.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=u}else $p.isTrue(a.getLocation(t,jd.LEFT)===Sp.NONE,"found single null side"),a.setLocation(t,jd.RIGHT,r),a.setLocation(t,jd.LEFT,r)}}},ay.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},ay.prototype.print=function(t){jp.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){e.next().print(t)}},ay.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},ay.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,jd.LEFT);$p.isTrue(i!==Sp.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();$p.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,jd.LEFT),u=s.getLocation(t,jd.RIGHT);if(a===u)return!1;if(u!==r)return!1;r=a}return!0},ay.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++){if(this._edgeList.get(e)===t)return e}return-1},ay.prototype.iterator=function(){return this.getEdges().iterator()},ay.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new If(this._edgeMap.values())),this._edgeList},ay.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===Sp.NONE&&(this._ptInAreaLocation[t]=sy.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},ay.prototype.toString=function(){var t=new Op;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},ay.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();){e.next().computeLabel(t)}},ay.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===Sp.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),u=0;u<2;u++)if(a.isAnyNull(u)){var l=Sp.NONE;if(e[u])l=Sp.EXTERIOR;else{var h=s.getCoordinate();l=this.getLocation(u,h,t)}a.setAllLocationsIfNull(u,l)}},ay.prototype.getDegree=function(){return this._edgeMap.size()},ay.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},ay.prototype.interfaces_=function(){return[]},ay.prototype.getClass=function(){return ay};var uy=function(o){function t(){o.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return o&&(t.__proto__=o),((t.prototype=Object.create(o&&o.prototype)).constructor=t).prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Xd("no outgoing dirEdge found",this.getCoordinate());$p.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},t.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},t.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return rg.isNorthern(r)&&rg.isNorthern(o)?n:rg.isNorthern(r)||rg.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:($p.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},t.prototype.print=function(t){jp.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},t.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new If;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},t.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},t.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;0<=n;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},t.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(jd.LEFT),i=t.getDepth(jd.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new Xd("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=o;u<s;u++){var l=this._edgeList.get(u);l.setEdgeDepths(jd.RIGHT,a),a=l.getDepth(jd.LEFT)}return a}},t.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},t.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;0<=r;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&($p.isTrue(null!==e,"found null for first outgoing dirEdge"),$p.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},t.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();){e.next().isInResult()&&t++}return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();){r.next().getEdgeRing()===n&&i++}return i}},t.prototype.getLabel=function(){return this._label},t.prototype.findCoveredLineEdges=function(){for(var t=Sp.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=Sp.INTERIOR;break}if(i.isInResult()){t=Sp.EXTERIOR;break}}}if(t===Sp.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===Sp.INTERIOR):(s.isInResult()&&(r=Sp.EXTERIOR),a.isInResult()&&(r=Sp.INTERIOR))}},t.prototype.computeLabelling=function(t){o.prototype.computeLabelling.call(this,t),this._label=new Zd(Sp.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next().getEdge().getLabel(),i=0;i<2;i++){var r=n.getLocation(i);r!==Sp.INTERIOR&&r!==Sp.BOUNDARY||this._label.setLocation(i,Sp.INTERIOR)}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(ay),ly=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.createNode=function(t){return new ng(t,new uy)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ug),hy=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};hy.prototype.compareTo=function(t){var e=t;return hy.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},hy.prototype.interfaces_=function(){return[mp]},hy.prototype.getClass=function(){return hy},hy.orientation=function(t){return 1===Mf.increasingDirection(t)},hy.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,u=e?0:t.length-1,l=i?0:n.length-1;;){var h=t[u].compareTo(n[l]);if(0!==h)return h;var c=(u+=r)===s,p=(l+=o)===a;if(c&&!p)return-1;if(!c&&p)return 1;if(c&&p)return 0}};var cy=function(){this._edges=new If,this._ocaMap=new zf};cy.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);0<e&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)0<r&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},cy.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},cy.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},cy.prototype.iterator=function(){return this._edges.iterator()},cy.prototype.getEdges=function(){return this._edges},cy.prototype.get=function(t){return this._edges.get(t)},cy.prototype.findEqualEdge=function(t){var e=new hy(t.getCoordinates());return this._ocaMap.get(e)},cy.prototype.add=function(t){this._edges.add(t);var e=new hy(t.getCoordinates());this._ocaMap.put(e,t)},cy.prototype.interfaces_=function(){return[]},cy.prototype.getClass=function(){return cy};var py=function(){};py.prototype.processIntersections=function(t,e,n,i){},py.prototype.isDone=function(){},py.prototype.interfaces_=function(){return[]},py.prototype.getClass=function(){return py};var fy=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0;var t=arguments[this.numTests=0];this._li=t};fy.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(fy.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},fy.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},fy.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},fy.prototype.getLineIntersector=function(){return this._li},fy.prototype.hasProperIntersection=function(){return this._hasProper},fy.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},fy.prototype.hasIntersection=function(){return this._hasIntersection},fy.prototype.isDone=function(){return!1},fy.prototype.hasInteriorIntersection=function(){return this._hasInterior},fy.prototype.interfaces_=function(){return[py]},fy.prototype.getClass=function(){return fy},fy.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var dy=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new Ep(t),this.segmentIndex=e,this.dist=n};dy.prototype.getSegmentIndex=function(){return this.segmentIndex},dy.prototype.getCoordinate=function(){return this.coord},dy.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},dy.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},dy.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},dy.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},dy.prototype.getDistance=function(){return this.dist},dy.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},dy.prototype.interfaces_=function(){return[mp]},dy.prototype.getClass=function(){return dy};var gy=function(){this._nodeMap=new zf,this.edge=null;var t=arguments[0];this.edge=t};gy.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},gy.prototype.iterator=function(){return this._nodeMap.values().iterator()},gy.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},gy.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},gy.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=0<e.dist||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new Ep(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new by(o,new Zd(this.edge._label))},gy.prototype.add=function(t,e,n){var i=new dy(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},gy.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1},gy.prototype.interfaces_=function(){return[]},gy.prototype.getClass=function(){return gy};var yy=function(){};yy.prototype.getChainStartIndices=function(t){var e=0,n=new If;n.add(new Tp(e));do{var i=this.findChainEnd(t,e);n.add(new Tp(i)),e=i}while(e<t.length-1);return yy.toIntArray(n)},yy.prototype.findChainEnd=function(t,e){for(var n=rg.quadrant(t[e],t[e+1]),i=e+1;i<t.length;){if(rg.quadrant(t[i-1],t[i])!==n)break;i++}return i-1},yy.prototype.interfaces_=function(){return[]},yy.prototype.getClass=function(){return yy},yy.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var _y=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Vp,this.env2=new Vp;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new yy;this.startIndex=e.getChainStartIndices(this.pts)};_y.prototype.getCoordinates=function(){return this.pts},_y.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return n<e?e:n},_y.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},_y.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],u=arguments[4],l=arguments[5],h=this.pts[r],c=this.pts[o],p=s.pts[a],f=s.pts[u];if(o-r==1&&u-a==1)return l.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(h,c),this.env2.init(p,f),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),g=Math.trunc((a+u)/2);r<d&&(a<g&&this.computeIntersectsForChain(r,d,s,a,g,l),g<u&&this.computeIntersectsForChain(r,d,s,g,u,l)),d<o&&(a<g&&this.computeIntersectsForChain(d,o,s,a,g,l),g<u&&this.computeIntersectsForChain(d,o,s,g,u,l))}},_y.prototype.getStartIndexes=function(){return this.startIndex},_y.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},_y.prototype.interfaces_=function(){return[]},_y.prototype.getClass=function(){return _y};var my=function t(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},vy={NULL_VALUE:{configurable:!0}};my.prototype.getDepth=function(t,e){return this._depth[t][e]},my.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},my.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==my.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===my.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._depth[i][r]===my.NULL_VALUE}},my.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},my.prototype.getDelta=function(t){return this._depth[t][jd.RIGHT]-this._depth[t][jd.LEFT]},my.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?Sp.EXTERIOR:Sp.INTERIOR},my.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},my.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==Sp.EXTERIOR&&i!==Sp.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=my.depthAtLocation(i):this._depth[e][n]+=my.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===Sp.INTERIOR&&this._depth[r][o]++}},my.prototype.interfaces_=function(){return[]},my.prototype.getClass=function(){return my},my.depthAtLocation=function(t){return t===Sp.EXTERIOR?0:t===Sp.INTERIOR?1:my.NULL_VALUE},vy.NULL_VALUE.get=function(){return-1},Object.defineProperties(my,vy);var by=function(i){function s(){if(i.call(this),this.pts=null,this._env=null,this.eiList=new gy(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new my,this._depthDelta=0,1===arguments.length){var t=arguments[0];s.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pts=e,this._label=n}}return i&&(s.__proto__=i),((s.prototype=Object.create(i&&i.prototype)).constructor=s).prototype.getDepth=function(){return this._depth},s.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new s(t,Zd.toLineLabel(this._label))},s.prototype.isIsolated=function(){return this._isIsolated},s.prototype.getCoordinates=function(){return this.pts},s.prototype.setIsolated=function(t){this._isIsolated=t},s.prototype.setName=function(t){this._name=t},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,i=!0,r=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(n=!1),this.pts[o].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0},s.prototype.getCoordinate=function(){if(0===arguments.length)return 0<this.pts.length?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},s.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},s.prototype.computeIM=function(t){s.updateIM(this._label,t)},s.prototype.isCollapsed=function(){return!!this._label.isArea()&&(3===this.pts.length&&!!this.pts[0].equals(this.pts[2]))},s.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},s.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},s.prototype.getDepthDelta=function(){return this._depthDelta},s.prototype.getNumPoints=function(){return this.pts.length},s.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;0<=e;e--)t.print(this.pts[e]+" ");t.println("")},s.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new _y(this)),this._mce},s.prototype.getEnvelope=function(){if(null===this._env){this._env=new Vp;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},s.prototype.addIntersection=function(t,e,n,i){var r=new Ep(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var u=this.pts[a];r.equals2D(u)&&(o=a,s=0)}this.eiList.add(r,o,s)},s.prototype.toString=function(){var t=new Op;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},s.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},s.prototype.setDepthDelta=function(t){this._depthDelta=t},s.prototype.getEdgeIntersectionList=function(){return this.eiList},s.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},s.prototype.interfaces_=function(){return[]},s.prototype.getClass=function(){return s},s.updateIM=function(){if(2!==arguments.length)return i.prototype.updateIM.apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,jd.ON),t.getLocation(1,jd.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,jd.LEFT),t.getLocation(1,jd.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,jd.RIGHT),t.getLocation(1,jd.RIGHT),2))},s}(eg),xy=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new cy,this._bufParams=t||null};xy.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},xy.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Zd(t.getLabel())).flip(),n.merge(i);var r=xy.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(xy.depthDelta(t.getLabel()))},xy.prototype.buildSubgraphs=function(t,e){for(var n=new If,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new $g(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},xy.prototype.createSubgraphs=function(t){for(var e=new If,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Jd;r.create(i),e.add(r)}}return mg.sort(e,mg.reverseOrder()),e},xy.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},xy.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new Ug,n=new nf;return n.setPrecisionModel(t),e.setSegmentIntersector(new fy(n)),e},xy.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new Qg(n,this._bufParams),r=new iy(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new lg(new ly),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new hg(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},xy.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new by(r.getCoordinates(),new Zd(s));this.insertUniqueEdge(a)}}},xy.prototype.setNoder=function(t){this._workingNoder=t},xy.prototype.interfaces_=function(){return[]},xy.prototype.getClass=function(){return xy},xy.depthDelta=function(t){var e=t.getLocation(0,jd.LEFT),n=t.getLocation(0,jd.RIGHT);return e===Sp.INTERIOR&&n===Sp.EXTERIOR?1:e===Sp.EXTERIOR&&n===Sp.INTERIOR?-1:0},xy.convertSegStrings=function(t){for(var e=new kd,n=new If;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};var Ey=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=i,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};Ey.prototype.rescale=function(){if(Cp(arguments[0],vf))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&jp.out.println(n)}},Ey.prototype.scale=function(){if(Cp(arguments[0],vf)){for(var t=arguments[0],e=new If,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Tg(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),s=0;s<r.length;s++)o[s]=new Ep(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return Mf.removeRepeatedPoints(o)}},Ey.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Ey.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},Ey.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},Ey.prototype.interfaces_=function(){return[Gg]},Ey.prototype.getClass=function(){return Ey};var wy=function(){this._li=new nf,this._segStrings=null;var t=arguments[0];this._segStrings=t},Iy={fact:{configurable:!0}};wy.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(n))throw new Zp("found endpt/interior pt intersection at index "+o+" :pt "+n)},wy.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),u=0;u<s.length-1;u++)for(var l=0;l<a.length-1;l++)this.checkInteriorIntersections(r,u,o,l);else if(4===arguments.length){var h=arguments[0],c=arguments[1],p=arguments[2],f=arguments[3];if(h===p&&c===f)return null;var d=h.getCoordinates()[c],g=h.getCoordinates()[c+1],y=p.getCoordinates()[f],_=p.getCoordinates()[f+1];if(this._li.computeIntersection(d,g,y,_),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,g)||this.hasInteriorIntersection(this._li,y,_)))throw new Zp("found non-noded intersection at "+d+"-"+g+" and "+y+"-"+_)}},wy.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},wy.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])},wy.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},wy.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new Zp("found non-noded collapse at "+wy.fact.createLineString([t,e,n]))},wy.prototype.interfaces_=function(){return[]},wy.prototype.getClass=function(){return wy},Iy.fact.get=function(){return new kd},Object.defineProperties(wy,Iy);var Ly=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new gp("Scale factor must be non-zero");1!==e&&(this._pt=new Ep(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new Ep,this._p1Scaled=new Ep),this.initCorners(this._pt)},Sy={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Ly.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return $p.isTrue(!(s&&a),"Found bad envelope test"),a},Ly.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new Ep(this._maxx,this._maxy),this._corner[1]=new Ep(this._minx,this._maxy),this._corner[2]=new Ep(this._minx,this._miny),this._corner[3]=new Ep(this._maxx,this._miny)},Ly.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Ly.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},Ly.prototype.getCoordinate=function(){return this._originalPt},Ly.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},Ly.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=Ly.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Vp(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},Ly.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},Ly.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||(!(!n||!i)||(!!t.equals(this._pt)||!!e.equals(this._pt))))))},Ly.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},Ly.prototype.interfaces_=function(){return[]},Ly.prototype.getClass=function(){return Ly},Sy.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(Ly,Sy);var My=function(){this.tempEnv1=new Vp,this.selectedSegment=new Rg};My.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},My.prototype.interfaces_=function(){return[]},My.prototype.getClass=function(){return My};var Cy=function(){this._index=null;var t=arguments[0];this._index=t},Py={HotPixelSnapAction:{configurable:!0}};Cy.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new Ny(e,n,i);return this._index.query(r,{interfaces_:function(){return[dg]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},Cy.prototype.interfaces_=function(){return[]},Cy.prototype.getClass=function(){return Cy},Py.HotPixelSnapAction.get=function(){return Ny},Object.defineProperties(Cy,Py);var Ny=function(i){function t(){i.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(){if(2!==arguments.length)return i.prototype.select.apply(this,arguments);var t=arguments[0],e=arguments[1],n=t.getContext();if(null!==this._parentEdge&&n===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,e)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(My),Oy=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new If};Oy.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},Oy.prototype.isDone=function(){return!1},Oy.prototype.getInteriorIntersections=function(){return this._interiorIntersections},Oy.prototype.interfaces_=function(){return[py]},Oy.prototype.getClass=function(){return Oy};var Ty=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new nf,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};Ty.prototype.checkCorrectness=function(t){var e=Tg.getNodedSubstrings(t),n=new wy(e);try{n.checkValid()}catch(t){if(!(t instanceof Up))throw t;t.printStackTrace()}},Ty.prototype.getNodedSubstrings=function(){return Tg.getNodedSubstrings(this._nodedSegStrings)},Ty.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},Ty.prototype.findInteriorIntersections=function(t,e){var n=new Oy(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},Ty.prototype.computeVertexSnaps=function(){if(Cp(arguments[0],vf))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Tg)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new Ly(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},Ty.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new Ug,this._pointSnapper=new Cy(this._noder.getIndex()),this.snapRound(t,this._li)},Ty.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new Ly(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},Ty.prototype.interfaces_=function(){return[Gg]},Ty.prototype.getClass=function(){return Ty};var Ry=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new jg,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},ky={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Ry.prototype.bufferFixedPrecision=function(t){var e=new Ey(new Ty(new Nd(1)),t.getScale()),n=new xy(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},Ry.prototype.bufferReducedPrecision=function(){var e=this;if(0===arguments.length){for(var t=Ry.MAX_PRECISION_DIGITS;0<=t;t--){try{e.bufferReducedPrecision(t)}catch(t){if(!(t instanceof Xd))throw t;e._saveException=t}if(null!==e._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],i=Ry.precisionScaleFactor(this._argGeom,this._distance,n),r=new Nd(i);this.bufferFixedPrecision(r)}},Ry.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Nd.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},Ry.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},Ry.prototype.bufferOriginalPrecision=function(){try{var t=new xy(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof Zp))throw t;this._saveException=t}},Ry.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},Ry.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},Ry.prototype.interfaces_=function(){return[]},Ry.prototype.getClass=function(){return Ry},Ry.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Ry(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof lf&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1],r=arguments[2],o=new Ry(n);return o.setQuadrantSegments(r),o.getResultGeometry(i)}if(arguments[2]instanceof jg&&arguments[0]instanceof lf&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],u=arguments[2];return new Ry(s,u).getResultGeometry(a)}}else if(4===arguments.length){var l=arguments[0],h=arguments[1],c=arguments[2],p=arguments[3],f=new Ry(l);return f.setQuadrantSegments(c),f.setEndCapStyle(p),f.getResultGeometry(h)}},Ry.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=Pp.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(0<e?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},ky.CAP_ROUND.get=function(){return jg.CAP_ROUND},ky.CAP_BUTT.get=function(){return jg.CAP_FLAT},ky.CAP_FLAT.get=function(){return jg.CAP_FLAT},ky.CAP_SQUARE.get=function(){return jg.CAP_SQUARE},ky.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(Ry,ky);var Dy=function(){this._pt=[new Ep,new Ep],this._distance=yp.NaN,this._isNull=!0};Dy.prototype.getCoordinates=function(){return this._pt},Dy.prototype.getCoordinate=function(t){return this._pt[t]},Dy.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Dy.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Dy.prototype.getDistance=function(){return this._distance},Dy.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Dy.prototype.interfaces_=function(){return[]},Dy.prototype.getClass=function(){return Dy};var Ay=function(){};Ay.prototype.interfaces_=function(){return[]},Ay.prototype.getClass=function(){return Ay},Ay.computeDistance=function(){if(arguments[2]instanceof Dy&&arguments[0]instanceof pd&&arguments[1]instanceof Ep)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=t.getCoordinates(),r=new Rg,o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var s=r.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Dy&&arguments[0]instanceof yd&&arguments[1]instanceof Ep){var a=arguments[0],u=arguments[1],l=arguments[2];Ay.computeDistance(a.getExteriorRing(),u,l);for(var h=0;h<a.getNumInteriorRing();h++)Ay.computeDistance(a.getInteriorRingN(h),u,l)}else if(arguments[2]instanceof Dy&&arguments[0]instanceof lf&&arguments[1]instanceof Ep){var c=arguments[0],p=arguments[1],f=arguments[2];if(c instanceof pd)Ay.computeDistance(c,p,f);else if(c instanceof yd)Ay.computeDistance(c,p,f);else if(c instanceof $f)for(var d=c,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);Ay.computeDistance(y,p,f)}else f.setMinimum(c.getCoordinate(),p)}else if(arguments[2]instanceof Dy&&arguments[0]instanceof Rg&&arguments[1]instanceof Ep){var _=arguments[0],m=arguments[1],v=arguments[2],b=_.closestPoint(m);v.setMinimum(b,m)}};var Fy=function(t){this._maxPtDist=new Dy,this._inputGeom=t||null},Gy={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};Fy.prototype.computeMaxMidpointDistance=function(t){var e=new Uy(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Fy.prototype.computeMaxVertexDistance=function(t){var e=new By(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},Fy.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},Fy.prototype.getDistancePoints=function(){return this._maxPtDist},Fy.prototype.interfaces_=function(){return[]},Fy.prototype.getClass=function(){return Fy},Gy.MaxPointDistanceFilter.get=function(){return By},Gy.MaxMidpointDistanceFilter.get=function(){return Uy},Object.defineProperties(Fy,Gy);var By=function(t){this._maxPtDist=new Dy,this._minPtDist=new Dy,this._geom=t||null};By.prototype.filter=function(t){this._minPtDist.initialize(),Ay.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},By.prototype.getMaxPointDistance=function(){return this._maxPtDist},By.prototype.interfaces_=function(){return[pf]},By.prototype.getClass=function(){return By};var Uy=function(t){this._maxPtDist=new Dy,this._minPtDist=new Dy,this._geom=t||null};Uy.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new Ep((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),Ay.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Uy.prototype.isDone=function(){return!1},Uy.prototype.isGeometryChanged=function(){return!1},Uy.prototype.getMaxPointDistance=function(){return this._maxPtDist},Uy.prototype.interfaces_=function(){return[Qf]},Uy.prototype.getClass=function(){return Uy};var qy=function(t){this._comps=t||null};qy.prototype.filter=function(t){t instanceof yd&&this._comps.add(t)},qy.prototype.interfaces_=function(){return[Zf]},qy.prototype.getClass=function(){return qy},qy.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return qy.getPolygons(t,new If)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof yd?n.add(e):e instanceof $f&&e.apply(new qy(n)),n}};var jy=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};jy.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof md){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof pd&&this._lines.add(t)},jy.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},jy.prototype.interfaces_=function(){return[uf]},jy.prototype.getClass=function(){return jy},jy.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(jy.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(jy.getLines(e,n))}},jy.getLines=function(){if(1===arguments.length){var t=arguments[0];return jy.getLines(t,!1)}if(2===arguments.length){if(Cp(arguments[0],vf)&&Cp(arguments[1],vf)){for(var e=arguments[0],n=arguments[1],i=e.iterator();i.hasNext();){var r=i.next();jy.getLines(r,n)}return n}if(arguments[0]instanceof lf&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1],a=new If;return o.apply(new jy(a,s)),a}if(arguments[0]instanceof lf&&Cp(arguments[1],vf)){var u=arguments[0],l=arguments[1];return u instanceof pd?l.add(u):u.apply(new jy(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Cp(arguments[0],vf)&&Cp(arguments[1],vf)){for(var h=arguments[0],c=arguments[1],p=arguments[2],f=h.iterator();f.hasNext();){var d=f.next();jy.getLines(d,c,p)}return c}if("boolean"==typeof arguments[2]&&arguments[0]instanceof lf&&Cp(arguments[1],vf)){var g=arguments[0],y=arguments[1],_=arguments[2];return g.apply(new jy(y,_)),y}}};var zy=function(){if(this._boundaryRule=ff.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new gp("Rule must be non-null");this._boundaryRule=t}};zy.prototype.locateInternal=function(){if(arguments[0]instanceof Ep&&arguments[1]instanceof yd){var t=arguments[0],e=arguments[1];if(e.isEmpty())return Sp.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===Sp.EXTERIOR)return Sp.EXTERIOR;if(i===Sp.BOUNDARY)return Sp.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===Sp.INTERIOR)return Sp.EXTERIOR;if(s===Sp.BOUNDARY)return Sp.BOUNDARY}return Sp.INTERIOR}if(arguments[0]instanceof Ep&&arguments[1]instanceof pd){var a=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(a))return Sp.EXTERIOR;var l=u.getCoordinates();return u.isClosed()||!a.equals(l[0])&&!a.equals(l[l.length-1])?sf.isOnLine(a,l)?Sp.INTERIOR:Sp.EXTERIOR:Sp.BOUNDARY}if(arguments[0]instanceof Ep&&arguments[1]instanceof dd){var h=arguments[0];return arguments[1].getCoordinate().equals2D(h)?Sp.INTERIOR:Sp.EXTERIOR}},zy.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?sf.locatePointInRing(t,e.getCoordinates()):Sp.EXTERIOR},zy.prototype.intersects=function(t,e){return this.locate(t,e)!==Sp.EXTERIOR},zy.prototype.updateLocationInfo=function(t){t===Sp.INTERIOR&&(this._isIn=!0),t===Sp.BOUNDARY&&this._numBoundaries++},zy.prototype.computeLocation=function(t,e){if(e instanceof dd&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof pd)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof yd)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof td)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof vd)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof $f)for(var u=new oy(e);u.hasNext();){var l=u.next();l!==e&&this.computeLocation(t,l)}},zy.prototype.locate=function(t,e){return e.isEmpty()?Sp.EXTERIOR:e instanceof pd?this.locateInternal(t,e):e instanceof yd?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?Sp.BOUNDARY:0<this._numBoundaries||this._isIn?Sp.INTERIOR:Sp.EXTERIOR)},zy.prototype.interfaces_=function(){return[]},zy.prototype.getClass=function(){return zy};var Vy=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._component=i,this._segIndex=r,this._pt=o}},Yy={INSIDE_AREA:{configurable:!0}};Vy.prototype.isInsideArea=function(){return this._segIndex===Vy.INSIDE_AREA},Vy.prototype.getCoordinate=function(){return this._pt},Vy.prototype.getGeometryComponent=function(){return this._component},Vy.prototype.getSegmentIndex=function(){return this._segIndex},Vy.prototype.interfaces_=function(){return[]},Vy.prototype.getClass=function(){return Vy},Yy.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Vy,Yy);var Hy=function(t){this._pts=t||null};Hy.prototype.filter=function(t){t instanceof dd&&this._pts.add(t)},Hy.prototype.interfaces_=function(){return[Zf]},Hy.prototype.getClass=function(){return Hy},Hy.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof dd?mg.singletonList(t):Hy.getPoints(t,new If)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof dd?n.add(e):e instanceof $f&&e.apply(new Hy(n)),n}};var Xy=function(){this._locations=null;var t=arguments[0];this._locations=t};Xy.prototype.filter=function(t){(t instanceof dd||t instanceof pd||t instanceof yd)&&this._locations.add(new Vy(t,0,t.getCoordinate()))},Xy.prototype.interfaces_=function(){return[Zf]},Xy.prototype.getClass=function(){return Xy},Xy.getLocations=function(t){var e=new If;return t.apply(new Xy(e)),e};var Wy=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new zy,this._minDistanceLocation=null,this._minDistance=yp.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=i,this._terminateDistance=r}};Wy.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=qy.getPolygons(this._geom[e]);if(0<r.size()){var o=Xy.getLocations(this._geom[i]);if(this.computeContainmentDistance(o,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Cp(arguments[0],Ef)&&Cp(arguments[1],Ef)){for(var s=arguments[0],a=arguments[1],u=arguments[2],l=0;l<s.size();l++)for(var h=s.get(l),c=0;c<a.size();c++)if(this.computeContainmentDistance(h,a.get(c),u),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Vy&&arguments[1]instanceof yd){var p=arguments[0],f=arguments[1],d=arguments[2],g=p.getCoordinate();if(Sp.EXTERIOR!==this._ptLocator.locate(g,f))return d[this._minDistance=0]=p,d[1]=new Vy(f,g),null}},Wy.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Wy.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=jy.getLines(this._geom[0]),n=jy.getLines(this._geom[1]),i=Hy.getPoints(this._geom[0]),r=Hy.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},Wy.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Wy.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;this._minDistanceLocation[1]=e?(this._minDistanceLocation[0]=t[1],t[0]):(this._minDistanceLocation[0]=t[0],t[1])},Wy.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Wy.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof pd&&arguments[1]instanceof dd){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var s=sf.distancePointLine(r,i[o],i[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new Rg(i[o],i[o+1]).closestPoint(r);n[0]=new Vy(t,o,a),n[1]=new Vy(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof pd&&arguments[1]instanceof pd){var u=arguments[0],l=arguments[1],h=arguments[2];if(u.getEnvelopeInternal().distance(l.getEnvelopeInternal())>this._minDistance)return null;for(var c=u.getCoordinates(),p=l.getCoordinates(),f=0;f<c.length-1;f++)for(var d=0;d<p.length-1;d++){var g=sf.distanceLineLine(c[f],c[f+1],p[d],p[d+1]);if(g<this._minDistance){this._minDistance=g;var y=new Rg(c[f],c[f+1]),_=new Rg(p[d],p[d+1]),m=y.closestPoints(_);h[0]=new Vy(u,f,m[0]),h[1]=new Vy(l,d,m[1])}if(this._minDistance<=this._terminateDistance)return null}}},Wy.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Vy(r,0,r.getCoordinate()),n[1]=new Vy(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Wy.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new gp("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Wy.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Wy.prototype.interfaces_=function(){return[]},Wy.prototype.getClass=function(){return Wy},Wy.distance=function(t,e){return new Wy(t,e).distance()},Wy.isWithinDistance=function(t,e,n){return new Wy(t,e,n).distance()<=n},Wy.nearestPoints=function(t,e){return new Wy(t,e).nearestPoints()};var Jy=function(){this._pt=[new Ep,new Ep],this._distance=yp.NaN,this._isNull=!0};Jy.prototype.getCoordinates=function(){return this._pt},Jy.prototype.getCoordinate=function(t){return this._pt[t]},Jy.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Jy.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Jy.prototype.toString=function(){return Kp.toLineString(this._pt[0],this._pt[1])},Jy.prototype.getDistance=function(){return this._distance},Jy.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Jy.prototype.interfaces_=function(){return[]},Jy.prototype.getClass=function(){return Jy};var Ky=function(){};Ky.prototype.interfaces_=function(){return[]},Ky.prototype.getClass=function(){return Ky},Ky.computeDistance=function(){if(arguments[2]instanceof Jy&&arguments[0]instanceof pd&&arguments[1]instanceof Ep)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=new Rg,r=t.getCoordinates(),o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Jy&&arguments[0]instanceof yd&&arguments[1]instanceof Ep){var a=arguments[0],u=arguments[1],l=arguments[2];Ky.computeDistance(a.getExteriorRing(),u,l);for(var h=0;h<a.getNumInteriorRing();h++)Ky.computeDistance(a.getInteriorRingN(h),u,l)}else if(arguments[2]instanceof Jy&&arguments[0]instanceof lf&&arguments[1]instanceof Ep){var c=arguments[0],p=arguments[1],f=arguments[2];if(c instanceof pd)Ky.computeDistance(c,p,f);else if(c instanceof yd)Ky.computeDistance(c,p,f);else if(c instanceof $f)for(var d=c,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);Ky.computeDistance(y,p,f)}else f.setMinimum(c.getCoordinate(),p)}else if(arguments[2]instanceof Jy&&arguments[0]instanceof Rg&&arguments[1]instanceof Ep){var _=arguments[0],m=arguments[1],v=arguments[2],b=_.closestPoint(m);v.setMinimum(b,m)}};var Zy=function(){this._g0=null,this._g1=null,this._ptDist=new Jy;var t=arguments[this._densifyFrac=0],e=arguments[1];this._g0=t,this._g1=e},Qy={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Zy.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Zy.prototype.setDensifyFraction=function(t){if(1<t||t<=0)throw new gp("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Zy.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Zy.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Zy.prototype.computeOrientedDistance=function(t,e,n){var i=new $y(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),0<this._densifyFrac){var r=new t_(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},Zy.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Zy.prototype.interfaces_=function(){return[]},Zy.prototype.getClass=function(){return Zy},Zy.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Zy(t,e).distance()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new Zy(n,i);return o.setDensifyFraction(r),o.distance()}},Qy.MaxPointDistanceFilter.get=function(){return $y},Qy.MaxDensifiedByFractionDistanceFilter.get=function(){return t_},Object.defineProperties(Zy,Qy);var $y=function(){this._maxPtDist=new Jy,this._minPtDist=new Jy,this._euclideanDist=new Ky,this._geom=null;var t=arguments[0];this._geom=t};$y.prototype.filter=function(t){this._minPtDist.initialize(),Ky.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},$y.prototype.getMaxPointDistance=function(){return this._maxPtDist},$y.prototype.interfaces_=function(){return[pf]},$y.prototype.getClass=function(){return $y};var t_=function(){this._maxPtDist=new Jy,this._minPtDist=new Jy,this._geom=null;var t=arguments[this._numSubSegs=0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};t_.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,u=n.y+s*o,l=new Ep(a,u);this._minPtDist.initialize(),Ky.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},t_.prototype.isDone=function(){return!1},t_.prototype.isGeometryChanged=function(){return!1},t_.prototype.getMaxPointDistance=function(){return this._maxPtDist},t_.prototype.interfaces_=function(){return[Qf]},t_.prototype.getClass=function(){return t_};var e_=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},n_={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};e_.prototype.checkMaximumDistance=function(t,e,n){var i=new Zy(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Kp.toLineString(r[0],r[1])+")"}},e_.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=e_.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(0<this._bufDistance?this.checkPositiveValid():this.checkNegativeValid(),e_.VERBOSE&&jp.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},e_.prototype.checkNegativeValid=function(){if(!(this._input instanceof yd||this._input instanceof vd||this._input instanceof $f))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},e_.prototype.getErrorIndicator=function(){return this._errorIndicator},e_.prototype.checkMinimumDistance=function(t,e,n){var i=new Wy(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Kp.toLineString(r[0],r[1])+" )"}},e_.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},e_.prototype.getErrorLocation=function(){return this._errorLocation},e_.prototype.getPolygonLines=function(t){for(var e=new If,n=new jy(e),i=qy.getPolygons(t).iterator();i.hasNext();){i.next().apply(n)}return t.getFactory().buildGeometry(e)},e_.prototype.getErrorMessage=function(){return this._errMsg},e_.prototype.interfaces_=function(){return[]},e_.prototype.getClass=function(){return e_},n_.VERBOSE.get=function(){return!1},n_.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(e_,n_);var i_=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},r_={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};i_.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid&&this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid},i_.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*i_.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new Vp(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new Vp(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},i_.prototype.checkDistance=function(){var t=new e_(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},i_.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();0<this._distance&&e<t&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},i_.prototype.checkPolygonal=function(){this._result instanceof yd||this._result instanceof vd||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},i_.prototype.getErrorIndicator=function(){return this._errorIndicator},i_.prototype.getErrorLocation=function(){return this._errorLocation},i_.prototype.checkExpectedEmpty=function(){return 2<=this._input.getDimension()?null:0<this._distance?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},i_.prototype.report=function(t){if(!i_.VERBOSE)return null;jp.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},i_.prototype.getErrorMessage=function(){return this._errorMsg},i_.prototype.interfaces_=function(){return[]},i_.prototype.getClass=function(){return i_},i_.isValidMsg=function(t,e,n){var i=new i_(t,e,n);return i.isValid()?null:i.getErrorMessage()},i_.isValid=function(t,e,n){return!!new i_(t,e,n).isValid()},r_.VERBOSE.get=function(){return!1},r_.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(i_,r_);var o_=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};o_.prototype.getCoordinates=function(){return this._pts},o_.prototype.size=function(){return this._pts.length},o_.prototype.getCoordinate=function(t){return this._pts[t]},o_.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},o_.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:Pg.octant(this.getCoordinate(t),this.getCoordinate(t+1))},o_.prototype.setData=function(t){this._data=t},o_.prototype.getData=function(){return this._data},o_.prototype.toString=function(){return Kp.toLineString(new Ld(this._pts))},o_.prototype.interfaces_=function(){return[Ng]},o_.prototype.getClass=function(){return o_};var s_=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new If,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};s_.prototype.getInteriorIntersection=function(){return this._interiorIntersection},s_.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},s_.prototype.getIntersectionSegments=function(){return this._intSegments},s_.prototype.count=function(){return this._intersectionCount},s_.prototype.getIntersections=function(){return this._intersections},s_.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},s_.prototype.setKeepIntersections=function(t){this._keepIntersections=t},s_.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!(this.isEndSegment(t,e)||this.isEndSegment(n,i)))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},s_.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},s_.prototype.hasIntersection=function(){return null!==this._interiorIntersection},s_.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},s_.prototype.interfaces_=function(){return[py]},s_.prototype.getClass=function(){return s_},s_.createAllIntersectionsFinder=function(t){var e=new s_(t);return e.setFindAllIntersections(!0),e},s_.createAnyIntersectionFinder=function(t){return new s_(t)},s_.createIntersectionCounter=function(t){var e=new s_(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var a_=function(){this._li=new nf,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};a_.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},a_.prototype.getIntersections=function(){return this._segInt.getIntersections()},a_.prototype.isValid=function(){return this.execute(),this._isValid},a_.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},a_.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new s_(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new Ug;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},a_.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Xd(this.getErrorMessage(),this._segInt.getInteriorIntersection())},a_.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Kp.toLineString(t[0],t[1])+" and "+Kp.toLineString(t[2],t[3])},a_.prototype.interfaces_=function(){return[]},a_.prototype.getClass=function(){return a_},a_.computeIntersections=function(t){var e=new a_(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var u_=function t(){this._nv=null;var e=arguments[0];this._nv=new a_(t.toSegmentStrings(e))};u_.prototype.checkValid=function(){this._nv.checkValid()},u_.prototype.interfaces_=function(){return[]},u_.prototype.getClass=function(){return u_},u_.toSegmentStrings=function(t){for(var e=new If,n=t.iterator();n.hasNext();){var i=n.next();e.add(new o_(i.getCoordinates(),i))}return e},u_.checkValid=function(t){new u_(t).checkValid()};var l_=function(t){this._mapOp=t};l_.prototype.map=function(t){for(var e=new If,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(kd.toGeometryArray(e))},l_.prototype.interfaces_=function(){return[]},l_.prototype.getClass=function(){return l_},l_.map=function(t,e){return new l_(e).map(t)};var h_=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new If,this._resultLineList=new If;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};h_.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},h_.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},h_.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},h_.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!V_.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},h_.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();){t.next().getEdges().findCoveredLineEdges()}for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},h_.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},h_.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}},h_.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:($p.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(V_.isResultOfOp(i,e)&&e===V_.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},h_.prototype.interfaces_=function(){return[]},h_.prototype.getClass=function(){return h_};var c_=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new If;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};c_.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},c_.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!n.isInResult()&&(!n.isIncidentEdgeInResult()&&(0===n.getEdges().getDegree()||t===V_.INTERSECTION))){var i=n.getLabel();V_.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},c_.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},c_.prototype.interfaces_=function(){return[]},c_.prototype.getClass=function(){return c_};var p_=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};p_.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},p_.prototype.transformPolygon=function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof md&&!i.isEmpty()||(n=!1);for(var r=new If,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof md||(n=!1),r.add(s))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new If;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)},p_.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},p_.prototype.getInputGeometry=function(){return this._inputGeom},p_.prototype.transformMultiLineString=function(t,e){for(var n=new If,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},p_.prototype.transformCoordinates=function(t,e){return this.copy(t)},p_.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},p_.prototype.transformMultiPoint=function(t,e){for(var n=new If,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},p_.prototype.transformMultiPolygon=function(t,e){for(var n=new If,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},p_.prototype.copy=function(t){return t.copy()},p_.prototype.transformGeometryCollection=function(t,e){for(var n=new If,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(kd.toGeometryArray(n)):this._factory.buildGeometry(n)},p_.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof dd)return this.transformPoint(t,null);if(t instanceof _d)return this.transformMultiPoint(t,null);if(t instanceof md)return this.transformLinearRing(t,null);if(t instanceof pd)return this.transformLineString(t,null);if(t instanceof td)return this.transformMultiLineString(t,null);if(t instanceof yd)return this.transformPolygon(t,null);if(t instanceof vd)return this.transformMultiPolygon(t,null);if(t instanceof $f)return this.transformGeometryCollection(t,null);throw new gp("Unknown Geometry subtype: "+t.getClass().getName())},p_.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return 0<i&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},p_.prototype.interfaces_=function(){return[]},p_.prototype.getClass=function(){return p_};var f_=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Rg,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof pd&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=t.isClosed(i),this._snapTolerance=r}};f_.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new Ep(o)),0===i&&this._isClosed&&t.set(t.size()-1,new Ep(o)))}},f_.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},f_.prototype.snapTo=function(t){var e=new Sf(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},f_.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);0<=o&&t.add(o+1,new Ep(r),!1)}},f_.prototype.findSegmentIndexToSnap=function(t,e){for(var n=yp.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},f_.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},f_.prototype.interfaces_=function(){return[]},f_.prototype.getClass=function(){return f_},f_.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var d_=function(t){this._srcGeom=t||null},g_={SNAP_PRECISION_FACTOR:{configurable:!0}};d_.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new y_(e,n).transform(this._srcGeom)},d_.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new y_(t,n,!0).transform(this._srcGeom),r=i;return e&&Cp(r,gd)&&(r=i.buffer(0)),r},d_.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},d_.prototype.extractTargetCoordinates=function(t){for(var e=new Hf,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},d_.prototype.computeMinimumSegmentLength=function(t){for(var e=yp.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},d_.prototype.interfaces_=function(){return[]},d_.prototype.getClass=function(){return d_},d_.snap=function(t,e,n){var i=new Array(2).fill(null),r=new d_(t);i[0]=r.snapTo(e,n);var o=new d_(e);return i[1]=o.snapTo(i[0],n),i},d_.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=d_.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===Nd.FIXED){var i=1/n.getScale()*2/1.415;e<i&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(d_.computeOverlaySnapTolerance(r),d_.computeOverlaySnapTolerance(o))}},d_.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*d_.SNAP_PRECISION_FACTOR},d_.snapToSelf=function(t,e,n){return new d_(t).snapToSelf(e,n)},g_.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(d_,g_);var y_=function(i){function t(t,e,n){i.call(this),this._snapTolerance=t||null,this._snapPts=e||null,this._isSelfSnap=void 0!==n&&n}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.snapLine=function(t,e){var n=new f_(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},t.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(p_),__=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};__.prototype.getCommon=function(){return yp.longBitsToDouble(this._commonBits)},__.prototype.add=function(t){var e=yp.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=__.signExpBits(this._commonBits),this._isFirst=!1,null):__.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=__.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=__.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},__.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=yp.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+yp.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},__.prototype.interfaces_=function(){return[]},__.prototype.getClass=function(){return __},__.getBit=function(t,e){return 0!=(t&1<<e)?1:0},__.signExpBits=function(t){return t>>52},__.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},__.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;0<=i;i--){if(__.getBit(t,i)!==__.getBit(e,i))return n;n++}return 52};var m_=function(){this._commonCoord=null,this._ccFilter=new b_},v_={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};m_.prototype.addCommonBits=function(t){var e=new x_(this._commonCoord);t.apply(e),t.geometryChanged()},m_.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new Ep(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new x_(e);return t.apply(n),t.geometryChanged(),t},m_.prototype.getCommonCoordinate=function(){return this._commonCoord},m_.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},m_.prototype.interfaces_=function(){return[]},m_.prototype.getClass=function(){return m_},v_.CommonCoordinateFilter.get=function(){return b_},v_.Translater.get=function(){return x_},Object.defineProperties(m_,v_);var b_=function(){this._commonBitsX=new __,this._commonBitsY=new __};b_.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},b_.prototype.getCommonCoordinate=function(){return new Ep(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},b_.prototype.interfaces_=function(){return[pf]},b_.prototype.getClass=function(){return b_};var x_=function(){this.trans=null;var t=arguments[0];this.trans=t};x_.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},x_.prototype.isDone=function(){return!1},x_.prototype.isGeometryChanged=function(){return!0},x_.prototype.interfaces_=function(){return[Qf]},x_.prototype.getClass=function(){return x_};var E_=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};E_.prototype.selfSnap=function(t){return new d_(t).snapTo(t,this._snapTolerance)},E_.prototype.removeCommonBits=function(t){this._cbr=new m_,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},E_.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},E_.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=V_.overlayOp(e[0],e[1],t);return this.prepareResult(n)},E_.prototype.checkValid=function(t){t.isValid()||jp.out.println("Snapped geometry is invalid")},E_.prototype.computeSnapTolerance=function(){this._snapTolerance=d_.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},E_.prototype.snap=function(t){var e=this.removeCommonBits(t);return d_.snap(e[0],e[1],this._snapTolerance)},E_.prototype.interfaces_=function(){return[]},E_.prototype.getClass=function(){return E_},E_.overlayOp=function(t,e,n){return new E_(t,e).getResultGeometry(n)},E_.union=function(t,e){return E_.overlayOp(t,e,V_.UNION)},E_.intersection=function(t,e){return E_.overlayOp(t,e,V_.INTERSECTION)},E_.symDifference=function(t,e){return E_.overlayOp(t,e,V_.SYMDIFFERENCE)},E_.difference=function(t,e){return E_.overlayOp(t,e,V_.DIFFERENCE)};var w_=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};w_.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=V_.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof Zp))throw t;i=t}if(!n)try{e=E_.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof Zp?i:t}return e},w_.prototype.interfaces_=function(){return[]},w_.prototype.getClass=function(){return w_},w_.overlayOp=function(t,e,n){return new w_(t,e).getResultGeometry(n)},w_.union=function(t,e){return w_.overlayOp(t,e,V_.UNION)},w_.intersection=function(t,e){return w_.overlayOp(t,e,V_.INTERSECTION)},w_.symDifference=function(t,e){return w_.overlayOp(t,e,V_.SYMDIFFERENCE)},w_.difference=function(t,e){return w_.overlayOp(t,e,V_.DIFFERENCE)};var I_=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};I_.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},I_.prototype.interfaces_=function(){return[]},I_.prototype.getClass=function(){return I_};var L_=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=i,this._xValue=r,this._obj=o}},S_={INSERT:{configurable:!0},DELETE:{configurable:!0}};L_.prototype.isDelete=function(){return this._eventType===L_.DELETE},L_.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},L_.prototype.getObject=function(){return this._obj},L_.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},L_.prototype.getInsertEvent=function(){return this._insertEvent},L_.prototype.isInsert=function(){return this._eventType===L_.INSERT},L_.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},L_.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},L_.prototype.interfaces_=function(){return[mp]},L_.prototype.getClass=function(){return L_},S_.INSERT.get=function(){return 1},S_.DELETE.get=function(){return 2},Object.defineProperties(L_,S_);var M_=function(){};M_.prototype.interfaces_=function(){return[]},M_.prototype.getClass=function(){return M_};var C_=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};C_.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(C_.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},C_.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},C_.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},C_.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},C_.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},C_.prototype.hasProperIntersection=function(){return this._hasProper},C_.prototype.hasIntersection=function(){return this._hasIntersection},C_.prototype.isDone=function(){return this._isDone},C_.prototype.isBoundaryPoint=function(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))},C_.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},C_.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},C_.prototype.interfaces_=function(){return[]},C_.prototype.getClass=function(){return C_},C_.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var P_=function(t){function e(){t.call(this),this.events=new If,this.nOverlaps=null}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.prepareEvents=function(){mg.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof C_&&Cp(arguments[0],Ef)&&Cp(arguments[1],Ef)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&Cp(arguments[0],Ef)&&arguments[1]instanceof C_){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new I_(n,r),s=new L_(e,n.getMinX(r),o);this.events.add(s),this.events.add(new L_(n.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var o=r.next();this.addEdge(o,i)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(M_),N_=function(){this._min=yp.POSITIVE_INFINITY,this._max=yp.NEGATIVE_INFINITY},O_={NodeComparator:{configurable:!0}};N_.prototype.getMin=function(){return this._min},N_.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},N_.prototype.getMax=function(){return this._max},N_.prototype.toString=function(){return Kp.toLineString(new Ep(this._min,0),new Ep(this._max,0))},N_.prototype.interfaces_=function(){return[]},N_.prototype.getClass=function(){return N_},O_.NodeComparator.get=function(){return T_},Object.defineProperties(N_,O_);var T_=function(){};T_.prototype.compare=function(t,e){var n=t,i=e,r=(n._min+n._max)/2,o=(i._min+i._max)/2;return r<o?-1:o<r?1:0},T_.prototype.interfaces_=function(){return[bp]},T_.prototype.getClass=function(){return T_};var R_=function(i){function t(){i.call(this),this._item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._min=t,this._max=e,this._item=n}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(N_),k_=function(n){function t(){n.call(this),this._node1=null,this._node2=null;var t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)}return n&&(t.__proto__=n),((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},t.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},t}(N_),D_=function(){this._leaves=new If,this._root=null,this._level=0};D_.prototype.buildTree=function(){mg.sort(this._leaves,new N_.NodeComparator);for(var t=this._leaves,e=null,n=new If;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},D_.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new R_(t,e,n))},D_.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},D_.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},D_.prototype.printNode=function(t){jp.out.println(Kp.toLineString(new Ep(t._min,this._level),new Ep(t._max,this._level)))},D_.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},D_.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new k_(t.get(n),t.get(n+1));e.add(r)}}},D_.prototype.interfaces_=function(){return[]},D_.prototype.getClass=function(){return D_};var A_=function(){this._items=new If};A_.prototype.visitItem=function(t){this._items.add(t)},A_.prototype.getItems=function(){return this._items},A_.prototype.interfaces_=function(){return[dg]},A_.prototype.getClass=function(){return A_};var F_=function(){this._index=null;var t=arguments[0];if(!Cp(t,gd))throw new gp("Argument must be Polygonal");this._index=new U_(t)},G_={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};F_.prototype.locate=function(t){var e=new of(t),n=new B_(e);return this._index.query(t.y,t.y,n),e.getLocation()},F_.prototype.interfaces_=function(){return[ry]},F_.prototype.getClass=function(){return F_},G_.SegmentVisitor.get=function(){return B_},G_.IntervalIndexedGeometry.get=function(){return U_},Object.defineProperties(F_,G_);var B_=function(){this._counter=null;var t=arguments[0];this._counter=t};B_.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},B_.prototype.interfaces_=function(){return[dg]},B_.prototype.getClass=function(){return B_};var U_=function(){this._index=new D_;var t=arguments[0];this.init(t)};U_.prototype.init=function(t){for(var e=jy.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},U_.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new Rg(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},U_.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new A_;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._index.query(i,r,o)}},U_.prototype.interfaces_=function(){return[]},U_.prototype.getClass=function(){return U_};var q_=function(s){function o(){if(s.call(this),this._parentGeom=null,this._lineEdgeMap=new Pd,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new zy,2===arguments.length){var t=arguments[0],e=arguments[1],n=ff.OGC_SFS_BOUNDARY_RULE;this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=n,null!==e&&this.add(e)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._argIndex=i,this._parentGeom=r,this._boundaryNodeRule=o,null!==r&&this.add(r)}}return s&&(o.__proto__=s),((o.prototype=Object.create(s&&s.prototype)).constructor=o).prototype.insertBoundaryPoint=function(t,e){var n=this._nodes.addNode(e).getLabel(),i=1;n.getLocation(t,jd.ON)===Sp.BOUNDARY&&i++;var r=o.determineBoundary(this._boundaryNodeRule,i);n.setLocation(t,r)},o.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new C_(n,!0,!1);o.setIsDoneIfProperInt(r);var s=this.createEdgeSetIntersector(),a=this._parentGeom instanceof md||this._parentGeom instanceof yd||this._parentGeom instanceof vd,u=i||!a;return s.computeIntersections(this._edges,o,u),this.addSelfIntersectionNodes(this._argIndex),o}},o.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();){e.next().eiList.addSplitEdges(t)}},o.prototype.computeEdgeIntersections=function(t,e,n){var i=new C_(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},o.prototype.getGeometry=function(){return this._parentGeom},o.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},o.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},o.prototype.addPoint=function(){if(arguments[0]instanceof dd){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,Sp.INTERIOR)}else if(arguments[0]instanceof Ep){var e=arguments[0];this.insertPoint(this._argIndex,e,Sp.INTERIOR)}},o.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),Sp.EXTERIOR,Sp.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,Sp.INTERIOR,Sp.EXTERIOR)}},o.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],Sp.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],Sp.BOUNDARY)},o.prototype.addLineString=function(t){var e=Mf.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new by(e,new Zd(this._argIndex,Sp.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),$p.isTrue(2<=e.length,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},o.prototype.getInvalidPoint=function(){return this._invalidPoint},o.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},o.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},o.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===Sp.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},o.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=Mf.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;sf.isCCW(i)&&(r=n,o=e);var s=new by(i,new Zd(this._argIndex,Sp.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],Sp.BOUNDARY)},o.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new Zd(t,n):r.setLocation(t,n)},o.prototype.createEdgeSetIntersector=function(){return new P_},o.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},o.prototype.add=function(){if(1!==arguments.length)return s.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof vd&&(this._useBoundaryDeterminationRule=!1),t instanceof yd)this.addPolygon(t);else if(t instanceof pd)this.addLineString(t);else if(t instanceof dd)this.addPoint(t);else if(t instanceof _d)this.addCollection(t);else if(t instanceof td)this.addCollection(t);else if(t instanceof vd)this.addCollection(t);else{if(!(t instanceof $f))throw new Error(t.getClass().getName());this.addCollection(t)}},o.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},o.prototype.locate=function(t){return Cp(this._parentGeom,gd)&&50<this._parentGeom.getNumGeometries()?(null===this._areaPtLocator&&(this._areaPtLocator=new F_(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},o.prototype.findEdge=function(){if(1!==arguments.length)return s.prototype.findEdge.apply(this,arguments);var t=arguments[0];return this._lineEdgeMap.get(t)},o.prototype.interfaces_=function(){return[]},o.prototype.getClass=function(){return o},o.determineBoundary=function(t,e){return t.isInBoundary(e)?Sp.BOUNDARY:Sp.INTERIOR},o}(lg),j_=function(){if(this._li=new nf,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new q_(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=ff.OGC_SFS_BOUNDARY_RULE;0<=e.getPrecisionModel().compareTo(n.getPrecisionModel())?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new q_(0,e,i),this._arg[1]=new q_(1,n,i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];0<=r.getPrecisionModel().compareTo(o.getPrecisionModel())?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new q_(0,r,s),this._arg[1]=new q_(1,o,s)}};j_.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},j_.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},j_.prototype.interfaces_=function(){return[]},j_.prototype.getClass=function(){return j_};var z_=function(){};z_.prototype.interfaces_=function(){return[]},z_.prototype.getClass=function(){return z_},z_.map=function(){if(arguments[0]instanceof lf&&Cp(arguments[1],z_.MapOp)){for(var t=arguments[0],e=arguments[1],n=new If,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(Cp(arguments[0],vf)&&Cp(arguments[1],z_.MapOp)){for(var o=arguments[0],s=arguments[1],a=new If,u=o.iterator();u.hasNext();){var l=u.next(),h=s.map(l);null!==h&&a.add(h)}return a}},z_.MapOp=function(){};var V_=function(n){function o(){var t=arguments[0],e=arguments[1];n.call(this,t,e),this._ptLocator=new zy,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new cy,this._resultPolyList=new If,this._resultLineList=new If,this._resultPointList=new If,this._graph=new lg(new ly),this._geomFact=t.getFactory()}return n&&(o.__proto__=n),((o.prototype=Object.create(n&&n.prototype)).constructor=o).prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Zd(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},o.prototype.getGraph=function(){return this._graph},o.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},o.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},o.prototype.computeGeometry=function(t,e,n,i){var r=new If;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?o.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(r)},o.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){t.next().getEdges().mergeSymLabels()}},o.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==Sp.EXTERIOR)return!0}return!1},o.prototype.replaceCollapsedEdges=function(){for(var t=new If,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},o.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},o.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},o.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},o.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new If;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),u_.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new hg(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new h_(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new c_(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},o.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},o.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},o.prototype.findResultAreaEdges=function(t){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&o.isResultOfOp(i.getLocation(0,jd.RIGHT),i.getLocation(1,jd.RIGHT),t)&&n.setInResult(!0)}},o.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):($p.isTrue(!i.isNull(r,jd.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,jd.LEFT,i.getLocation(r,jd.LEFT)),$p.isTrue(!i.isNull(r,jd.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,jd.RIGHT,i.getLocation(r,jd.RIGHT))))}}},o.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){t.next().getEdges().computeLabelling(this._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},o.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},o.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},o.prototype.interfaces_=function(){return[]},o.prototype.getClass=function(){return o},o}(j_);V_.overlayOp=function(t,e,n){return new V_(t,e).getResultGeometry(n)},V_.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return V_.createEmptyResult(V_.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return l_.map(t,{interfaces_:function(){return[z_.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),w_.overlayOp(t,e,V_.INTERSECTION)},V_.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return V_.createEmptyResult(V_.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),w_.overlayOp(t,e,V_.SYMDIFFERENCE)},V_.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case V_.INTERSECTION:o=Math.min(i,r);break;case V_.UNION:o=Math.max(i,r);break;case V_.DIFFERENCE:o=i;break;case V_.SYMDIFFERENCE:o=Math.max(i,r)}return o},V_.createEmptyResult=function(t,e,n,i){var r=null;switch(V_.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},V_.difference=function(t,e){return t.isEmpty()?V_.createEmptyResult(V_.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),w_.overlayOp(t,e,V_.DIFFERENCE))},V_.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return V_.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===Sp.BOUNDARY&&(r=Sp.INTERIOR),o===Sp.BOUNDARY&&(o=Sp.INTERIOR),s){case V_.INTERSECTION:return r===Sp.INTERIOR&&o===Sp.INTERIOR;case V_.UNION:return r===Sp.INTERIOR||o===Sp.INTERIOR;case V_.DIFFERENCE:return r===Sp.INTERIOR&&o!==Sp.INTERIOR;case V_.SYMDIFFERENCE:return r===Sp.INTERIOR&&o!==Sp.INTERIOR||r!==Sp.INTERIOR&&o===Sp.INTERIOR}return!1}},V_.INTERSECTION=1,V_.UNION=2,V_.DIFFERENCE=3,V_.SYMDIFFERENCE=4;var Y_=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new zy,this._seg=new Rg;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Y_.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++){if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0}return!1},Y_.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?Sp.BOUNDARY:this._ptLocator.locate(t,this._g)},Y_.prototype.extractLinework=function(t){var e=new H_;t.apply(e);var n=e.getLinework(),i=kd.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},Y_.prototype.interfaces_=function(){return[]},Y_.prototype.getClass=function(){return Y_};var H_=function(){this._linework=null,this._linework=new If};H_.prototype.getLinework=function(){return this._linework},H_.prototype.filter=function(t){if(t instanceof yd){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},H_.prototype.interfaces_=function(){return[Zf]},H_.prototype.getClass=function(){return H_};var X_=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};X_.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},X_.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},X_.prototype.getPoints=function(t){for(var e=new If,n=jy.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},X_.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=n*r/s,u=n*o/s,l=(e.x+t.x)/2,h=(e.y+t.y)/2;if(this._doLeft){var c=new Ep(l-u,h+a);i.add(c)}if(this._doRight){var p=new Ep(l+u,h-a);i.add(p)}},X_.prototype.interfaces_=function(){return[]},X_.prototype.getClass=function(){return X_};var W_=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new If;var e=arguments[0],n=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,i],this._locFinder=[new Y_(this._geom[0],this._boundaryDistanceTolerance),new Y_(this._geom[1],this._boundaryDistanceTolerance),new Y_(this._geom[2],this._boundaryDistanceTolerance)]},J_={TOLERANCE:{configurable:!0}};W_.prototype.reportResult=function(t,e,n){jp.out.println("Overlay result invalid - A:"+Sp.toLocationSymbol(e[0])+" B:"+Sp.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+Sp.toLocationSymbol(e[2]))},W_.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var e=this.checkValid(t);return e},W_.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!W_.hasLocation(this._location,Sp.BOUNDARY)||this.isValidResult(i,this._location)}},W_.prototype.addTestPts=function(t){var e=new X_(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},W_.prototype.isValidResult=function(t,e){var n=V_.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===Sp.INTERIOR);return i||this.reportResult(t,e,n),i},W_.prototype.getInvalidLocation=function(){return this._invalidLocation},W_.prototype.interfaces_=function(){return[]},W_.prototype.getClass=function(){return W_},W_.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},W_.computeBoundaryDistanceTolerance=function(t,e){return Math.min(d_.computeSizeBasedSnapTolerance(t),d_.computeSizeBasedSnapTolerance(e))},W_.isValid=function(t,e,n,i){return new W_(t,e,i).isValid(n)},J_.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(W_,J_);var K_=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};K_.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},K_.prototype.combine=function(){for(var t=new If,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},K_.prototype.interfaces_=function(){return[]},K_.prototype.getClass=function(){return K_},K_.combine=function(){if(1===arguments.length){var t=arguments[0];return new K_(t).combine()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new K_(K_.createList(e,n)).combine()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];return new K_(K_.createList(i,r,o)).combine()}},K_.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},K_.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new If;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=new If;return s.add(i),s.add(r),s.add(o),s}};var Z_=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new If)},Q_={STRTREE_NODE_CAPACITY:{configurable:!0}};Z_.prototype.reduceToGeometries=function(t){for(var e=new If,n=t.iterator();n.hasNext();){var i=n.next(),r=null;Cp(i,Ef)?r=this.unionTree(i):i instanceof lf&&(r=i),e.add(r)}return e},Z_.prototype.extractByEnvelope=function(t,e,n){for(var i=new If,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},Z_.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return K_.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},Z_.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new Ig(Z_.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},Z_.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=Z_.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Z_.getGeometry(e,n),Z_.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,i);return this.unionSafe(s,a)}},Z_.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},Z_.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Z_.prototype.unionActual=function(t,e){return Z_.restrictToPolygons(t.union(e))},Z_.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Z_.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new If,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),K_.combine(i)},Z_.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Z_.prototype.interfaces_=function(){return[]},Z_.prototype.getClass=function(){return Z_},Z_.restrictToPolygons=function(t){if(Cp(t,gd))return t;var e=qy.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(kd.toPolygonArray(e))},Z_.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Z_.union=function(t){return new Z_(t).union()},Q_.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Z_,Q_);var $_=function(){};function tm(t){switch(t.type){case"Polygon":return 1<au(t)?t:null;case"MultiPolygon":var e=[];if(kr(t,function(t){1<au(t)&&e.push(t.geometry.coordinates)}),e.length)return{type:"MultiPolygon",coordinates:e}}}$_.prototype.interfaces_=function(){return[]},$_.prototype.getClass=function(){return $_},$_.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return V_.createEmptyResult(V_.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),w_.overlayOp(t,e,V_.UNION)};var em=function(){return new nm};function nm(){this.reset()}nm.prototype={constructor:nm,reset:function(){this.s=this.t=0},add:function(t){rm(im,t,this.t),rm(this,im.s,this.s),this.s?this.t+=im.t:this.s=im.t},valueOf:function(){return this.s}};var im=new nm;function rm(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}var om=1e-6,sm=Math.PI,am=sm/2,um=sm/4,lm=2*sm,hm=180/sm,cm=sm/180,pm=Math.abs,fm=Math.atan,dm=Math.atan2,gm=Math.cos,ym=Math.exp,_m=Math.log,mm=Math.sin,vm=Math.sqrt,bm=Math.tan;function xm(t){return 1<t?am:t<-1?-am:Math.asin(t)}function Em(){}function wm(t,e){t&&Lm.hasOwnProperty(t.type)&&Lm[t.type](t,e)}var Im={Feature:function(t,e){wm(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)wm(n[i].geometry,e)}},Lm={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Sm(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Sm(n[i],e,0)},Polygon:function(t,e){Mm(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Mm(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)wm(n[i],e)}};function Sm(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function Mm(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Sm(t[n],e,1);e.polygonEnd()}var Cm=function(t,e){t&&Im.hasOwnProperty(t.type)?Im[t.type](t,e):wm(t,e)};em(),em();function Pm(t){return[dm(t[1],t[0]),xm(t[2])]}function Nm(t){var e=t[0],n=t[1],i=gm(n);return[i*gm(e),i*mm(e),mm(n)]}function Om(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Tm(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Rm(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function km(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Dm(t){var e=vm(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}em();var Am=function(n,i){function t(t,e){return t=n(t,e),i(t[0],t[1])}return n.invert&&i.invert&&(t.invert=function(t,e){return(t=i.invert(t,e))&&n.invert(t[0],t[1])}),t};function Fm(t,e){return[sm<t?t-lm:t<-sm?t+lm:t,e]}function Gm(t,e,n){return(t%=lm)?e||n?Am(Um(t),qm(e,n)):Um(t):e||n?qm(e,n):Fm}function Bm(n){return function(t,e){return[sm<(t+=n)?t-lm:t<-sm?t+lm:t,e]}}function Um(t){var e=Bm(t);return e.invert=Bm(-t),e}function qm(t,e){var a=gm(t),u=mm(t),l=gm(e),h=mm(e);function n(t,e){var n=gm(e),i=gm(t)*n,r=mm(t)*n,o=mm(e),s=o*a+i*u;return[dm(r*l-s*h,i*a-o*u),xm(s*l+r*h)]}return n.invert=function(t,e){var n=gm(e),i=gm(t)*n,r=mm(t)*n,o=mm(e),s=o*l-r*h;return[dm(r*l+o*h,i*a+s*u),xm(s*a-i*u)]},n}Fm.invert=Fm;function jm(t,e){(e=Nm(e))[0]-=t,Dm(e);var n,i=1<(n=-e[1])?0:n<-1?sm:Math.acos(n);return((-e[2]<0?-i:i)+lm-om)%lm}var zm=function(){var n,e=[];return{point:function(t,e){n.push([t,e])},lineStart:function(){e.push(n=[])},lineEnd:Em,rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))},result:function(){var t=e;return e=[],n=null,t}}},Vm=function(t,e,n,i,r,o){var s,a=t[0],u=t[1],l=0,h=1,c=e[0]-a,p=e[1]-u;if(s=n-a,c||!(0<s)){if(s/=c,c<0){if(s<l)return;s<h&&(h=s)}else if(0<c){if(h<s)return;l<s&&(l=s)}if(s=r-a,c||!(s<0)){if(s/=c,c<0){if(h<s)return;l<s&&(l=s)}else if(0<c){if(s<l)return;s<h&&(h=s)}if(s=i-u,p||!(0<s)){if(s/=p,p<0){if(s<l)return;s<h&&(h=s)}else if(0<p){if(h<s)return;l<s&&(l=s)}if(s=o-u,p||!(s<0)){if(s/=p,p<0){if(h<s)return;l<s&&(l=s)}else if(0<p){if(s<l)return;s<h&&(h=s)}return 0<l&&(t[0]=a+l*c,t[1]=u+l*p),h<1&&(e[0]=a+h*c,e[1]=u+h*p),!0}}}}},Ym=function(t,e){return pm(t[0]-e[0])<om&&pm(t[1]-e[1])<om};function Hm(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}var Xm=function(t,e,n,i,o){var s,r,a=[],u=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],r=t[e];if(Ym(i,r)){for(o.lineStart(),s=0;s<e;++s)o.point((i=t[s])[0],i[1]);o.lineEnd()}else a.push(n=new Hm(i,t,null,!0)),u.push(n.o=new Hm(i,null,n,!1)),a.push(n=new Hm(r,t,null,!1)),u.push(n.o=new Hm(r,null,n,!0))}}),a.length){for(u.sort(e),Wm(a),Wm(u),s=0,r=u.length;s<r;++s)u[s].e=n=!n;for(var l,h,c=a[0];;){for(var p=c,f=!0;p.v;)if((p=p.n)===c)return;l=p.z,o.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(s=0,r=l.length;s<r;++s)o.point((h=l[s])[0],h[1]);else i(p.x,p.n.x,1,o);p=p.n}else{if(f)for(l=p.p.z,s=l.length-1;0<=s;--s)o.point((h=l[s])[0],h[1]);else i(p.x,p.p.x,-1,o);p=p.p}l=(p=p.o).z,f=!f}while(!p.v);o.lineEnd()}}};function Wm(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}var Jm=function(t,e){return t<e?-1:e<t?1:e<=t?0:NaN};1===(Km=Jm).length&&(Zm=Km,Km=function(t,e){return Jm(Zm(t),e)});var Km,Zm,Qm=function(t){for(var e,n,i,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(n=new Array(s);0<=--r;)for(e=(i=t[r]).length;0<=--e;)n[--s]=i[e];return n},$m=1e9,tv=-$m;function ev(_,m,v,b){function x(t,e){return _<=t&&t<=v&&m<=e&&e<=b}function E(t,e,n,i){var r=0,o=0;if(null==t||(r=s(t,n))!==(o=s(e,n))||a(t,e)<0^0<n)for(;i.point(0===r||3===r?_:v,1<r?b:m),(r=(r+n+4)%4)!==o;);else i.point(e[0],e[1])}function s(t,e){return pm(t[0]-_)<om?0<e?0:3:pm(t[0]-v)<om?0<e?2:1:pm(t[1]-m)<om?0<e?1:0:0<e?3:2}function w(t,e){return a(t.x,e.x)}function a(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(i){var r,c,o,s,a,u,l,h,p,f,d,g=i,t=zm(),e={point:n,lineStart:function(){e.point=y,c&&c.push(o=[]);f=!0,p=!1,l=h=NaN},lineEnd:function(){r&&(y(s,a),u&&p&&t.rejoin(),r.push(t.result()));e.point=n,p&&g.lineEnd()},polygonStart:function(){g=t,r=[],c=[],d=!0},polygonEnd:function(){var t=function(){for(var t=0,e=0,n=c.length;e<n;++e)for(var i,r,o=c[e],s=1,a=o.length,u=o[0],l=u[0],h=u[1];s<a;++s)i=l,r=h,u=o[s],l=u[0],h=u[1],r<=b?b<h&&(h-r)*(_-i)<(l-i)*(b-r)&&++t:h<=b&&(l-i)*(b-r)<(h-r)*(_-i)&&--t;return t}(),e=d&&t,n=(r=Qm(r)).length;(e||n)&&(i.polygonStart(),e&&(i.lineStart(),E(null,null,1,i),i.lineEnd()),n&&Xm(r,w,t,E,i),i.polygonEnd());g=i,r=c=o=null}};function n(t,e){x(t,e)&&g.point(t,e)}function y(t,e){var n=x(t,e);if(c&&o.push([t,e]),f)s=t,a=e,f=!1,(u=n)&&(g.lineStart(),g.point(t,e));else if(n&&p)g.point(t,e);else{var i=[l=Math.max(tv,Math.min($m,l)),h=Math.max(tv,Math.min($m,h))],r=[t=Math.max(tv,Math.min($m,t)),e=Math.max(tv,Math.min($m,e))];Vm(i,r,_,m,v,b)?(p||(g.lineStart(),g.point(i[0],i[1])),g.point(r[0],r[1]),n||g.lineEnd(),d=!1):n&&(g.lineStart(),g.point(t,e),d=!1)}l=t,h=e,p=n}return e}}var nv=em(),iv=(em(),function(t){return t}),rv=(em(),em(),1/0),ov=rv,sv=-rv,av=sv,uv={point:function(t,e){t<rv&&(rv=t);sv<t&&(sv=t);e<ov&&(ov=e);av<e&&(av=e)},lineStart:Em,lineEnd:Em,polygonStart:Em,polygonEnd:Em,result:function(){var t=[[rv,ov],[sv,av]];return sv=av=-(ov=rv=1/0),t}};em();var lv=function(m,v,b,x){return function(i,a){var u,l,h,r=v(a),e=i.invert(x[0],x[1]),c=zm(),p=v(c),f=!1,n={point:o,lineStart:s,lineEnd:d,polygonStart:function(){n.point=g,n.lineStart=y,n.lineEnd=_,l=[],u=[]},polygonEnd:function(){n.point=o,n.lineStart=s,n.lineEnd=d,l=Qm(l);var t=function(t,e){var n=e[0],i=e[1],r=[mm(n),-gm(n),0],o=0,s=0;nv.reset();for(var a=0,u=t.length;a<u;++a)if(h=(l=t[a]).length)for(var l,h,c=l[h-1],p=c[0],f=c[1]/2+um,d=mm(f),g=gm(f),y=0;y<h;++y,p=m,d=b,g=x,c=_){var _=l[y],m=_[0],v=_[1]/2+um,b=mm(v),x=gm(v),E=m-p,w=0<=E?1:-1,I=w*E,L=sm<I,S=d*b;if(nv.add(dm(S*w*mm(I),g*x+S*gm(I))),o+=L?E+w*lm:E,L^n<=p^n<=m){var M=Tm(Nm(c),Nm(_));Dm(M);var C=Tm(r,M);Dm(C);var P=(L^0<=E?-1:1)*xm(C[2]);(P<i||i===P&&(M[0]||M[1]))&&(s+=L^0<=E?1:-1)}}return(o<-om||o<om&&nv<-om)^1&s}(u,e);l.length?(f||(a.polygonStart(),f=!0),Xm(l,cv,t,b,a)):t&&(f||(a.polygonStart(),f=!0),a.lineStart(),b(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),l=u=null},sphere:function(){a.polygonStart(),a.lineStart(),b(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function o(t,e){var n=i(t,e);m(t=n[0],e=n[1])&&a.point(t,e)}function t(t,e){var n=i(t,e);r.point(n[0],n[1])}function s(){n.point=t,r.lineStart()}function d(){n.point=o,r.lineEnd()}function g(t,e){h.push([t,e]);var n=i(t,e);p.point(n[0],n[1])}function y(){p.lineStart(),h=[]}function _(){g(h[0][0],h[0][1]),p.lineEnd();var t,e,n,i,r=p.clean(),o=c.result(),s=o.length;if(h.pop(),u.push(h),h=null,s)if(1&r){if(0<(e=(n=o[0]).length-1)){for(f||(a.polygonStart(),f=!0),a.lineStart(),t=0;t<e;++t)a.point((i=n[t])[0],i[1]);a.lineEnd()}}else 1<s&&2&r&&o.push(o.pop().concat(o.shift())),l.push(o.filter(hv))}return n}};function hv(t){return 1<t.length}function cv(t,e){return((t=t.x)[0]<0?t[1]-am-om:am-t[1])-((e=e.x)[0]<0?e[1]-am-om:am-e[1])}var pv=lv(function(){return!0},function(c){var p,f=NaN,d=NaN,g=NaN;return{lineStart:function(){c.lineStart(),p=1},point:function(t,e){var n,i,r,o,s,a,u,l=0<t?sm:-sm,h=pm(t-f);pm(h-sm)<om?(c.point(f,d=0<(d+e)/2?am:-am),c.point(g,d),c.lineEnd(),c.lineStart(),c.point(l,d),c.point(t,d),p=0):g!==l&&sm<=h&&(pm(f-g)<om&&(f-=g*om),pm(t-l)<om&&(t-=l*om),i=d,o=e,u=mm((n=f)-(r=t)),d=pm(u)>om?fm((mm(i)*(a=gm(o))*mm(r)-mm(o)*(s=gm(i))*mm(n))/(s*a*u)):(i+o)/2,c.point(g,d),c.lineEnd(),c.lineStart(),c.point(l,d),p=0),c.point(f=t,d=e),g=l},lineEnd:function(){c.lineEnd(),f=d=NaN},clean:function(){return 2-p}}},function(t,e,n,i){var r;if(null==t)r=n*am,i.point(-sm,r),i.point(0,r),i.point(sm,r),i.point(sm,0),i.point(sm,-r),i.point(0,-r),i.point(-sm,-r),i.point(-sm,0),i.point(-sm,r);else if(pm(t[0]-e[0])>om){var o=t[0]<e[0]?sm:-sm;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])},[-sm,-am]);var fv=function(r,o){var S=gm(r),f=0<S,d=pm(S)>om;function g(t,e){return gm(t)*gm(e)>S}function y(t,e,n){var i=[1,0,0],r=Tm(Nm(t),Nm(e)),o=Om(r,r),s=r[0],a=o-s*s;if(!a)return!n&&t;var u=S*o/a,l=-S*s/a,h=Tm(i,r),c=km(i,u);Rm(c,km(r,l));var p=h,f=Om(c,p),d=Om(p,p),g=f*f-d*(Om(c,c)-1);if(!(g<0)){var y=vm(g),_=km(p,(-f-y)/d);if(Rm(_,c),_=Pm(_),!n)return _;var m,v=t[0],b=e[0],x=t[1],E=e[1];b<v&&(m=v,v=b,b=m);var w=b-v,I=pm(w-sm)<om;if(!I&&E<x&&(m=x,x=E,E=m),I||w<om?I?0<x+E^_[1]<(pm(_[0]-v)<om?x:E):x<=_[1]&&_[1]<=E:sm<w^(v<=_[0]&&_[0]<=b)){var L=km(p,(-f+y)/d);return Rm(L,c),[_,Pm(L)]}}}function _(t,e){var n=f?r:sm-r,i=0;return t<-n?i|=1:n<t&&(i|=2),e<-n?i|=4:n<e&&(i|=8),i}return lv(g,function(a){var u,l,h,c,p;return{lineStart:function(){c=h=!1,p=1},point:function(t,e){var n,i=[t,e],r=g(t,e),o=f?r?0:_(t,e):r?_(t+(t<0?sm:-sm),e):0;if(!u&&(c=h=r)&&a.lineStart(),r!==h&&(!(n=y(u,i))||Ym(u,n)||Ym(i,n))&&(i[0]+=om,i[1]+=om,r=g(i[0],i[1])),r!==h)p=0,r?(a.lineStart(),n=y(i,u),a.point(n[0],n[1])):(n=y(u,i),a.point(n[0],n[1]),a.lineEnd()),u=n;else if(d&&u&&f^r){var s;o&l||!(s=y(i,u,!0))||(p=0,f?(a.lineStart(),a.point(s[0][0],s[0][1]),a.point(s[1][0],s[1][1]),a.lineEnd()):(a.point(s[1][0],s[1][1]),a.lineEnd(),a.lineStart(),a.point(s[0][0],s[0][1])))}!r||u&&Ym(u,i)||a.point(i[0],i[1]),u=i,h=r,l=o},lineEnd:function(){h&&a.lineEnd(),u=null},clean:function(){return p|(c&&h)<<1}}},function(t,e,n,i){!function(t,e,n,i,r,o){if(n){var s=gm(e),a=mm(e),u=i*n;null==r?(r=e+i*lm,o=e-u/2):(r=jm(s,r),o=jm(s,o),(0<i?r<o:o<r)&&(r+=i*lm));for(var l,h=r;0<i?o<h:h<o;h-=u)l=Pm([s,-a*gm(h),-a*mm(h)]),t.point(l[0],l[1])}}(i,r,o,n,t,e)},f?[0,-r]:[-sm,r-sm])};function dv(i){return function(t){var e=new gv;for(var n in i)e[n]=i[n];return e.stream=t,e}}function gv(){}function yv(t,e,n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),Cm(n,t.stream(uv));var s=uv.result(),a=Math.min(i/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),u=+e[0][0]+(i-a*(s[1][0]+s[0][0]))/2,l=+e[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([u,l])}gv.prototype={constructor:gv,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var _v=gm(30*cm),mv=function(t,e){return+e?function(P,N){function O(t,e,n,i,r,o,s,a,u,l,h,c,p,f){var d=s-t,g=a-e,y=d*d+g*g;if(4*N<y&&p--){var _=i+l,m=r+h,v=o+c,b=vm(_*_+m*m+v*v),x=xm(v/=b),E=pm(pm(v)-1)<om||pm(n-u)<om?(n+u)/2:dm(m,_),w=P(E,x),I=w[0],L=w[1],S=I-t,M=L-e,C=g*S-d*M;(N<C*C/y||.3<pm((d*S+g*M)/y-.5)||i*l+r*h+o*c<_v)&&(O(t,e,n,i,r,o,I,L,E,_/=b,m/=b,v,p,f),f.point(I,L),O(I,L,E,_,m,v,s,a,u,l,h,c,p,f))}}return function(r){var n,i,o,s,a,u,l,h,c,p,f,d,g={point:t,lineStart:e,lineEnd:_,polygonStart:function(){r.polygonStart(),g.lineStart=m},polygonEnd:function(){r.polygonEnd(),g.lineStart=e}};function t(t,e){t=P(t,e),r.point(t[0],t[1])}function e(){h=NaN,g.point=y,r.lineStart()}function y(t,e){var n=Nm([t,e]),i=P(t,e);O(h,c,l,p,f,d,h=i[0],c=i[1],l=t,p=n[0],f=n[1],d=n[2],16,r),r.point(h,c)}function _(){g.point=t,r.lineEnd()}function m(){e(),g.point=v,g.lineEnd=b}function v(t,e){y(n=t,e),i=h,o=c,s=p,a=f,u=d,g.point=y}function b(){O(h,c,l,p,f,d,i,o,n,s,a,u,16,r),(g.lineEnd=_)()}return g}}(t,e):(n=t,dv({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}}));var n};var vv=dv({point:function(t,e){this.stream.point(t*cm,e*cm)}});function bv(t){return function(t){var n,i,r,e,o,s,a,u,l,h,c=150,p=480,f=250,d=0,g=0,y=0,_=0,m=0,v=null,b=pv,x=null,E=iv,w=.5,I=mv(M,w);function L(t){return[(t=o(t[0]*cm,t[1]*cm))[0]*c+i,r-t[1]*c]}function S(t){return(t=o.invert((t[0]-i)/c,(r-t[1])/c))&&[t[0]*hm,t[1]*hm]}function M(t,e){return[(t=n(t,e))[0]*c+i,r-t[1]*c]}function C(){o=Am(e=Gm(y,_,m),n);var t=n(d,g);return i=p-t[0]*c,r=f+t[1]*c,P()}function P(){return l=h=null,L}return L.stream=function(t){return l&&h===t?l:l=vv(b(e,I(E(h=t))))},L.clipAngle=function(t){return arguments.length?(b=+t?fv(v=t*cm,6*cm):(v=null,pv),P()):v*hm},L.clipExtent=function(t){return arguments.length?(E=null==t?(x=s=a=u=null,iv):ev(x=+t[0][0],s=+t[0][1],a=+t[1][0],u=+t[1][1]),P()):null==x?null:[[x,s],[a,u]]},L.scale=function(t){return arguments.length?(c=+t,C()):c},L.translate=function(t){return arguments.length?(p=+t[0],f=+t[1],C()):[p,f]},L.center=function(t){return arguments.length?(d=t[0]%360*cm,g=t[1]%360*cm,C()):[d*hm,g*hm]},L.rotate=function(t){return arguments.length?(y=t[0]%360*cm,_=t[1]%360*cm,m=2<t.length?t[2]%360*cm:0,C()):[y*hm,_*hm,m*hm]},L.precision=function(t){return arguments.length?(I=mv(M,w=t*t),P()):vm(w)},L.fitExtent=function(t,e){return yv(L,t,e)},L.fitSize=function(t,e){return yv(L,[[0,0],t],e)},function(){return n=t.apply(this,arguments),L.invert=n.invert&&S,C()}}(function(){return t})()}function xv(t,e){return[t,_m(bm((am+e)/2))]}function Ev(n){var i,r,o,s=bv(n),e=s.center,a=s.scale,u=s.translate,l=s.clipExtent,h=null;function c(){var t=sm*a(),e=s(function(e){function t(t){return(t=e(t[0]*cm,t[1]*cm))[0]*=hm,t[1]*=hm,t}return e=Gm(e[0]*cm,e[1]*cm,2<e.length?e[2]*cm:0),t.invert=function(t){return(t=e.invert(t[0]*cm,t[1]*cm))[0]*=hm,t[1]*=hm,t},t}(s.rotate()).invert([0,0]));return l(null==h?[[e[0]-t,e[1]-t],[e[0]+t,e[1]+t]]:n===xv?[[Math.max(e[0]-t,h),i],[Math.min(e[0]+t,r),o]]:[[h,Math.max(e[1]-t,i)],[r,Math.min(e[1]+t,o)]])}return s.scale=function(t){return arguments.length?(a(t),c()):a()},s.translate=function(t){return arguments.length?(u(t),c()):u()},s.center=function(t){return arguments.length?(e(t),c()):e()},s.clipExtent=function(t){return arguments.length?(null==t?h=i=r=o=null:(h=+t[0][0],i=+t[0][1],r=+t[1][0],o=+t[1][1]),c()):null==h?null:[[h,i],[r,o]]},c()}function wv(t,e){return[_m(bm((am+e)/2)),-t]}xv.invert=function(t,e){return[t,2*fm(ym(e))-am]},wv.invert=function(t,e){return[-e,2*fm(ym(t))-am]};var Iv=function(){var t=Ev(wv),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],2<t.length?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)};function Lv(t,n,i,r){var e,o=t.properties||{},s="Feature"===t.type?t.geometry:t;if("GeometryCollection"===s.type){var a=[];return Tr(t,function(t){var e=Lv(t,n,i,r);e&&a.push(e)}),sr(a)}var u=qr(t),l=50<u[1]&&50<u[3];e=l?{type:s.type,coordinates:function e(t,n){if("object"!=typeof t[0])return n(t);return t.map(function(t){return e(t,n)})}(s.coordinates,Sv(s))}:Za(s);var h,c=(new Ud).read(e),p=pr(fr(n,i),"meters"),f=Ry.bufferOp(c,p);if(!function t(e){if(Array.isArray(e[0]))return t(e[0]);return isNaN(e[0])}((f=(new qd).write(f)).coordinates))return(h=l?{type:f.type,coordinates:function e(t,n){if("object"!=typeof t[0])return n.invert(t);return t.map(function(t){return e(t,n)})}(f.coordinates,Sv(s))}:Qa(f)).geometry?h:Qi(h,o)}function Sv(t){var e=Ks(t).geometry.coordinates.reverse(),n=e.map(function(t){return-t});return Iv().center(e).rotate(n).scale(Wi)}function Mv(){for(var t=new Ud,e=t.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)e=$_.union(e,t.read(JSON.stringify(arguments[n].geometry)));return{type:"Feature",geometry:e=(new qd).write(e),properties:arguments[0].properties}}function Cv(t,e){var n=Wr(t),i=Wr(e);if(Rs(bu(i,{precision:4})).coordinates[0].length<4)return null;if(Rs(bu(n,{precision:4})).coordinates[0].length<4)return null;var r=new Ud,o=r.read(bu(n)),s=r.read(bu(i)),a=V_.intersection(o,s);return a.isEmpty()?null:Qi((new qd).write(a))}function Pv(t,e){return function(i,t,r){var o,s;if(!Array.isArray(t))throw new Error("Get closest expects an array as second argument");return t.forEach(function(t,e){var n=r(t,i);0<=n&&(void 0===s||n<s)&&(s=n,o=e)}),o}(t,e,function(t,e){return t-e})}function Nv(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.properties||{},r=n.triangles,o=n.mask;if(null==e)throw new Error("cellSide is required");if(!br(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(o&&-1===["Polygon","MultiPolygon"].indexOf(Kr(o)))throw new Error("options.mask must be a (Multi)Polygon");var s=t[0],a=t[1],u=t[2],l=t[3],h=(a+l)/2,c=(s+u)/2,p=2*e/as([s,h],[u,h],n)*(u-s),f=2*e/as([c,a],[c,l],n)*(l-a),d=p/2,g=2*d,y=Math.sqrt(3)/2*f,_=u-s,m=l-a,v=.75*g,b=y,x=(_-g)/(g-d/2),E=Math.floor(x),w=(E*v-d/2-_)/2-d/2+v/2,I=Math.floor((m-y)/y),L=(m-I*y)/2,S=y/2<I*y-m;S&&(L-=y/4);for(var M=[],C=[],P=0;P<6;P++){var N=2*Math.PI/6*P;M.push(Math.cos(N)),C.push(Math.sin(N))}for(var O=[],T=0;T<=E;T++)for(var R=0;R<=I;R++){var k=T%2==1;if((0!==R||!k)&&(0!==R||!S)){var D=T*v+s-w,A=R*b+a+L;if(k&&(A-=y/2),!0===r)Tv([D,A],p/2,f/2,i,M,C).forEach(function(t){o?Cv(o,t)&&O.push(t):O.push(t)});else{var F=Ov([D,A],p/2,f/2,i,M,C);o?Cv(o,F)&&O.push(F):O.push(F)}}}return sr(O)}function Ov(t,e,n,i,r,o){for(var s=[],a=0;a<6;a++){var u=t[0]+e*r[a],l=t[1]+n*o[a];s.push([u,l])}return s.push(s[0].slice()),nr([s],i)}function Tv(t,e,n,i,r,o){for(var s=[],a=0;a<6;a++){var u=[];u.push(t),u.push([t[0]+e*r[a],t[1]+n*o[a]]),u.push([t[0]+e*r[(a+1)%6],t[1]+n*o[(a+1)%6]]),u.push(t),s.push(nr([u],i))}return s}function Rv(t){if(t.features.length<=1)return t;var e,n,i,o=(e=t,n=lo(),i=[],kr(e,function(t,e){var n=qr(t);i.push({minX:n[0],minY:n[1],maxX:n[2],maxY:n[3],geojson:t,index:e})}),n.load(i),n),s=[],a={};return kr(t,function(t,e){if(a[e])return!0;for(o.remove({index:e},kv),a[e]=!0;;){var n=qr(t),i=o.search({minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]});if(0<i.length){var r=i.map(function(t){return a[t.index]=!0,o.remove({index:t.index},kv),t.geojson});r.push(t),t=Mv.apply(this,r)}if(0===i.length)break}s.push(t)}),sr(s)}function kv(t,e){return t.index===e.index}function Dv(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.mask,o=[];if(null==e)throw new Error("cellSide is required");if(!br(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(Kr(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=t[0],a=t[1],u=t[2],l=t[3],h=e/as([s,a],[u,a],n)*(u-s),c=e/as([s,a],[s,l],n)*(l-a),p=u-s,f=l-a,d=Math.floor(p/h),g=Math.floor(f/c),y=(f-g*c)/2,_=s+(p-d*h)/2,m=0;m<d;m++){for(var v=a+y,b=0;b<g;b++){var x=nr([[[_,v],[_,v+c],[_+h,v+c],[_+h,v],[_,v]]],i);r?Cv(r,x)&&o.push(x):o.push(x),v+=c}_+=h}return sr(o)}function Av(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.mask,o=[];if(null==e)throw new Error("cellSide is required");if(!br(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(Kr(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=e/as([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),a=e/as([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),u=0,l=t[0];l<=t[2];){for(var h=0,c=t[1];c<=t[3];){var p=null,f=null;u%2==0&&h%2==0?(p=nr([[[l,c],[l,c+a],[l+s,c],[l,c]]],i),f=nr([[[l,c+a],[l+s,c+a],[l+s,c],[l,c+a]]],i)):u%2==0&&h%2==1?(p=nr([[[l,c],[l+s,c+a],[l+s,c],[l,c]]],i),f=nr([[[l,c],[l,c+a],[l+s,c+a],[l,c]]],i)):h%2==0&&u%2==1?(p=nr([[[l,c],[l,c+a],[l+s,c+a],[l,c]]],i),f=nr([[[l,c],[l+s,c+a],[l+s,c],[l,c]]],i)):h%2==1&&u%2==1&&(p=nr([[[l,c],[l,c+a],[l+s,c],[l,c]]],i),f=nr([[[l,c+a],[l+s,c+a],[l+s,c],[l,c+a]]],i)),r?(Cv(r,p)&&o.push(p),Cv(r,f)&&o.push(f)):(o.push(p),o.push(f)),c+=a,h++}u++,l+=s}return sr(o)}var Fv,Gv=Object.freeze({projection:nu,random:op,clusters:fp,helpers:Ir,invariant:Zr,meta:Ur,isolines:function(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.zProperty||"elevation",r=n.commonProperties||{},o=n.breaksProperties||[];if(Xr(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!xr(r))throw new Error("commonProperties must be an Object");if(!Array.isArray(o))throw new Error("breaksProperties must be an Array");var s,a,u,l,h,c,p,f,d,g,y,_,m=oo(t,{zProperty:i,flip:!0}),v=function(t,e,n,i,r){for(var o=[],s=1;s<e.length;s++){var a=+e[s],u=Object.assign({},i,r[s]);u[n]=a;var l=ar(to(t,a),u);o.push(l)}return o}(m,e,i,r,o);return sr((s=v,a=m,u=qr(t),l=u[2]-u[0],h=u[3]-u[1],c=u[0],p=u[1],f=a[0].length-1,d=a.length-1,g=l/f,y=h/d,_=function(t){t[0]=t[0]*g+c,t[1]=t[1]*y+p},s.forEach(function(t){Lr(t,_)}),s))},convex:$o,pointsWithinPolygon:ns,concave:function(t,a){if(!xr(a=a||{}))throw new Error("options is invalid");if(!t)throw new Error("points is required");var u=a.maxEdge||1/0;if(!br(u))throw new Error("maxEdge is invalid");var n,i,e=is((n=[],i={},Pr(t,function(t){if(t.geometry){var e=t.geometry.coordinates.join("-");i.hasOwnProperty(e)||(n.push(t),i[e]=!0)}}),sr(n)));if(e.features=e.features.filter(function(t){var e=t.geometry.coordinates[0][0],n=t.geometry.coordinates[0][1],i=t.geometry.coordinates[0][2],r=as(e,n,a),o=as(n,i,a),s=as(e,i,a);return r<=u&&o<=u&&s<=u}),e.features.length<1)return null;var r=Ts(e,a);return 1===r.coordinates.length&&(r.coordinates=r.coordinates[0],r.type="Polygon"),Qi(r)},collect:function(t,e,n,r){var o=lo(6),i=e.features.map(function(t){return{minX:t.geometry.coordinates[0],minY:t.geometry.coordinates[1],maxX:t.geometry.coordinates[0],maxY:t.geometry.coordinates[1],property:t.properties[n]}});return o.load(i),t.features.forEach(function(e){e.properties||(e.properties={});var t=qr(e),n=o.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}),i=[];n.forEach(function(t){ts([t.minX,t.minY],e)&&i.push(t.property)}),e.properties[r]=i}),t},flip:function(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if(!t)throw new Error("geojson is required");return!1!==n&&void 0!==n||(t=us(t)),Lr(t,function(t){var e=t[0],n=t[1];t[0]=n,t[1]=e}),t},simplify:function(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=void 0!==e.tolerance?e.tolerance:1,i=e.highQuality||!1,r=e.mutate||!1;if(!t)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return!0!==r&&(t=us(t)),Tr(t,function(t){!function(t,e,n){var i=t.type;if("Point"!==i&&"MultiPoint"!==i){Rs(t,!0);var r=t.coordinates;switch(i){case"LineString":t.coordinates=Bs(r,e,n);break;case"MultiLineString":t.coordinates=r.map(function(t){return Bs(t,e,n)});break;case"Polygon":t.coordinates=Us(r,e,n);break;case"MultiPolygon":t.coordinates=r.map(function(t){return Us(t,e,n)})}}}(t,n,i)}),t},bezierSpline:zs,tag:function(t,n,i,r){return t=us(t),n=us(n),Pr(t,function(e){e.properties||(e.properties={}),Pr(n,function(t){void 0===e.properties[r]&&ts(e,t)&&(e.properties[r]=t.properties[i])})}),t},sample:function(t,e){if(!t)throw new Error("featurecollection is required");if(null==e)throw new Error("num is required");if("number"!=typeof e)throw new Error("num must be a number");return sr(function(t,e){for(var n,i,r=t.slice(0),o=t.length,s=o-e;o-- >s;)i=Math.floor((o+1)*Math.random()),n=r[i],r[i]=r[o],r[o]=n;return r.slice(s)}(t.features,e))},envelope:Ys,square:Hs,circle:Ws,midpoint:function(t,e){return Xs(t,as(t,e)/2,Js(t,e))},center:Ks,centerOfMass:function t(e,n){switch(Kr(e)){case"Point":return e;case"Polygon":var i=[];Lr(e,function(t){i.push(t)});var r,o,s,a,u,l,h,c,p=Zs(e,n),f=p.geometry.coordinates,d=0,g=0,y=0,_=i.map(function(t){return[t[0]-f[0],t[1]-f[1]]});for(r=0;r<i.length-1;r++)a=(o=_[r])[0],l=o[1],u=(s=_[r+1])[0],y+=c=a*(h=s[1])-u*l,d+=(a+u)*c,g+=(l+h)*c;if(0===y)return p;var m=1/(.5*y*6);return tr([f[0]+m*d,f[1]+m*g],n);default:var v=$o(e);return v?t(v,n):Zs(e,n)}},centroid:Zs,combine:function(t){var i={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},e=Object.keys(i).reduce(function(t,e){return t[e.replace("Multi","")]=e,t},{});function n(t,e,n){n?i[e].coordinates=i[e].coordinates.concat(t.geometry.coordinates):i[e].coordinates.push(t.geometry.coordinates),i[e].properties.push(t.properties)}return Pr(t,function(t){t.geometry&&(i[t.geometry.type]?n(t,t.geometry.type,!0):e[t.geometry.type]&&n(t,e[t.geometry.type],!1))}),sr(Object.keys(i).filter(function(t){return i[t].coordinates.length}).sort().map(function(t){return Qi({type:t,coordinates:i[t].coordinates},{collectedProperties:i[t].properties})}))},distance:as,explode:Qs,bbox:qr,tesselate:function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=wa(t.geometry.coordinates):t.geometry.coordinates.forEach(function(t){e.features=e.features.concat(wa(t))}),e},bboxPolygon:Vs,booleanPointInPolygon:ts,nearestPoint:Ia,nearestPointOnLine:Xa,nearestPointToLine:function(t,n,e){if(!xr(e=e||{}))throw new Error("options is invalid");var i=e.units,r=e.properties||{};if(!t)throw new Error("points is required");if(!(t=function(t){var e=[];switch(t.geometry?t.geometry.type:t.type){case"GeometryCollection":return Tr(t,function(t){"Point"===t.type&&e.push({type:"Feature",properties:{},geometry:t})}),{type:"FeatureCollection",features:e};case"FeatureCollection":return t.features=t.features.filter(function(t){return"Point"===t.geometry.type}),t;default:throw new Error("points must be a Point Collection")}}(t)).features.length)throw new Error("points must contain features");if(!n)throw new Error("line is required");if("LineString"!==Kr(n))throw new Error("line must be a LineString");var o=1/0,s=null;return Pr(t,function(t){var e=iu(t,n,{units:i});e<o&&(o=e,s=t)}),s&&(s.properties=Object.assign({dist:o},s.properties,r)),s},planepoint:function(t,e){var n=jr(t),i=Wr(e).coordinates[0];if(i.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var r=e.properties||{},o=r.a,s=r.b,a=r.c,u=n[0],l=n[1],h=i[0][0],c=i[0][1],p=void 0!==o?o:i[0][2],f=i[1][0],d=i[1][1],g=void 0!==s?s:i[1][2],y=i[2][0],_=i[2][1],m=void 0!==a?a:i[2][2];return(m*(u-h)*(l-d)+p*(u-f)*(l-_)+g*(u-y)*(l-c)-g*(u-h)*(l-_)-m*(u-f)*(l-c)-p*(u-y)*(l-d))/((u-h)*(l-d)+(u-f)*(l-_)+(u-y)*(l-c)-(u-h)*(l-_)-(u-f)*(l-c)-(u-y)*(l-d))},tin:is,bearing:Js,destination:Xs,kinks:function(t){var e,n,m={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach(function(_){e.forEach(function(t){for(var e=0;e<_.length-1;e++)for(var n=e;n<t.length-1;n++){if(_===t){if(1===Math.abs(e-n))continue;if(0===e&&n===_.length-2&&_[e][0]===_[_.length-1][0]&&_[e][1]===_[_.length-1][1])continue}var i=(r=_[e][0],o=_[e][1],s=_[e+1][0],a=_[e+1][1],u=t[n][0],l=t[n][1],h=t[n+1][0],c=t[n+1][1],y=g=d=f=p=void 0,y={x:null,y:null,onLine1:!1,onLine2:!1},0==(p=(c-l)*(s-r)-(h-u)*(a-o))?null!==y.x&&null!==y.y&&y:(g=(s-r)*(f=o-l)-(a-o)*(d=r-u),f=((h-u)*f-(c-l)*d)/p,d=g/p,y.x=r+f*(s-r),y.y=o+f*(a-o),0<=f&&f<=1&&(y.onLine1=!0),0<=d&&d<=1&&(y.onLine2=!0),!(!y.onLine1||!y.onLine2)&&[y.x,y.y]));i&&m.features.push(tr([i[0],i[1]]))}var r,o,s,a,u,l,h,c,p,f,d,g,y})}),m},pointOnFeature:ou,area:au,along:function(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i;if("Feature"===t.type)i=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");i=t.coordinates}if(!br(e))throw new Error("distance must be a number");for(var r=0,o=0;o<i.length&&!(r<=e&&o===i.length-1);o++){if(e<=r){var s=e-r;if(s){var a=Js(i[o],i[o-1])-180;return Xs(i[o],s,a,n)}return tr(i[o])}r+=as(i[o],i[o+1],n)}return tr(i[i.length-1])},length:pu,lineSlice:function(t,e,n){var i=zr(n);if("LineString"!==Kr(n))throw new Error("line must be a LineString");for(var r,o=Xa(n,t),s=Xa(n,e),a=[(r=o.properties.index<=s.properties.index?[o,s]:[s,o])[0].geometry.coordinates],u=r[0].properties.index+1;u<r[1].properties.index+1;u++)a.push(i[u]);return a.push(r[1].geometry.coordinates),rr(a,n.properties)},lineSliceAlong:fu,pointGrid:vu,truncate:bu,flatten:function(t){if(!t)throw new Error("geojson is required");var e=[];return kr(t,function(t){e.push(t)}),sr(e)},lineIntersect:Ya,lineChunk:function(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.units,r=n.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var o=[];return kr(t,function(t){r&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,n,i){var r=pu(t,{units:n});if(r<=e)return i(t);var o=r/e;Number.isInteger(o)||(o=Math.floor(o)+1);for(var s=0;s<o;s++){var a=fu(t,e*s,e*(s+1),{units:n});i(a,s)}}(t,e,i,function(t){o.push(t)})}),sr(o)},unkinkPolygon:function(t){var n=[];return kr(t,function(e){"Polygon"===e.geometry.type&&Pr(function(t){if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var e=t.geometry.coordinates.length,n=[],i=0;i<e;i++){var r=t.geometry.coordinates[i];Mu(r[0],r[r.length-1])||r.push(r[0]),n.push.apply(n,r.slice(0,r.length-1))}if(!function(t){for(var e={},n=1,i=0,r=t.length;i<r;++i){if(e.hasOwnProperty(t[i])){n=0;break}e[t[i]]=1}return n}(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=n.length,s=xu(t,function(t,e,n,i,r,o,s,a,u,l,h,c){return[t,e,n,i,r,o,s,a,u,l,h,c]}),a=s.length;if(0==a){var u=[];for(i=0;i<e;i++)u.push(nr([t.geometry.coordinates[i]],{parent:-1,winding:Su(t.geometry.coordinates[i])}));var l=sr(u);return A(),F(),l}var h=[],c=[];for(i=0;i<e;i++){h.push([]);for(var p=0;p<t.geometry.coordinates[i].length-1;p++)h[i].push([new wu(t.geometry.coordinates[i][(p+1).modulo(t.geometry.coordinates[i].length-1)],1,[i,p],[i,(p+1).modulo(t.geometry.coordinates[i].length-1)],void 0)]),c.push(new Iu(t.geometry.coordinates[i][p],[i,(p-1).modulo(t.geometry.coordinates[i].length-1)],[i,p],void 0,void 0,!1,!0))}for(i=0;i<a;i++)h[s[i][1]][s[i][2]].push(new wu(s[i][0],s[i][5],[s[i][1],s[i][2]],[s[i][6],s[i][7]],void 0)),s[i][11]&&c.push(new Iu(s[i][0],[s[i][1],s[i][2]],[s[i][6],s[i][7]],void 0,void 0,!0,!0));var f=c.length;for(i=0;i<h.length;i++)for(p=0;p<h[i].length;p++)h[i][p].sort(function(t,e){return t.param<e.param?-1:1});var d=[];for(i=0;i<f;i++)d.push({minX:c[i].coord[0],minY:c[i].coord[1],maxX:c[i].coord[0],maxY:c[i].coord[1],index:i});var g=lo();for(g.load(d),i=0;i<h.length;i++)for(p=0;p<h[i].length;p++)for(var y=0;y<h[i][p].length;y++){m=y==h[i][p].length-1?h[i][(p+1).modulo(t.geometry.coordinates[i].length-1)][0].coord:h[i][p][y+1].coord;var _=g.search({minX:m[0],minY:m[1],maxX:m[0],maxY:m[1]})[0];h[i][p][y].nxtIsectAlongEdgeIn=_.index}for(i=0;i<h.length;i++)for(p=0;p<h[i].length;p++)for(y=0;y<h[i][p].length;y++){var m=h[i][p][y].coord,v=(_=g.search({minX:m[0],minY:m[1],maxX:m[0],maxY:m[1]})[0]).index;v<o?c[v].nxtIsectAlongRingAndEdge2=h[i][p][y].nxtIsectAlongEdgeIn:Mu(c[v].ringAndEdge1,h[i][p][y].ringAndEdgeIn)?c[v].nxtIsectAlongRingAndEdge1=h[i][p][y].nxtIsectAlongEdgeIn:c[v].nxtIsectAlongRingAndEdge2=h[i][p][y].nxtIsectAlongEdgeIn}var b=[];for(p=i=0;p<e;p++){var x=i;for(y=0;y<t.geometry.coordinates[p].length-1;y++)c[i].coord[0]<c[x].coord[0]&&(x=i),i++;var E=c[x].nxtIsectAlongRingAndEdge2;for(y=0;y<c.length;y++)if(c[y].nxtIsectAlongRingAndEdge1==x||c[y].nxtIsectAlongRingAndEdge2==x){var w=y;break}var I=Lu([c[w].coord,c[x].coord,c[E].coord],!0)?1:-1;b.push({isect:x,parent:-1,winding:I})}for(b.sort(function(t,e){return c[t.isect].coord>c[e.isect].coord?-1:1}),u=[];0<b.length;){var L=b.pop(),S=L.isect,M=L.parent,C=L.winding,P=u.length,N=[c[S].coord],O=S;if(c[S].ringAndEdge1Walkable)var T=c[S].ringAndEdge1,R=c[S].nxtIsectAlongRingAndEdge1;else T=c[S].ringAndEdge2,R=c[S].nxtIsectAlongRingAndEdge2;for(;!Mu(c[S].coord,c[R].coord);){N.push(c[R].coord);var k=void 0;for(i=0;i<b.length;i++)if(b[i].isect==R){k=i;break}if(null!=k&&b.splice(k,1),Mu(T,c[R].ringAndEdge1)){if(T=c[R].ringAndEdge2,c[R].ringAndEdge2Walkable=!1,c[R].ringAndEdge1Walkable){var D={isect:R};Lu([c[O].coord,c[R].coord,c[c[R].nxtIsectAlongRingAndEdge2].coord],1==C)?(D.parent=M,D.winding=-C):(D.parent=P,D.winding=C),b.push(D)}R=c[O=R].nxtIsectAlongRingAndEdge2}else T=c[R].ringAndEdge1,c[R].ringAndEdge1Walkable=!1,c[R].ringAndEdge2Walkable&&(D={isect:R},Lu([c[O].coord,c[R].coord,c[c[R].nxtIsectAlongRingAndEdge1].coord],1==C)?(D.parent=M,D.winding=-C):(D.parent=P,D.winding=C),b.push(D)),R=c[O=R].nxtIsectAlongRingAndEdge1}N.push(c[R].coord),u.push(nr([N],{index:P,parent:M,winding:C,netWinding:void 0}))}function A(){for(var t=[],e=0;e<l.features.length;e++)-1==l.features[e].properties.parent&&t.push(e);if(1<t.length)for(e=0;e<t.length;e++){for(var n=-1,i=0;i<l.features.length;i++)t[e]!=i&&ts(l.features[t[e]].geometry.coordinates[0][0],l.features[i],{ignoreBoundary:!0})&&au(l.features[i])<1/0&&(n=i);l.features[t[e]].properties.parent=n}}function F(){for(var t=0;t<l.features.length;t++)if(-1==l.features[t].properties.parent){var e=l.features[t].properties.winding;G(t,l.features[t].properties.netWinding=e)}}function G(t,e){for(var n=0;n<l.features.length;n++)if(l.features[n].properties.parent==t){var i=e+l.features[n].properties.winding;G(n,l.features[n].properties.netWinding=i)}}return l=sr(u),A(),F(),l}(e),function(t){n.push(nr(t.geometry.coordinates,e.properties))})}),sr(n)},greatCircle:function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.npoints,o=n.offset;return t=jr(t),e=jr(e),i=i||{},r=r||100,o=o||10,new Ru({x:t[0],y:t[1]},{x:e[0],y:e[1]},i).Arc(r,{offset:o}).json()},lineSegment:Va,lineSplit:function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=Kr(t),i=Kr(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===i)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===i)throw new Error("splitter cannot be a GeometryCollection");var r=bu(e,{precision:7});switch(i){case"Point":return Du(t,r);case"MultiPoint":return ku(t,r);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return ku(t,Ya(t,r))}},lineArc:Gu,polygonToLine:Uu,lineToPolygon:ju,bboxClip:function(t,e){var n,i=(n=t).geometry?n.geometry.type:n.type,r=zr(t),o=t.properties;switch(i){case"LineString":case"MultiLineString":var s=[];return"LineString"===i&&(r=[r]),r.forEach(function(t){Yu(t,e,s)}),1===s.length?rr(s[0],o):ar(s,o);case"Polygon":return nr(Ju(r,e),o);case"MultiPolygon":return lr(r.map(function(t){return Ju(t,e)}),o);default:throw new Error("geometry "+i+" not supported")}},lineOverlap:el,sector:function(t,e,n,i,r){if(!xr(r=r||{}))throw new Error("options is invalid");if(!t)throw new Error("center is required");if(null==n)throw new Error("bearing1 is required");if(null==i)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if("object"!=typeof r)throw new Error("options must be an object");if(il(n)===il(i))return Ws(t,e,r);var o=zr(t),s=Gu(t,e,n,i,r),a=[[o]];return Lr(s,function(t){a[0].push(t)}),a[0].push(o),nr(a)},rhumbBearing:Wa,rhumbDistance:Ka,rhumbDestination:rl,polygonTangents:function(t,e){var n,i,r,o=zr(t),s=zr(e);switch(Kr(e)){case"Polygon":n=s[0][0],i=s[0][0],r=sl(s[0][0],s[0][s[0].length-1],o);var a=ol(s[0],o,r,void 0,n,i);n=a[0],i=a[1];break;case"MultiPolygon":n=s[0][0][0],i=s[0][0][0],r=sl(s[0][0][0],s[0][0][s[0][0].length-1],o),s.forEach(function(t){var e=ol(t[0],o,r,void 0,n,i);n=e[0],i=e[1]})}return sr([tr(n),tr(i)])},rewind:function(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.reverse||!1,i=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof i)throw new Error("<mutate> must be a boolean");!1===i&&(t=us(t));var r=[];switch(t.type){case"GeometryCollection":return Tr(t,function(t){ul(t,n)}),t;case"FeatureCollection":return Pr(t,function(t){Pr(ul(t,n),function(t){r.push(t)})}),sr(r)}return ul(t,n)},isobands:function(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.zProperty||"elevation",r=n.commonProperties||{},o=n.breaksProperties||[];if(Xr(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks is not an Array");if(!xr(r))throw new Error("commonProperties is not an Object");if(!Array.isArray(o))throw new Error("breaksProperties is not an Array");var s,a,u,l,h,c,p,f,d,g,y,_,m=cl(t,{zProperty:i,flip:!0}),v=function(t,e,n){for(var i=[],r=1;r<e.length;r++){var o=+e[r-1],s=+e[r],a=dl(t,o,s-o),u=ch(a),l=ph(u),h={};h.groupedRings=l,h[n]=o+"-"+s,i.push(h)}return i}(m,e,i);return s=v,a=m,u=qr(t),l=u[2]-u[0],h=u[3]-u[1],c=u[0],p=u[1],f=a[0].length-1,d=a.length-1,g=l/f,y=h/d,_=function(t){t[0]=t[0]*g+c,t[1]=t[1]*y+p},s.forEach(function(t){t.groupedRings.forEach(function(t){t.forEach(function(t){t.forEach(_)})})}),sr((v=s).map(function(t,e){if(o[e]&&!xr(o[e]))throw new Error("Each mappedProperty is required to be an Object");var n=Object.assign({},r,o[e]);return n[i]=t[i],lr(t.groupedRings,n)}))},transformRotate:gh,transformScale:yh,transformTranslate:function(t,n,i,e){if(!xr(e=e||{}))throw new Error("options is invalid");var r=e.units,o=e.zTranslation,s=e.mutate;if(!t)throw new Error("geojson is required");if(null==n||isNaN(n))throw new Error("distance is required");if(o&&"number"!=typeof o&&isNaN(o))throw new Error("zTranslation is not a number");if(o=void 0!==o?o:0,0===n&&0===o)return t;if(null==i||isNaN(i))throw new Error("direction is required");return n<0&&(n=-n,i=-i),!1!==s&&void 0!==s||(t=us(t)),Lr(t,function(t){var e=zr(rl(t,n,i,{units:r}));t[0]=e[0],t[1]=e[1],o&&3===t.length&&(t[2]+=o)}),t},lineOffset:function(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.units;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");var r=Kr(t),o=t.properties;switch(r){case"LineString":return xh(t,e,i);case"MultiLineString":var s=[];return kr(t,function(t){s.push(xh(t,e,i).geometry.coordinates)}),ar(s,o);default:throw new Error("geometry "+r+" is not supported")}},polygonize:function(t){var e=Ch.fromGeoJson(t);e.deleteDangles(),e.deleteCutEdges();var n=[],i=[];return e.getEdgeRings().filter(function(t){return t.isValid()}).forEach(function(t){t.isHole()?n.push(t):i.push(t)}),n.forEach(function(t){Sh.findEdgeRingContaining(t,i)&&i.push(t)}),sr(i.map(function(t){return t.toPolygon()}))},booleanDisjoint:function(t,n){var i;return kr(t,function(e){kr(n,function(t){if(!1===i)return!1;i=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return n=t.coordinates,i=e.coordinates,!(n[0]===i[0]&&n[1]===i[1]);case"LineString":return!Ph(e,t);case"Polygon":return!ts(t,e)}break;case"LineString":switch(e.type){case"Point":return!Ph(t,e);case"LineString":return!(0<Ya(t,e).features.length);case"Polygon":return!Nh(e,t)}break;case"Polygon":switch(e.type){case"Point":return!ts(e,t);case"LineString":return!Nh(t,e);case"Polygon":return!function(t,e){for(var n=0;n<t.coordinates[0].length;n++)if(ts(t.coordinates[0][n],e))return!0;for(var i=0;i<e.coordinates[0].length;i++)if(ts(e.coordinates[0][i],t))return!0;return!1}(e,t)}}var n,i}(e.geometry,t.geometry)})}),i},booleanContains:function(t,e){var n=Kr(t),i=Kr(e),r=Wr(t),o=Wr(e),s=zr(t),a=zr(e);switch(n){case"Point":switch(i){case"Point":return Rh(s,a);default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"Point":return function(t,e){var n,i=!1;for(n=0;n<t.coordinates.length;n++)if(Rh(t.coordinates[n],e.coordinates)){i=!0;break}return i}(r,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++){for(var i=!1,r=0;r<t.coordinates.length;r++)if(Rh(e.coordinates[n],t.coordinates[r])){i=!0;break}if(!i)return!1}return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"Point":return du(o,r,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var n=!1,i=0;i<e.coordinates.length;i++)if(du({type:"Point",coordinates:e.coordinates[i]},t,{ignoreEndVertices:!0})&&(n=!0),!du({type:"Point",coordinates:e.coordinates[i]},t,{ignoreEndVertices:!1}))return!1;return n}(r,o);case"MultiPoint":return function(t,e){for(var n=!1,i=0;i<e.coordinates.length;i++)if(du(e.coordinates[i],t,{ignoreEndVertices:!0})&&(n=!0),!du(e.coordinates[i],t))return!1;return!!n}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Point":return ts(o,r,{ignoreBoundary:!0});case"LineString":return function(t,e){var n,i,r=!1,o=0,s=qr(t),a=qr(e);if(!Th(s,a))return!1;for(;o<e.coordinates.length-1;o++){var u=(n=e.coordinates[o],i=e.coordinates[o+1],[(n[0]+i[0])/2,(n[1]+i[1])/2]);if(ts({type:"Point",coordinates:u},t,{ignoreBoundary:!0})){r=!0;break}}return r}(r,o);case"Polygon":return function(t,e){var n=qr(t),i=qr(e);if(!Th(n,i))return!1;for(var r=0;r<e.coordinates[0].length;r++)if(!ts(e.coordinates[0][r],t))return!1;return!0}(r,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++)if(!ts(e.coordinates[n],t,{ignoreBoundary:!0}))return!1;return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},booleanCrosses:function(t,e){var n=Kr(t),i=Kr(e),r=Wr(t),o=Wr(e);switch(n){case"MultiPoint":switch(i){case"LineString":return kh(r,o);case"Polygon":return Ah(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"MultiPoint":return kh(o,r);case"LineString":return function(t,e){if(0<Ya(t,e).features.length)for(var n=0;n<t.coordinates.length-1;n++)for(var i=0;i<e.coordinates.length-1;i++){var r=!0;if(0!==i&&i!==e.coordinates.length-2||(r=!1),Fh(t.coordinates[n],t.coordinates[n+1],e.coordinates[i],r))return!0}return!1}(r,o);case"Polygon":return Dh(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"MultiPoint":return Ah(o,r);case"LineString":return Dh(o,r);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},booleanClockwise:al,booleanOverlap:Hh,booleanPointOnLine:du,booleanEqual:function(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");return Kr(t)===Kr(e)&&new Yh({precision:6}).compare(Rs(t),Rs(e))},booleanWithin:yu,clone:us,cleanCoords:Rs,clustersDbscan:function(n,t,e){if("object"!=typeof(e=e||{}))throw new Error("options is invalid");var i=e.minPoints,r=e.units;if(Xr(n,"Point","Input must contain Points"),null==t)throw new Error("maxDistance is required");if(!(0<Math.sign(t)))throw new Error("Invalid maxDistance");if(!(null==i||0<Math.sign(i)))throw new Error("Invalid minPoints");n=us(n),i=i||3;var o=new Zh.DBSCAN,s=o.run(Or(n),mr(t,r),i,as),a=-1;return s.forEach(function(t){a++,t.forEach(function(t){var e=n.features[t];e.properties||(e.properties={}),e.properties.cluster=a,e.properties.dbscan="core"})}),o.noise.forEach(function(t){var e=n.features[t];e.properties||(e.properties={}),e.properties.cluster?e.properties.dbscan="edge":e.properties.dbscan="noise"}),n},clustersKmeans:function(t,e){if("object"!=typeof(e=e||{}))throw new Error("options is invalid");var n=e.numberOfClusters,i=e.mutate;Xr(t,"Point","Input must contain Points");var r=t.features.length;r<(n=n||Math.round(Math.sqrt(r/2)))&&(n=r),!1!==i&&void 0!==i||(t=us(t));var o=Or(t),s=o.slice(0,n),a=oc(o,n,s),u={};return a.centroids.forEach(function(t,e){u[e]=t}),Pr(t,function(t,e){var n=a.idxs[e];t.properties.cluster=n,t.properties.centroid=u[n]}),t},pointToLineDistance:iu,booleanParallel:function(t,e){if(!t)throw new Error("line1 is required");if(!e)throw new Error("line2 is required");if("LineString"!==sc(t,"line1"))throw new Error("line1 must be a LineString");if("LineString"!==sc(e,"line2"))throw new Error("line2 must be a LineString");for(var n,i,r,o,s=Va(Rs(t)).features,a=Va(Rs(e)).features,u=0;u<s.length;u++){var l=s[u].geometry.coordinates;if(!a[u])break;var h=a[u].geometry.coordinates;if(i=h,r=gr(Wa((n=l)[0],n[1])),o=gr(Wa(i[0],i[1])),r!==o)return!1}return!0},shortestPath:function(t,e,n){if(!xr(n=n||{}))throw new Error("options is invalid");var i=n.resolution,r=n.minDistance,o=n.obstacles||sr([]);if(!t)throw new Error("start is required");if(!e)throw new Error("end is required");if(i&&!br(i)||i<=0)throw new Error("options.resolution must be a number, greater than 0");if(r)throw new Error("options.minDistance is not yet implemented");var s=jr(t),a=jr(e);switch(t=tr(s),e=tr(a),Kr(o)){case"FeatureCollection":if(0===o.features.length)return rr([s,a]);break;case"Polygon":o=sr([Qi(Wr(o))]);break;default:throw new Error("invalid obstacles")}var u=o;u.features.push(t),u.features.push(e);var l=qr(yh(Vs(qr(u)),1.15));i||(i=as([l[0],l[1]],[l[2],l[1]],n)/100),u.features.pop(),u.features.pop();for(var h=l[0],c=l[1],p=l[2],f=l[3],d=i/as([h,c],[p,c],n)*(p-h),g=i/as([h,c],[h,f],n)*(f-c),y=p-h,_=f-c,m=Math.floor(y/d),v=Math.floor(_/g),b=(y-m*d)/2,x=[],E=[],w=[],I=[],L=1/0,S=1/0,M=f-(_-v*g)/2,C=0;c<=M;){for(var P=[],N=[],O=h+b,T=0;O<=p;){var R=tr([O,M]),k=pc(R,o);P.push(k?0:1),N.push(O+"|"+M);var D=as(R,t);!k&&D<L&&(L=D,w={x:T,y:C});var A=as(R,e);!k&&A<S&&(S=A,I={x:T,y:C}),O+=d,T++}E.push(P),x.push(N),M-=g,C++}var F=new lc(E,{diagonal:!0}),G=F.grid[w.y][w.x],B=F.grid[I.y][I.x],U=uc.search(F,G,B),q=[s];return U.forEach(function(t){var e=x[t.x][t.y].split("|");q.push([+e[0],+e[1]])}),q.push(a),Rs(rr(q))},voronoi:function(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.bbox||[-180,-85,180,85];if(!t)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return Xr(t,"Point","points"),sr(function(){var r=dc,o=gc,e=null;function n(i){return new Xc(i.map(function(t,e){var n=[Math.round(r(t,e,i)/Vc)*Vc,Math.round(o(t,e,i)/Vc)*Vc];return n.index=e,n.data=t,n}),e)}return n.polygons=function(t){return n(t).polygons()},n.links=function(t){return n(t).links()},n.triangles=function(t){return n(t).triangles()},n.x=function(t){return arguments.length?(r="function"==typeof t?t:fc(+t),n):r},n.y=function(t){return arguments.length?(o="function"==typeof t?t:fc(+t),n):o},n.extent=function(t){return arguments.length?(e=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],n):e&&[[e[0][0],e[0][1]],[e[1][0],e[1][1]]]},n.size=function(t){return arguments.length?(e=null==t?null:[[0,0],[+t[0],+t[1]]],n):e&&[e[1][0]-e[0][0],e[1][1]-e[0][1]]},n}().x(function(t){return t.geometry.coordinates[0]}).y(function(t){return t.geometry.coordinates[1]}).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(t.features).map(Wc))},ellipse:Jc,centerMean:Zc,centerMedian:function(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.counter||10;if(!br(n))throw new Error("counter must be a number");var i=e.weight,r=Zc(t,{weight:e.weight}),o=sr([]);return Pr(t,function(t){o.features.push(Zs(t,{weight:t.properties[i]}))}),o.properties={tolerance:e.tolerance,medianCandidates:[]},function t(o,e,n,i){var r=n.properties.tolerance||.001,s=0,a=0,u=0,l=0;if(Pr(n,function(t){var e=t.properties.weight,n=null==e?1:e;if(!br(n=Number(n)))throw new Error("weight value must be a number");if(0<n){l+=1;var i=n*as(t,o);0===i&&(i=1);var r=n/i;s+=t.geometry.coordinates[0]*r,a+=t.geometry.coordinates[1]*r,u+=r}}),l<1)throw new Error("no features to measure");var h=s/u,c=a/u;return 1===l||0===i||Math.abs(h-e[0])<r&&Math.abs(c-e[1])<r?tr([h,c],{medianCandidates:n.properties.medianCandidates}):(n.properties.medianCandidates.push([h,c]),t([h,c],o,n,i-1))}(r.geometry.coordinates,[0,0],o,n)},standardDeviationalEllipse:function(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var n=e.steps||64,i=e.weight,r=e.properties||{};if(!br(n))throw new Error("steps must be a number");if(!xr(r))throw new Error("properties must be a number");var o=Or(t).length,s=Zc(t,{weight:i}),a=0,u=0,l=0;Pr(t,function(t){var e=t.properties[i]||1,n=Qc(zr(t),zr(s));a+=Math.pow(n.x,2)*e,u+=Math.pow(n.y,2)*e,l+=n.x*n.y*e});var h=a-u,c=Math.sqrt(Math.pow(h,2)+4*Math.pow(l,2)),p=2*l,f=Math.atan((h+c)/p),d=180*f/Math.PI,g=0,y=0,_=0;Pr(t,function(t){var e=t.properties[i]||1,n=Qc(zr(t),zr(s));g+=Math.pow(n.x*Math.cos(f)-n.y*Math.sin(f),2)*e,y+=Math.pow(n.x*Math.sin(f)+n.y*Math.cos(f),2)*e,_+=e});var m=Math.sqrt(2*g/_),v=Math.sqrt(2*y/_),b=Jc(s,m,v,{units:"degrees",angle:d,steps:n,properties:r}),x=ns(t,sr([b])),E={meanCenterCoordinates:zr(s),semiMajorAxis:m,semiMinorAxis:v,numberOfFeatures:o,angle:d,percentageWithinEllipse:100*Or(x).length/o};return b.properties.standardDeviationalEllipse=E,b},difference:function(t,e){var n=Wr(t),i=Wr(e),r=t.properties||{};if(n=tm(n),i=tm(i),!n)return null;if(!i)return Qi(n,r);var o=new Ud,s=o.read(n),a=o.read(i),u=V_.difference(s,a);return u.isEmpty()?null:Qi((new qd).write(u),r)},buffer:function(t,n,e){var i=(e=e||{}).units,r=e.steps||64;if(!t)throw new Error("geojson is required");if("object"!=typeof e)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===n)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");r=r||64,i=i||"kilometers";var o=[];switch(t.type){case"GeometryCollection":return Tr(t,function(t){var e=Lv(t,n,i,r);e&&o.push(e)}),sr(o);case"FeatureCollection":return Pr(t,function(t){var e=Lv(t,n,i,r);e&&Pr(e,function(t){t&&o.push(t)})}),sr(o)}return Lv(t,n,i,r)},union:Mv,intersect:Cv,dissolve:function(t,e){if(!xr(e=e||{}))throw new Error("options is invalid");var a=e.propertyName;Xr(t,"Polygon","dissolve");var n=us(t),u=n.features,l=[];u.forEach(function(t,e){t.properties.origIndexPosition=e});var h=qa();for(var c in h.load(n),u){var p=u[c],f=!1;if(h.search(p).features.forEach(function(t){p=u[c];var e=t.properties.origIndexPosition;if(0<l.length&&0!==e)if(e>l[l.length-1])e-=l.length;else{var n=Pv(e,l);0!==n&&(e-=n)}if(e!==+c){var i,r,o,s=u[e];s&&p&&(void 0!==a&&s.properties[a]!==p.properties[a]||Hh(p,s)&&(i=s,r=rr(Or(p)),o=rr(Or(i)),0<Ya(r,o).features.length)&&(u[c]=Mv(p,s),l.push(t.properties.origIndexPosition),l.sort(function(t,e){return t-e}),h.remove(t),u.splice(e,1),p.properties.origIndexPosition=c,h.remove(p,function(t,e){return t.properties.origIndexPosition===e.properties.origIndexPosition}),f=!0))}}),f){if(!p)continue;p.properties.origIndexPosition=c,h.insert(p),c--}}return u.forEach(function(t){delete t.properties.origIndexPosition,delete t.bbox}),n},hexGrid:Nv,mask:function(t,e){var n,r,o,i,s,a,u=nr((n=e)&&n.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]),l=(r=[],o=[],kr(t,function(t){var e=t.geometry.coordinates,n=e[0],i=e.slice(1);r.push(nr([n])),i.forEach(function(t){o.push(nr([t]))})}),[sr(r),sr(o)]),h=l[0],c=l[1];return h=Rv(h),c=Rv(c),i=h,s=c,(a=[]).push(u.geometry.coordinates[0]),kr(i,function(t){a.push(t.geometry.coordinates[0])}),kr(s,function(t){a.push(t.geometry.coordinates[0])}),nr(a)},squareGrid:Dv,triangleGrid:Av,interpolate:function(e,t,a){if("object"!=typeof(a=a||{}))throw new Error("options is invalid");var u=a.gridType,l=a.property,h=a.weight;if(!e)throw new Error("points is required");if(Xr(e,"Point","input must contain Points"),!t)throw new Error("cellSize is required");if(void 0!==h&&"number"!=typeof h)throw new Error("weight must be a number");l=l||"elevation",u=u||"square",h=h||1;var n,i=qr(e);switch(u){case"point":case"points":n=vu(i,t,a);break;case"square":case"squares":n=Dv(i,t,a);break;case"hex":case"hexes":n=Nv(i,t,a);break;case"triangle":case"triangles":n=Av(i,t,a);break;default:throw new Error("invalid gridType")}var c=[];return Pr(n,function(r){var o=0,s=0;Pr(e,function(t){var e,n=as("point"===u?r:Zs(r),t,a);if(void 0!==l&&(e=t.properties[l]),void 0===e&&(e=t.geometry.coordinates[2]),void 0===e)throw new Error("zValue is missing");0===n&&(o=e);var i=1/Math.pow(n,h);s+=i,o+=i*e});var t=us(r);t.properties[l]=o/s,c.push(t)}),sr(c)},pointOnSurface:ou,polygonToLineString:Uu,lineStringToPolygon:ju,inside:ts,within:ns,bezier:zs,nearest:Ia,pointOnLine:Xa,lineDistance:pu,radians2degrees:yr,degrees2radians:_r,distanceToDegrees:dr,distanceToRadians:fr,radiansToDistance:pr,bearingToAngle:gr,convertDistance:mr,toMercator:Za,toWgs84:Qa,randomPosition:$c,randomPoint:tp,randomPolygon:ep,randomLineString:np,getCluster:sp,clusterEach:ap,clusterReduce:up,createBins:lp,applyFilter:hp,propertiesContainsFilter:cp,filterProperties:pp,earthRadius:Wi,factors:Ji,unitsFactors:Ki,areaFactors:Zi,feature:Qi,geometry:$i,point:tr,points:er,polygon:nr,polygons:ir,lineString:rr,lineStrings:or,featureCollection:sr,multiLineString:ar,multiPoint:ur,multiPolygon:lr,geometryCollection:hr,round:cr,radiansToLength:pr,lengthToRadians:fr,lengthToDegrees:dr,bearingToAzimuth:gr,radiansToDegrees:yr,degreesToRadians:_r,convertLength:mr,convertArea:vr,isNumber:br,isObject:xr,validateBBox:Er,validateId:wr,getCoord:jr,getCoords:zr,containsNumber:Vr,geojsonType:Yr,featureOf:Hr,collectionOf:Xr,getGeom:Wr,getGeomType:Jr,getType:Kr,coordEach:Lr,coordReduce:Sr,propEach:Mr,propReduce:Cr,featureEach:Pr,featureReduce:Nr,coordAll:Or,geomEach:Tr,geomReduce:Rr,flattenEach:kr,flattenReduce:Dr,segmentEach:Ar,segmentReduce:Fr,lineEach:Gr,lineReduce:Br}),Bv=ii.extend({options:{bSnap:!1,strokeColor:new ne(0,0,0,255),fillColor:new ne(203,220,245,100)},initialize:function(t,e){ii.prototype.initialize.call(this,t,e),this._enabled=!1,this._drawType="",this._pointArray=null,this._pixelArray=null,this._feature=null,this._drawLayer=null},enable:function(t){this.disable(),t&&(this._enabled=!0,this._drawType=t,this._drawLayer=new Xi,this._drawLayer.addTo(this._map),this.setMapDragging(!1),this.setMouseStyle(t),this._map.on("mousedown",this._onClick,this),this._map.on("dblclick",this._onDblClick,this),this._map.on("mousemove",this._onMouseMove,this))},disable:function(){this._enabled&&(this._enabled=!1,this._drawType="",this._clearData(),this._drawLayer&&(this._drawLayer.clear(),this._drawLayer.remove(),this._drawLayer=null),this.setMapDragging(!0),this.setMouseStyle(),this._map.off("mousedown",this._onClick,this),this._map.off("dblclick",this._onDblClick,this),this._map.off("mousemove",this._onMouseMove,this))},_clearData:function(){this._pointArray=null,this._pixelArray=null,this._feature=null,this._drawLayer&&this._drawLayer.clear()},_finish:function(){this._clearData()},_draw:function(){this._drawLayer&&(this._drawLayer.clear(),this._feature&&(this._drawLayer.addFeature(this._feature.clone()),this._drawLayer.draw()))},_onClick:function(t){var i=this,r=t.latlng,o=new G.Point(r.lng,r.lat),s=t.layerPoint;if(this._pixelArray||(this._pixelArray=[]),this._pointArray||(this._pointArray=[]),!this._bRequestGeo){switch(this._drawType){case $n.CLIP_POLYGON:case $n.CREATE_POLYLINE:case $n.CREATE_POLYGON:case $n.CREATE_CIRCLE:case $n.CREATE_FILL_CIRCLE:if(0<this._pixelArray.length)if(this._pixelArray[this._pixelArray.length-1].equals(s))return}var e=!1;if(this.options.bSnap){var a=this._map.seManager.getEditManager().getSnapHandler(),n=a.getSnapResult();if(n){var u=n.layerId,l=n.featureId,h=this._map.seManager.getLayerById(u);if(h&&h.getDataset()){var c=h.getDataset();e=!0,this._requestGeo(c,l).then(function(t){i._bRequestGeo=!1;var e=a.getSnapMapPoint(t,r,c.getProjInfo());if(e&&e.snapPoint){var n=c.getProjInfo().unproject(e.snapPoint);i._pointArray.push(new G.Point(n.lng,n.lat))}else i._pointArray.push(o);i._pixelArray.push(s),i._clickHandler()}).catch(function(){i._bRequestGeo=!1,i._pointArray.push(o),i._pixelArray.push(s),i._clickHandler()})}}}e?this._bRequestGeo=!0:(this._pointArray.push(o),this._pixelArray.push(s),this._clickHandler())}},_requestGeo:function(t,e){return new Promise(function(o,s){ht({data:{dataset_list:[{dataset_id:t.getID(),dataset_ver:t.getVersion(),feature_id_list:[e],query_geo:!0}]},success:function(t){if(t.status!==rt.SUCCESS)s();else{var e=t.result.dataset_list;if(!e||0===e.length)return void s();var n=e[0];if(!n.geo_list||0===n.geo_list.length)return void s();var i=n.geo_list[0],r=bt.createFeatureFromGeoJSON(i);o(r)}},error:function(){s()}})})},_clickHandler:function(){switch(this._drawType){case $n.CREATE_POINT:this._feature=new Et({mapPoints:this._pointArray.slice(0),polyCount:[1],subCount:1}),this.fire("end",{drawType:this._drawType,feature:this._feature.clone()}),this._finish();break;case $n.CREATE_POLYLINE:case $n.CLIP_POLYGON:var t=this._pointArray.slice(0);this._feature?(this._feature.setMapPoints(t),this._feature.setPolyCount([t.length])):(this._feature=new wt({mapPoints:t,polyCount:[t.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.LINE))),this._draw();break;case $n.CREATE_POLYGON:var e=this._pointArray.slice(0);2<e.length&&e.push(e[0]),this._feature?(this._feature.setMapPoints(e),this._feature.setPolyCount([e.length])):(this._feature=new It({mapPoints:e,polyCount:[e.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.POLYGON))),this._draw();break;case $n.CREATE_HAND_LINE:var n=this._pointArray.slice(0);if(console.log(n),this._feature){var i=this.getCurvePoints(this._feature),r=new wt({mapPoints:i,polyCount:[i.length],subCount:1});this.fire("end",{drawType:this._drawType,feature:r.clone()}),this._finish()}else this._feature=new wt({mapPoints:n,polyCount:[n.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.LINE));break;case $n.CREATE_HAND_POLYGON:var o=this._pointArray.slice(0);if(this._feature){var s=this.getCurvePoints(this._feature,!0);s.push(s[s.length-1]);var a=new It({mapPoints:s,polyCount:[s.length],subCount:1});this.fire("end",{drawType:this._drawType,feature:a.clone()}),this._finish()}else this._feature=new wt({mapPoints:o,polyCount:[o.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.LINE));break;case $n.CREATE_RECT:case $n.CREATE_FILL_RECT:var u=this._pointArray.slice(0),l=this._pixelArray.slice(0),h=!1;3===u.length&&(u=this.getRectPoints(l),h=!0),this._feature?(this._feature.setMapPoints(u),this._feature.setPolyCount([u.length])):this._drawType===$n.CREATE_RECT?(this._feature=new wt({mapPoints:u,polyCount:[u.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.LINE))):(this._feature=new It({mapPoints:u,polyCount:[u.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.POLYGON))),this._draw(),h&&(this.fire("end",{drawType:this._drawType,feature:this._feature.clone()}),this._finish());break;case $n.CREATE_CIRCLE:case $n.CREATE_FILL_CIRCLE:var c=this._pointArray.slice(0);this._pixelArray.slice(0);this._feature?(c=this.getCirclePoints(c),this._feature.setMapPoints(c),this._feature.setPolyCount([c.length]),this.fire("end",{drawType:this._drawType,feature:this._feature.clone()}),this._finish()):this._drawType===$n.CREATE_CIRCLE?(this._feature=new wt({mapPoints:c,polyCount:[c.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.LINE))):(this._feature=new It({mapPoints:c,polyCount:[c.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.POLYGON)));break;case $n.CREATE_ELLIPSE:case $n.CREATE_FILL_ELLIPSE:var p=this._pointArray.slice(0),f=this._pixelArray.slice(0),d=!1;if(3===p.length){var g=this.getEllipsePoints(f);g&&0<g.length&&(p=g),d=!0}else if(2===p.length){p=[new G.Point(2*p[0].x-p[1].x,2*p[0].y-p[1].y),p[1]]}this._feature?(this._feature.setMapPoints(p),this._feature.setPolyCount([p.length])):this._drawType===$n.CREATE_ELLIPSE?(this._feature=new wt({mapPoints:p,polyCount:[p.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.LINE))):(this._feature=new It({mapPoints:p,polyCount:[p.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(xt.POLYGON))),this._draw(),d&&(this.fire("end",{drawType:this._drawType,feature:this._feature.clone()}),this._finish())}},_onDblClick:function(){if(this._pointArray&&0!==this._pointArray.length){var t=this._pointArray.slice(0);switch(this._drawType){case $n.CREATE_POLYLINE:case $n.CLIP_POLYGON:if(t.length<=1)break;var e=new wt({mapPoints:t,polyCount:[t.length],subCount:1});this.fire("end",{drawType:this._drawType,feature:e}),this._finish();break;case $n.CREATE_POLYGON:if(t.length<=2)break;t.push(t[0].clone());var n=new It({mapPoints:t,polyCount:[t.length],subCount:1});this.fire("end",{drawType:this._drawType,feature:n}),this._finish()}}},_onMouseMove:function(t){var e=t.latlng,n=new G.Point(e.lng,e.lat),i=t.layerPoint;if(this._pointArray&&0!==this._pointArray.length&&this._feature)switch(this._drawType){case $n.CREATE_POLYLINE:case $n.CLIP_POLYGON:var r=this._pointArray.slice(0);r.push(n),this._feature.setMapPoints(r),this._feature.setPolyCount([r.length]),this._draw();break;case $n.CREATE_POLYGON:var o=this._pointArray.slice(0);o.push(n),2<=this._pointArray.length&&o.push(this._pointArray[0]),this._feature.setMapPoints(o),this._feature.setPolyCount([o.length]),this._draw();break;case $n.CREATE_HAND_LINE:case $n.CREATE_HAND_POLYGON:var s=this._pointArray.slice(0);s.push(n);var a=this._pixelArray[this._pixelArray.length-1];5<Math.sqrt(Math.pow(a.x-i.x,2)+Math.pow(a.y-i.y,2))&&(this._pixelArray.push(i),this._pointArray.push(n)),this._feature.setMapPoints(s),this._feature.setPolyCount([s.length]),this._draw();break;case $n.CREATE_RECT:case $n.CREATE_FILL_RECT:var u=this._pointArray.slice(0);u.push(n);var l=this._pixelArray.slice(0);l.push(i),3===u.length&&(u=this.getRectPoints(l)),this._feature.setMapPoints(u),this._feature.setPolyCount([u.length]),this._draw();break;case $n.CREATE_CIRCLE:case $n.CREATE_FILL_CIRCLE:var h=this._pointArray.slice(0);if(h.push(n),this._pixelArray.slice(0).push(i),h.length<2)break;h=this.getCirclePoints(h),this._feature.setMapPoints(h),this._feature.setPolyCount([h.length]),this._draw();break;case $n.CREATE_ELLIPSE:case $n.CREATE_FILL_ELLIPSE:var c=this._pointArray.slice(0);c.push(n);var p=this._pixelArray.slice(0);if(p.push(i),c.length<2)break;if(3===c.length){var f=this.getEllipsePoints(p);if(f&&0<f.length)c=f;else c=[new G.Point(2*c[0].x-c[1].x,2*c[0].y-c[1].y),c[1]]}else if(2===c.length){c=[new G.Point(2*c[0].x-c[1].x,2*c[0].y-c[1].y),c[1]]}this._feature.setMapPoints(c),this._feature.setPolyCount([c.length]),this._draw()}},getDefaultSymbol:function(t){var e=null;switch(t){case xt.POINT:e=new Ci({color:this.options.fillColor});break;case xt.LINE:e=new Gi({width:1,color:this.options.strokeColor});break;case xt.POLYGON:case xt.MULTIPOLYGON:e=new Hi({color:this.options.fillColor,hasOutline:!0,outlineSymbol:new Gi({color:this.options.strokeColor})})}return e},getCurvePoints:function(t,e){var n=t.toGeoJSON().geometry.coordinates,i=null;if(1<n.length){if(e){var r=n[0];n.push([r[0],r[1]])}var o=Gv.lineString(n),s=Gv.bezierSpline(o);i=bt.createFeatureFromGeoJSON(s).getMapPoints()}else i=t.getMapPoints();return i},getRectPoints:function(t){if(!t||3!==t.length)return null;var e=[],n=t[0],i=t[1],r=t[2];if(n.x===i.x||n.y===i.y){var o=n.x<r.x?n.x:r.x,s=n.x>r.x?n.x:r.x,a=n.y<r.y?n.y:r.y,u=n.y>r.y?n.y:r.y,l=this._map.layerPointToLatLng(new G.Point(o,a)),h=this._map.layerPointToLatLng(new G.Point(o,u)),c=this._map.layerPointToLatLng(new G.Point(s,u)),p=this._map.layerPointToLatLng(new G.Point(s,a));return e.push(new G.Point(l.lng,l.lat),new G.Point(h.lng,h.lat),new G.Point(c.lng,c.lat),new G.Point(p.lng,p.lat),new G.Point(l.lng,l.lat)),e}var f=(i.y-n.y)/(i.x-n.x),d=n.y-f*n.x,g=(r.y+r.x/f-d)/(f+1/f),y=f*g+d,_=n.x+(r.x-g),m=r.y+(n.y-y),v=this._map.layerPointToLatLng(n),b=this._map.layerPointToLatLng(new G.Point(g,y)),x=this._map.layerPointToLatLng(r),E=this._map.layerPointToLatLng(new G.Point(_,m));return e.push(new G.Point(v.lng,v.lat),new G.Point(b.lng,b.lat),new G.Point(x.lng,x.lat),new G.Point(E.lng,E.lat),new G.Point(v.lng,v.lat)),e},getCirclePoints:function(t){if(!t||t.length<2)return null;var e=[],n=t[0],i=t[1],r=Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2)),o=r;return vt.convArc2PLine(e,n,r,o,0,0,2*Math.PI),e},getEllipsePoints:function(t){if(!t||3!==t.length)return null;var e=[],n=t[0],i=t[1],r=t[2];if(n.x===i.x||n.y===i.y){var o,s;o=Math.abs(r.x-n.x),s=Math.abs(r.y-n.y),vt.convArc2PLine(e,n,o,s,0,0,2*Math.PI)}else{var a=(i.y-n.y)/(i.x-n.x),u=n.y-a*n.x,l=(r.y+r.x/a-u)/(a+1/a),h=a*l+u,c=new G.Point(l,h),p=Math.sqrt(Math.pow(n.x-c.x,2)+Math.pow(n.y-c.y,2)),f=Math.sqrt(Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2)),d=Math.atan((n.y-i.y)/(n.x-i.x));(d=180*d/Math.PI)<0&&(d+=180),d=d*Math.PI/180,vt.convArc2PLine(e,n,p,f,d,0,2*Math.PI)}for(var g=[],y=0;y<e.length;y++){var _=this._map.layerPointToLatLng(e[y]);g.push(new G.Point(_.lng,_.lat))}return g}}),Uv=ii.extend({options:{bSnap:!0,strokeColor:new ne(255,0,255,255),fillColor:new ne(255,0,255,50)},initialize:function(t,e){ii.prototype.initialize.call(this,t,e),this._enabled=!1,this._editType="",this._pointArray=null,this._drawLayer=null},enable:function(t){(this.disable(),t)&&(this._enabled=!0,this._editType=t,this._drawLayer=new Xi,this._drawLayer.addTo(this._map),this.setMapDragging(!1),this.setMouseStyle(t),this._map.on("mousedown",this._onMouseDown,this),this._map.on("mousemove",this._onMouseMove,this),this._map.on("mouseup",this._onMouseUp,this),(this._editType===$n.ADD_NODE||this._editType===$n.EDIT_NODE)&&this._map.seManager.getEditManager().draw())},disable:function(){this._enabled&&(this._enabled=!1,this._editType="",this._clearData(),this._drawLayer&&(this._drawLayer.clear(),this._drawLayer.remove(),this._drawLayer=null),this.setMapDragging(!0),this.setMouseStyle(),this._map.off("mousedown",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this),this._map.off("mouseup",this._onMouseUp,this),this._map.seManager.getEditManager().draw())},_clearData:function(){this._pointArray=null,this._editNodeResult=null,this._drawLayer&&this._drawLayer.clear()},_finish:function(){this._clearData()},_getEditFeatures:function(){var t=this._map.seManager.getEditManager().getCurrentEditFeatures();if(!t||0===t.length)return null;var e=[];return t.forEach(function(t){e.push(t.clone())}),e},_draw:function(t){if(t&&0!==t.length&&this._drawLayer){var e=this.getDefaultSymbol(t[0].getType());this._drawLayer.clear(),this._drawLayer.setFeatures(t),this._drawLayer.setSymbol(e),this._drawLayer.draw()}},_onMouseDown:function(t){if(this._enabled){var e=this._map.seManager.getEditManager();if(e.hasEditFeature()){var n=e.getSnapHandler(),i=t.latlng;switch(this._pointArray||(this._pointArray=[]),this._editNodeResult=null,this._editType){case $n.MOVE:e.bClickOnEditFeatures(i)&&this._pointArray.push(i);break;case $n.ROTATE:this._pointArray.push(i);break;case $n.EDIT_NODE:var r=this._getEditFeatures();if(!r||1!==r.length)break;var o=r[0],s=n.getSnapNode(o,i,null,8);s&&s.snapPoint&&(this._editNodeResult=s,this._pointArray.push(i))}}}},_onMouseMove:function(t){if(this._enabled&&this._pointArray&&0!==this._pointArray.length){var e=t.latlng,n=this._map.seManager.getEditManager();switch(this._editType){case $n.MOVE:var i=this._pointArray.slice(0);i.push(e);var r=this._getMoveFeatures(i);r&&0<r.length&&this._draw(r);break;case $n.ROTATE:var o=this._pointArray.slice(0);o.push(e);var s=this._getRotateFeatures(o);s&&0<s.length&&this._draw(s);break;case $n.EDIT_NODE:if(!this._editNodeResult)break;var a=this._getEditFeatures();if(!a||1!==a.length)break;var u=a[0],l=u.getProjInfo().project(e),h=this._editNode(u,this._editNodeResult,l);h&&n.drawEditNodes(h)}}},_onMouseUp:function(t){if(this._enabled){var e=this._map.seManager.getEditManager(),n=e.getSnapHandler(),i=t.latlng;switch(this._editType){case $n.MOVE:if(!this._pointArray||0===this._pointArray.length)break;var r=this._pointArray.slice(0);r.push(i);var o=this._getMoveFeatures(r);this.fire("end",{editType:this._editType,features:o}),this._finish();break;case $n.ROTATE:if(!this._pointArray||0===this._pointArray.length)break;var s=this._pointArray.slice(0);s.push(i);var a=this._getRotateFeatures(s);this.fire("end",{editType:this._editType,features:a}),this._finish();break;case $n.ADD_NODE:var u=this._getEditFeatures();if(!u||1!==u.length)break;var l=u[0],h=n.getSnapMapPoint(l,i);if(!h||!h.snapPoint){e.fire("editTip",{tip:vi});break}var c=this._addNode(l,h);c&&this.fire("end",{editType:this._editType,features:[c]}),this._finish();break;case $n.CLIP_LINE:var p=this._getEditFeatures();if(!p||1!==p.length)break;var f=p[0],d=n.getSnapMapPoint(f,i);if(!d||!d.snapPoint){e.fire("editTip",{tip:_i});break}var g=this._clipLine(f,d);g&&this.fire("end",{editType:this._editType,features:g}),this._finish();break;case $n.EDIT_NODE:if(!this._editNodeResult)break;var y=this._getEditFeatures();if(!y||1!==y.length)break;var _=n.getSnapResult();if(!_){var m=y[0],v=m.getProjInfo().project(i),b=this._editNode(m,this._editNodeResult,v);b&&this.fire("end",{editType:this._editType,features:[b]}),this._finish();break}this._getSnapGeoHandler(_,i)}}},_getSnapGeoHandler:function(t,i){var r=this,o=this._map.seManager.getEditManager().getSnapHandler(),e=t.layerId,n=t.featureId,s=this._map.seManager.getLayerById(e);if(s&&s.getDataset()){var a=s.getDataset();this._requestGeo(a,n).then(function(t){var e=o.getSnapMapPoint(t,i,a.getProjInfo());if(e&&e.snapPoint){var n=a.getProjInfo().unproject(e.snapPoint);r._snapMouseUp(n)}else r._snapMouseUp(i)}).catch(function(){r._snapMouseUp(i)})}else this._snapMouseUp(i)},_snapMouseUp:function(t){switch(this._editType){case $n.EDIT_NODE:if(!this._editNodeResult)break;var e=this._getEditFeatures();if(!e||1!==e.length)break;var n=e[0],i=n.getProjInfo().project(t),r=this._editNode(n,this._editNodeResult,i);r&&this.fire("end",{editType:this._editType,features:[r]}),this._finish()}},_requestGeo:function(t,e){return new Promise(function(o,s){ht({data:{dataset_list:[{dataset_id:t.getID(),dataset_ver:t.getVersion(),feature_id_list:[e],query_geo:!0}]},success:function(t){if(t.status!==rt.SUCCESS)s();else{var e=t.result.dataset_list;if(!e||0===e.length)return void s();var n=e[0];if(!n.geo_list||0===n.geo_list.length)return void s();var i=n.geo_list[0],r=bt.createFeatureFromGeoJSON(i);o(r)}},error:function(){s()}})})},getDefaultSymbol:function(t){var e=null,n=this.options.strokeColor,i=this.options.fillColor;switch(t){case xt.POINT:e=new Ci({color:i,hasOutline:!0,outlineColor:n,size:12});break;case xt.LINE:e=new Gi({width:2,color:n});break;case xt.POLYGON:case xt.MULTIPOLYGON:e=new Hi({color:i,hasOutline:!0,outlineSymbol:new Gi({color:n,width:2})})}return e},_getMoveFeatures:function(t){var n=this;if(!t||2!==t.length)return null;var e=t[0],i=t[1],r=this._getEditFeatures();if(!r||0===r.length)return null;var o=this._map.seManager.getEditManager().getEditLayer().getDataset().getProjInfo(),s=o.project(e),a=o.project(i),u=a.x-s.x,l=a.y-s.y;return r.forEach(function(t){if(t)if(t.getType()===xt.MULTIPOLYGON){var e=t.getPolygons();e&&0<e.length&&e.forEach(function(t){n._getMovePoints(t.getMapPoints(),u,l)})}else n._getMovePoints(t.getMapPoints(),u,l)}),r},_getMovePoints:function(t,e,n){t&&0!==t.length&&t.forEach(function(t){t.x+=e,t.y+=n})},_getRotateFeatures:function(t){var n=this;if(!t||2!==t.length)return null;var e=t[0],i=t[1],r=this._getEditFeatures();if(!r||0===r.length)return null;var o=this._map.seManager.getEditManager(),s=o.getEditLayer().getDataset().getProjInfo(),a=s.project(e),u=s.project(i),l=o.getCenter(r),h=Math.atan2(a.y-l.y,a.x-l.x),c=Math.atan2(u.y-l.y,u.x-l.x)-h;return r.forEach(function(t){if(t)if(t.getType()===xt.MULTIPOLYGON){var e=t.getPolygons();e&&0<e.length&&e.forEach(function(t){n._getRotatePoints(t.getMapPoints(),l,c)})}else n._getRotatePoints(t.getMapPoints(),l,c)}),r},_getRotatePoints:function(t,e,n){t&&0!==t.length&&t.forEach(function(t){vt.rotatePoint(t,e,n)})},_addNode:function(t,e){var n=e.pointIndex,i=e.subIndex,r=e.points,o=e.snapPoint;if(!o||!r||0===r.length)return null;var s=t.clone(),a=s;if(s.getType()===xt.MULTIPOLYGON){var u=s.getPolygons();if(!u)return null;var l=e.geoIndex;if(u.length<=l)return null;a=u[l]}var h=a.getMapPoints(),c=a.getPolyCount();return h.length<=n+1?null:c.length<=i?null:(h.splice(n+1,0,o),c[i]++,s)},_clipLine:function(t,e){var n=e.pointIndex,i=e.snapPoint;if(!i)return null;for(var r=t.clone(),o=r.getMapPoints(),s=r.getPolyCount(),a=r.getSubCount(),u=[],l=0,h=0;h<a;h++){var c=s[h];if(n<l+c){(u=o.slice(n+1,l+c)).unshift(i);var p=l+c-(n+1);o.splice(n+1,p,i),s[h]=c-p+1;break}l+=c}return[r,new wt({mapPoints:u,polyCount:[u.length],subCount:1})]},_editNode:function(t,e,n){var i=e.pointIndex,r=t.clone(),o=r;if(r.getType()===xt.MULTIPOLYGON){var s=r.getPolygons();if(!s)return null;var a=e.geoIndex;if(s.length<=a)return null;o=s[a]}var u=o.getMapPoints();return u.length<=i?null:(u[i].x=n.x,u[i].y=n.y,r)}}),qv=G.Evented.extend({options:{},initialize:function(t,e){G.setOptions(this,e),this._map=t,this._action=$n.PAN,this._selectTool=new ri(t),this._selectTool.on("end",this._selectEnd,this),this._seDrawTool=new Bv(t,{bSnap:!0}),this._seDrawTool.on("end",this._drawEnd,this),this._seEditTool=new Uv(t),this._seEditTool.on("end",this._editEnd,this),this._selectAction=new si(this._map)},getAction:function(){return this._action},_selectEnd:function(t){if(t&&t.points&&t.points.length){var e=t.selectType,n=t.points;this._selectAction.select(e,n)}},_drawEnd:function(t){if(t&&t.feature){var e=this._map.seManager.getEditManager();t.drawType===$n.CLIP_POLYGON?e.clipPolygon(t.feature):e.addFeatures([t.feature])}},_editEnd:function(t){if(t&&t.features&&0!==t.features.length){var e=this._map.seManager.getEditManager();t.editType===$n.CLIP_LINE?e.clipFeatures(t.features):e.modifyFeatures(t.features)}},setAction:function(t,e){var n=this;e=e||{};var i=this._map.seManager.getEditManager();i.snapDisable();var r,o=i.getEditLayer(),s=null;switch(o&&(s=o.getDataset()),t){case $n.PAN:this._action=t,this._initTool();break;case $n.IDENTIFY:case $n.SELECT_BY_POINT:case $n.SELECT_BY_RECT:case $n.SELECT_BY_CIRCLE:case $n.SELECT_BY_POLYGON:this._action=t,this._initTool(),this._selectTool.enable(t);break;case $n.CREATE_POINT:o&&s&&s.getType()===ae.POINT?(this._action=t,this._initTool(),i.snapEnable(),this._seDrawTool.enable(t)):i.fire("editTip",{tip:ai});break;case $n.CREATE_POLYLINE:case $n.CREATE_HAND_LINE:case $n.CREATE_RECT:case $n.CREATE_CIRCLE:case $n.CREATE_ELLIPSE:o&&s&&s.getType()===ae.LINE?(this._action=t,this._initTool(),i.snapEnable(),this._seDrawTool.enable(t)):i.fire("editTip",{tip:ai});break;case $n.CREATE_POLYGON:case $n.CREATE_HAND_POLYGON:case $n.CREATE_FILL_RECT:case $n.CREATE_FILL_CIRCLE:case $n.CREATE_FILL_ELLIPSE:o&&s&&s.getType()===ae.POLYGON?(this._action=t,this._initTool(),i.snapEnable(),this._seDrawTool.enable(t)):i.fire("editTip",{tip:ai});break;case $n.MOVE:case $n.ROTATE:if(!i.hasEditFeature()){i.fire("editTip",{tip:li});break}if(i.isOutMaxCount()){i.fire("editTip",{tip:ui});break}i.lock().then(function(){n._action=t,n._initTool(),i.snapEnable(),n._seEditTool.enable(t)}).catch(function(t){i.fire("editTip",{tip:t})});break;case $n.ADD_NODE:case $n.EDIT_NODE:case $n.CLIP_LINE:if(!i.hasEditFeature()){i.fire("editTip",{tip:li});break}if(1<i.getEditCount()){i.fire("editTip",{tip:hi});break}i.lock().then(function(){n._action=t,n._initTool(),i.snapEnable(),n._seEditTool.enable(t)}).catch(function(t){i.fire("editTip",{tip:t})});break;case $n.CLIP_POLYGON:if(!o||!s||s.getType()!==ae.POLYGON){i.fire("editTip",{tip:ai});break}if(!i.hasEditFeature()){i.fire("editTip",{tip:li});break}if(1<i.getEditCount()){i.fire("editTip",{tip:ci});break}i.lock().then(function(){n._action=t,n._initTool(),i.snapEnable(),n._seDrawTool.enable(t)}).catch(function(t){i.fire("editTip",{tip:t})});break;default:e.error&&e.error(r)}e.success&&e.success()},_initTool:function(){this._selectTool.disable(),this._seDrawTool.disable(),this._seEditTool.disable()}}),jv=G.Layer.extend({options:{},initialize:function(t){G.setOptions(this,t),this.id=vt.stamp(),this.sId=-1,this.name="",this.label="",this.visible=!0,this.selected=!0,this.type=Zn.SEGROUPLAYER,this._layers=null,this.renderStyle=new de,this.minScale=0,this.maxScale=0,this._parentLayerId=-1},getType:function(){return this.type},getParentLayerId:function(){return this._parentLayerId},setParentLayerId:function(t){this._parentLayerId=t},getID:function(){return this.id},getName:function(){return this.name},setName:function(t){this.name=t,this.label=t},isVisible:function(){return this.visible},setVisible:function(t){this.visible=t},isSelected:function(){return this.selected},setSelected:function(t){this.selected=t},getRenderStyle:function(){return this.renderStyle},setRenderStyle:function(t){this.renderStyle=t},getMinScale:function(){return this.minScale},setMinScale:function(t){this.minScale=t},getMaxScale:function(){return this.maxScale},setMaxScale:function(t){this.maxScale=t},getLayers:function(t){if(!t)return this._layers;var e=[];return this._mapGroupLayer(this._layers,e),e},setLayers:function(t){this._layers=t},_mapGroupLayer:function(t,e){var n=this;t&&0!==t.length&&t.forEach(function(t){t&&(t.getType()===Zn.SEGROUPLAYER?n._mapGroupLayer(t.getLayers(),e):e.push(t))})},addLayer:function(t,e){t&&(this._layers||(this._layers=[]),t.setParentLayerId(this.getID()),e?this._layers.unshift(t):this._layers.push(t))},addLayers:function(t){if(t&&t.length)for(var e=0;e<t.length;e++){var n=t[e];n&&this.addLayer(n)}},removeLayer:function(t){if(t&&this._layers&&this._layers.length){var e=this._layers.indexOf(t);0<=e&&this._layers.splice(e,1)}},hasLayer:function(t){return!!(t&&this._layers&&this._layers.length)&&0<=this._layers.indexOf(t)},getRequestObj:function(t,e){return this._getRequestObj(this,t,e)},_getRequestObj:function(t,e,n){if(t){var i=t.getLayers();if(i&&0!==i.length&&t.visible)if(t.isQuery(n))for(var r=i.length,o=0;o<r;o++){var s=i[o];s&&(s.getType()===Zn.SEGROUPLAYER?this._getRequestObj(s,e,n):s.dataset&&s.getRequestObj(e,n))}}},isQuery:function(t){if(0<=t){if(t=1/t,0===this.maxScale&&0===this.minScale)return!0;if(0===this.maxScale&&0<this.minScale&&t>=1/this.minScale)return!0;if(0<this.maxScale&&0===this.minScale&&t<=1/this.maxScale)return!0;if(0<this.maxScale&&0<this.minScale&&t<=1/this.maxScale&&t>=1/this.minScale)return!0}return!1},clearData:function(){this._layers&&0!==this._layers.length&&this._layers.forEach(function(t){t&&t.clearData()})},readJson:function(t,e){if(t){if(this.expand=!!t.expand,this.sId=void 0!==t.id?t.id:-1,this.name=t.name?t.name:"",this.label=t.label?t.label:"",this.visible=!!t.visible,this.minScale=t.min_scale?t.min_scale:0,this.maxScale=t.max_scale?t.max_scale:0,t.legend_group){this.renderStyle=new de;var n=new Ot;n.readJson(t.legend_group),this.renderStyle.setLegendGroup(n)}if(t.sub_layer_list&&0<t.sub_layer_list.length)for(var i=t.sub_layer_list,r=i.length,o=0;o<r;o++){var s=i[o];if(s){var a=null;(a=s.class===Zn.SEGROUPLAYER?new jv:new Qn)&&(a.readJson(s,e),this.addLayer(a))}}}},toJson:function(){var t={};this.renderStyle&&this.renderStyle.getLegendGroup()&&this.renderStyle.getLegendGroup().toJson(t);var e=[];return this._layers&&0<this._layers.length&&this._layers.forEach(function(t){t&&e.push(t.toJson())}),{expand:this.expand,id:this.id,name:this.name,label:this.label,visible:this.visible,min_scale:this.minScale,max_scale:this.maxScale,legend_group:t,sub_layer_list:e}},clone:function(){return vt.clone(this)},draw:function(t,e){if(this.visible&&this.renderStyle&&this._layers&&this._layers.length)if(this.renderStyle.bDrawByLegendGroup())this._drawByMerged(t,e);else for(var n=this._layers.length-1;0<=n;n--){var i=this._layers[n];i&&i.draw(t,e)}},_drawByMerged:function(n,h){var t=this.getLayers(!0),c={};t.forEach(function(t){if(t){var e=t.getGroupFeatures(n);e&&vt.extend(c,e)}});var e=this.renderStyle.getLegendGroup(),i=e.getLegendClasses(),r=e.getLayerIndexList();r&&0!==r.length&&r.forEach(function(l){i.forEach(function(t){var e=t.getLayerIndexList();if(e){var n=e.indexOf(l);if(-1!==n){var i=t.getRenderItemId(),r=c[i];if(r){var o=r.renderItem,s=r.geometrys,a=o.getSymbol();if(!(a.getSymbolLayerCount()<=n)){var u=a.getSymbolLayer(n);u&&u.draw(h,s)}}}}})})}}),zv=G.Layer.extend({options:{pane:jn,zIndex:0},initialize:function(t){G.setOptions(this,t),this.renderer=this._createRenderer(),this._seSelections=null},_createRenderer:function(){var t=this.options.pane||jn;return new C({pane:t,zIndex:this.options.zIndex})},onAdd:function(t){t.addLayer(this.renderer)},onRemove:function(){this._map&&this._map.removeLayer(this.renderer)},setZIndex:function(t){this.options.zIndex=t,this.renderer.setZIndex(t)},addSelection:function(t){t&&(this._seSelections||(this._seSelections=[]),this._seSelections.push(t))},getSelections:function(){return this._seSelections},clearRenderer:function(){this.renderer.clear()},clear:function(){var t=this.getEditFeatureIds();t&&0<t.length&&this._map.seManager.getEditManager().clear();this._seSelections=null,this.clearRenderer()},getEditFeatureIds:function(){var t=this._map.seManager.getEditManager().getEditLayer();if(!t)return null;if(!this._seSelections||0===this._seSelections.length)return null;for(var e=0;e<this._seSelections.length;e++){var n=this._seSelections[e];if(n){var i=n.getIds();if(i&&0!==i.length&&n.getLayerId()===t.getID())return i}}return null},draw:function(){var a=this,t=this.getEditFeatureIds();t&&0<t.length&&this._map.seManager.getEditManager().setGeoIds(t);if(this.clearRenderer(),this._seSelections&&0!==this._seSelections.length)for(var u=this.renderer.ctx,l=this._map.seManager,h=this._seSelections,e=function(t){var n=h[t];if(!n||n.isNull())return"continue";var e=n.getLayerId(),i=l.getLayerById(e);if(!i||!i.dataset)return"continue";var r=i.dataset,o=r.features;if(!o||0===o.length)return"continue";var s=a._getSymbol(r.getType());o.forEach(function(t){if(t&&n.hasId(t.getID())){var e=t.toPixelGeometry(a._map);s.draw(u,[e])}})},n=h.length-1;0<=n;n--)e(n)},_getSymbol:function(t){var e=this._map.seManager.getSelectSetting().color,n=null;switch(t){case ae.POINT:n=new Ci({color:e,size:12});break;case ae.LINE:case ae.POLYGON:n=new Gi({width:3,color:e})}return n}}),Vv=A(function(t,e){function b(t,e){this.x=t||0,this.y=e||0}function n(t,e){return t==e}function g(t,e){this.UpperLeftCorner=t||new b,this.LowerRightCorner=e||new b}function u(t,e){return t*e}function w(t,e){return t<<e}function i(t,e){this.data_=null,this.pixel_bits_=8,this.bounds_=null,this.stride_=-1,this.Init(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,g.prototype={getWidth:function(){return this.LowerRightCorner&&this.UpperLeftCorner?Math.abs(this.LowerRightCorner.x-this.UpperLeftCorner.x):0},getHeight:function(){return this.LowerRightCorner&&this.UpperLeftCorner?Math.abs(this.LowerRightCorner.y-this.UpperLeftCorner.y):0},Width:function(){var t=this.getWidth();return t<0&&(t=-t),t},Height:function(){var t=this.getHeight();return t<0&&(t=-t),t},NormalizeRect:function(){this.UpperLeftCorner.x>this.LowerRightCorner.x&&this.SwapLeftRight(),this.UpperLeftCorner.y>this.LowerRightCorner.y&&this.SwapTopBottom()},NormalizeGeoRect:function(){this.UpperLeftCorner.x>this.LowerRightCorner.x&&this.SwapLeftRight(),this.UpperLeftCorner.y<this.LowerRightCorner.y&&this.SwapTopBottom()},SwapLeftRight:function(){var t=this.UpperLeftCorner.x;this.UpperLeftCorner.x=this.LowerRightCorner.x,this.LowerRightCorner.x=t},SwapTopBottom:function(){var t=this.UpperLeftCorner.y;this.UpperLeftCorner.y=this.LowerRightCorner.y,this.LowerRightCorner.y=t},IntersectRect:function(t,e){return t.IsIntersect(e)?(this.UpperLeftCorner.x=Math.max(t.UpperLeftCorner.x,e.UpperLeftCorner.x),this.LowerRightCorner.x=Math.min(t.LowerRightCorner.x,e.LowerRightCorner.x),this.UpperLeftCorner.y=Math.max(t.UpperLeftCorner.y,e.UpperLeftCorner.y),this.LowerRightCorner.y=Math.min(t.LowerRightCorner.y,e.LowerRightCorner.y),!0):(this.SetNULL(),!1)},SetNULL:function(){this.UpperLeftCorner.x=this.UpperLeftCorner.y=0,this.LowerRightCorner.x=this.LowerRightCorner.y=0},IsIntersect:function(t){var e;return t.UpperLeftCorner.y>=t.LowerRightCorner.y&&this.UpperLeftCorner.y>=this.LowerRightCorner.y?(this.LowerRightCorner.x>=t.UpperLeftCorner.x||n(this.LowerRightCorner.x-t.UpperLeftCorner.x))&&(this.UpperLeftCorner.x<=t.LowerRightCorner.x||n(this.UpperLeftCorner.x-t.LowerRightCorner.x))&&(this.LowerRightCorner.y<=t.UpperLeftCorner.y||n(this.LowerRightCorner.y-t.UpperLeftCorner.y))&&(this.UpperLeftCorner.y>=t.LowerRightCorner.y||n(this.UpperLeftCorner.y-t.LowerRightCorner.y)):t.UpperLeftCorner.y<=t.LowerRightCorner.y&&this.UpperLeftCorner.y<=this.LowerRightCorner.y?(this.LowerRightCorner.x>=t.UpperLeftCorner.x||n(this.LowerRightCorner.x-t.UpperLeftCorner.x))&&(this.UpperLeftCorner.x<=t.LowerRightCorner.x||n(this.UpperLeftCorner.x-t.LowerRightCorner.x))&&(this.LowerRightCorner.y>=t.UpperLeftCorner.y||n(this.LowerRightCorner.y-t.UpperLeftCorner.y))&&(this.UpperLeftCorner.y<=t.LowerRightCorner.y||n(this.UpperLeftCorner.y-t.LowerRightCorner.y)):(this.UpperLeftCorner.y<=this.LowerRightCorner.y?(e=t).NormalizeRect():(e=t).NormalizeGeoRect(),this.IsIntersect(e))}},i.prototype={Release:function(){return this.data_&&(this.data_=null),!0},Copy:function(t){this.data_&&(this.data_=null),this.bounds_=t.bounds_,this.pixel_bits_=t.pixel_bits_,this.stride_=t.stride_;this.bounds_.Width(),this.bounds_.Height();var e=this.ComputeAllocSize(this.pixel_bits_,this.bounds_);this.data_=new Int8Array(e);for(var n=t.data_.byteLength<e?t.data_.byteLength:e,i=0;i<n;i++)this.data_[i]=t.data_[i]},Init:function(t,e){var n=new g(new b(0,0),new b(t,e));if(n.NormalizeRect(),this.data_){if(this.bounds_==n)return Reset(),!0;this.data_=null}this.bounds_=n;var i=this.ComputeAllocSize(this.pixel_bits_,this.bounds_);return this.data_=new Int8Array(i),!0},Reset:function(){if(this.data_){var t=this.ComputeAllocSize(this.pixel_bits_,this.bounds_);this.data_=new Int8Array(t)}},IsValid:function(){return!!this.data_},ComputeAllocSize:function(t,e){return this.GetWidthBytes(t,e)*e.Height()},GetWidthBytes:function(t,e){var n=e.Width(),i=e.Height();if(n<=0||i<=0)return 0;var r=0;switch(t){case 1:case 2:break;case 3:case 4:break;case 5:case 6:case 7:case 8:r=n+1}return r},GetValue:function(t,e,n){if(!this.IsValid())return-3;if(t<this.bounds_.UpperLeftCorner.x||t>=this.bounds_.LowerRightCorner.x||e<this.bounds_.UpperLeftCorner.y||e>=this.bounds_.LowerRightCorner.y)return n.avoid_edge?-3:0;this.stride_<=0&&(this.stride_=this.GetWidthBytes(this.pixel_bits_,this.bounds_));var i=n.test_mask;switch(this.pixel_bits_){case 1:case 2:break;case 3:case 4:break;case 5:case 6:case 7:case 8:var r=u(e,this.stride_)+t;return this.data_[r]&i}return-3},SetValue:function(t,e,n){if(!this.IsValid())return!1;if(t<this.bounds_.UpperLeftCorner.x||t>=this.bounds_.LowerRightCorner.x||e<this.bounds_.UpperLeftCorner.y||e>=this.bounds_.LowerRightCorner.y)return!1;this.stride_<=0&&(this.stride_=this.GetWidthBytes(this.pixel_bits_,this.bounds_));var i=n.set_mask,r=i&n.set_value,o=!1;switch(this.pixel_bits_){case 1:case 2:break;case 3:case 4:break;case 5:case 6:case 7:case 8:var s=u(e,this.stride_)+t,a=this.data_[s];this.data_[s]=a&~i|r,o=!0}return o},PlaceRect:function(t,e,n,i,r){var o=new g(new b(t,e),new b(n,i));o.NormalizeRect();var s=new g;if(s.NormalizeRect(),!s.IntersectRect(this.bounds_,o))return!1;for(var a=s.UpperLeftCorner.y;a<=s.LowerRightCorner.y;a++)this.PlaceLinesect(s.UpperLeftCorner.x-this.bounds_.UpperLeftCorner.x,a-this.bounds_.UpperLeftCorner.y,s.LowerRightCorner.x-this.bounds_.UpperLeftCorner.x,a-this.bounds_.UpperLeftCorner.y,r);return!0},PlaceLine:function(t,e,n){for(var i=0;i<e-1;i++)this.PlaceLinesect(t[i].x,t[i].y,t[i+1].x,t[i+1].y,n)},PlaceMultiLine:function(t,e,n,i){if(t&&e&&0<n)for(var r=0,o=0;o<n;o++){var s=t.slice(r,r+e[o]);this.PlaceLine(s,e[o],i),r+=e[o]}return!1},Sign:function(t){return t<0?-1:0<t?1:t},PlaceLinesect:function(t,e,n,i,r){if(t!=n||e!=i)if(e==i)for(var o=Math.min(t,n),s=Math.max(t,n),a=o;a<=s;a++)this.SetValue(a,e,r);else if(t==n)for(var u=Math.min(e,i),l=Math.max(e,i),h=u;h<=l;h++)this.SetValue(t,h,r);else{var c,p,f,d,g,y;if(a=t,h=e,c=Math.abs(n-t),p=Math.abs(i-e),d=this.Sign(n-t),g=this.Sign(i-e),c<p){var _=c;c=p,p=_,y=1}else y=0;var m=w(p,1),v=w(c,1);f=m-c;for(var b=1;b<=c;b++){for(this.SetValue(a,h,r);0<f;)1==y?a+=d:h+=g,f-=v;1==y?h+=g:a+=d,f+=m}}else this.SetValue(t,e,r)},CanPlaceLinesect:function(t,e,n,i,r){return r.entire_visble?!!this.IsLinesectAllFreeness(t,e,n,i,r):!this.IsLinesectAllForce(t,e,n,i,r)},PlacePolygon:function(t,e,n){if(!(t&&2<e))return!1;function i(){this.ymax=0,this.x=0,this.dx=0,this.pNext=null}var r=0,o=0,s=0,a=0,u=0,l=null,h=null;for((l=new i).pNext=null,a=u=t[0].y,r=1;r<e;r++)t[r].y<a?a=t[r].y:t[r].y>u&&(u=t[r].y);if(u<=a)return l&&(l=null),!1;for(h=new Array(u-a+1),r=0;r<=u-a;r++)h[r]=new i,h[r].pNext=null;for(r=0;r<e;r++)if(o=(r+1)%e,t[r].y!=t[o].y){var c,p;for(c=new i,s=t[r].y>t[o].y?r:o,c.ymax=t[s].y,s=s==o?r:o,c.x=t[s].x,t[r].y!=t[o].y&&(c.dx=(t[r].x-t[o].x)/(t[r].y-t[o].y)),c.pNext=null,p=h[t[s].y-a];p.pNext;)p=p.pNext;p.pNext=c}for(r=a;r<=u;r++)if(!(r<this.bounds_.UpperLeftCorner.x||r>this.bounds_.LowerRightCorner.y)){var f=h[r-a].pNext,d=h[r-a];if(f){for(;d.pNext;)d=d.pNext;d.pNext=l.pNext,l.pNext=f}for(f=l;f.pNext;){for(var g=f,y=(d=f,null);d.pNext;)d.pNext.x>g.pNext.x&&(g=d),d=d.pNext;y=g.pNext,g.pNext=y.pNext,y.pNext=l.pNext,l.pNext=y,f==l&&(f=y)}for(f=l;f.pNext&&f.pNext.pNext;){var _=new b,m=new b;_.x=Math.floor(f.pNext.x),_.y=r,_.x<this.bounds_.UpperLeftCorner.x&&(_.x=this.bounds_.UpperLeftCorner.x),_.x>this.bounds_.LowerRightCorner.x&&(_.x=this.bounds_.LowerRightCorner.x),m.x=Math.floor(f.pNext.pNext.x),m.y=r,m.x<this.bounds_.UpperLeftCorner.x&&(m.x=this.bounds_.UpperLeftCorner.x),m.x>this.bounds_.LowerRightCorner.x&&(m.x=this.bounds_.LowerRightCorner.x),this.bounds_.LowerRightCorner.y<this.bounds_.UpperLeftCorner.y?_.y<=this.bounds_.UpperLeftCorner.y&&_.y>=this.bounds_.LowerRightCorner.y&&this.PlaceLinesect(_.x,_.y,m.x,m.y,n):_.y>=this.bounds_.UpperLeftCorner.y&&_.y<=this.bounds_.LowerRightCorner.y&&this.PlaceLinesect(_.x,_.y,m.x,m.y,n),f=f.pNext.pNext}for(f=l;f.pNext;)f.pNext.ymax<r+2?(d=f.pNext,f.pNext=f.pNext.pNext,d=null):(f.pNext.x+=f.pNext.dx,f=f.pNext)}for(r=0;r<=u-a;r++)h[r]&&(h[r]=null);return l&&(l=null),h&&(h=null),!0},CanPlacePolygon:function(t,e,n){if(!(t&&2<e))return!1;function i(){this.ymax=0,this.x=0,this.dx=0,this.pNext=null}var r=0,o=0,s=0,a=0,u=0,l=null,h=null;for((l=new i).pNext=null,a=u=t[0].y,r=1;r<e;r++)t[r].y<a?a=t[r].y:t[r].y>u&&(u=t[r].y);if((a<this.bounds_.UpperLeftCorner.y||u>this.bounds_.LowerRightCorner.y)&&n.entire_visble)return!1;if(u<=a)return l&&(l=null),!1;try{h=new Array(u-a+1)}catch(t){return!1}for(r=0;r<=u-a;r++)h[r]=new i,h[r].pNext=null;for(r=0;r<e;r++)if(o=(r+1)%e,t[r].y!=t[o].y){var c,p;for(c=new i,s=t[r].y>t[o].y?r:o,c.ymax=t[s].y,s=s==o?r:o,c.x=t[s].x,t[r].y!=t[o].y&&(c.dx=(t[r].x-t[o].x)/(t[r].y-t[o].y)),c.pNext=null,p=h[t[s].y-a];p.pNext;)p=p.pNext;p.pNext=c}for(r=a;r<=u;r++){var f=h[r-a].pNext,d=h[r-a];if(f){for(;d.pNext;)d=d.pNext;d.pNext=l.pNext,l.pNext=f}for(f=l;f.pNext;){for(var g=f,y=(d=f,null);d.pNext;)d.pNext.x>g.pNext.x&&(g=d),d=d.pNext;y=g.pNext,g.pNext=y.pNext,y.pNext=l.pNext,l.pNext=y,f==l&&(f=y)}for(f=l;f.pNext&&f.pNext.pNext;){var _=new b,m=new b;if(_.x=Math.floor(f.pNext.x),_.y=r,_.x<this.bounds_.UpperLeftCorner.x){if(n.entire_visble)return!1;_.x=this.bounds_.UpperLeftCorner.x}if(_.x>this.bounds_.LowerRightCorner.x){if(n.entire_visble)return!1;_.x=this.bounds_.LowerRightCorner.x}if(m.x=Math.floor(f.pNext.pNext.x),m.y=r,m.x<this.bounds_.UpperLeftCorner.x){if(n.entire_visble)return!1;m.x=this.bounds_.UpperLeftCorner.x}if(m.x>this.bounds_.LowerRightCorner.x){if(n.entire_visble)return!1;m.x=this.bounds_.LowerRightCorner.x}if(this.bounds_.LowerRightCorner.y<this.bounds_.UpperLeftCorner.y){if(_.y<=this.bounds_.UpperLeftCorner.y&&_.y>=this.bounds_.LowerRightCorner.y){var v=this.CanPlaceLinesect(_.x,_.y,m.x,m.y,n);if(n.entire_visble){if(!v)return!1}else if(v)return!0}}else if(_.y>=this.bounds_.UpperLeftCorner.y&&_.y<=this.bounds_.LowerRightCorner.y){v=this.CanPlaceLinesect(_.x,_.y,m.x,m.y,n);if(n.entire_visble){if(!v)return!1}else if(v)return!0}f=f.pNext.pNext}for(f=l;f.pNext;)f.pNext.ymax<r+2?(d=f.pNext,f.pNext=f.pNext.pNext,d=null):(f.pNext.x+=f.pNext.dx,f=f.pNext)}for(r=0;r<=u-a;r++)h[r]&&(h[r]=null);return l&&(l=null),h&&(h=null),!!n.entire_visble},IsLinesectAllForce:function(t,e,n,i,r){var o=0;if(t==n&&e==i)return 0<(o=this.GetValue(t,e,r));var s=!1;if(r.avoid_edge&&(s=!0),e==i)for(var a=Math.min(t,n),u=Math.max(t,n),l=a;l<=u;l++)if(o=this.GetValue(l,e,r),r.avoid_edge){if(o<=0)return!1}else{if(0==o)return!1;0<o&&(s=!0)}else if(t==n)for(var h=Math.min(e,i),c=Math.max(e,i),p=h;p<=c;p++)if(o=this.GetValue(t,p,r),r.avoid_edge){if(o<=0)return!1}else{if(0==o)return!1;0<o&&(s=!0)}else{var f,d,g,y,_,m;if(l=t,p=e,f=Math.abs(n-t),d=Math.abs(i-e),y=this.Sign(n-t),_=this.Sign(i-e),f<d){var v=f;f=d,d=v,m=1}else m=0;var b=w(d,1),x=w(f,1);g=b-f;for(var E=1;E<=f;E++){if(o=this.GetValue(l,p,r),r.avoid_edge){if(o<=0)return!1}else{if(0==o)return!1;0<o&&(s=!0)}for(;0<g;)1==m?l+=y:p+=_,g-=x;1==m?p+=_:l+=y,g+=b}}return s},IsLinesectAllFreeness:function(t,e,n,i,r){if(t==n&&e==i)return 0==this.GetValue(t,e,r);var o=!1;r.avoid_edge&&(o=!0);var s=0;if(e==i)for(var a=Math.min(t,n),u=Math.max(t,n),l=a;l<=u;l++)if(s=this.GetValue(l,e,r),r.avoid_edge){if(0!=s)return!1}else{if(0<s)return!1;0==s&&(o=!0)}else if(t==n)for(var h=Math.min(e,i),c=Math.max(e,i),p=h;p<=c;p++)if(s=this.GetValue(t,p,r),r.avoid_edge){if(0!=s)return!1}else{if(0<s)return!1;0==s&&(o=!0)}else{var f,d,g,y,_,m;if(l=t,p=e,f=Math.abs(n-t),d=Math.abs(i-e),y=this.Sign(n-t),_=this.Sign(i-e),f<d){var v=f;f=d,d=v,m=1}else m=0;var b=w(d,1),x=w(f,1);g=b-f;for(var E=1;E<=f;E++){if(s=this.GetValue(l,p,r),r.avoid_edge){if(0!=s)return!1}else{if(0<s)return!1;0==s&&(o=!0)}for(;0<g;)1==m?l+=y:p+=_,g-=x;1==m?p+=_:l+=y,g+=b}}return o},CanPlaceRect:function(t,e,n,i,r){var o=new g(new b(t,e),new b(n,i));if(o.NormalizeRect(),!this.bounds_.IsIntersect(o))return!1;for(var s=o,a=Math.min(this.bounds_.UpperLeftCorner.x,this.bounds_.LowerRightCorner.x),u=Math.min(this.bounds_.UpperLeftCorner.y,this.bounds_.LowerRightCorner.y),l=Math.min(s.UpperLeftCorner.x,s.LowerRightCorner.x),h=Math.max(s.UpperLeftCorner.x,s.LowerRightCorner.x),c=Math.min(s.UpperLeftCorner.y,s.LowerRightCorner.y),p=Math.max(s.UpperLeftCorner.y,s.LowerRightCorner.y),f=c;f<=p;f++){var d=this.CanPlaceLinesect(l-a,f-u,h-a,f-u,r);if(r.entire_visble){if(!d)return!1}else if(d)return!0}return!!r.entire_visble},CanPlaceLine:function(t,e,n){for(var i=0;i<e-1;i++){var r=t[i],o=t[i+1],s=this.CanPlaceLinesect(r.x,r.y,o.x,o.y,n);if(n.entire_visble){if(!s)return!1}else if(s)return!0}return!!n.entire_visble},CanPlaceMultiLine:function(t,e,n,i){if(t&&e&&0<n)for(var r=0,o=0;o<n;o++){var s=t.slice(r,r+e[o]),a=CanPlaceLine(s,e[o],i);if(i.entire_visble){if(!a)return!1}else if(a)return!0;r+=e[o]}return!!i.entire_visble}};var r=i;e.default=r}),Yv=(Fv=Vv)&&Fv.__esModule&&Object.prototype.hasOwnProperty.call(Fv,"default")?Fv.default:Fv,Hv=function(){function n(t,e){h(this,n),this.m_pModel=null,this.m_nViewWidth=t,this.m_nViewHeight=e}return c(n,[{key:"getModel",value:function(){return this.m_pModel||(this.m_pModel=new Yv(this.m_nViewWidth,this.m_nViewHeight)),this.m_pModel}},{key:"releaseAllModel",value:function(){this.m_pModel&&(this.m_pModel=null)}},{key:"releaseModel",value:function(t){t&&(t=null)}},{key:"canPlacePoint",value:function(t,e,n){var i=Math.round(e.x>>1),r=Math.round(e.y>>1);return this.getModel().CanPlaceRect(t.x-i,t.y-r,t.x+i,t.y+r,n)}},{key:"placePoint",value:function(t,e,n){var i=Math.round(e.x>>1),r=Math.round(e.y>>1);return this.getModel().PlaceRect(t.x-i,t.y-r,t.x+i,t.y+r,n),!0}},{key:"canPlaceRect",value:function(t,e,n){return this.getModel().CanPlaceRect(t.x,t.y,e.x,e.y,n)}},{key:"placeRect",value:function(t,e,n){return this.getModel().PlaceRect(t.x,t.y,e.x,e.y,n),!0}},{key:"canPlacePolygon",value:function(t,e){if(!t||0===t.length)return!1;var n=t.length;return this.getModel().CanPlacePolygon(t,n,e)}},{key:"placePolygon",value:function(t,e){var n=t.length;return this.getModel().PlacePolygon(t,n,e),!0}},{key:"placeLine",value:function(t,e,n,i){return this.getModel().PlaceMultiLine(t,e,n,i),!0}}]),n}(),Xv=function(){function n(t,e){h(this,n),this._topLeft=t||new G.Point(0,0),this._bottomRight=e||new G.Point(0,0)}return c(n,[{key:"getWidth",value:function(){return this._bottomRight.x-this._topLeft.x}},{key:"getHeight",value:function(){return this._bottomRight.y-this._topLeft.y}},{key:"getMaxX",value:function(){return this._bottomRight.x}},{key:"setRect",value:function(t,e,n,i){this._topLeft.x=t,this._topLeft.y=e,this._bottomRight.x=n,this._bottomRight.y=i}}]),n}(),Wv=function(){function n(t){h(this,n),this._ctx=document.createElement("canvas").getContext("2d");var e=t.getFontStr();this._ctx.font=e}return c(n,[{key:"getTextWidth",value:function(t){return this._ctx.measureText(t).width}}]),n}();function Jv(t,e,n,i,r){if(void 0===i&&(i=!0),!t)return!1;for(var o=0,s=0,a=n.getFontInfo().getSize(),u=t.length,l=0;l<u;l++){var h=t[l],c=!(" "!==h),p=r.getTextWidth(h);i?(o+=p+n.getInterval(),s=a,c&&(o+=n.getWordInterval())):(s+=(o=a)+n.getInterval(),c&&(s+=n.getWordInterval()))}return e.setRect(0,0,o,s),!0}function Kv(t,e,n,i,r,o){if(r.isWrap()){var s=function(t,e,n,i){var r=!1;/^[\u3220-\uFA29]+$/.test(t)&&(r=!0);var o=t+e,s=[];if(e)for(var a=new RegExp(e),u=o.indexOf(e);-1!==u;)s.push(u),u=(o=o.replace(a)).indexOf(e);else{if(!r)return[t];for(var l=0;l<o.length;l++)(l+1)%n==0&&s.push(l+1);s.push(o.length)}var h=[],c=o.length;if(s.length<=i){for(var p=0,f=0;f<s.length;f++){var d=o.substr(p,s[f]-p);p=s[f],d&&h.push(d)}return h}var g=0;g=n*i<c?c/i:n;for(var y=0,_=0;_<s.length;_++){if(h.length===i-1){var m=o.substr(y);m&&h.push(m);break}if(s[_]===c){if(g<c-y){var v=s[0<_?_-1:0],b=o.substr(y,v-y);b&&h.push(b);var x=o.substr(v,s[_]-v);x&&h.push(x)}else{var E=o.substr(y,s[_]-y);E&&h.push(E)}break}if(s[_]-y>g){var w=o.substr(y,s[0<_?_-1:0]-y);w&&h.push(w),y=s[0<_?_-1:0]}else if(s[_]-y===g){var I=o.substr(y,s[_]-y);I&&h.push(I),y=s[_]}}return h}(t,r.getWrapChar(),r.getWordCountPerLine(),r.getMaxLineCount());s&&0<s.length&&s.forEach(function(t){e.push(t)})}else{var a=t,u=r.getWrapChar();if(u){var l=new RegExp(u,"g");a=a.replace(l,"")}e.push(a)}for(var h=e.length,c=0,p=0,f=h-1,d=0;d<h;d++){var g=new Xv;Jv(e[d],g,r,!0,o),i.push(g),c=c>g.getMaxX()?c:g.getWidth(),p+=g.getHeight(),0<f&&(p+=d===f?r.getLineSpacing():0)}return n.setRect(0,0,c,p),!0}function Zv(t){if(!t||t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var i=t[n],r=t[n+1];e+=Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2))}return e}function Qv(t,e,n){n||(n={});var i,r,o=n.dPos||0,s=n.pos||0,a=n.di||0;if(!a||o+a<e)for(var u=s;u<t.length-1;u++){var l=t[u],h=t[u+1];if(i=l,r=h,e<o+(a=Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2))))break;s++,o+=a}var c=void 0,p=void 0,f=e-o;s>=t.length-1&&(s=t.length-2);var d=t[s],g=t[s+1];p=f?(c=d.x+(g.x-d.x)*f/a,d.y+(g.y-d.y)*f/a):(c=d.x,d.y);var y=Math.atan2(g.y-d.y,g.x-d.x);return n.dPos=o,n.pos=s,n.di=a,{x:c,y:p,angle:y}}function $v(t){var e=Zv(t);return 0===e?null:Qv(t,e/2)}var tb={ptAnchor:null,ptPoints:null,ptCount:null,nCount:0,angle:0,rotatePoint:null,xStep:0,yStep:0,bHori:!0,wText:"",wordInterval:0},eb=function(){function e(t){h(this,e),this.options=vt.extend({},tb,t)}return c(e,[{key:"getAnchor",value:function(){return this.options.ptAnchor}},{key:"getPoints",value:function(){return this.options.ptPoints}},{key:"getAngle",value:function(){return this.options.angle}},{key:"getStepX",value:function(){return this.options.xStep}},{key:"getStepY",value:function(){return this.options.yStep}},{key:"isHori",value:function(){return this.options.bHori}},{key:"getText",value:function(){return this.options.wText}},{key:"getWordInterval",value:function(){return this.options.wordInterval}},{key:"getRotatePoint",value:function(){return this.options.rotatePoint}}]),e}(),nb=function(){function n(t,e){h(this,n),this.symbol=t,this.position=e,this._measureTextTool=new Wv(this.symbol.getTextInfo().getFontInfo())}return c(n,[{key:"addPointLabel",value:function(t){var e=!1,n=this.position.getPositionType();switch(n){case Be:e=this.handlerAroundPoint(t);break;case Ue:e=this.handlerOnPointTop(t);break;case je:case qe:var i=0;if(n===je){var r=t.properties,o=this.position.getAngleField().toLowerCase();r&&o&&r[o]&&(i=parseFloat(r[o]))}else if(n===qe){i=this.position.getSpecifiedAngle()||0}e=this.handlerAnglePoint(i,t)}return e}},{key:"_addPosition",value:function(t){for(var e=t.vText,n=t.vBox,i=t.ptText,r=t.ptPoints,o=t.pALabelPositions,s=t.rotatePoint,a=t.angle,u=this.symbol.getTextInfo(),l=e.length,h=i.x,c=i.y-u.getLineSpacing()*(l-1)-n[0].getHeight()*l,p=0;p<l;p++){c+=n[p].getHeight(),0<p&&(c+=u.getLineSpacing());var f={ptAnchor:new G.Point(h,c),xStep:u.getInterval(),bHori:!0,wText:e[p],wordInterval:u.getWordInterval(),rotatePoint:s,angle:a};0===p&&r&&(f.ptPoints=r);var d=new eb(f);o.addPosition(d,this.symbol)}}},{key:"handlerAroundPoint",value:function(t){var e=t.text,n=t.avoidHandler,i=t.coverCondition,r=t.pALabelPositions,o=t.pPoint,s=t.size+4,a=this.symbol.getTextInfo(),u=o.x,l=o.y,h=!1,c=s/2,p=[],f=new Xv,d=[];Kv(e,p,f,d,a,this._measureTextTool);var g=c;g+=this.position.getAroundOffset();var y=f.getWidth(),_=f.getHeight(),m=this.symbol.validFillSymbol();m&&(y+=a.getLeftMargin()+a.getRightMargin(),_+=a.getTopMargin()+a.getBottomMargin());for(var v=u-g+a.getOffsetX(),b=l-g+a.getOffsetY(),x=u+g+a.getOffsetX(),E=l+g+a.getOffsetY(),w=.5*(v+x),I=.5*(b+E),L=this.position.getLabelPosList(),S=new G.Point(0,0),M=new G.Point(0,0),C=0;C<L.length;C++){switch(L[C]){case Ve:S.x=w-.5*y,S.y=b-_;break;case We:S.x=w-.5*y,S.y=E;break;case He:S.x=x,S.y=I-.5*_;break;case Ke:S.x=v-y,S.y=I-.5*_;break;case Xe:S.x=x,S.y=E;break;case ze:S.x=x,S.y=b-_;break;case Ye:S.x=v-y,S.y=b-_;break;case Je:S.x=v-y,S.y=E}if(M.x=S.x+y,M.y=S.y+_,h=n.canPlaceRect(S,M,i)){n.placeRect(S,M,i);break}}if(h){var P=null,N=null;N=m?(P=[new G.Point(S.x,S.y),new G.Point(S.x,M.y),new G.Point(M.x,M.y),new G.Point(M.x,S.y),new G.Point(S.x,S.y)],new G.Point(S.x+a.getLeftMargin(),M.y-a.getBottomMargin())):new G.Point(S.x,M.y),this._addPosition({vText:p,vBox:d,ptText:N,ptPoints:P,pALabelPositions:r,rotatePoint:null,angle:0})}return h}},{key:"handlerOnPointTop",value:function(t){var e=t.text,n=t.avoidHandler,i=t.coverCondition,r=t.pALabelPositions,o=t.pPoint,s=this.symbol.getTextInfo(),a=o.x,u=o.y;a+=s.getOffsetX(),u+=s.getOffsetY();var l,h=[],c=new Xv,p=[];Kv(e,h,c,p,s,this._measureTextTool);var f=c.getWidth(),d=c.getHeight(),g=this.symbol.validFillSymbol();g&&(f+=s.getLeftMargin()+s.getRightMargin(),d+=s.getTopMargin()+s.getBottomMargin());var y=new G.Point(a-f/2,u-d/2),_=new G.Point(a+f/2,u+d/2);if(l=n.canPlaceRect(y,_,i)){n.placeRect(y,_,i);var m=null,v=null;v=g?(m=[new G.Point(y.x,y.y),new G.Point(y.x,_.y),new G.Point(_.x,_.y),new G.Point(_.x,y.y),new G.Point(y.x,y.y)],new G.Point(y.x+s.getLeftMargin(),_.y-s.getBottomMargin())):new G.Point(y.x,_.y),this._addPosition({vText:h,vBox:p,ptText:v,ptPoints:m,pALabelPositions:r,rotatePoint:null,angle:0})}return l}},{key:"handlerAnglePoint",value:function(e,t){var n=t.text,i=t.avoidHandler,r=t.coverCondition,o=t.pALabelPositions,s=t.size+4,a=t.pPoint,u=this.symbol.getTextInfo(),l=a.x,h=a.y;l+=u.getOffsetX(),h+=u.getOffsetY();var c,p=[],f=new Xv,d=[];Kv(n,p,f,d,u,this._measureTextTool);var g=f.getWidth(),y=f.getHeight(),_=this.symbol.validFillSymbol();_&&(g+=u.getLeftMargin()+u.getRightMargin(),y+=u.getTopMargin()+u.getBottomMargin());var m=l+s/2,v=m+g,b=h-y/2,x=h+y/2,E=[new G.Point(m,b),new G.Point(m,x),new G.Point(v,x),new G.Point(v,b),new G.Point(m,b)],w=new G.Point(l,h);if(0!==e&&E.forEach(function(t){vt.rotatePoint(t,w,e*Math.PI/180)}),c=i.canPlacePolygon(E,r)){i.placePolygon(E,r);var I=null;I=_?new G.Point(m+u.getLeftMargin(),x-u.getBottomMargin()):new G.Point(m,x),this._addPosition({vText:p,vBox:d,ptText:I,ptPoints:_?E:null,pALabelPositions:o,rotatePoint:w,angle:e})}return c}}]),n}(),ib=function(){function n(t,e){h(this,n),this.symbol=t,this.position=e,this._measureTextTool=new Wv(this.symbol.getTextInfo().getFontInfo())}return c(n,[{key:"addPolygonLabel",value:function(t){var e=!1;if(this.position.getDuplicateLabels()===Re&&t.hasTextList&&-1!==t.hasTextList.indexOf(t.text))return!1;switch(this.position.getPositionType()){case sn:e=this._horiLabelHandler(t)}return e}},{key:"_addPosition",value:function(t){for(var e=t.vText,n=t.vBox,i=t.ptText,r=t.ptPoints,o=t.pALabelPositions,s=t.rotatePoint,a=t.angle,u=this.symbol.getTextInfo(),l=e.length,h=i.x,c=i.y-u.getLineSpacing()*(l-1)-n[0].getHeight()*l,p=0;p<l;p++){c+=n[p].getHeight(),0<p&&(c+=u.getLineSpacing());var f={ptAnchor:new G.Point(h,c),xStep:u.getInterval(),bHori:!0,wText:e[p],wordInterval:u.getWordInterval(),rotatePoint:s,angle:a};0===p&&r&&(f.ptPoints=r);var d=new eb(f);o.addPosition(d,this.symbol)}}},{key:"_horiLabelHandler",value:function(t){var e,n=t.geoList,i=this.toGeoJSON(n),r=t.text,o=t.avoidHandler,s=t.coverCondition,a=t.pALabelPositions,u=this.symbol.getTextInfo(),l=[],h=new Xv,c=[];Kv(r,l,h,c,u,this._measureTextTool);var p=Gv.centroid(i);if(!p)return!1;var f=p.geometry.coordinates,d=f[0],g=f[1];d+=u.getOffsetX(),g+=u.getOffsetY();var y=h.getWidth(),_=h.getHeight(),m=this.symbol.validFillSymbol();m&&(y+=u.getLeftMargin()+u.getRightMargin(),_+=u.getTopMargin()+u.getBottomMargin());var v=new G.Point(d-y/2,g-_/2),b=new G.Point(d+y/2,g+_/2),x=[new G.Point(v.x,v.y),new G.Point(v.x,b.y),new G.Point(b.x,b.y),new G.Point(b.x,v.y),new G.Point(v.x,v.y)];if(this.position.isOnlyInPolygon()){var E=this.toGeoJSON([{pPoints:x,polyCount:[x.length],subCount:1}]);if(!Gv.booleanContains(i,E))return!1}if(e=o.canPlaceRect(v,b,s)){o.placeRect(v,b,s);var w=null;w=m?new G.Point(v.x+u.getLeftMargin(),b.y-u.getBottomMargin()):new G.Point(v.x,b.y),this._addPosition({vText:l,vBox:c,ptText:w,ptPoints:x,pALabelPositions:a,rotatePoint:null,angle:0}),this.position.getDuplicateLabels()===Re&&t.hasTextList.push(r)}return e}},{key:"toGeoJSON",value:function(t){if(!t||0===t.length)return null;for(var e={type:"MultiPolygon"},n=[],i=0;i<t.length;i++){var r=t[i];if(r){var o=r.pPoints,s=r.polyCount,a=r.subCount;if(o&&!(o.length<2)&&s&&0!==s.length&&0!==a){for(var u=0,l=[],h=0;h<a;h++){for(var c=[],p=s[h],f=0;f<p;f++){var d=o[u+f];c.push([d.x,d.y])}l.push(c),u+=p}n.push(l)}}}return e.coordinates=n,{type:"Feature",geometry:e}}}]),n}(),rb=function(){function n(t,e){h(this,n),this.symbol=t,this.position=e,this._measureTextTool=new Wv(this.symbol.getTextInfo().getFontInfo())}return c(n,[{key:"addLineLabel",value:function(t){var e=!1;if(this.position.getDuplicateLabels()===Re&&t.hasTextList&&-1!==t.hasTextList.indexOf(t.text))return!1;switch(this.position.getPositionType()){case Ze:e=this._horiLineHandler(t);break;case Qe:e=this._parallelHandler(t);break;case $e:e=this._verticalHandler(t);break;case tn:e=this._alongHandler(t);break;case en:e=this._dispersionHandler(t)}return e}},{key:"_horiLineHandler",value:function(t){var e=!1,n=t.text,i=t.avoidHandler,r=t.coverCondition,o=t.pALabelPositions,s=t.ptPoints,a=t.polyCount,u=t.subCount,l=this.symbol.getTextInfo(),h=new Xv;Jv(n,h,l,!0,this._measureTextTool);for(var c=0,p=0;p<u;p++){var f=a[p],d=s.slice(c,c+f);if(c+=f,!(Zv(d)<h.getWidth())){var g=$v(d);if(g){var y=g.x,_=g.y,m=h.getWidth(),v=h.getHeight(),b=this.symbol.validFillSymbol();b&&(m+=l.getLeftMargin()+l.getRightMargin(),v+=l.getTopMargin()+l.getBottomMargin());var x=new G.Point(y-m/2,_-v/2),E=new G.Point(y+m/2,_+v/2);if(e=i.canPlaceRect(x,E,r)){i.placeRect(x,E,r);var w=null,I=null;b?(w=new G.Point(x.x+l.getLeftMargin(),E.y-l.getBottomMargin()),I=[new G.Point(x.x,x.y),new G.Point(x.x,E.y),new G.Point(E.x,E.y),new G.Point(E.x,x.y),new G.Point(x.x,x.y)]):w=new G.Point(x.x,E.y);var L={ptAnchor:w,ptPoints:I,xStep:l.getInterval(),bHori:!0,wText:n,wordInterval:l.getWordInterval()},S=new eb(L);if(o.addPosition(S,this.symbol),this.position.getDuplicateLabels()===Re)t.hasTextList.push(n);else if(this.position.getDuplicateLabels()===ke)break}}}}return e}},{key:"_verticalHandler",value:function(E){var w=this,I=!1,L=E.text,S=E.avoidHandler,M=E.coverCondition,C=E.pALabelPositions,P=E.ptPoints,N=E.polyCount,t=E.subCount,O=this.symbol.getTextInfo(),T=new Xv;Jv(L,T,O,!0,this._measureTextTool);var R=0,e=function(t){var e=N[t],n=P.slice(R,R+e);if(R+=e,Zv(n)<T.getWidth())return"continue";var i=$v(n);if(!i)return"continue";var r=i.angle;n[0].y>i.y?r+=Math.PI/2:r+=Math.PI/2*3;var o=T.getWidth(),s=T.getHeight(),a=w.symbol.validFillSymbol();a&&(o+=O.getLeftMargin()+O.getRightMargin(),s+=O.getTopMargin()+O.getBottomMargin());for(var u=null,l=null,h=null,c=null,p=w.position.getVertPosList(),f=0;f<p.length;f++){var d=p[f],g=O.getOffsetX();d===rn?g-=o/2:d===on&&(g+=o/2);var y=w._getTranslatePoint(i,g,0,r),_=y.x,m=y.y;if(u=new G.Point(_-o/2,m-s/2),l=new G.Point(_+o/2,m+s/2),h=[new G.Point(u.x,u.y),new G.Point(u.x,l.y),new G.Point(l.x,l.y),new G.Point(l.x,u.y),new G.Point(u.x,u.y)],c=new G.Point(_,m),0!==r&&h.forEach(function(t){vt.rotatePoint(t,c,r)}),I=S.canPlacePolygon(h,M))break}if(I){S.placePolygon(h,M);var v=null;a?v=new G.Point(u.x+O.getLeftMargin(),l.y-O.getBottomMargin()):(v=new G.Point(u.x,l.y),h=null);var b={ptAnchor:v,ptPoints:h,xStep:O.getInterval(),bHori:!0,angle:r/Math.PI*180,rotatePoint:c,wText:L,wordInterval:O.getWordInterval()},x=new eb(b);if(C.addPosition(x,w.symbol),w.position.getDuplicateLabels()===Re)E.hasTextList.push(L);else if(w.position.getDuplicateLabels()===ke)return"break"}};t:for(var n=0;n<t;n++){switch(e(n)){case"continue":continue;case"break":break t}}return I}},{key:"_getTranslatePoint",value:function(t,e,n,i){return{x:t.x+e*Math.cos(i)+n*Math.sin(i),y:t.y+e*Math.sin(i)-n*Math.cos(i)}}},{key:"_parallelHandler",value:function(I){var L=this,S=!1,M=I.text,C=I.avoidHandler,P=I.coverCondition,N=I.pALabelPositions,O=I.ptPoints,T=I.polyCount,t=I.subCount,R=this.symbol.getTextInfo(),e=new Xv;Jv(M,e,R,!0,this._measureTextTool);var k=e.getWidth(),D=e.getHeight(),A=this.symbol.validFillSymbol();A&&(k+=R.getLeftMargin()+R.getRightMargin(),D+=R.getTopMargin()+R.getBottomMargin());var F=0,n=function(t){var e=T[t],n=O.slice(F,F+e);F+=e;var i=Zv(n);if(i<k)return"continue";var r={dPos:0,pos:0,di:0},o=(i-k)/2,s=Qv(n,o,r),a=Qv(n,o+k,r),u=0,l={x:(s.x+a.x)/2,y:(s.y+a.y)/2};(u=Math.atan2(a.y-s.y,a.x-s.x))<0&&(u+=2*Math.PI),u>=Math.PI/2&&u<Math.PI/2*3&&(u-=Math.PI);for(var h=null,c=null,p=null,f=null,d=L.position.getVertPosList(),g=0;g<d.length;g++){var y=d[g],_=R.getOffsetY();y===rn?_+=D/2:y===on&&(_-=D/2);var m=L._getTranslatePoint(l,0,_,u),v=m.x,b=m.y;if(h=new G.Point(v-k/2,b-D/2),c=new G.Point(v+k/2,b+D/2),p=[new G.Point(h.x,h.y),new G.Point(h.x,c.y),new G.Point(c.x,c.y),new G.Point(c.x,h.y),new G.Point(h.x,h.y)],f=new G.Point(v,b),0!==u&&p.forEach(function(t){vt.rotatePoint(t,f,u)}),S=C.canPlacePolygon(p,P))break}if(S){C.placePolygon(p,P);var x=null;A?x=new G.Point(h.x+R.getLeftMargin(),c.y-R.getBottomMargin()):(x=new G.Point(h.x,c.y),p=null);var E={ptAnchor:x,ptPoints:p,xStep:R.getInterval(),bHori:!0,angle:u/Math.PI*180,rotatePoint:f,wText:M,wordInterval:R.getWordInterval()},w=new eb(E);if(N.addPosition(w,L.symbol),L.position.getDuplicateLabels()===Re)I.hasTextList.push(M);else if(L.position.getDuplicateLabels()===ke)return"break"}};t:for(var i=0;i<t;i++){switch(n(i)){case"continue":continue;case"break":break t}}return S}},{key:"_alongHandler",value:function(u){var m=this,l=!1,v=u.text,b=u.avoidHandler,x=u.coverCondition,E=u.pALabelPositions,w=u.ptPoints,I=u.polyCount,t=u.subCount,L=this.symbol.getTextInfo(),e=new Xv;Jv(v,e,L,!0,this._measureTextTool);var S=e.getWidth(),M=e.getHeight(),C=0,n=function(t){var e=I[t],n=w.slice(C,C+e);if(C+=e,Zv(n)<S)return"continue";var h=m.getAlongLetterList(v,n,S);if(!h||0===h.length)return"continue";for(var c=null,p=null,f=null,d=null,g=[],i=m.position.getVertPosList(),r=0;r<i.length;r++){var o=i[r],y=L.getOffsetY();o===rn?y+=M/2:o===on&&(y-=M/2);for(var _=!0,s=function(t){var e=h[t],n=e.letter,i=e.p,r=i.angle,o=e.letterW,s=m._getTranslatePoint(i,0,y,r),a=s.x,u=s.y;if(c=new G.Point(a-o/2,u-M/2),p=new G.Point(a+o/2,u+M/2),f=[new G.Point(c.x,c.y),new G.Point(c.x,p.y),new G.Point(p.x,p.y),new G.Point(p.x,c.y),new G.Point(c.x,c.y)],d=new G.Point(a,u),0!==r&&f.forEach(function(t){vt.rotatePoint(t,d,r)}),!b.canPlacePolygon(f,x))return _=!1,"break";var l=new G.Point(c.x,p.y);g.push({ptAnchor:l,angle:r/Math.PI*180,rotatePoint:d,wText:n,boundPoints:f})},a=0;a<h.length;a++){if("break"===s(a))break}if(_){l=!0;break}}if(l&&0<g.length)if(g.forEach(function(t){b.placePolygon(t.boundPoints,x),delete t.boundPoints;var e=new eb(t);E.addPosition(e,m.symbol)}),m.position.getDuplicateLabels()===Re)u.hasTextList.push(v);else if(m.position.getDuplicateLabels()===ke)return"break"};t:for(var i=0;i<t;i++){switch(n(i)){case"continue":continue;case"break":break t}}return l}},{key:"_dispersionHandler",value:function(u){var m=this,l=!1,v=u.text,b=u.avoidHandler,x=u.coverCondition,E=u.pALabelPositions,w=u.ptPoints,I=u.polyCount,t=u.subCount,L=this.symbol.getTextInfo(),e=new Xv;Jv(v,e,L,!0,this._measureTextTool);var S=e.getWidth(),M=e.getHeight(),C=0,n=function(t){var e=I[t],n=w.slice(C,C+e);if(C+=e,Zv(n)<S)return"continue";var h=m.getDispersionLetterList(v,n,S);if(!h||0===h.length)return"continue";for(var c=null,p=null,f=null,d=null,g=[],i=m.position.getVertPosList(),r=0;r<i.length;r++){var o=i[r],y=L.getOffsetY();o===rn?y+=M/2:o===on&&(y-=M/2);for(var _=!0,s=function(t){var e=h[t],n=e.letter,i=e.p,r=i.angle,o=e.letterW,s=m._getTranslatePoint(i,0,y,r),a=s.x,u=s.y;if(c=new G.Point(a-o/2,u-M/2),p=new G.Point(a+o/2,u+M/2),f=[new G.Point(c.x,c.y),new G.Point(c.x,p.y),new G.Point(p.x,p.y),new G.Point(p.x,c.y),new G.Point(c.x,c.y)],d=new G.Point(a,u),0!==r&&f.forEach(function(t){vt.rotatePoint(t,d,r)}),!b.canPlacePolygon(f,x))return _=!1,"break";var l=new G.Point(c.x,p.y);g.push({ptAnchor:l,angle:r/Math.PI*180,rotatePoint:d,wText:n,boundPoints:f})},a=0;a<h.length;a++){if("break"===s(a))break}if(_){l=!0;break}}if(l&&0<g.length)if(g.forEach(function(t){b.placePolygon(t.boundPoints,x),delete t.boundPoints;var e=new eb(t);E.addPosition(e,m.symbol)}),m.position.getDuplicateLabels()===Re)u.hasTextList.push(v);else if(m.position.getDuplicateLabels()===ke)return"break"};t:for(var i=0;i<t;i++){switch(n(i)){case"continue":continue;case"break":break t}}return l}},{key:"getAlongLetterList",value:function(t,e,n){var i=this.symbol.getTextInfo(),r=Zv(e);if(r<n)return null;for(var o=(t=this._reverseText(t,e)).length,s=(r-n)/2,a={dPos:0,pos:0,di:0},u=[],l=20/180*Math.PI,h=i.getInterval(),c=i.getWordInterval(),p=0;p<o;p++){var f=t[p],d=this._measureTextTool.getTextWidth(f),g=Qv(e,s+d/2,a);if(g.angle<0&&(g.angle+=2*Math.PI),g.angle>=Math.PI/2&&g.angle<Math.PI/2*3&&(g.angle-=Math.PI),0<u.length){var y=u[u.length-1].p.angle;if(Math.abs(g.angle-y)>l)return null}s+=d+h," "===f&&(s+=c),u.push({letter:f,p:g,letterW:d})}return u}},{key:"getDispersionLetterList",value:function(t,e,n){var i=Zv(e);if(i<n)return null;for(var r=(t=this._reverseText(t,e)).length,o=(i-n)/(r+1),s=o,a={dPos:0,pos:0,di:0},u=[],l=20/180*Math.PI,h=0;h<r;h++){var c=t[h],p=this._measureTextTool.getTextWidth(c),f=Qv(e,s+p/2,a);if(f.angle<0&&(f.angle+=2*Math.PI),f.angle>=Math.PI/2&&f.angle<Math.PI/2*3&&(f.angle-=Math.PI),0<u.length){var d=u[u.length-1].p.angle;if(Math.abs(f.angle-d)>l)return null}s+=p+o,u.push({letter:c,p:f,letterW:p})}return u}},{key:"_reverseText",value:function(t,e){var n=e.length,i=Math.atan2(e[n-1].y-e[0].y,e[n-1].x-e[0].x);return i<0&&(i+=2*Math.PI),i>=Math.PI/2&&i<Math.PI/2*3&&(t=t.split("").reverse().join("")),t}}]),n}(),ob={},sb=function(){function i(t,e,n){h(this,i),this.options=vt.extend({},ob,n),this._map=t,this._aLabelPositions=e,this._pCoreModel=new Hv(this._map.getSize().x,this._map.getSize().y)}return c(i,[{key:"releaseModel",value:function(){this._pCoreModel.releaseAllModel(),this._pCoreModel=null}},{key:"canPlacePoint",value:function(t,e,n){var i=this._map._getMapPanePos();return t=t.add(i).round(),e={x:e,y:e},this._pCoreModel.canPlacePoint(t,e,n)}},{key:"placePoint",value:function(t,e,n){var i=this._map._getMapPanePos();return t=t.add(i).round(),e={x:e,y:e},this._pCoreModel.placePoint(t,e,n),!0}},{key:"canPlaceRect",value:function(t,e,n){var i=this._map._getMapPanePos();return t=t.add(i).round(),e=e.add(i).round(),this._pCoreModel.canPlaceRect(t,e,n)}},{key:"placeRect",value:function(t,e,n){var i=this._map._getMapPanePos();return t=t.add(i).round(),e=e.add(i).round(),this._pCoreModel.placeRect(t,e,n),!0}},{key:"canPlacePolygon",value:function(t,e){var n=this._map._getMapPanePos(),i=[];return t.forEach(function(t){i.push(t.add(n).round())}),this._pCoreModel.canPlacePolygon(i,e)}},{key:"placePolygon",value:function(t,e){var n=this._map._getMapPanePos(),i=[];return t.forEach(function(t){i.push(t.add(n).round())}),this._pCoreModel.placePolygon(i,e),!0}},{key:"avoid",value:function(t){var e=this;t&&0!==t.length&&t.forEach(function(t){t&&t.dataset&&t.dataset.features&&0!==t.dataset.features.length&&(t.dataset.getType()===ae.POINT?e._pointAvoidHandler(t):e._labelAvoidHandler(t))})}},{key:"_labelAvoidHandler",value:function(t){var a=this,u=t.dataset,e=u.features;if(e&&0!==e.length){var n=t.getRenderTextStyle();if(n.isQuery()){n.isSortByPriority()&&this._sortByPriority(n.getPriorityField(),e);var l=[],h=new pe({test_mask:n.getAvoidFlag(),set_mask:he,set_value:he});e.forEach(function(o){var s=o.getProperties();if(!n.isIgnore(s)){var t=n.getRenderItemList();t&&0!==t.length&&t.forEach(function(t){if(t.compareFilter(s)){var e=t.getText(s);if(""!==e&&null!==e){var n=null;if(u.getType()===ae.LINE)(n=new rb(t.getTextSymbol(),t.getLabelPosition())).addLineLabel({ptPoints:o.getPixelPoints(a._map),polyCount:o.getPolyCount(),subCount:o.getSubCount(),text:e,avoidHandler:a,coverCondition:h,pALabelPositions:a._aLabelPositions,hasTextList:l});else if(u.getType()===ae.POLYGON){n=new ib(t.getTextSymbol(),t.getLabelPosition());var i=null;o.getType()===xt.POLYGON?i=[o]:o.getType()===xt.MULTIPOLYGON&&(i=o.getPolygons());var r=[];i.forEach(function(t){r.push({pPoints:t.getPixelPoints(a._map),polyCount:t.getPolyCount(),subCount:t.getSubCount()})}),n.addPolygonLabel({geoList:r,text:e,avoidHandler:a,coverCondition:h,pALabelPositions:a._aLabelPositions,hasTextList:l})}}}})}})}}}},{key:"_pointAvoidHandler",value:function(t){var e=t.dataset.features;if(e&&0!==e.length){var n=t.getRenderTextStyle(),i=n.isQuery(),r=n.isRelate();i&&n.isSortByPriority()&&this._sortByPriority(n.getPriorityField(),e),i&&r?this._labelRelatePointHandler(t):this._pointAvoid(t)}}},{key:"_labelRelatePointHandler",value:function(t){var r=this,e=t.dataset,n=e.features,o=t.getRenderTextStyle();if(o.isQuery()){var s=[],a=new pe({test_mask:le|he,set_mask:le,set_value:le}),u=new pe({test_mask:le|he,set_mask:he,set_value:he});n.forEach(function(t){if(t){var e=t.splitToSingle();e&&0!==e.length&&e.forEach(function(t){if(t){var e=t.getSymbol();if(e){var n=t.getSize();if(e.isVisible()&&n){var i=t.getPixelPoints(r._map);if(i&&0!==i.length)if(r.canPlacePoint(i[0],n,a))r._pointFeatureLabelAvoid(o,t,u)&&(r.placePoint(i[0],n,a),s.push(t))}else s.push(t)}}})}}),e.features=s}}},{key:"_pointAvoid",value:function(t){var r=this,e=t.dataset,n=e.features,i=t.renderStyle.getAvoidFlag(),o=t.getRenderTextStyle(),s=o.isQuery();if(i!==ue){var a=[],u=new pe({test_mask:le,set_mask:le,set_value:le});n.forEach(function(t){if(t){var e=t.splitToSingle();e&&0!==e.length&&e.forEach(function(t){if(t){var e=t.getSymbol();if(e){var n=t.getSize();if(e.isVisible()&&n){var i=t.getPixelPoints(r._map);if(i&&0!==i.length)r.canPlacePoint(i[0],n,u)&&(r.placePoint(i[0],n,u),a.push(t))}else a.push(t)}}})}}),n=e.features=a}if(s){var l=new pe({test_mask:o.getAvoidFlag(),set_mask:he,set_value:he});n.forEach(function(t){if(t){var e=t.splitToSingle();e&&0!==e.length&&e.forEach(function(t){r._pointFeatureLabelAvoid(o,t,l)})}})}}},{key:"_pointFeatureLabelAvoid",value:function(t,i,r){var o=this,s=!1,a=i.getProperties();if(t.isIgnore(a))return s;var e=t.getRenderItemList();return!(!e||0===e.length)&&(e.forEach(function(t){if(!t.compareFilter(a))return!1;var e=t.getText(a);if(""===e||null===e)return!1;var n=new nb(t.getTextSymbol(),t.getLabelPosition());return s=n.addPointLabel({pPoint:i.getPixelPoints(o._map)[0],size:i.getSize(),properties:a,text:e,avoidHandler:o,coverCondition:r,pALabelPositions:o._aLabelPositions})}),s)}},{key:"_sortByPriority",value:function(t,e){}}]),i}(),ab=function(){function t(){h(this,t),this._aLabelPosionList=null}return c(t,[{key:"addPosition",value:function(t,e){if(t&&e){this._aLabelPosionList||(this._aLabelPosionList={});var n=e.getID();this._aLabelPosionList[n]||(this._aLabelPosionList[n]={labels:[],labelSymbol:e}),this._aLabelPosionList[n].labels.push(t)}}},{key:"clear",value:function(){this._aLabelPosionList=null}},{key:"drawLabels",value:function(t){this._aLabelPosionList&&0!==Object.keys(this._aLabelPosionList).length&&(this._drawBackground(t),this._drawText(t))}},{key:"_drawBackground",value:function(s){var a=this,t=function(t){var e=a._aLabelPosionList[t];if(!e||!e.labelSymbol||!e.labels||0===e.labels.length)return"continue";var n=e.labelSymbol,i=e.labels;if(!n.validFillSymbol())return"continue";var r=n.getFillSymbol(),o=[];i.forEach(function(t){if(t){var e=t.getPoints();if(e&&0!==e.length){var n=new _t({points:e,polyCount:[e.length],subCount:1});o.push(n)}}}),0<o.length&&r.draw(s,o)};for(var e in this._aLabelPosionList)t(e)}},{key:"_drawText",value:function(g){var a=this,t=function(t){var e=a._aLabelPosionList[t];if(!e||!e.labelSymbol||!e.labels||0===e.labels.length)return"continue";var n=e.labelSymbol,i=n.getTextInfo(),r=i.getFontInfo(),f=r.getSize(),o=r.getFontStr(),s=i.getHalo(),d=s.hasHalo();g.fillStyle=n.getColor().getStrColor(),g.font=o,d&&(g.strokeStyle=s.getColor().getStrColor(),g.lineWidth=s.getSize()),e.labels.forEach(function(t){if(t){var e=t.getText();if(e){var n=t.getAngle(),i=t.getRotatePoint(),r=t.getAnchor();0===n&&(i={x:r.x,y:r.y});var o=t.isHori();g.save(),g.translate(i.x,i.y),g.rotate(n*Math.PI/180);for(var s=r.x-i.x,a=r.y-i.y,u=t.getStepX(),l=t.getStepY(),h=t.getWordInterval(),c=0;c<e.length;c++){var p=e[c];if(g.fillText(p,s,a),d&&g.strokeText(p,s,a),o)s+=g.measureText(p).width+u," "===p&&(s+=h);else a+=f+l," "===p&&(a+=h)}g.restore()}}})};for(var e in this._aLabelPosionList)t(e)}}]),t}(),ub=G.Layer.extend({options:{pane:"tilePane",zIndex:0},initialize:function(t){G.setOptions(this,t),this.renderer=this._createRenderer(),this._seSelectionLayer=new zv({zIndex:this.options.zIndex}),this._aLabelPositions=null,this.id=-1,this._name="新地图",this._bounds=null,this._projInfo=null,this._dataType=1,this._isPublic=!1,this._userId=0,this._layers=null,this.visible=!0},setVisible:function(t){this.visible=t,this.update()},getVisible:function(){return this.visible},setIsPublic:function(t){this._isPublic=t},isPublic:function(){return this._isPublic},getID:function(){return this.id},getName:function(){return this._name},setName:function(t){this._name=t},isNew:function(){return-1===this.id},onAdd:function(t){t.addLayer(this.renderer),t.addLayer(this._seSelectionLayer),this.update()},onRemove:function(){this._map&&(this._map.removeLayer(this.renderer),this._map.removeLayer(this._seSelectionLayer))},_createRenderer:function(){var t=this.options.pane||qn;return new C({pane:t,zIndex:this.options.zIndex})},addLayer:function(t,e){if(t&&t.dataset)if(this._layers||(this._layers=[]),e)this._layers.unshift(t);else{var n=this._getInsertIndex(t.dataset.getType());this._layers.splice(n,0,t)}},removeLayer:function(t){var e=this.getLayerById(t);if(!e)return!1;var n=this.getLayerById(e.getParentLayerId());if(n)n.removeLayer(e);else{var i=this._layers.indexOf(e);this._layers.splice(i,1)}return!0},_getInsertIndex:function(t){if(!this._layers||0===this._layers.length)return 0;for(var e=this._layers.length,n=0;n<e;n++){var i=this._layers[n];if(i.getType()!==Zn.SEGROUPLAYER)if(i.dataset.type>=t)return n}return e},getLayers:function(t){if(!this._layers)return null;if(!t)return this._layers;for(var e=this._layers.length,n=[],i=0;i<e;i++){var r=this._layers[i];if(r)if(r.getType()===Zn.SEGROUPLAYER){var o=r.getLayers(!0);o&&o.length&&o.forEach(function(t){n.push(t)})}else n.push(r)}return n},getContainer:function(){return this.renderer._divContainer},getRenderer:function(){return this.renderer},setZIndex:function(t){this.options.zIndex=t,this.renderer.setZIndex(t),this._seSelectionLayer.setZIndex(t)},getZIndex:function(){return this.options.zIndex},getBounds:function(){var t=this._bounds;return t||(t=this.getMaxBounds()),t},getLatLngBounds:function(){var t=this.getBounds();return t?t.toLatLngBounds(this._projInfo):null},getMaxBounds:function(){var t=this.getLayers(!0);if(!t||0===t.length)return null;var n=null;return t.forEach(function(t){if(t&&t.getDataset()){var e=t.getDataset();n?n.add(e.getBounds()):n=e.getBounds()}}),n},readJson:function(t){if(t){if(t.bbox&&(this._bounds=new mt,this._bounds.readJson(t.bbox)),t.crs){var e=new Xn;e.readJson(t.crs),this._projInfo=e}if(this.id=t.data_id,this._dataType=t.data_type||1,this._name=t.name?t.name:"",this._isPublic=1===t.public,this._userId=t.user_id?t.user_id:0,t.style){var n=JSON.parse(t.style).layer_list;if(n&&n.length){this._layers=[];for(var i=n,r=i.length,o=0;o<r;o++){var s=i[o];if(s){var a=null,u=s.class;u===Zn.SEGROUPLAYER?a=new jv:u===Zn.SELAYER&&(a=new Qn),a&&(a.readJson(s,t.dataset_list),this._layers.push(a))}}}}}},toJson:function(){var t=this._map.getBounds(),e=mt.createFromLatLngBounds(t),n={name:this.getName(),public:this.isPublic()?1:0,crsid:"EPSG:4326",bbox:e.toJson(),style:"",thumbnail:""};if(this._layers&&0<this._layers.length){var i=this.getLayers(!0),r=null,o=[];if(i.forEach(function(t){if(t&&t.dataset){var e=t.dataset;r||(r=e.projInfo),-1===o.indexOf(e.id)&&o.push(e.id)}}),r){var s=mt.createFromLatLngBounds(t,r);n.bbox=s.toJson(),n.crsid=r.getCode()}var a=this._createStyleJson();n.dataset_list=o,n.style=JSON.stringify(a),n.thumbnail=this._createThumbnail()}return n},_createThumbnail:function(){var t=document.createElement("canvas");t.width=200,t.height=150;var e=t.getContext("2d"),n=this.renderer.getContainer();return e.drawImage(n,0,0,200,150),t.toDataURL()},_createStyleJson:function(){var e=[];return this._layers.forEach(function(t){t&&e.push(t.toJson())}),{layer_list:e,version:$.styleVersion}},getEvents:function(){return{moveend:this.update,viewreset:this.update}},refresh:function(){this.update()},update:function(){if(!this.visible)return this._clearDtData(),this.clearRenderer(),void this.clearSelection();this.timeOut&&clearTimeout(this.timeOut),this.timeOut=setTimeout(G.bind(this.requestData,this),50)},clearRenderer:function(){this.renderer.clear()},_clearDtData:function(){var t=this.getLayers(!0);t&&t.length&&t.forEach(function(t){t.clearData()})},requestData:function(){var e=this;if(this.fire("requestDataEnd"),this.requests&&0<this.requests.length)for(var t=0;t<this.requests.length;t++)this.requests[t].abort();if(this._clearDtData(),this.requests=[],this.promiseList=[],this._layers&&0!==this._layers.length){for(var n=this._map.getSize(),i=this._map.getBounds(),r=n.x/(i.getEast()-i.getWest()),o=this._layers.length,s=[],a=this._map.getScale(),u=0;u<o;u++){var l=this._layers[u];l&&l.getRequestObj(s,a)}if(0!==s.length){var h=20/r,c=i.getWest()-h,p=i.getSouth()-h,f=i.getEast()+h,d=i.getNorth()+h;c<-180&&(c=-180),p<-85&&(p=-85),180<f&&(f=180),85<d&&(d=85),this._map.fire("requestDataStart");var g={query_define:{type:at.BOUNDS,bbox:{min_x:c,min_y:p,max_x:f,max_y:d}},dataset_list:s,view_bbox:{min_x:0,min_y:0,max_x:n.x,max_y:n.y}},y=ut({data:g,success:function(t){e._firstRequestResult(t,y,g)},error:function(){e.requestError(y)}});this.requests.push(y)}else this.clearRenderer()}else this.clearRenderer()},requestError:function(t){if(this.requests){var e=this.requests.indexOf(t);-1<e&&this.requests.splice(e,1)}},_firstRequestResult:function(t,e,n){var i=this._updateData(t,e,!0);if(i&&i.maxCount){var r=i.maxCount,o=i.packs;this._sendSubPacks(o,r,n)}else this._updateDataEnd()},_sendSubPacks:function(t,e,n){var i=this;if(t&&e){for(var r=[],o=0;o<e;o++){for(var s=t.length,a=[],u=0;u<s;u++){var l=t[u],h=l.subPacks;if(h&&!(h.length<=o)){var c={dataset_id:l.dataset_id,dataset_ver:l.dataset_ver,layer_id:l.layer_id,field_list:l.field_list,feature_ids:h[o],sub_pack_index:o+1};a.push(c)}}n.layer_list=a;var p=this._createRequestPromise(n);r.push(p)}var f=(new Date).getTime()+"_"+Math.random();this.promiseList||(this.promiseList=[]),this.promiseList.push(f),Promise.all(r).then(function(){i.promiseList&&-1!==i.promiseList.indexOf(f)&&i._updateDataEnd()}).catch(function(t){throw new Error(t)})}},_createRequestPromise:function(i){var r=this;return new Promise(function(e,t){var n=ut({data:i,success:function(t){r._updateData(t,n,!1),e()},error:function(){t()}});r.requests.push(n)})},_updateDataEnd:function(){this._mergeFeatures(),this._avoid(),this.draw(),this.fire("requestDataEnd")},_mergeFeatures:function(){var t=this.getLayers(!0);t&&t.length&&t.forEach(function(t){t&&t.dataset&&t.dataset.mergeFeatures()})},_getRequestLayers:function(){var t=this.getLayers(!0);if(!t||!t.length)return null;var e=[];return t.forEach(function(t){t&&t.dataset&&t.visible&&(t.dataset.hasFeatureData()&&e.push(t))}),e},_sortByPriority:function(t){t&&0!==t.length&&t.sort(function(t,e){var n=t.renderTextStyle.getLabelWeight();return e.renderTextStyle.getLabelWeight()-n})},_updateData:function(t,e,n){var i=this.requests.indexOf(e);if(-1<i&&this.requests.splice(i,1),t.status!==rt.SUCCESS)throw new Error("render error:"+t.message);var r=t.result;if(!r||!r.dataset_list||0===r.dataset_list.length)return null;for(var o=r.dataset_list,s=o.length,a=[],u=0,l=0;l<s;l++){var h=o[l];if(h){var c=this.getLayerById(h.layer_id);if(c&&c.dataset)if(n&&c.clearData(),h.result_status){var p=this._getLayerSubPacks(h);p&&(a.push(p),u=u>=p.count?u:p.count)}else c.updateData(h)}}return n?{packs:a,maxCount:u}:null},_getLayerSubPacks:function(t){if(!t)return null;var e=t.feature_id_list,n=t.max_feature_count;if(!e||0===e.length||!n)return null;for(var i=e.length,r=Math.ceil(i/n),o=0,s=[],a=0;a<r;a++){var u=o+n;i<=u&&(u=i);var l=e.slice(o,u);s.push(l),o=u}return{dataset_id:t.dataset_id,dataset_ver:t.dataset_ver,layer_id:t.layer_id,field_list:t.field_list,subPacks:s,count:r}},getLayerById:function(s){var t=function t(e){if(!e||0===e.length)return null;for(var n=e.length,i=0;i<n;i++){var r=e[i];if(r){if(r.id===s)return r;if(r.getType()===Zn.SEGROUPLAYER){var o=t(r.getLayers());if(o)return o}}}return null};return t(this._layers)},_avoid:function(){this._aLabelPositions||(this._aLabelPositions=new ab),this._aLabelPositions.clear();var t=this._getRequestLayers();if(t&&0!==t.length){this._sortByPriority(t);var e=new sb(this._map,this._aLabelPositions);e.avoid(t),e.releaseModel()}},draw:function(){this.clearRenderer();var t=this.renderer.ctx,e=this._layers;if(e&&0!==e.length){for(var n=e.length-1;0<=n;n--){var i=e[n];i&&i.visible&&i.draw(this._map,t)}this._drawLabels(),this.drawSelection()}},addSelection:function(t){this._seSelectionLayer.addSelection(t)},getSelections:function(){return this._seSelectionLayer.getSelections()},clearSelection:function(){this._seSelectionLayer.clear()},drawSelection:function(){this._seSelectionLayer.draw()},_drawLabels:function(){if(this._aLabelPositions){var t=this.renderer.ctx;this._aLabelPositions.drawLabels(t)}},changeLayerOrder:function(t){var i=this;if(t&&0!==t.length){!function n(t){t&&0!==t.length&&t.forEach(function(t){if(t){var e=i.getLayerById(t.layerId);e&&(t.layer=e),e.getType()===Zn.SEGROUPLAYER&&e.setLayers(null),t.subLayers&&0<t.subLayers.length&&n(t.subLayers)}})}(t),this._layers=[],t.forEach(function(t){if(t&&t.layer){var e=t.layer;i.addLayer(e),e.getType()===Zn.SEGROUPLAYER&&t.subLayers&&0<t.subLayers.length&&i._createSubLayers(e,t.subLayers)}})}},_createSubLayers:function(n,t){var i=this;n&&t&&0!==t.length&&t.forEach(function(t){if(t&&t.layer){var e=t.layer;n.addLayer(e),e.getType()===Zn.SEGROUPLAYER&&t.subLayers&&0<t.subLayers.length&&i._createSubLayers(e,t.subLayers)}})},createGroupLayer:function(t,e){e=e||"新建图层组";var n=new jv;if(n.setName(e),t){var i=this.getLayerById(t);if(!i)return!1;i.addLayer(n,!0)}else this.addLayer(n,!0);return!0},zoomToLayer:function(t){var e=this.getLayerById(t);if(!e||!e.getDataset()||e.getType()!==Zn.SELAYER)return!1;var n=e.getDataset(),i=n.getBounds().toLatLngBounds(n.getProjInfo());return i&&this._map.fitBounds(i),!0},getEditFeatureIds:function(){return this._seSelectionLayer.getEditFeatureIds()},getLayersByDtId:function(e){var t=this.getLayers(!0);if(!t||0===t.length)return null;var n=[];return t.forEach(function(t){t&&t.getDataset()&&(t.getDataset().getID()===e&&n.push(t))}),n}}),lb=G.Layer.extend({options:{pane:Vn,zIndex:10,delay:400},initialize:function(t){G.setOptions(this,t),this.renderer=this._createRenderer(),this._features=null},_createRenderer:function(){var t=this.options.pane||Vn;return new C({pane:t,zIndex:this.options.zIndex})},onAdd:function(t){t.addLayer(this.renderer)},onRemove:function(){this._map&&this._map.removeLayer(this.renderer)},setZIndex:function(t){this.options.zIndex=t,this.renderer.setZIndex(t)},setFeatures:function(t){var e=this;this._features=t,this._draw(),setTimeout(function(){e.clear()},this.options.delay)},clearRenderer:function(){this.renderer.clear()},clear:function(){this._features=null,this.clearRenderer()},_draw:function(){var i=this;if(this.clearRenderer(),this._map&&this._features&&0!==this._features.length){var r=this.renderer.ctx;this._features.forEach(function(t){if(t){var e=i._getSymbol(t.getType()),n=t.toPixelGeometry(i._map,!0);e.draw(r,[n])}})}},_getSymbol:function(t){var e=this._map.seManager.getSelectSetting().highlightColor,n=null;switch(t){case xt.POINT:n=new Ci({color:e,size:12});break;case xt.LINE:n=new Gi({color:e,width:4});break;case xt.POLYGON:case xt.MULTIPOLYGON:n=new Hi({color:e})}return n}}),hb={},cb=function(t){function i(t){h(this,i);var e=y(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.mergeOptions(hb,t),e.class=Ft,e.isMultiLayer=!0,e.symbols=null,e}return d(i,wi),c(i,[{key:"readJson",value:function(t){var n=this;(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"readJson",this).call(this,t),t.symbol_layer_list&&0<t.symbol_layer_list.length)&&t.symbol_layer_list.forEach(function(t){var e=re.readFromJson(t);e&&(n.symbols||(n.symbols=[]),n.symbols.push(e))})}},{key:"toJson",value:function(t){if(t)if(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJson",this).call(this,t),this.symbols&&0<this.symbols.length){var n=[];this.symbols.forEach(function(t){if(t){var e={};t.toJson(e),n.push(e)}}),t.symbol_layer_list=n}else t.symbol_layer_list=null}},{key:"getSize",value:function(){if(!this.symbols||0===this.symbols.length)return 0;var n=0;return this.symbols.forEach(function(t){var e=t.getSize();n<e&&(n=e)}),n}},{key:"setSize",value:function(t){if(this.symbols&&0!==this.symbols.length&&!(t<=0)){var e=this.getSize();if(0!==e){var n=t/e;this.symbols.forEach(function(t){t.setSize(t.getSize()*n),t.setOffsetX(t.getOffsetX()*n),t.setOffsetY(t.getOffsetY()*n)})}}}},{key:"setAngle",value:function(t){var e=this;if(this.symbols&&0!==this.symbols.length){var n=t-this.getAngle();this.symbols.forEach(function(t){t.setAngle(e.getAngle()+n)}),this.options.angle=t}}},{key:"setColor",value:function(e){this.symbols&&0!==this.symbols.length&&(this.symbols.forEach(function(t){t&&!t.isLocked()&&t.setColor(e)}),f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setColor",this).call(this,e))}},{key:"getSymbols",value:function(){return this.symbols}},{key:"setSymbols",value:function(t){this.symbols=t}},{key:"getSymbolLayer",value:function(t){return t<0||!this.symbols||this.symbols.length<=t?null:this.symbols[t]}},{key:"getSymbolLayerCount",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols.length:0}},{key:"draw",value:function(e,n){e&&n&&n.length&&this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.draw(e,n)})}},{key:"drawPoint",value:function(e,n){e&&n&&this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.drawPoint(e,n)})}}]),i}(),pb={},fb=function(t){function i(t){h(this,i);var e=y(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.mergeOptions(pb,t),e.class=Wt,e.symbols=null,e}return d(i,ji),c(i,[{key:"readJson",value:function(t){var n=this;(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"readJson",this).call(this,t),t.symbol_layer_list&&0<t.symbol_layer_list.length)&&t.symbol_layer_list.forEach(function(t){var e=re.readFromJson(t);e&&(n.symbols||(n.symbols=[]),n.symbols.push(e))})}},{key:"toJson",value:function(t){if(t)if(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJson",this).call(this,t),this.symbols&&0<this.symbols.length){var n=[];this.symbols.forEach(function(t){if(t){var e={};t.toJson(e),n.push(e)}}),t.symbol_layer_list=n}else t.symbol_layer_list=null}},{key:"setColor",value:function(e){this.symbols&&0!==this.symbols.length&&(this.symbols.forEach(function(t){t&&!t.isLocked()&&t.setColor(e)}),f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setColor",this).call(this,e))}},{key:"setOutlineWidth",value:function(t){this.symbols&&0!==this.symbols.length&&(this.symbols[this.symbols.length-1].setOutlineWidth(t),f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setOutlineWidth",this).call(this,t))}},{key:"getOutlineWidth",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols[this.symbols.length-1].getOutlineWidth():null}},{key:"setOutlineColor",value:function(t){this.symbols&&0!==this.symbols.length&&(this.symbols[this.symbols.length-1].setOutlineColor(t),f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setOutlineColor",this).call(this,t))}},{key:"getOutlineColor",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols[this.symbols.length-1].getOutlineColor():null}},{key:"getSymbols",value:function(){return this.symbols}},{key:"getSymbolLayer",value:function(t){return t<0||!this.symbols||this.symbols.length<=t?null:this.symbols[t]}},{key:"getSymbolLayerCount",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols.length:0}},{key:"draw",value:function(e,n){e&&n&&n.length&&this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.draw(e,n)})}},{key:"drawPolygon",value:function(e,n){!e||!n||n.length<3||this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.drawPolygon(e,n)})}}]),i}(),db="round",gb="linear",yb="square",_b={colorList:[new ne(255,0,0),new ne(0,255,0),new ne(0,0,255),new ne(255,255,0)],angle:0,interval:5,percent:1,colorBandIndex:-1,fillStyle:gb},mb=function(t){function r(t){h(this,r);var e=y(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.mergeOptions(_b,t),e.class=Vt,e}return d(r,Vi),c(r,[{key:"readJson",value:function(t){if(f(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"readJson",this).call(this,t),this.options.angle=t.angle,this.options.interval=t.interval,this.options.percent=t.percent,this.options.fillStyle=t.style,t.tape_style){var e=t.tape_style;this.options.colorBandIndex=e.color_band_index;var n=e.color,i=[];n&&n.length&&n.forEach(function(t){i.push(ne.createFromArray(t))}),this.options.colorList=i}}},{key:"toJson",value:function(t){if(t){f(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"toJson",this).call(this,t),t.angle=this.options.angle,t.interval=this.options.interval,t.percent=this.options.percent,t.style=this.options.fillStyle;var e={};if(e.color_band_index=this.options.colorBandIndex,this.options.colorList&&this.options.colorList.length){var n=[];this.options.colorList.forEach(function(t){n.push(t.toArray())}),e.color=n}else e.color=null;t.tape_style=e}}},{key:"getColorList",value:function(){return this.options.colorList}},{key:"setColorList",value:function(t){this.options.colorList=t}},{key:"getAngle",value:function(){return this.options.angle}},{key:"setAngle",value:function(t){this.options.angle=t}},{key:"getInterval",value:function(){return this.options.interval}},{key:"setInterval",value:function(t){this.options.interval=t}},{key:"getPercent",value:function(){return this.options.percent}},{key:"setPercent",value:function(t){this.options.percent=t}},{key:"getColorBandIndex",value:function(){return this.options.colorBandIndex}},{key:"setColorBandIndex",value:function(t){this.options.colorBandIndex=t}},{key:"getFillStyle",value:function(){return this.options.fillStyle}},{key:"setFillStyle",value:function(t){this.options.fillStyle=t}},{key:"_drawGeometry",value:function(t,e){if(t&&e&&this.isVisible()){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){for(var o=0,s=this.getFillStyle(),a=0;a<i;a++){t.save(),t.beginPath();var u=r[a],l=n.slice(o,o+u);o+=u,Si.drawPath(t,l),t.clip(),s===db?this._drawRoundGradient(t,l):s===gb?this._drawLinearGradient(t,l):s===yb&&this._drawSquareGradient(t,l),t.restore()}this._fill(t);var h=this.getOutlineSymbol();this.hasOutline()&&h&&h.draw(t,[e])}}}},{key:"_drawRoundGradient",value:function(t,e){var n=this.getPercent();(!n||n<=0||1<n)&&(n=1);var i=this.getColorList();if(i&&0!==i.length){var r=i.length,o=gt.getPolygonBox(e);if(o&&4===o.length)for(var s=o[2]-o[0],a=o[3]-o[1],u={x:(o[0]+o[2])/2,y:(o[1]+o[3])/2},l=Math.sqrt(s*s+a*a),h=l*n/r*.5,c=0;c<r;c++){t.beginPath();var p=i[c];t.fillStyle=p;var f=.5*l-h*c;t.arc(u.x,u.y,f,0,2*Math.PI),t.fill()}}}},{key:"_drawLinearGradient",value:function(t,e){var n=this.getPercent();(!n||n<=0||1<n)&&(n=1);var i=-1*this.angle,r=this.getColorList();if(r&&0!==r.length){var o=r.length,s=gt.getPolygonBox(e);if(s&&4===s.length)for(var a=s[2]-s[0],u=s[3]-s[1],l={x:(s[0]+s[2])/2,y:(s[1]+s[3])/2},h=Math.abs(u*Math.cos(i/180*Math.PI))+Math.abs(a*Math.sin(i/180*Math.PI)),c=Math.abs(u*Math.sin(i/180*Math.PI))+Math.abs(a*Math.cos(i/180*Math.PI)),p=c*n/o,f=0;f<o;f++){t.save(),t.beginPath();var d=r[f];t.fillStyle=d,t.translate(l.x,l.y),t.rotate(i/180*Math.PI);var g=c-p*f,y=h;t.fillRect(c/2*-1,h/2*-1,g,y),t.restore()}}}},{key:"_drawSquareGradient",value:function(t,e){var n=this.getPercent();(!n||n<=0||1<n)&&(n=1);var i=-1*this.angle,r=this.getColorList();if(r&&0!==r.length){var o=r.length,s=gt.getPolygonBox(e);if(s&&4===s.length)for(var a=s[2]-s[0],u=s[3]-s[1],l={x:(s[0]+s[2])/2,y:(s[1]+s[3])/2},h=Math.abs(u*Math.cos(i/180*Math.PI))+Math.abs(a*Math.sin(i/180*Math.PI)),c=Math.abs(u*Math.sin(i/180*Math.PI))+Math.abs(a*Math.cos(i/180*Math.PI)),p=c*n/o*.5,f=h*n/o*.5,d=0;d<o;d++){t.save(),t.beginPath();var g=r[d];t.fillStyle=g,t.translate(l.x,l.y),t.rotate(i/180*Math.PI);var y=c-p*d*2,_=h-f*d*2;t.fillRect(y/2*-1,_/2*-1,y,_),t.restore()}}}}]),r}(),vb={arrowWidth:10,arrowLength:20},bb=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(vb,t),e.class=At,e}return d(n,Li),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.arrowWidth=gt.poundToPixel(t.width),this.options.arrowLength=gt.poundToPixel(t.length)}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.width=gt.pixelToPound(this.options.arrowWidth),t.length=gt.pixelToPound(this.options.arrowLength))}},{key:"getArrowWidth",value:function(){return this.options.arrowWidth}},{key:"setArrowWidth",value:function(t){this.options.arrowWidth=t}},{key:"getArrowLength",value:function(){return this.options.arrowLength}},{key:"setArrowLength",value:function(t){this.options.arrowLength=t}},{key:"setSize",value:function(t){var e=0;0!==this.options.arrowLength&&(e=this.options.arrowWidth/this.options.arrowLength),this.options.arrowWidth>this.options.arrowLength?(this.options.arrowWidth=t,e||(this.options.arrowLength=this.options.arrowWidth/e)):(this.options.arrowLength=t,this.options.arrowWidth=this.options.arrowLength*e)}},{key:"drawPoint",value:function(t,e){if(t&&e&&this.isVisible()){var n=this.getSize(),i=this.getAngle(),r=this.getOffsetX(),o=this.getOffsetY(),s=this.getArrowLength(),a=this.getArrowWidth();e.x+=r,e.y+=o,Si.drawArrow(t,e,n,i,s,a);var u=this.getHalo();u&&u.hasHalo()&&this._drawHalo(t),t.fillStyle=this.getColor().getStrColor(),t.fill()}}}]),n}(),xb="flip_start",Eb="flip_end",wb="flip_both",Ib="mid",Lb="no_flip",Sb={markerSymbol:null,symbolCount:0,isFixedRotation:!1,flipStyle:Lb,isFirstRotation:!1,isAllRotation:!1},Mb=function(){function e(t){h(this,e),this.options=gt.extend({},Sb,t)}return c(e,[{key:"readJson",value:function(t){this.options.symbolCount=t.symbol_count,this.options.isFixedRotation=t.fixed_rotation,this.options.flipStyle=t.flip_style,this.options.isFirstRotation=t.is_first_rotation,this.options.isAllRotation=t.is_all_rotation,t.symbol&&(this.options.markerSymbol=re.readFromJson(t.symbol))}},{key:"toJson",value:function(t){if(t)if(t.symbol_count=this.options.symbolCount,t.fixed_rotation=this.options.isFixedRotation,t.flip_style=this.options.flipStyle,t.is_first_rotation=this.options.isFirstRotation,t.is_all_rotation=this.options.isAllRotation,this.options.markerSymbol){var e={};this.options.markerSymbol.toJson(e),t.symbol=e}else t.symbol=null}},{key:"getMarkerSymbol",value:function(){return this.options.markerSymbol}},{key:"setMarkerSymbol",value:function(t){this.options.markerSymbol=t}},{key:"getFlipStyle",value:function(){return this.options.fillStyle}},{key:"setFlipStyle",value:function(t){this.options.flipStyle=t}},{key:"isFirstRotation",value:function(){return this.options.isFirstRotation}},{key:"setIsFirstRotation",value:function(t){this.options.isFirstRotation=t}},{key:"isAllRotation",value:function(){return this.options.isAllRotation}},{key:"setIsAllRotation",value:function(t){this.options.isAllRotation=t}},{key:"enable",value:function(){return!(this.options.flipStyle===Lb||!this.options.markerSymbol)}}]),e}();function Cb(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}function Pb(t,e){if(t&&!(t.length<1))for(var n=1,i=t.length;n<i;n++)e(t[n-1],t[n])}function Nb(t,e){if(t.x===e.x)return t.y===e.y?null:{x:t.x};var n=(e.y-t.y)/(e.x-t.x);return{a:n,b:t.y-n*t.x}}function Ob(t,e,n){return{x:t.x+e*Math.cos(n),y:t.y+e*Math.sin(n)}}var Tb={offsetPointLine:function(t,i){var r=[];return Pb(t,Cb(function(t,e){if(t.x!==e.x||t.y!==e.y){var n=Math.atan2(t.y-e.y,t.x-e.x)-Math.PI/2;r.push({offsetAngle:n,original:[t,e],offset:[Ob(t,i,n),Ob(e,i,n)]})}},this)),r},offsetPoints:function(t,e){var n=this.offsetPointLine(t,e);return this.joinLineSegments(n,e)},joinSegments:function(t,e,n){return this.circularArc(t,e,n).filter(function(t){return t})},joinLineSegments:function(t,n){var i=[],e=t[0],r=t[t.length-1];return e&&r&&(i.push(e.offset[0]),Pb(t,Cb(function(t,e){i=i.concat(this.joinSegments(t,e,n))},this)),i.push(r.offset[1])),i},segmentAsVector:function(t){return{x:t[1].x-t[0].x,y:t[1].y-t[0].y}},getSignedAngle:function(t,e){var n=this.segmentAsVector(t),i=this.segmentAsVector(e);return Math.atan2(n.x*i.y-n.y*i.x,n.x*i.x+n.y*i.y)},circularArc:function(t,e,n){if(t.offsetAngle===e.offsetAngle)return[t.offset[1]];var i=this.getSignedAngle(t.offset,e.offset);if(0<i*n&&0<i*this.getSignedAngle(t.offset,[t.offset[0],e.offset[1]]))return[function(t,e,n,i){var r=Nb(t,e),o=Nb(n,i);if(null===r||null===o)return null;if(r.hasOwnProperty("x"))return o.hasOwnProperty("x")?null:{x:r.x,y:o.a*r.x+o.b};if(o.hasOwnProperty("x"))return{x:o.x,y:r.a*o.x+r.b};if(r.a===o.a)return null;var s=(o.b-r.b)/(r.a-o.a);return{x:s,y:r.a*s+r.b}}(t.offset[0],t.offset[1],e.offset[0],e.offset[1])];var r=[],o=t.original[1],s=0<n,a=s?e.offsetAngle:t.offsetAngle,u=s?t.offsetAngle:e.offsetAngle;u<a&&(u+=2*Math.PI);for(var l=Math.PI/8,h=a;h<u;h+=l)r.push(Ob(o,n,h));return r.push(Ob(o,n,u)),s?r.reverse():r}},Rb={lineCap:"butt",lineJoin:"bevel",dashArray:[1,0],interval:1,indent:6,lineDecoration:null,offset:0},kb=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Rb,t),e.class=Bt,e}return d(n,Ti),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.lineCap=t.cartoline_cap,this.options.lineJoin=t.cartoline_join,this.options.dashArray=t.carto_array,this.options.interval=t.interval,this.options.indent=gt.poundToPixel(t.indent),this.options.offset=gt.poundToPixel(t.offset),t.decoration&&(this.options.lineDecoration=new Mb,this.options.lineDecoration.readJson(t.decoration))}},{key:"toJson",value:function(t){if(t)if(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.cartoline_cap=this.options.lineCap,t.cartoline_join=this.options.lineJoin,t.carto_array=this.options.dashArray,t.interval=this.options.interval,t.indent=gt.pixelToPound(this.options.indent),t.offset=gt.pixelToPound(this.options.offset),this.options.lineDecoration){var e={};this.options.lineDecoration.toJson(e),t.decoration=e}else t.decoration=null}},{key:"getLineCap",value:function(){return this.options.lineCap}},{key:"setLineCap",value:function(t){this.options.lineCap=t}},{key:"getLineJoin",value:function(){return this.options.lineJoin}},{key:"setLineJoin",value:function(t){this.options.lineJoin=t}},{key:"getDashArray",value:function(){return this.options.dashArray}},{key:"setDashArray",value:function(t){this.options.dashArray=t}},{key:"getInterval",value:function(){return this.options.interval}},{key:"setInterval",value:function(t){this.options.interval=t}},{key:"getIndent",value:function(){return this.options.indent}},{key:"setIndent",value:function(t){this.options.indent=t}},{key:"getLineDecoration",value:function(){return this.options.lineDecoration}},{key:"setLineDecoration",value:function(t){this.options.lineDecoration=t}},{key:"getOffset",value:function(){return this.options.offset}},{key:"setOffset",value:function(t){this.options.offset=t}},{key:"drawLine",value:function(t,e){if(t&&e&&!(e.length<2)&&this.isVisible()){var n=this.getOffset();n&&(e=Tb.offsetPoints(e,-1*n)),Si.drawPath(t,e,!0),t.save();var i=this.getInterval(),r=this.getIndent()||0,o=this.getDashArray();if(o&&0<o.length){if(1!==(i=(i=Math.round(i))&&1<i?i:1)){var s=[];o.forEach(function(t){s.push(t*i)}),o=s}t.setLineDash(o),t.lineDashOffset=r}t.strokeStyle=this.getColor().getStrColor(),t.lineWidth=this.getWidth(),t.lineCap=this.getLineCap(),t.lineJoin=this.getLineJoin(),t.stroke(),t.restore(),this._drawLineDecoration(t,e)}}},{key:"_drawLineDecoration",value:function(t,e){var n=this.getLineDecoration();if(n&&n.enable()){this._decorationMarkerPattern||(this._decorationMarkerPattern=this._getMarkerPattern(n.getMarkerSymbol()));var i=this._decorationMarkerPattern;if(i){var r=null,o=null,s=null;switch(n.getFlipStyle()){case wb:var a=e[0].x,u=e[0].y,l=e[1].x,h=e[1].y;r={p:0,x:a,y:u,a:Math.atan2(h-u,l-a)};var c=e.length;a=e[c-2].x,u=e[c-2].y,s={p:2,x:l=e[c-1].x,y:h=e[c-1].y,a:Math.atan2(h-u,l-a)};break;case Eb:var p=e.length,f=e[p-2].x,d=e[p-2].y,g=e[p-1].x,y=e[p-1].y;s={p:2,x:g,y:y,a:Math.atan2(y-d,g-f)};break;case Ib:o={p:1,x:0,y:0,a:0},gt.getPolylineMidPoint(e,e.length,o,0),o.a=o.a*Math.PI/180,o.p=1;break;case xb:var _=e[0].x,m=e[0].y,v=e[1].x,b=e[1].y;r={p:0,x:_,y:m,a:Math.atan2(b-m,v-_)}}o&&(n.isAllRotation()&&(o.a+=Math.PI),this._drawDecorationFlip(t,o,i)),r&&this._drawDecorationFlip(t,r,i),s&&this._drawDecorationFlip(t,s,i)}}}},{key:"_drawDecorationFlip",value:function(t,e,n){var i=this.getLineDecoration(),r=i.isFirstRotation(),o=i.isAllRotation;r&&0===e.p&&(e.a+=Math.PI),o&&1!==e.p&&(e.a+=Math.PI);var s=gt.rad2Deg(e.a),a={x:e.x,y:e.y},u=n.width>n.height?n.width:n.height;Si.drawImage(t,a,u,s,n)}},{key:"_getMarkerPattern",value:function(t){if(!t)return null;var e=t.getSize();if(!(e+=4))return null;var n=document.createElement("canvas");n.width=e,n.height=e;var i=n.getContext("2d"),r={x:e/2,y:e/2};return t.drawPoint(i,r),n}}]),n}(),Db={lineSymbol:null,lineAngle:90},Ab=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Db,t),e.class=qt,e}return d(n,kb),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.lineAngle=t.angle,t.line_symbol&&(this.options.lineSymbol=re.readFromJson(t.line_symbol))}},{key:"toJson",value:function(t){if(t)if(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.angle=this.options.lineAngle,this.options.lineSymbol){var e={};this.options.lineSymbol.toJson(e),t.line_symbol=e}else t.line_symbol=null}},{key:"getLineSymbol",value:function(){return this.options.lineSymbol}},{key:"setLineSymbol",value:function(t){this.options.lineSymbol=t}},{key:"getLineAngle",value:function(){return this.options.lineAngle}},{key:"setLineAngle",value:function(t){this.options.lineAngle=t}},{key:"setColor",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setColor",this).call(this,t),this.options.lineSymbol&&this.options.lineSymbol.setColor(t)}},{key:"drawLine",value:function(t,e){if(t&&e&&!(e.length<2)&&this.isVisible()){var n=this.getOffset();n&&(e=Tb.offsetPoints(e,-1*n));var i=[],r=this.getInterval(),o=this.getIndent()||0,s=this.getDashArray();if(s&&0<s.length&&1!==(r=(r=Math.round(r))&&1<r?r:1)){var a=[];s.forEach(function(t){a.push(t*r)}),s=a}gt.getPolylineDecroPoints(i,e,e.length,s,o),0<i.length&&(this._drawLineMarkers(t,i),this._drawLineDecoration(t,e))}}},{key:"_drawLineMarkers",value:function(t,e){if(e&&0!==e.length){var n=this.getLineSymbol();if(n){this._linePattern||(this._linePattern=this._getLinePattern(n));var i=this._linePattern;if(i)for(var r=this.getLineAngle()||0,o=e.length,s=0;s<o;s++){var a=e[s],u=a.a;u+=r;var l={x:a.x,y:a.y},h=i.width>i.height?i.width:i.height;Si.drawImage(t,l,h,u,i)}}}}},{key:"_getLinePattern",value:function(t){if(!t)return null;var e=t.getWidth(),n=this.getWidth(),i=n<e?e:n,r=document.createElement("canvas");r.width=i,r.height=i;var o=r.getContext("2d"),s={x:0,y:i/2},a={x:n,y:i/2};return t.drawPath(o,[s,a]),r}}]),n}(),Fb={imageUrl:""},Gb=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Fb,t),e.class=Dt,e._bitmap=null,e}return d(n,Li),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.imageUrl=t.image_url}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.image_url=this.options.imageUrl)}},{key:"getImageUrl",value:function(){return this.options.imageUrl}},{key:"setImageUrl",value:function(t){this.options.imageUrl=t}},{key:"drawPoint",value:function(t,e){var n=this;if(t&&e&&this.isVisible())if(this._bitmap){var i=this.getSize(),r=this.getAngle(),o=this.getOffsetX(),s=this.getOffsetY();e.x+=o,e.y+=s;var a=this.getHalo();a&&a.hasHalo()&&(Si.drawSquare(t,e,i,r),this._drawHalo(t,e,i,r)),Si.drawImage(t,e,i,r,this._bitmap)}else this._tempData||(this._tempData=[]),this._tempData.push({ctx:t,p:e}),this._loading||this._loadImg().then(function(){n._tempData&&0<n._tempData.length&&n._tempData.forEach(function(t){n.drawPoint(t.ctx,t.p)})}).catch(function(){n._tempData=null})}},{key:"_loadImg",value:function(){var r=this;return this._loading=!0,new Promise(function(t,e){var n=r.getImageUrl();n||e();var i=new Image;i.onload=function(){r._bitmap=i,r._loading=!1,t()},i.onerror=function(){e()},i.src=n})}}]),n}(),Bb="normal",Ub="interval",qb="random",jb="centroid",zb={xOffset:0,yOffset:0,xInterval:20,yInterval:20,markFillType:Bb,markerSymbol:null},Vb=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(zb,t),e.class=Yt,e}return d(n,Vi),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.xOffset=gt.poundToPixel(t.offset_x),this.options.yOffset=gt.poundToPixel(t.offset_y),this.options.xInterval=gt.poundToPixel(t.interval_x),this.options.yInterval=gt.poundToPixel(t.interval_y),this.options.markFillType=t.arrange,t.marker_symbol&&(this.options.markerSymbol=re.readFromJson(t.marker_symbol))}},{key:"toJson",value:function(t){if(t)if(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.offset_x=gt.pixelToPound(this.options.xOffset),t.offset_y=gt.pixelToPound(this.options.yOffset),t.interval_x=gt.pixelToPound(this.options.xInterval),t.interval_y=gt.pixelToPound(this.options.yInterval),t.arrange=this.options.markFillType,this.options.markerSymbol){var e={};this.options.markerSymbol.toJson(e),t.marker_symbol=e}else t.marker_symbol=null}},{key:"getOffsetX",value:function(){return this.options.xOffset}},{key:"setOffsetX",value:function(t){this.options.xOffset=t}},{key:"getOffsetY",value:function(){return this.options.yOffset}},{key:"setOffsetY",value:function(t){this.options.yOffset=t}},{key:"getIntervalX",value:function(){return this.options.xInterval}},{key:"setIntervalX",value:function(t){this.options.xInterval=t}},{key:"getIntervalY",value:function(){return this.options.yInterval}},{key:"setIntervalY",value:function(t){this.options.yInterval=t}},{key:"getMarkFillType",value:function(){return this.options.markFillType}},{key:"setMarkFillType",value:function(t){this.options.markFillType=t}},{key:"getMarkerSymbol",value:function(){return this.options.markerSymbol}},{key:"setMarkerSymbol",value:function(t){this.options.markerSymbol=t}},{key:"setColor",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setColor",this).call(this,t),this.options.markerSymbol&&this.options.markerSymbol.setColor(t)}},{key:"_drawGeometry",value:function(t,e){if(t&&e&&this.isVisible()){this.getMarkFillType()===jb?this._drawCentroid(t,e):this._drawNormal(t,e);var n=this.getOutlineSymbol();this.hasOutline()&&n&&n.draw(t,[e])}}},{key:"_drawCentroid",value:function(t,e){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){var o=this.getMarkerSymbol();if(o)for(var s=0,a=0;a<i;a++){var u=r[a],l=n.slice(s,s+u),h=gt.getCenter(l);s+=u,o.drawPoint(t,h)}}}},{key:"_drawNormal",value:function(t,e){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){var o=0;t.beginPath();for(var s=null,a=0;a<i;a++){var u=r[a],l=n.slice(o,o+u);Si.drawPath(t,l),o+=u,s||(s=l[0])}this._fillNormal(t,s)}}},{key:"_fillNormal",value:function(t,e){var n=this.getOffsetX(),i=this.getOffsetY(),r=null,o=this.getMarkFillType();o===Bb?r=this._getNormalFillPattern():o===Ub?r=this._getIntervalFillPattern():o===qb&&(r=this._getRandomFillPattern()),r&&(t.save(),r=t.createPattern(r,"repeat"),t.fillStyle=r,t.translate(e.x-n,e.y-i),t.fill("evenodd"),t.setTransform(1,0,0,1,0,0),t.restore())}},{key:"_getNormalFillPattern",value:function(){if(this._fillPattern)return this._fillPattern;var t=this.getMarkerSymbol();if(!t)return null;var e=t.getSize(),n=this.getIntervalX(),i=this.getIntervalY(),r=document.createElement("canvas"),o=n,s=i;r.width=o,r.height=s;var a=r.getContext("2d"),u={x:e/2,y:e/2};return t.drawPoint(a,u),this._fillPattern=r}},{key:"_getIntervalFillPattern",value:function(){if(this._fillPattern)return this._fillPattern;var t=this.getMarkerSymbol();if(!t)return null;var e=t.getSize(),n=this.getIntervalX(),i=this.getIntervalY(),r=document.createElement("canvas"),o=2*e+2*n,s=2*e+2*i;r.width=o,r.height=s;var a=r.getContext("2d"),u={x:e/2,y:e/2},l={x:u.x+e+n/2,y:u.y+e+i},h=new _t({points:[u,{x:u.x+e+n,y:u.y},l,{x:l.x+e+n,y:l.y}],polyCount:[1,1,1,1],subCount:4});return t.draw(a,[h]),this._fillPattern=r}},{key:"_getRandomFillPattern",value:function(){var t=this.getMarkerSymbol();if(!t)return null;var e=t.getSize(),n=this.getIntervalX(),i=this.getIntervalY(),r=document.createElement("canvas"),o=2*e+2*n,s=2*e+2*i;r.width=o,r.height=s;var a=r.getContext("2d"),u=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},l={x:u(e/2,o/2-e/2),y:u(e/2,s/2-e/2)},h={x:u(o/2+e/2,o-e/2),y:u(e/2,s/2-e/2)},c={x:u(e/2,o/2-e/2),y:u(s/2+e/2,s-e/2)},p={x:u(o/2+e/2,o-e/2),y:u(s/2+e/2,s-e/2)},f=new _t({points:[l,h,c,p],polyCount:[1,1,1,1],subCount:4});return t.draw(a,[f]),r}}]),n}(),Yb={markerSymbol:null},Hb=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Yb,t),e.class=Ut,e}return d(n,kb),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),t.marker_symbol&&(this.options.markerSymbol=re.readFromJson(t.marker_symbol))}},{key:"toJson",value:function(t){if(t)if(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),this.options.markerSymbol){var e={};this.options.markerSymbol.toJson(e),t.marker_symbol=e}else t.marker_symbol=null}},{key:"getMarkerSymbol",value:function(){return this.options.markerSymbol}},{key:"setMarkerSymbol",value:function(t){this.options.markerSymbol=t}},{key:"setColor",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setColor",this).call(this,t),this.options.markerSymbol&&this.options.markerSymbol.setColor(t)}},{key:"setWidth",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setWidth",this).call(this,t),this.options.markerSymbol&&this.options.markerSymbol.setSize(t)}},{key:"drawLine",value:function(t,e){if(t&&e&&!(e.length<2)&&this.isVisible()){var n=this.getOffset();n&&(e=Tb.offsetPoints(e,-1*n));var i=[],r=this.getInterval(),o=this.getIndent()||0,s=this.getDashArray();if(s&&0<s.length&&1!==(r=(r=Math.round(r))&&1<r?r:1)){var a=[];s.forEach(function(t){a.push(t*r)}),s=a}gt.getPolylineDecroPoints(i,e,e.length,s,o),0<i.length&&(this._drawMarkers(t,i),this._drawLineDecoration(t,e))}}},{key:"_drawMarkers",value:function(t,e){if(e&&0!==e.length){var n=this.getMarkerSymbol();if(n){this._markerPattern||(this._markerPattern=this._getMarkerPattern(n));var i=this._markerPattern;if(i)for(var r=e.length,o=0;o<r;o++){var s=e[o],a=s.a,u={x:s.x,y:s.y},l=i.width>i.height?i.width:i.height;Si.drawImage(t,u,l,a,i)}}}}}]),n}(),Xb={},Wb=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Xb,t),e}return d(n,Li),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t)}},{key:"toJson",value:function(t){t&&f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t)}}]),n}(),Jb=A(function(t,e){t.exports=function o(s,a,u){function l(n,t){if(!a[n]){if(!s[n]){var e=D;if(!t&&e)return e(n,!0);if(h)return h(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=a[n]={exports:{}};s[n][0].call(r.exports,function(t){var e=s[n][1][t];return l(e||t)},r,r.exports,o,s,a,u)}return a[n].exports}for(var h=D,t=0;t<u.length;t++)l(u[t]);return l}({1:[function(t,e,n){var u=0,o=-3;function i(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function s(t,e){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new i,this.dtree=new i}var a=new i,l=new i,h=new Uint8Array(30),c=new Uint16Array(30),p=new Uint8Array(30),f=new Uint16Array(30),d=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),g=new i,y=new Uint8Array(320);function r(t,e,n,i){var r,o;for(r=0;r<n;++r)t[r]=0;for(r=0;r<30-n;++r)t[r+n]=r/n|0;for(o=i,r=0;r<30;++r)e[r]=o,o+=1<<t[r]}var _=new Uint16Array(16);function m(t,e,n,i){var r,o;for(r=0;r<16;++r)t.table[r]=0;for(r=0;r<i;++r)t.table[e[n+r]]++;for(t.table[0]=0,r=o=0;r<16;++r)_[r]=o,o+=t.table[r];for(r=0;r<i;++r)e[n+r]&&(t.trans[_[e[n+r]]++]=r)}function v(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=1&t.tag;return t.tag>>>=1,e}function b(t,e,n){if(!e)return n;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var i=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,i+n}function x(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;for(var n=0,i=0,r=0,o=t.tag;i=2*i+(1&o),o>>>=1,++r,n+=e.table[r],0<=(i-=e.table[r]););return t.tag=o,t.bitcount-=r,e.trans[n+i]}function E(t,e,n){var i,r,o,s,a,u;for(i=b(t,5,257),r=b(t,5,1),o=b(t,4,4),s=0;s<19;++s)y[s]=0;for(s=0;s<o;++s){var l=b(t,3,0);y[d[s]]=l}for(m(g,y,0,19),a=0;a<i+r;){var h=x(t,g);switch(h){case 16:var c=y[a-1];for(u=b(t,2,3);u;--u)y[a++]=c;break;case 17:for(u=b(t,3,3);u;--u)y[a++]=0;break;case 18:for(u=b(t,7,11);u;--u)y[a++]=0;break;default:y[a++]=h}}m(e,y,0,i),m(n,y,i,r)}function w(t,e,n){for(;;){var i,r,o,s,a=x(t,e);if(256===a)return u;if(a<256)t.dest[t.destLen++]=a;else for(i=b(t,h[a-=257],c[a]),r=x(t,n),o=t.destLen-b(t,p[r],f[r]),s=o;s<o+i;++s)t.dest[t.destLen++]=t.dest[s]}}function I(t){for(var e,n,i;8<t.bitcount;)t.sourceIndex--,t.bitcount-=8;if(e=256*(e=t.source[t.sourceIndex+1])+t.source[t.sourceIndex],n=256*(n=t.source[t.sourceIndex+3])+t.source[t.sourceIndex+2],e!==(65535&~n))return o;for(t.sourceIndex+=4,i=e;i;--i)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,u}!function(t,e){var n;for(n=0;n<7;++n)t.table[n]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,n=0;n<24;++n)t.trans[n]=256+n;for(n=0;n<144;++n)t.trans[24+n]=n;for(n=0;n<8;++n)t.trans[168+n]=280+n;for(n=0;n<112;++n)t.trans[176+n]=144+n;for(n=0;n<5;++n)e.table[n]=0;for(e.table[5]=32,n=0;n<32;++n)e.trans[n]=n}(a,l),r(h,c,4,3),r(p,f,2,1),h[28]=0,c[28]=258,e.exports=function(t,e){var n,i,r=new s(t,e);do{switch(n=v(r),b(r,2,0)){case 0:i=I(r);break;case 1:i=w(r,a,l);break;case 2:E(r,r.ltree,r.dtree),i=w(r,r.ltree,r.dtree);break;default:i=o}if(i!==u)throw new Error("Data error")}while(!n);return r.destLen<r.dest.length?"function"==typeof r.dest.slice?r.dest.slice(0,r.destLen):r.dest.subarray(0,r.destLen):r.dest}},{}],2:[function(t,e,n){n.fail=function(t){throw new Error(t)},n.argument=function(t,e){t||n.fail(e)},n.assert=n.argument},{}],3:[function(t,e,n){n.line=function(t,e,n,i,r){t.beginPath(),t.moveTo(e,n),t.lineTo(i,r),t.stroke()}},{}],4:[function(t,e,n){function i(t){this.font=t}function r(t){this.cmap=t}function o(t,e){this.encoding=t,this.charset=e}function s(t){var e;switch(t.version){case 1:this.names=n.standardNames.slice();break;case 2:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)t.glyphNameIndex[e]<n.standardNames.length?this.names[e]=n.standardNames[t.glyphNameIndex[e]]:this.names[e]=t.names[t.glyphNameIndex[e]-n.standardNames.length];break;case 2.5:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)this.names[e]=n.standardNames[e+t.glyphNameIndex[e]];break;case 3:this.names=[]}}i.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),n=this.font.glyphs;if(!n)return null;for(var i=0;i<n.length;i+=1)for(var r=n.get(i),o=0;o<r.unicodes.length;o+=1)if(r.unicodes[o]===e)return i},r.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.charCodeAt(0)]||0},o.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),n=this.encoding[e];return this.charset.indexOf(n)},s.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},s.prototype.glyphIndexToName=function(t){return this.names[t]},n.cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],n.cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],n.cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],n.standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"],n.DefaultEncoding=i,n.CmapEncoding=r,n.CffEncoding=o,n.GlyphNames=s,n.addGlyphNames=function(t){for(var e,n=t.tables.cmap.glyphIndexMap,i=Object.keys(n),r=0;r<i.length;r+=1){var o=i[r],s=n[o];(e=t.glyphs.get(s)).addUnicode(parseInt(o))}for(r=0;r<t.glyphs.length;r+=1)e=t.glyphs.get(r),t.cffEncoding?e.name=t.cffEncoding.charset[r]:t.glyphNames.names&&(e.name=t.glyphNames.glyphIndexToName(r))}},{}],5:[function(s,t,e){var a=s("./path"),n=s("./tables/sfnt"),i=s("./encoding"),r=s("./glyphset"),o=s("./substitution"),u=s("./util");function l(t){(t=t||{}).empty||(u.checkArgument(t.familyName,"When creating a new Font object, familyName is required."),u.checkArgument(t.styleName,"When creating a new Font object, styleName is required."),u.checkArgument(t.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),u.checkArgument(t.ascender,"When creating a new Font object, ascender is required."),u.checkArgument(t.descender,"When creating a new Font object, descender is required."),u.checkArgument(t.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:t.familyName||" "},fontSubfamily:{en:t.styleName||" "},fullName:{en:t.fullName||t.familyName+" "+t.styleName},postScriptName:{en:t.postScriptName||t.familyName+t.styleName},designer:{en:t.designer||" "},designerURL:{en:t.designerURL||" "},manufacturer:{en:t.manufacturer||" "},manufacturerURL:{en:t.manufacturerURL||" "},license:{en:t.license||" "},licenseURL:{en:t.licenseURL||" "},version:{en:t.version||"Version 0.1"},description:{en:t.description||" "},copyright:{en:t.copyright||" "},trademark:{en:t.trademark||" "}},this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.createdTimestamp=t.createdTimestamp,this.tables={os2:{usWeightClass:t.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:t.widthClass||this.usWidthClasses.MEDIUM,fsSelection:t.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new r.GlyphSet(this,t.glyphs||[]),this.encoding=new i.DefaultEncoding(this),this.substitution=new o(this),this.tables=this.tables||{}}l.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},l.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},l.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},l.prototype.stringToGlyphs=function(t){for(var e=[],n=0;n<t.length;n+=1){var i=t[n];e.push(this.charToGlyph(i))}return e},l.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},l.prototype.nameToGlyph=function(t){var e=this.nametoGlyphIndex(t),n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},l.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},l.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var n=this.getGposKerningValue;return n?n(t,e):this.kerningPairs[t+","+e]||0},l.prototype.forEachGlyph=function(t,e,n,i,r,o){e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:72;for(var s=void 0===(r=r||{}).kerning||r.kerning,a=1/this.unitsPerEm*i,u=this.stringToGlyphs(t),l=0;l<u.length;l+=1){var h=u[l];if(o(h,e,n,i,r),h.advanceWidth&&(e+=h.advanceWidth*a),s&&l<u.length-1){var c=this.getKerningValue(h,u[l+1]);e+=c*a}}},l.prototype.getPath=function(t,e,n,i,r){var o=new a.Path;return this.forEachGlyph(t,e,n,i,r,function(t,e,n,i){var r=t.getPath(e,n,i);o.extend(r)}),o},l.prototype.getPaths=function(t,e,n,i,r){var o=[];return this.forEachGlyph(t,e,n,i,r,function(t,e,n,i){var r=t.getPath(e,n,i);o.push(r)}),o},l.prototype.draw=function(t,e,n,i,r,o){this.getPath(e,n,i,r,o).draw(t)},l.prototype.drawPoints=function(r,t,e,n,i,o){this.forEachGlyph(t,e,n,i,o,function(t,e,n,i){t.drawPoints(r,e,n,i)})},l.prototype.drawMetrics=function(r,t,e,n,i,o){this.forEachGlyph(t,e,n,i,o,function(t,e,n,i){t.drawMetrics(r,e,n,i)})},l.prototype.getEnglishName=function(t){var e=this.names[t];if(e)return e.en},l.prototype.validate=function(){var n=this;function t(t){var e=n.getEnglishName(t);e&&e.trim().length}t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),this.unitsPerEm},l.prototype.toTables=function(){return n.fontToTable(this)},l.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},l.prototype.toArrayBuffer=function(){for(var t=this.toTables(),e=t.encode(),n=new ArrayBuffer(e.length),i=new Uint8Array(n),r=0;r<e.length;r++)i[r]=e[r];return n},l.prototype.download=function(){var t=this.getEnglishName("fontFamily"),e=this.getEnglishName("fontSubfamily"),n=t.replace(/\s/g,"")+"-"+e+".otf",r=this.toArrayBuffer();if(u.isBrowser())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,r.byteLength,function(t){t.root.getFile(n,{create:!0},function(i){i.createWriter(function(t){var e=new DataView(r),n=new Blob([e],{type:"font/opentype"});t.write(n),t.addEventListener("writeend",function(){location.href=i.toURL()},!1)})})},function(t){throw new Error(t.name+": "+t.message)});else{var i=s("fs"),o=u.arrayBufferToNodeBuffer(r);i.writeFileSync(n,o)}},l.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},l.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},l.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900},e.Font=l},{"./encoding":4,"./glyphset":7,"./path":11,"./substitution":12,"./tables/sfnt":31,"./util":33,fs:void 0}],6:[function(t,e,n){var r=t("./check"),h=t("./draw"),c=t("./path");function i(t){this.bindConstructorValues(t)}i.prototype.bindConstructorValues=function(t){var e,n;this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],t.xMin&&(this.xMin=t.xMin),t.yMin&&(this.yMin=t.yMin),t.xMax&&(this.xMax=t.xMax),t.yMax&&(this.yMax=t.yMax),t.advanceWidth&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",(e=t.path,n=e||{commands:[]},{configurable:!0,get:function(){return"function"==typeof n&&(n=n()),n},set:function(t){n=t}}))},i.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},i.prototype.getPath=function(t,e,n,i){t=void 0!==t?t:0,e=void 0!==e?e:0,i=void 0!==i?i:{xScale:1,yScale:1},n=void 0!==n?n:72;for(var r=1/this.path.unitsPerEm*n,o=i.xScale*r,s=i.yScale*r,a=new c.Path,u=this.path.commands,l=0;l<u.length;l+=1){var h=u[l];"M"===h.type?a.moveTo(t+h.x*o,e+-h.y*s):"L"===h.type?a.lineTo(t+h.x*o,e+-h.y*s):"Q"===h.type?a.quadraticCurveTo(t+h.x1*o,e+-h.y1*s,t+h.x*o,e+-h.y*s):"C"===h.type?a.curveTo(t+h.x1*o,e+-h.y1*s,t+h.x2*o,e+-h.y2*s,t+h.x*o,e+-h.y*s):"Z"===h.type&&a.closePath()}return a},i.prototype.getContours=function(){if(void 0===this.points)return[];for(var t=[],e=[],n=0;n<this.points.length;n+=1){var i=this.points[n];e.push(i),i.lastPointOfContour&&(t.push(e),e=[])}return r.argument(0===e.length,"There are still points left in the current contour."),t},i.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],n=[],i=0;i<t.length;i+=1){var r=t[i];"Z"!==r.type&&(e.push(r.x),n.push(r.y)),"Q"!==r.type&&"C"!==r.type||(e.push(r.x1),n.push(r.y1)),"C"===r.type&&(e.push(r.x2),n.push(r.y2))}var o={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},i.prototype.draw=function(t,e,n,i,r){this.getPath(e,n,i,r).draw(t)},i.prototype.drawPoints=function(s,t,e,n){function i(t,e,n,i){var r=2*Math.PI;s.beginPath();for(var o=0;o<t.length;o+=1)s.moveTo(e+t[o].x*i,n+t[o].y*i),s.arc(e+t[o].x*i,n+t[o].y*i,2,0,r,!1);s.closePath(),s.fill()}t=void 0!==t?t:0,e=void 0!==e?e:0,n=void 0!==n?n:24;for(var r=1/this.path.unitsPerEm*n,o=[],a=[],u=this.path,l=0;l<u.commands.length;l+=1){var h=u.commands[l];void 0!==h.x&&o.push({x:h.x,y:-h.y}),void 0!==h.x1&&a.push({x:h.x1,y:-h.y1}),void 0!==h.x2&&a.push({x:h.x2,y:-h.y2})}s.fillStyle="blue",i(o,t,e,r),s.fillStyle="red",i(a,t,e,r)},i.prototype.drawMetrics=function(t,e,n,i){var r;e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:24,r=1/this.path.unitsPerEm*i,t.lineWidth=1,t.strokeStyle="black",h.line(t,e,-1e4,e,1e4),h.line(t,-1e4,n,1e4,n);var o=this.xMin||0,s=this.yMin||0,a=this.xMax||0,u=this.yMax||0,l=this.advanceWidth||0;t.strokeStyle="blue",h.line(t,e+o*r,-1e4,e+o*r,1e4),h.line(t,e+a*r,-1e4,e+a*r,1e4),h.line(t,-1e4,n+-s*r,1e4,n+-s*r),h.line(t,-1e4,n+-u*r,1e4,n+-u*r),t.strokeStyle="green",h.line(t,e+l*r,-1e4,e+l*r,1e4)},n.Glyph=i},{"./check":2,"./draw":3,"./path":11}],7:[function(t,e,n){var a=t("./glyph");function u(e,t,n){Object.defineProperty(e,t,{get:function(){return e.path,e[n]},set:function(t){e[n]=t},enumerable:!0,configurable:!0})}function i(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(var n=0;n<e.length;n++)this.glyphs[n]=e[n];this.length=e&&e.length||0}i.prototype.get=function(t){return"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]()),this.glyphs[t]},i.prototype.push=function(t,e){this.glyphs[t]=e,this.length++},n.GlyphSet=i,n.glyphLoader=function(t,e){return new a.Glyph({index:e,font:t})},n.ttfGlyphLoader=function(n,t,i,r,o,s){return function(){var e=new a.Glyph({index:t,font:n});return e.path=function(){i(e,r,o);var t=s(n.glyphs,e);return t.unitsPerEm=n.unitsPerEm,t},u(e,"xMin","_xMin"),u(e,"xMax","_xMax"),u(e,"yMin","_yMin"),u(e,"yMax","_yMax"),e}},n.cffGlyphLoader=function(n,t,i,r){return function(){var e=new a.Glyph({index:t,font:n});return e.path=function(){var t=i(n,e,r);return t.unitsPerEm=n.unitsPerEm,t},e}}},{"./glyph":6}],8:[function(t,e,n){var h=t("./check");function s(t,e){for(var n=0,i=t.length-1;n<=i;){var r=n+i>>>1,o=t[r].tag;if(o===e)return r;o<e?n=r+1:i=r-1}return-n-1}var i={searchTag:s,binSearch:function(t,e){for(var n=0,i=t.length-1;n<=i;){var r=n+i>>>1,o=t[r];if(o===e)return r;o<e?n=r+1:i=r-1}return-n-1},getScriptNames:function(){var t=this.getGsubTable();return t?t.scripts.map(function(t){return t.tag}):[]},getScriptTable:function(t,e){var n=this.getGsubTable(e);if(n){var i=n.scripts,r=s(n.scripts,t);if(0<=r)return i[r].script;var o={tag:t,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-r,0,o.script),o}},getLangSysTable:function(t,e,n){var i=this.getScriptTable(t,n);if(i){if("DFLT"===e)return i.defaultLangSys;var r=s(i.langSysRecords,e);if(0<=r)return i.langSysRecords[r].langSys;if(n){var o={tag:e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-r,0,o),o.langSys}}},getFeatureTable:function(t,e,n,i){var r=this.getLangSysTable(t,e,i);if(r){for(var o,s=r.featureIndexes,a=this.font.tables.gsub.features,u=0;u<s.length;u++)if((o=a[s[u]]).tag===n)return o.feature;if(i){var l=a.length;return h.assert(0===l||n>=a[l-1].tag,"Features must be added in alphabetical order."),o={tag:n,feature:{params:0,lookupListIndexes:[]}},a.push(o),s.push(l),o.feature}}},getLookupTable:function(t,e,n,i,r){var o=this.getFeatureTable(t,e,n,r);if(o){for(var s,a=o.lookupListIndexes,u=this.font.tables.gsub.lookups,l=0;l<a.length;l++)if((s=u[a[l]]).lookupType===i)return s;if(r){s={lookupType:i,lookupFlag:0,subtables:[],markFilteringSet:void 0};var h=u.length;return u.push(s),a.push(h),s}}},expandCoverage:function(t){if(1===t.format)return t.glyphs;for(var e=[],n=t.ranges,i=0;i<n;i++)for(var r=n[i],o=r.start,s=r.end,a=o;a<=s;a++)e.push(a);return e}};e.exports=i},{"./check":2}],9:[function(i,t,e){var o=i("tiny-inflate"),k=i("./encoding"),D=i("./font"),n=i("./glyph"),A=i("./parse"),r=i("./path"),s=i("./util"),F=i("./tables/cmap"),G=i("./tables/cff"),B=i("./tables/fvar"),U=i("./tables/glyf"),q=i("./tables/gpos"),j=i("./tables/gsub"),z=i("./tables/head"),V=i("./tables/hhea"),Y=i("./tables/hmtx"),H=i("./tables/kern"),X=i("./tables/ltag"),W=i("./tables/loca"),J=i("./tables/maxp"),K=i("./tables/name"),Z=i("./tables/os2"),Q=i("./tables/post"),$=i("./tables/meta");function a(t,n){var e=i("fs");e.readFile(t,function(t,e){if(t)return n(t.message);n(null,s.nodeBufferToArrayBuffer(e))})}function u(t,e){var n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){return 200!==n.status?e("Font could not be loaded: "+n.statusText):e(null,n.response)},n.send()}function tt(t,e){for(var n=[],i=12,r=0;r<e;r+=1){var o=A.getTag(t,i),s=A.getULong(t,i+4),a=A.getULong(t,i+8),u=A.getULong(t,i+12);n.push({tag:o,checksum:s,offset:a,length:u,compression:!1}),i+=16}return n}function et(t,e){if("WOFF"!==e.compression)return{data:t,offset:e.offset};var n=new Uint8Array(t.buffer,e.offset+2,e.compressedLength-2),i=new Uint8Array(e.originalLength);if(o(n,i),i.byteLength!==e.originalLength)throw new Error("Decompression error: "+e.tag+" decompressed length doesn't match recorded length");var r=new DataView(i.buffer,0);return{data:r,offset:0}}function l(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d=new D.Font({empty:!0}),g=new DataView(t,0),y=[],_=A.getTag(g,0);if(_===String.fromCharCode(0,1,0,0))d.outlinesFormat="truetype",i=A.getUShort(g,4),y=tt(g,i);else if("OTTO"===_)d.outlinesFormat="cff",i=A.getUShort(g,4),y=tt(g,i);else{if("wOFF"!==_)throw new Error("Unsupported OpenType signature "+_);var m=A.getTag(g,4);if(m===String.fromCharCode(0,1,0,0))d.outlinesFormat="truetype";else{if("OTTO"!==m)throw new Error("Unsupported OpenType flavor "+_);d.outlinesFormat="cff"}i=A.getUShort(g,12),y=function(t,e){for(var n=[],i=44,r=0;r<e;r+=1){var o,s=A.getTag(t,i),a=A.getULong(t,i+4),u=A.getULong(t,i+8),l=A.getULong(t,i+12);o=u<l&&"WOFF",n.push({tag:s,offset:a,compression:o,compressedLength:u,originalLength:l}),i+=20}return n}(g,i)}for(var v=0;v<i;v+=1){var b,x=y[v];switch(x.tag){case"cmap":b=et(g,x),d.tables.cmap=F.parse(b.data,b.offset),d.encoding=new k.CmapEncoding(d.tables.cmap);break;case"fvar":o=x;break;case"head":b=et(g,x),d.tables.head=z.parse(b.data,b.offset),d.unitsPerEm=d.tables.head.unitsPerEm,e=d.tables.head.indexToLocFormat;break;case"hhea":b=et(g,x),d.tables.hhea=V.parse(b.data,b.offset),d.ascender=d.tables.hhea.ascender,d.descender=d.tables.hhea.descender,d.numberOfHMetrics=d.tables.hhea.numberOfHMetrics;break;case"hmtx":l=x;break;case"ltag":b=et(g,x),n=X.parse(b.data,b.offset);break;case"maxp":b=et(g,x),d.tables.maxp=J.parse(b.data,b.offset),d.numGlyphs=d.tables.maxp.numGlyphs;break;case"name":p=x;break;case"OS/2":b=et(g,x),d.tables.os2=Z.parse(b.data,b.offset);break;case"post":b=et(g,x),d.tables.post=Q.parse(b.data,b.offset),d.glyphNames=new k.GlyphNames(d.tables.post);break;case"glyf":s=x;break;case"loca":c=x;break;case"CFF ":r=x;break;case"kern":h=x;break;case"GPOS":a=x;break;case"GSUB":u=x;break;case"meta":f=x}}var E=et(g,p);if(d.tables.name=K.parse(E.data,E.offset,n),d.names=d.tables.name,s&&c){var w=0===e,I=et(g,c),L=W.parse(I.data,I.offset,d.numGlyphs,w),S=et(g,s);d.glyphs=U.parse(S.data,S.offset,L,d)}else{if(!r)throw new Error("Font doesn't contain TrueType or CFF outlines.");var M=et(g,r);G.parse(M.data,M.offset,d)}var C=et(g,l);if(Y.parse(C.data,C.offset,d.numberOfHMetrics,d.numGlyphs,d.glyphs),k.addGlyphNames(d),h){var P=et(g,h);d.kerningPairs=H.parse(P.data,P.offset)}else d.kerningPairs={};if(a){var N=et(g,a);q.parse(N.data,N.offset,d)}if(u){var O=et(g,u);d.tables.gsub=j.parse(O.data,O.offset)}if(o){var T=et(g,o);d.tables.fvar=B.parse(T.data,T.offset,d.names)}if(f){var R=et(g,f);d.tables.meta=$.parse(R.data,R.offset),d.metas=d.tables.meta}return d}e._parse=A,e.Font=D.Font,e.Glyph=n.Glyph,e.Path=r.Path,e.parse=l,e.load=function(t,i){("undefined"==typeof window?a:u)(t,function(t,e){if(t)return i(t);var n;try{n=l(e)}catch(t){return i(t,null)}return i(null,n)})},e.loadSync=function(t){var e=i("fs").readFileSync(t);return l(s.nodeBufferToArrayBuffer(e))}},{"./encoding":4,"./font":5,"./glyph":6,"./parse":10,"./path":11,"./tables/cff":14,"./tables/cmap":15,"./tables/fvar":16,"./tables/glyf":17,"./tables/gpos":18,"./tables/gsub":19,"./tables/head":20,"./tables/hhea":21,"./tables/hmtx":22,"./tables/kern":23,"./tables/loca":24,"./tables/ltag":25,"./tables/maxp":26,"./tables/meta":27,"./tables/name":28,"./tables/os2":29,"./tables/post":30,"./util":33,fs:void 0,"tiny-inflate":1}],10:[function(t,e,n){var o=t("./check");function i(t,e){return t.getUint16(e,!1)}n.getByte=function(t,e){return t.getUint8(e)},n.getCard8=n.getByte,n.getUShort=n.getCard16=i,n.getShort=function(t,e){return t.getInt16(e,!1)},n.getULong=function(t,e){return t.getUint32(e,!1)},n.getFixed=function(t,e){var n=t.getInt16(e,!1),i=t.getUint16(e+2,!1);return n+i/65535},n.getTag=function(t,e){for(var n="",i=e;i<e+4;i+=1)n+=String.fromCharCode(t.getInt8(i));return n},n.getOffset=function(t,e,n){for(var i=0,r=0;r<n;r+=1)i<<=8,i+=t.getUint8(e+r);return i},n.getBytes=function(t,e,n){for(var i=[],r=e;r<n;r+=1)i.push(t.getUint8(r));return i},n.bytesToString=function(t){for(var e="",n=0;n<t.length;n+=1)e+=String.fromCharCode(t[n]);return e};var r={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function s(t,e){this.data=t,this.offset=e,this.relativeOffset=0}s.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},s.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},s.prototype.parseCard8=s.prototype.parseByte,s.prototype.parseCard16=s.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},s.prototype.parseSID=s.prototype.parseUShort,s.prototype.parseOffset16=s.prototype.parseUShort,s.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},s.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},s.prototype.parseULong=function(){var t=n.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},s.prototype.parseFixed=function(){var t=n.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},s.prototype.parseString=function(t){var e=this.data,n=this.offset+this.relativeOffset,i="";this.relativeOffset+=t;for(var r=0;r<t;r++)i+=String.fromCharCode(e.getUint8(n+r));return i},s.prototype.parseTag=function(){return this.parseString(4)},s.prototype.parseLongDateTime=function(){var t=n.getULong(this.data,this.offset+this.relativeOffset+4);return t-=2082844800,this.relativeOffset+=8,t},s.prototype.parseVersion=function(){var t=i(this.data,this.offset+this.relativeOffset),e=i(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t+e/4096/10},s.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=r[t]*e},s.prototype.parseOffset16List=s.prototype.parseUShortList=function(t){void 0===t&&(t=this.parseUShort());for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getUint16(i),i+=2;return this.relativeOffset+=2*t,e},s.prototype.parseList=function(t,e){e||(e=t,t=this.parseUShort());for(var n=new Array(t),i=0;i<t;i++)n[i]=e.call(this);return n},s.prototype.parseRecordList=function(t,e){e||(e=t,t=this.parseUShort());for(var n=new Array(t),i=Object.keys(e),r=0;r<t;r++){for(var o={},s=0;s<i.length;s++){var a=i[s],u=e[a];o[a]=u.call(this)}n[r]=o}return n},s.prototype.parseStruct=function(t){if("function"==typeof t)return t.call(this);for(var e=Object.keys(t),n={},i=0;i<e.length;i++){var r=e[i],o=t[r];n[r]=o.call(this)}return n},s.prototype.parsePointer=function(t){var e=this.parseOffset16();if(0<e)return new s(this.data,this.offset+e).parseStruct(t)},s.prototype.parseListOfLists=function(t){for(var e=this.parseOffset16List(),n=e.length,i=this.relativeOffset,r=new Array(n),o=0;o<n;o++){var s=e[o];if(0!==s)if(this.relativeOffset=s,t){for(var a=this.parseOffset16List(),u=new Array(a.length),l=0;l<a.length;l++)this.relativeOffset=s+a[l],u[l]=t.call(this);r[o]=u}else r[o]=this.parseUShortList();else r[o]=void 0}return this.relativeOffset=i,r},s.prototype.parseCoverage=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort(),n=this.parseUShort();if(1===e)return{format:1,glyphs:this.parseUShortList(n)};if(2===e){for(var i=new Array(n),r=0;r<n;r++)i[r]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:i}}o.assert(!1,"0x"+t.toString(16)+": Coverage format must be 1 or 2.")},s.prototype.parseClassDef=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()}:2===e?{format:2,ranges:this.parseRecordList({start:s.uShort,end:s.uShort,classId:s.uShort})}:void o.assert(!1,"0x"+t.toString(16)+": ClassDef format must be 1 or 2.")},s.list=function(t,e){return function(){return this.parseList(t,e)}},s.recordList=function(t,e){return function(){return this.parseRecordList(t,e)}},s.pointer=function(t){return function(){return this.parsePointer(t)}},s.tag=s.prototype.parseTag,s.byte=s.prototype.parseByte,s.uShort=s.offset16=s.prototype.parseUShort,s.uShortList=s.prototype.parseUShortList,s.struct=s.prototype.parseStruct,s.coverage=s.prototype.parseCoverage,s.classDef=s.prototype.parseClassDef;var a={reserved:s.uShort,reqFeatureIndex:s.uShort,featureIndexes:s.uShortList};s.prototype.parseScriptList=function(){return this.parsePointer(s.recordList({tag:s.tag,script:s.pointer({defaultLangSys:s.pointer(a),langSysRecords:s.recordList({tag:s.tag,langSys:s.pointer(a)})})}))},s.prototype.parseFeatureList=function(){return this.parsePointer(s.recordList({tag:s.tag,feature:s.pointer({featureParams:s.offset16,lookupListIndexes:s.uShortList})}))},s.prototype.parseLookupList=function(i){return this.parsePointer(s.list(s.pointer(function(){var t=this.parseUShort();o.argument(1<=t&&t<=8,"GSUB lookup type "+t+" unknown.");var e=this.parseUShort(),n=16&e;return{lookupType:t,lookupFlag:e,subtables:this.parseList(s.pointer(i[t])),markFilteringSet:n?this.parseUShort():void 0}})))},n.Parser=s},{"./check":2}],11:[function(t,e,n){function i(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}i.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},i.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},i.prototype.curveTo=i.prototype.bezierCurveTo=function(t,e,n,i,r,o){this.commands.push({type:"C",x1:t,y1:e,x2:n,y2:i,x:r,y:o})},i.prototype.quadTo=i.prototype.quadraticCurveTo=function(t,e,n,i){this.commands.push({type:"Q",x1:t,y1:e,x:n,y:i})},i.prototype.close=i.prototype.closePath=function(){this.commands.push({type:"Z"})},i.prototype.extend=function(t){t.commands&&(t=t.commands),Array.prototype.push.apply(this.commands,t)},i.prototype.draw=function(t){t.beginPath();for(var e=0;e<this.commands.length;e+=1){var n=this.commands[e];"M"===n.type?t.moveTo(n.x,n.y):"L"===n.type?t.lineTo(n.x,n.y):"C"===n.type?t.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):"Q"===n.type?t.quadraticCurveTo(n.x1,n.y1,n.x,n.y):"Z"===n.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},i.prototype.toPathData=function(r){function t(){for(var t="",e=0;e<arguments.length;e+=1){var n=arguments[e];0<=n&&0<e&&(t+=" "),t+=(i=n,Math.round(i)===i?""+Math.round(i):i.toFixed(r))}var i;return t}r=void 0!==r?r:2;for(var e="",n=0;n<this.commands.length;n+=1){var i=this.commands[n];"M"===i.type?e+="M"+t(i.x,i.y):"L"===i.type?e+="L"+t(i.x,i.y):"C"===i.type?e+="C"+t(i.x1,i.y1,i.x2,i.y2,i.x,i.y):"Q"===i.type?e+="Q"+t(i.x1,i.y1,i.x,i.y):"Z"===i.type&&(e+="Z")}return e},i.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&&"black"!==this.fill&&(null===this.fill?e+=' fill="none"':e+=' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},n.Path=i},{}],12:[function(t,e,n){var p=t("./check"),i=t("./layout"),r=function(t){this.font=t};function f(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function u(t,e,n){for(var i=t.subtables,r=0;r<i.length;r++){var o=i[r];if(o.substFormat===e)return o}if(n)return i.push(n),n}(r.prototype=i).getGsubTable=function(t){var e=this.font.tables.gsub;return!e&&t&&(this.font.tables.gsub=e={version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}),e},r.prototype.getSingle=function(t,e,n){var i=[],r=this.getLookupTable(e,n,t,1);if(!r)return i;for(var o=r.subtables,s=0;s<o.length;s++){var a,u=o[s],l=this.expandCoverage(u.coverage);if(1===u.substFormat){var h=u.deltaGlyphId;for(a=0;a<l.length;a++){var c=l[a];i.push({sub:c,by:c+h})}}else{var p=u.substitute;for(a=0;a<l.length;a++)i.push({sub:l[a],by:p[a]})}}return i},r.prototype.getAlternates=function(t,e,n){var i=[],r=this.getLookupTable(e,n,t,3);if(!r)return i;for(var o=r.subtables,s=0;s<o.length;s++)for(var a=o[s],u=this.expandCoverage(a.coverage),l=a.alternateSets,h=0;h<u.length;h++)i.push({sub:u[h],by:l[h]});return i},r.prototype.getLigatures=function(t,e,n){var i=[],r=this.getLookupTable(e,n,t,4);if(!r)return[];for(var o=r.subtables,s=0;s<o.length;s++)for(var a=o[s],u=this.expandCoverage(a.coverage),l=a.ligatureSets,h=0;h<u.length;h++)for(var c=u[h],p=l[h],f=0;f<p.length;f++){var d=p[f];i.push({sub:[c].concat(d.components),by:d.ligGlyph})}return i},r.prototype.addSingle=function(t,e,n,i){var r=this.getLookupTable(n,i,t,1,!0),o=u(r,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});p.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub,a=this.binSearch(o.coverage.glyphs,s);a<0&&(a=-1-a,o.coverage.glyphs.splice(a,0,s),o.substitute.splice(a,0,0)),o.substitute[a]=e.by},r.prototype.addAlternate=function(t,e,n,i){var r=this.getLookupTable(n,i,t,3,!0),o=u(r,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});p.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub,a=this.binSearch(o.coverage.glyphs,s);a<0&&(a=-1-a,o.coverage.glyphs.splice(a,0,s),o.alternateSets.splice(a,0,0)),o.alternateSets[a]=e.by},r.prototype.addLigature=function(t,e,n,i){n=n||"DFLT",i=i||"DFLT";var r=this.getLookupTable(n,i,t,4,!0),o=r.subtables[0];o||(o={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},r.subtables[0]=o),p.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub[0],a=e.sub.slice(1),u={ligGlyph:e.by,components:a},l=this.binSearch(o.coverage.glyphs,s);if(0<=l){for(var h=o.ligatureSets[l],c=0;c<h.length;c++)if(f(h[c].components,a))return;h.push(u)}else l=-1-l,o.coverage.glyphs.splice(l,0,s),o.ligatureSets.splice(l,0,[u])},r.prototype.getFeature=function(t,e,n){if(e=e||"DFLT",n=n||"DFLT",/ss\d\d/.test(t))return this.getSingle(t,e,n);switch(t){case"aalt":case"salt":return this.getSingle(t,e,n).concat(this.getAlternates(t,e,n));case"dlig":case"liga":case"rlig":return this.getLigatures(t,e,n)}},r.prototype.add=function(t,e,n,i){if(n=n||"DFLT",i=i||"DFLT",/ss\d\d/.test(t))return this.addSingle(t,e,n,i);switch(t){case"aalt":case"salt":return"number"==typeof e.by?this.addSingle(t,e,n,i):this.addAlternate(t,e,n,i);case"dlig":case"liga":case"rlig":return this.addLigature(t,e,n,i)}},e.exports=r},{"./check":2,"./layout":8}],13:[function(t,e,n){var r=t("./check"),i=t("./types").encode,o=t("./types").sizeOf;function s(t,e,n){var i;for(i=0;i<e.length;i+=1){var r=e[i];this[r.name]=r.value}if(this.tableName=t,this.fields=e,n){var o=Object.keys(n);for(i=0;i<o.length;i+=1){var s=o[i],a=n[s];void 0!==this[s]&&(this[s]=a)}}}function a(t,e,n){void 0===n&&(n=e.length);var i=new Array(e.length+1);i[0]={name:t+"Count",type:"USHORT",value:n};for(var r=0;r<e.length;r++)i[r+1]={name:t+r,type:"USHORT",value:e[r]};return i}function u(t,e,n){var i=e.length,r=new Array(i+1);r[0]={name:t+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r[o+1]={name:t+o,type:"TABLE",value:n(e[o],o)};return r}function l(t,e,n){var i=e.length,r=[];r[0]={name:t+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r=r.concat(n(e[o],o));return r}function h(t){1===t.format?s.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(a("glyph",t.glyphs))):r.assert(!1,"Can't create coverage table format 2 yet.")}function c(t){s.call(this,"scriptListTable",l("scriptRecord",t,function(t,e){var n=t.script,i=n.defaultLangSys;return r.assert(!!i,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+e,type:"TAG",value:t.tag},{name:"script"+e,type:"TABLE",value:new s("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new s("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:i.reqFeatureIndex}].concat(a("featureIndex",i.featureIndexes)))}].concat(l("langSys",n.langSysRecords,function(t,e){var n=t.langSys;return[{name:"langSysTag"+e,type:"TAG",value:t.tag},{name:"langSys"+e,type:"TABLE",value:new s("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(a("featureIndex",n.featureIndexes)))}]})))}]}))}function p(t){s.call(this,"featureListTable",l("featureRecord",t,function(t,e){var n=t.feature;return[{name:"featureTag"+e,type:"TAG",value:t.tag},{name:"feature"+e,type:"TABLE",value:new s("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(a("lookupListIndex",n.lookupListIndexes)))}]}))}function f(t,n){s.call(this,"lookupListTable",u("lookup",t,function(t){var e=n[t.lookupType];return r.assert(!!e,"Unable to write GSUB lookup type "+t.lookupType+" tables."),new s("lookupTable",[{name:"lookupType",type:"USHORT",value:t.lookupType},{name:"lookupFlag",type:"USHORT",value:t.lookupFlag}].concat(u("subtable",t.subtables,e)))}))}s.prototype.encode=function(){return i.TABLE(this)},s.prototype.sizeOf=function(){return o.TABLE(this)},(h.prototype=Object.create(s.prototype)).constructor=h,(c.prototype=Object.create(s.prototype)).constructor=c,(p.prototype=Object.create(s.prototype)).constructor=p,(f.prototype=Object.create(s.prototype)).constructor=f,n.Record=n.Table=s,n.Coverage=h,n.ScriptList=c,n.FeatureList=p,n.LookupList=f,n.ushortList=a,n.tableList=u,n.recordList=l},{"./check":2,"./types":32}],14:[function(t,e,n){var S=t("../encoding"),M=t("../glyphset"),C=t("../parse"),i=t("../path"),g=t("../table");function a(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(!a(t[n],e[n]))return!1;return!0}return!1}function P(t,e,n){var i,r,o,s=[],a=[],u=C.getCard16(t,e);if(0!==u){var l=C.getByte(t,e+2);r=e+(u+1)*l+2;var h=e+3;for(i=0;i<u+1;i+=1)s.push(C.getOffset(t,h,l)),h+=l;o=r+s[u]}else o=e+2;for(i=0;i<s.length-1;i+=1){var c=C.getBytes(t,r+s[i],r+s[i+1]);n&&(c=n(c)),a.push(c)}return{objects:a,startOffset:e,endOffset:o}}function u(t,e){var n,i,r,o;if(28===e)return n=t.parseByte(),i=t.parseByte(),n<<8|i;if(29===e)return n=t.parseByte(),i=t.parseByte(),r=t.parseByte(),o=t.parseByte(),n<<24|i<<16|r<<8|o;if(30===e)return function(t){for(var e="",n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var i=t.parseByte(),r=i>>4,o=15&i;if(15===r)break;if(e+=n[r],15===o)break;e+=n[o]}return parseFloat(e)}(t);if(32<=e&&e<=246)return e-139;if(247<=e&&e<=250)return n=t.parseByte(),256*(e-247)+n+108;if(251<=e&&e<=254)return n=t.parseByte(),256*-(e-251)-n-108;throw new Error("Invalid b0 "+e)}function N(t,e,n){e=void 0!==e?e:0;var i=new C.Parser(t,e),r=[],o=[];for(n=void 0!==n?n:t.length;i.relativeOffset<n;){var s=i.parseByte();s<=21?(12===s&&(s=1200+i.parseByte()),r.push([s,o]),o=[]):o.push(u(i,s))}return function(t){for(var e={},n=0;n<t.length;n+=1){var i,r=t[n][0],o=t[n][1];if(i=1===o.length?o[0]:o,e.hasOwnProperty(r))throw new Error("Object "+e+" already has key "+r);e[r]=i}return e}(r)}function h(t,e){return e=e<=390?S.cffStandardStrings[e]:t[e-391]}function O(t,e,n){for(var i={},r=0;r<e.length;r+=1){var o=e[r],s=t[o.op];void 0===s&&(s=void 0!==o.value?o.value:null),"SID"===o.type&&(s=h(n,s)),i[o.name]=s}return i}var T=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],R=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function k(t,e,n,i){var r,o,s,a=new C.Parser(t,e);n-=1;var u=[".notdef"],l=a.parseCard8();if(0===l)for(r=0;r<n;r+=1)o=a.parseSID(),u.push(h(i,o));else if(1===l)for(;u.length<=n;)for(o=a.parseSID(),s=a.parseCard8(),r=0;r<=s;r+=1)u.push(h(i,o)),o+=1;else{if(2!==l)throw new Error("Unknown charset format "+l);for(;u.length<=n;)for(o=a.parseSID(),s=a.parseCard16(),r=0;r<=s;r+=1)u.push(h(i,o)),o+=1}return u}function D(t,e,n){var i,r,o={},s=new C.Parser(t,e),a=s.parseCard8();if(0===a){var u=s.parseCard8();for(i=0;i<u;i+=1)r=s.parseCard8(),o[r]=i}else{if(1!==a)throw new Error("Unknown encoding format "+a);var l=s.parseCard8();for(r=1,i=0;i<l;i+=1)for(var h=s.parseCard8(),c=s.parseCard8(),p=h;p<=h+c;p+=1)o[p]=r,r+=1}return new S.CffEncoding(o,n)}function A(y,_,t){var m,v,b,x,E=new i.Path,w=[],I=0,L=!1,S=y.defaultWidthX,M=!1,C=0,P=0;function N(t,e){M&&E.closePath(),E.moveTo(t,e),M=!0}function O(){w.length%2!=0&&!L&&(S=w.shift()+y.nominalWidthX),I+=w.length>>1,w.length=0,L=!0}return function t(e){for(var n,i,r,o,s,a,u,l,h,c,p,f,d=0;d<e.length;){var g=e[d];switch(d+=1,g){case 1:case 3:O();break;case 4:1<w.length&&!L&&(S=w.shift()+y.nominalWidthX,L=!0),P+=w.pop(),N(C,P);break;case 5:for(;0<w.length;)C+=w.shift(),P+=w.shift(),E.lineTo(C,P);break;case 6:for(;0<w.length&&(C+=w.shift(),E.lineTo(C,P),0!==w.length);)P+=w.shift(),E.lineTo(C,P);break;case 7:for(;0<w.length&&(P+=w.shift(),E.lineTo(C,P),0!==w.length);)C+=w.shift(),E.lineTo(C,P);break;case 8:for(;0<w.length;)m=C+w.shift(),v=P+w.shift(),b=m+w.shift(),x=v+w.shift(),C=b+w.shift(),P=x+w.shift(),E.curveTo(m,v,b,x,C,P);break;case 10:s=w.pop()+y.subrsBias,(a=y.subrs[s])&&t(a);break;case 11:return;case 12:switch(g=e[d],d+=1,g){case 35:m=C+w.shift(),v=P+w.shift(),b=m+w.shift(),x=v+w.shift(),u=b+w.shift(),l=x+w.shift(),h=u+w.shift(),c=l+w.shift(),p=h+w.shift(),f=c+w.shift(),C=p+w.shift(),P=f+w.shift(),w.shift(),E.curveTo(m,v,b,x,u,l),E.curveTo(h,c,p,f,C,P);break;case 34:m=C+w.shift(),v=P,b=m+w.shift(),x=v+w.shift(),u=b+w.shift(),l=x,h=u+w.shift(),c=x,p=h+w.shift(),f=P,C=p+w.shift(),E.curveTo(m,v,b,x,u,l),E.curveTo(h,c,p,f,C,P);break;case 36:m=C+w.shift(),v=P+w.shift(),b=m+w.shift(),x=v+w.shift(),u=b+w.shift(),l=x,h=u+w.shift(),c=x,p=h+w.shift(),f=c+w.shift(),C=p+w.shift(),E.curveTo(m,v,b,x,u,l),E.curveTo(h,c,p,f,C,P);break;case 37:m=C+w.shift(),v=P+w.shift(),b=m+w.shift(),x=v+w.shift(),u=b+w.shift(),l=x+w.shift(),h=u+w.shift(),c=l+w.shift(),p=h+w.shift(),f=c+w.shift(),Math.abs(p-C)>Math.abs(f-P)?C=p+w.shift():P=f+w.shift(),E.curveTo(m,v,b,x,u,l),E.curveTo(h,c,p,f,C,P);break;default:console.log("Glyph "+_.index+": unknown operator 1200"+g),w.length=0}break;case 14:0<w.length&&!L&&(S=w.shift()+y.nominalWidthX,L=!0),M&&(E.closePath(),M=!1);break;case 18:O();break;case 19:case 20:O(),d+=I+7>>3;break;case 21:2<w.length&&!L&&(S=w.shift()+y.nominalWidthX,L=!0),P+=w.pop(),N(C+=w.pop(),P);break;case 22:1<w.length&&!L&&(S=w.shift()+y.nominalWidthX,L=!0),N(C+=w.pop(),P);break;case 23:O();break;case 24:for(;2<w.length;)m=C+w.shift(),v=P+w.shift(),b=m+w.shift(),x=v+w.shift(),C=b+w.shift(),P=x+w.shift(),E.curveTo(m,v,b,x,C,P);C+=w.shift(),P+=w.shift(),E.lineTo(C,P);break;case 25:for(;6<w.length;)C+=w.shift(),P+=w.shift(),E.lineTo(C,P);m=C+w.shift(),v=P+w.shift(),b=m+w.shift(),x=v+w.shift(),C=b+w.shift(),P=x+w.shift(),E.curveTo(m,v,b,x,C,P);break;case 26:for(w.length%2&&(C+=w.shift());0<w.length;)m=C,v=P+w.shift(),b=m+w.shift(),x=v+w.shift(),C=b,P=x+w.shift(),E.curveTo(m,v,b,x,C,P);break;case 27:for(w.length%2&&(P+=w.shift());0<w.length;)m=C+w.shift(),v=P,b=m+w.shift(),x=v+w.shift(),C=b+w.shift(),P=x,E.curveTo(m,v,b,x,C,P);break;case 28:n=e[d],i=e[d+1],w.push((n<<24|i<<16)>>16),d+=2;break;case 29:s=w.pop()+y.gsubrsBias,(a=y.gsubrs[s])&&t(a);break;case 30:for(;0<w.length&&(m=C,v=P+w.shift(),b=m+w.shift(),x=v+w.shift(),C=b+w.shift(),P=x+(1===w.length?w.shift():0),E.curveTo(m,v,b,x,C,P),0!==w.length);)m=C+w.shift(),v=P,b=m+w.shift(),x=v+w.shift(),P=x+w.shift(),C=b+(1===w.length?w.shift():0),E.curveTo(m,v,b,x,C,P);break;case 31:for(;0<w.length&&(m=C+w.shift(),v=P,b=m+w.shift(),x=v+w.shift(),P=x+w.shift(),C=b+(1===w.length?w.shift():0),E.curveTo(m,v,b,x,C,P),0!==w.length);)m=C,v=P+w.shift(),b=m+w.shift(),x=v+w.shift(),C=b+w.shift(),P=x+(1===w.length?w.shift():0),E.curveTo(m,v,b,x,C,P);break;default:g<32?console.log("Glyph "+_.index+": unknown operator "+g):g<247?w.push(g-139):g<251?(n=e[d],d+=1,w.push(256*(g-247)+n+108)):g<255?(n=e[d],d+=1,w.push(256*-(g-251)-n-108)):(n=e[d],i=e[d+1],r=e[d+2],o=e[d+3],d+=4,w.push((n<<24|i<<16|r<<8|o)/65536))}}}(t),_.advanceWidth=S,E}function F(t){return t.length<1240?107:t.length<33900?1131:32768}function l(t,e){var n,i=S.cffStandardStrings.indexOf(t);return 0<=i&&(n=i),0<=(i=e.indexOf(t))?n=i+S.cffStandardStrings.length:(n=S.cffStandardStrings.length+e.length,e.push(t)),n}function y(t){var e=new g.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var n=0;n<t.length;n+=1)e.names.push({name:"name_"+n,type:"NAME",value:t[n]});return e}function _(t,e,n){for(var i={},r=0;r<t.length;r+=1){var o=t[r],s=e[o.name];void 0===s||a(s,o.value)||("SID"===o.type&&(s=l(s,n)),i[o.op]={name:o.name,type:o.type,value:s})}return i}function m(t,e){var n=new g.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=_(T,t,e),n}function v(t){var e=new g.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function b(t){var e=new g.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var n=0;n<t.length;n+=1)e.strings.push({name:"string_"+n,type:"STRING",value:t[n]});return e}function x(t,e){for(var n=new g.Record("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<t.length;i+=1){var r=t[i],o=l(r,e);n.fields.push({name:"glyph_"+i,type:"SID",value:o})}return n}function o(t){var e=[],n=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var i=0,r=0,o=0;o<n.commands.length;o+=1){var s,a,u=n.commands[o];if("Q"===u.type&&(u={type:"C",x:u.x,y:u.y,x1:1/3*i+2/3*u.x1,y1:1/3*r+2/3*u.y1,x2:1/3*u.x+2/3*u.x1,y2:1/3*u.y+2/3*u.y1}),"M"===u.type)s=Math.round(u.x-i),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(u.x),r=Math.round(u.y);else if("L"===u.type)s=Math.round(u.x-i),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rlineto",type:"OP",value:5}),i=Math.round(u.x),r=Math.round(u.y);else if("C"===u.type){var l=Math.round(u.x1-i),h=Math.round(u.y1-r),c=Math.round(u.x2-u.x1),p=Math.round(u.y2-u.y1);s=Math.round(u.x-u.x2),a=Math.round(u.y-u.y2),e.push({name:"dx1",type:"NUMBER",value:l}),e.push({name:"dy1",type:"NUMBER",value:h}),e.push({name:"dx2",type:"NUMBER",value:c}),e.push({name:"dy2",type:"NUMBER",value:p}),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(u.x),r=Math.round(u.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}function E(t){for(var e=new g.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),n=0;n<t.length;n+=1){var i=t.get(n),r=o(i);e.charStrings.push({name:i.name,type:"CHARSTRING",value:r})}return e}n.parse=function(t,e,n){n.tables.cff={};var i,r,o,s=(i=t,r=e,(o={}).formatMajor=C.getCard8(i,r),o.formatMinor=C.getCard8(i,r+1),o.size=C.getCard8(i,r+2),o.offsetSize=C.getCard8(i,r+3),o.startOffset=r,o.endOffset=r+4,o),a=P(t,s.endOffset,C.bytesToString),u=P(t,a.endOffset),l=P(t,u.endOffset,C.bytesToString),h=P(t,l.endOffset);n.gsubrs=h.objects,n.gsubrsBias=F(n.gsubrs);var c,p,f=(c=new DataView(new Uint8Array(u.objects[0]).buffer),p=l.objects,O(N(c,0,c.byteLength),T,p));n.tables.cff.topDict=f;var d,g,y,_,m=e+f.private[1],v=(d=t,g=m,y=f.private[0],_=l.objects,O(N(d,g,y),R,_));if(n.defaultWidthX=v.defaultWidthX,n.nominalWidthX=v.nominalWidthX,0!==v.subrs){var b=m+v.subrs,x=P(t,b);n.subrs=x.objects,n.subrsBias=F(n.subrs)}else n.subrs=[],n.subrsBias=0;var E=P(t,e+f.charStrings);n.nGlyphs=E.objects.length;var w=k(t,e+f.charset,n.nGlyphs,l.objects);0===f.encoding?n.cffEncoding=new S.CffEncoding(S.cffStandardEncoding,w):1===f.encoding?n.cffEncoding=new S.CffEncoding(S.cffExpertEncoding,w):n.cffEncoding=D(t,e+f.encoding,w),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new M.GlyphSet(n);for(var I=0;I<n.nGlyphs;I+=1){var L=E.objects[I];n.glyphs.push(I,M.cffGlyphLoader(n,I,A,L))}},n.make=function(t,e){for(var n,i=new g.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),r=1/e.unitsPerEm,o={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontBBox:e.fontBBox||[0,0,0,0],fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},s={},a=[],u=1;u<t.length;u+=1)n=t.get(u),a.push(n.name);var l=[];i.header=new g.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),i.nameIndex=y([e.postScriptName]);var h,c,p,f=m(o,l);i.topDictIndex=v(f),i.globalSubrIndex=new g.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),i.charsets=x(a,l),i.charStringsIndex=E(t),i.privateDict=(h=s,c=l,(p=new g.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=_(R,h,c),p),i.stringIndex=b(l);var d=i.header.sizeOf()+i.nameIndex.sizeOf()+i.topDictIndex.sizeOf()+i.stringIndex.sizeOf()+i.globalSubrIndex.sizeOf();return o.charset=d,o.encoding=0,o.charStrings=o.charset+i.charsets.sizeOf(),o.private[1]=o.charStrings+i.charStringsIndex.sizeOf(),f=m(o,l),i.topDictIndex=v(f),i}},{"../encoding":4,"../glyphset":7,"../parse":10,"../path":11,"../table":13}],15:[function(t,e,n){var u=t("../check"),m=t("../parse"),g=t("../table");function l(t,e){var n,i;for(e.parseUShort(),t.length=e.parseULong(),t.language=e.parseULong(),t.groupCount=i=e.parseULong(),t.glyphIndexMap={},n=0;n<i;n+=1)for(var r=e.parseULong(),o=e.parseULong(),s=e.parseULong(),a=r;a<=o;a+=1)t.glyphIndexMap[a]=s,s++}function h(t,e,n,i,r){var o,s;t.length=e.parseUShort(),t.language=e.parseUShort(),t.segCount=s=e.parseUShort()>>1,e.skip("uShort",3),t.glyphIndexMap={};var a=new m.Parser(n,i+r+14),u=new m.Parser(n,i+r+16+2*s),l=new m.Parser(n,i+r+16+4*s),h=new m.Parser(n,i+r+16+6*s),c=i+r+16+8*s;for(o=0;o<s-1;o+=1)for(var p,f=a.parseUShort(),d=u.parseUShort(),g=l.parseShort(),y=h.parseUShort(),_=d;_<=f;_+=1)0!==y?(c=h.offset+h.relativeOffset-2,c+=y,c+=2*(_-d),0!==(p=m.getUShort(n,c))&&(p=p+g&65535)):p=_+g&65535,t.glyphIndexMap[_]=p}n.parse=function(t,e){var n,i={};i.version=m.getUShort(t,e),u.argument(0===i.version,"cmap table version should be 0."),i.numTables=m.getUShort(t,e+2);var r=-1;for(n=i.numTables-1;0<=n;n-=1){var o=m.getUShort(t,e+4+8*n),s=m.getUShort(t,e+4+8*n+2);if(3===o&&(0===s||1===s||10===s)){r=m.getULong(t,e+4+8*n+4);break}}if(-1===r)return null;var a=new m.Parser(t,e+r);if(i.format=a.parseUShort(),12===i.format)l(i,a);else{if(4!==i.format)throw new Error("Only format 4 and 12 cmap tables are supported.");h(i,a,t,e,r)}return i},n.make=function(t){var e,n,i,r,o,s=new g.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(s.segments=[],e=0;e<t.length;e+=1){for(var a=t.get(e),u=0;u<a.unicodes.length;u+=1)i=s,r=a.unicodes[u],o=e,i.segments.push({end:r,start:r,delta:-(r-o),offset:0});s.segments=s.segments.sort(function(t,e){return t.start-e.start})}s.segments.push({end:65535,start:65535,delta:1,offset:0}),n=s.segments.length,s.segCountX2=2*n,s.searchRange=2*Math.pow(2,Math.floor(Math.log(n)/Math.log(2))),s.entrySelector=Math.log(s.searchRange/2)/Math.log(2),s.rangeShift=s.segCountX2-s.searchRange;var l=[],h=[],c=[],p=[],f=[];for(e=0;e<n;e+=1){var d=s.segments[e];l=l.concat({name:"end_"+e,type:"USHORT",value:d.end}),h=h.concat({name:"start_"+e,type:"USHORT",value:d.start}),c=c.concat({name:"idDelta_"+e,type:"SHORT",value:d.delta}),p=p.concat({name:"idRangeOffset_"+e,type:"USHORT",value:d.offset}),void 0!==d.glyphId&&(f=f.concat({name:"glyph_"+e,type:"USHORT",value:d.glyphId}))}return s.fields=s.fields.concat(l),s.fields.push({name:"reservedPad",type:"USHORT",value:0}),s.fields=s.fields.concat(h),s.fields=s.fields.concat(c),s.fields=s.fields.concat(p),s.fields=s.fields.concat(f),s.length=14+2*l.length+2+2*h.length+2*c.length+2*p.length+2*f.length,s}},{"../check":2,"../parse":10,"../table":13}],16:[function(t,e,n){var b=t("../check"),x=t("../parse"),l=t("../table");function h(t,e){var n=JSON.stringify(t),i=256;for(var r in e){var o=parseInt(r);if(o&&!(o<256)){if(JSON.stringify(e[r])===n)return o;i<=o&&(i=o+1)}}return e[i]=t,i}function c(t,e,n,i){for(var r=h(e.name,i),o=[{name:"nameID_"+t,type:"USHORT",value:r},{name:"flags_"+t,type:"USHORT",value:0}],s=0;s<n.length;++s){var a=n[s].tag;o.push({name:"axis_"+t+" "+a,type:"FIXED",value:e.coordinates[a]<<16})}return o}function E(t,e,n,i){var r={},o=new x.Parser(t,e);r.name=i[o.parseUShort()]||{},o.skip("uShort",1),r.coordinates={};for(var s=0;s<n.length;++s)r.coordinates[n[s].tag]=o.parseFixed();return r}n.make=function(t,e){var n,i,r,o,s=new l.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:t.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:t.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*t.axes.length}]);s.offsetToData=s.sizeOf();for(var a=0;a<t.axes.length;a++)s.fields=s.fields.concat((n=a,i=t.axes[a],r=e,o=h(i.name,r),[{name:"tag_"+n,type:"TAG",value:i.tag},{name:"minValue_"+n,type:"FIXED",value:i.minValue<<16},{name:"defaultValue_"+n,type:"FIXED",value:i.defaultValue<<16},{name:"maxValue_"+n,type:"FIXED",value:i.maxValue<<16},{name:"flags_"+n,type:"USHORT",value:0},{name:"nameID_"+n,type:"USHORT",value:o}]));for(var u=0;u<t.instances.length;u++)s.fields=s.fields.concat(c(u,t.instances[u],t.axes,e));return s},n.parse=function(t,e,n){var i=new x.Parser(t,e),r=i.parseULong();b.argument(65536===r,"Unsupported fvar table version.");var o,s,a,u,l,h=i.parseOffset16();i.skip("uShort",1);for(var c=i.parseUShort(),p=i.parseUShort(),f=i.parseUShort(),d=i.parseUShort(),g=[],y=0;y<c;y++)g.push((o=t,s=e+h+y*p,a=n,l=u=void 0,u={},l=new x.Parser(o,s),u.tag=l.parseTag(),u.minValue=l.parseFixed(),u.defaultValue=l.parseFixed(),u.maxValue=l.parseFixed(),l.skip("uShort",1),u.name=a[l.parseUShort()]||{},u));for(var _=[],m=e+h+c*p,v=0;v<f;v++)_.push(E(t,m+v*d,g,n));return{axes:g,instances:_}}},{"../check":2,"../parse":10,"../table":13}],17:[function(t,e,n){var _=t("../check"),u=t("../glyphset"),m=t("../parse"),f=t("../path");function v(t,e,n,i,r){var o;return o=0<(e&i)?(o=t.parseByte(),0==(e&r)&&(o=-o),n+o):0<(e&r)?n:n+t.parseShort()}function l(t,e,n){var i,r,o=new m.Parser(e,n);if(t.numberOfContours=o.parseShort(),t._xMin=o.parseShort(),t._yMin=o.parseShort(),t._xMax=o.parseShort(),t._yMax=o.parseShort(),0<t.numberOfContours){var s,a=t.endPointIndices=[];for(s=0;s<t.numberOfContours;s+=1)a.push(o.parseUShort());for(t.instructionLength=o.parseUShort(),t.instructions=[],s=0;s<t.instructionLength;s+=1)t.instructions.push(o.parseByte());var u=a[a.length-1]+1;for(i=[],s=0;s<u;s+=1)if(r=o.parseByte(),i.push(r),0<(8&r))for(var l=o.parseByte(),h=0;h<l;h+=1)i.push(r),s+=1;if(_.argument(i.length===u,"Bad flags."),0<a.length){var c,p=[];if(0<u){for(s=0;s<u;s+=1)r=i[s],(c={}).onCurve=!!(1&r),c.lastPointOfContour=0<=a.indexOf(s),p.push(c);var f=0;for(s=0;s<u;s+=1)r=i[s],(c=p[s]).x=v(o,r,f,2,16),f=c.x;var d=0;for(s=0;s<u;s+=1)r=i[s],(c=p[s]).y=v(o,r,d,4,32),d=c.y}t.points=p}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var g=!0;g;){i=o.parseUShort();var y={glyphIndex:o.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};0<(1&i)?0<(2&i)?(y.dx=o.parseShort(),y.dy=o.parseShort()):y.matchedPoints=[o.parseUShort(),o.parseUShort()]:0<(2&i)?(y.dx=o.parseChar(),y.dy=o.parseChar()):y.matchedPoints=[o.parseByte(),o.parseByte()],0<(8&i)?y.xScale=y.yScale=o.parseF2Dot14():0<(64&i)?(y.xScale=o.parseF2Dot14(),y.yScale=o.parseF2Dot14()):0<(128&i)&&(y.xScale=o.parseF2Dot14(),y.scale01=o.parseF2Dot14(),y.scale10=o.parseF2Dot14(),y.yScale=o.parseF2Dot14()),t.components.push(y),g=!!(32&i)}}}function h(t,e){for(var n=[],i=0;i<t.length;i+=1){var r=t[i],o={x:e.xScale*r.x+e.scale01*r.y+e.dx,y:e.scale10*r.x+e.yScale*r.y+e.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};n.push(o)}return n}function c(t){var e=new f.Path;if(!t)return e;for(var n=function(t){for(var e=[],n=[],i=0;i<t.length;i+=1){var r=t[i];n.push(r),r.lastPointOfContour&&(e.push(n),n=[])}return _.argument(0===n.length,"There are still points left in the current contour."),e}(t),i=0;i<n.length;i+=1){var r,o,s=n[i],a=s[0],u=s[s.length-1];o=a.onCurve?!(r=null):(a=u.onCurve?u:{x:(a.x+u.x)/2,y:(a.y+u.y)/2},r=a,!1),e.moveTo(a.x,a.y);for(var l=o?1:0;l<s.length;l+=1){var h=s[l],c=0===l?a:s[l-1];if(c.onCurve&&h.onCurve)e.lineTo(h.x,h.y);else if(c.onCurve&&!h.onCurve)r=h;else if(c.onCurve||h.onCurve){if(c.onCurve||!h.onCurve)throw new Error("Invalid state.");e.quadraticCurveTo(r.x,r.y,h.x,h.y),r=null}else{var p={x:(c.x+h.x)/2,y:(c.y+h.y)/2};e.quadraticCurveTo(c.x,c.y,p.x,p.y),r=h}}a!==u&&(r?e.quadraticCurveTo(r.x,r.y,a.x,a.y):e.lineTo(a.x,a.y))}return e.closePath(),e}function p(t,e){if(e.isComposite)for(var n=0;n<e.components.length;n+=1){var i=e.components[n],r=t.get(i.glyphIndex);if(r.getPath(),r.points){var o;if(void 0===i.matchedPoints)o=h(r.points,i);else{if(i.matchedPoints[0]>e.points.length-1||i.matchedPoints[1]>r.points.length-1)throw Error("Matched points out of range in "+e.name);var s=e.points[i.matchedPoints[0]],a=r.points[i.matchedPoints[1]],u={xScale:i.xScale,scale01:i.scale01,scale10:i.scale10,yScale:i.yScale,dx:0,dy:0};a=h([a],u)[0],u.dx=s.x-a.x,u.dy=s.y-a.y,o=h(r.points,u)}e.points=e.points.concat(o)}}return c(e.points)}n.parse=function(t,e,n,i){var r,o=new u.GlyphSet(i);for(r=0;r<n.length-1;r+=1){var s=n[r],a=n[r+1];s!==a?o.push(r,u.ttfGlyphLoader(i,r,l,t,e+s,p)):o.push(r,u.glyphLoader(i,r))}return o}},{"../check":2,"../glyphset":7,"../parse":10,"../path":11}],18:[function(t,e,n){var c=t("../check"),P=t("../parse");function p(t,e){for(var n=new P.Parser(t,e),i=n.parseUShort(),r=[],o=0;o<i;o++)r[n.parseTag()]={offset:n.parseUShort()};return r}function N(t,e){var n=new P.Parser(t,e),i=n.parseUShort();if(1===i){var r=n.parseUShort(),o=n.parseUShort(),s=n.parseUShortList(o);return function(t){return s[t-r]||0}}if(2===i){for(var a=n.parseUShort(),u=[],l=[],h=[],c=0;c<a;c++)u[c]=n.parseUShort(),l[c]=n.parseUShort(),h[c]=n.parseUShort();return function(t){for(var e=0,n=u.length-1;e<n;){var i=e+n+1>>1;t<u[i]?n=i-1:e=i}return u[e]<=t&&t<=l[e]&&h[e]||0}}}function f(t,e){var n,i=new P.Parser(t,e),r=i.parseUShort(),o=i.parseUShort(),s=function(t,e){var n=new P.Parser(t,e),i=n.parseUShort(),r=n.parseUShort();if(1===i)return n.parseUShortList(r);if(2===i){for(var o=[];r--;)for(var s=n.parseUShort(),a=n.parseUShort(),u=n.parseUShort(),l=s;l<=a;l++)o[u++]=l;return o}}(t,e+o),a=i.parseUShort(),u=i.parseUShort();if(4===a&&0===u){var l={};if(1===r){for(var h=i.parseUShort(),c=[],p=i.parseOffset16List(h),f=0;f<h;f++){var d=p[f],g=l[d];if(!g){g={},i.relativeOffset=d;for(var y=i.parseUShort();y--;){var _=i.parseUShort();a&&(n=i.parseShort()),u&&i.parseShort(),g[_]=n}}c[s[f]]=g}return function(t,e){var n=c[t];if(n)return n[e]}}if(2===r){for(var m=i.parseUShort(),v=i.parseUShort(),b=i.parseUShort(),x=i.parseUShort(),E=N(t,e+m),w=N(t,e+v),I=[],L=0;L<b;L++)for(var S=I[L]=[],M=0;M<x;M++)a&&(n=i.parseShort()),u&&i.parseShort(),S[M]=n;var C={};for(L=0;L<s.length;L++)C[s[L]]=1;return function(t,e){if(C[t]){var n=E(t),i=w(e),r=I[n];return r?r[i]:void 0}}}}}function d(t,e){var n=new P.Parser(t,e),i=n.parseUShort(),r=n.parseUShort(),o=16&r,s=n.parseUShort(),a=n.parseOffset16List(s),u={lookupType:i,lookupFlag:r,markFilteringSet:o?n.parseUShort():-1};if(2===i){for(var l=[],h=0;h<s;h++)l.push(f(t,e+a[h]));u.getKerningValue=function(t,e){for(var n=l.length;n--;){var i=l[n](t,e);if(void 0!==i)return i}return 0}}return u}n.parse=function(t,e,n){var i=new P.Parser(t,e),r=i.parseFixed();c.argument(1===r,"Unsupported GPOS table version."),p(t,e+i.parseUShort()),p(t,e+i.parseUShort());var o=i.parseUShort();i.relativeOffset=o;for(var s=i.parseUShort(),a=i.parseOffset16List(s),u=e+o,l=0;l<s;l++){var h=d(t,u+a[l]);2!==h.lookupType||n.getGposKerningValue||(n.getGposKerningValue=h.getKerningValue)}}},{"../check":2,"../parse":10}],19:[function(t,e,n){var r=t("../check"),o=t("../parse").Parser,s=new Array(9),i=t("../table");s[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(o.coverage),deltaGlyphId:this.parseUShort()}:2===e?{substFormat:2,coverage:this.parsePointer(o.coverage),substitute:this.parseOffset16List()}:void r.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")},s[2]=function(){var t=this.parseUShort();return r.argument(1===t,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(o.coverage),sequences:this.parseListOfLists()}},s[3]=function(){var t=this.parseUShort();return r.argument(1===t,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(o.coverage),alternateSets:this.parseListOfLists()}},s[4]=function(){var t=this.parseUShort();return r.argument(1===t,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(o.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var a={sequenceIndex:o.uShort,lookupListIndex:o.uShort};s[5]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{substFormat:e,coverage:this.parsePointer(o.coverage),ruleSets:this.parseListOfLists(function(){var t=this.parseUShort(),e=this.parseUShort();return{input:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,a)}})};if(2===e)return{substFormat:e,coverage:this.parsePointer(o.coverage),classDef:this.parsePointer(o.classDef),classSets:this.parseListOfLists(function(){var t=this.parseUShort(),e=this.parseUShort();return{classes:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,a)}})};if(3===e){var n=this.parseUShort(),i=this.parseUShort();return{substFormat:e,coverages:this.parseList(n,o.pointer(o.coverage)),lookupRecords:this.parseRecordList(i,a)}}r.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},s[6]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(o.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(a)}})}:2===e?{substFormat:2,coverage:this.parsePointer(o.coverage),backtrackClassDef:this.parsePointer(o.classDef),inputClassDef:this.parsePointer(o.classDef),lookaheadClassDef:this.parsePointer(o.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(a)}})}:3===e?{substFormat:3,backtrackCoverage:this.parseList(o.pointer(o.coverage)),inputCoverage:this.parseList(o.pointer(o.coverage)),lookaheadCoverage:this.parseList(o.pointer(o.coverage)),lookupRecords:this.parseRecordList(a)}:void r.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},s[7]=function(){var t=this.parseUShort();r.argument(1===t,"GSUB Extension Substitution subtable identifier-format must be 1");var e=this.parseUShort(),n=new o(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:e,extension:s[e].call(n)}},s[8]=function(){var t=this.parseUShort();return r.argument(1===t,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(o.coverage),backtrackCoverage:this.parseList(o.pointer(o.coverage)),lookaheadCoverage:this.parseList(o.pointer(o.coverage)),substitutes:this.parseUShortList()}};var u=new Array(9);u[1]=function(t){return 1===t.substFormat?new i.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new i.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new i.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new i.Coverage(t.coverage)}].concat(i.ushortList("substitute",t.substitute)))},u[3]=function(t){return r.assert(1===t.substFormat,"Lookup type 3 substFormat must be 1."),new i.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new i.Coverage(t.coverage)}].concat(i.tableList("altSet",t.alternateSets,function(t){return new i.Table("alternateSetTable",i.ushortList("alternate",t))})))},u[4]=function(t){return r.assert(1===t.substFormat,"Lookup type 4 substFormat must be 1."),new i.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new i.Coverage(t.coverage)}].concat(i.tableList("ligSet",t.ligatureSets,function(t){return new i.Table("ligatureSetTable",i.tableList("ligature",t,function(t){return new i.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:t.ligGlyph}].concat(i.ushortList("component",t.components,t.components.length+1)))}))})))},n.parse=function(t,e){var n=new o(t,e=e||0),i=n.parseVersion();return r.argument(1===i,"Unsupported GSUB table version."),{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(s)}},n.make=function(t){return new i.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new i.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new i.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new i.LookupList(t.lookups,u)}])}},{"../check":2,"../parse":10,"../table":13}],20:[function(t,e,n){var r=t("../check"),o=t("../parse"),i=t("../table");n.parse=function(t,e){var n={},i=new o.Parser(t,e);return n.version=i.parseVersion(),n.fontRevision=Math.round(1e3*i.parseFixed())/1e3,n.checkSumAdjustment=i.parseULong(),n.magicNumber=i.parseULong(),r.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=i.parseUShort(),n.unitsPerEm=i.parseUShort(),n.created=i.parseLongDateTime(),n.modified=i.parseLongDateTime(),n.xMin=i.parseShort(),n.yMin=i.parseShort(),n.xMax=i.parseShort(),n.yMax=i.parseShort(),n.macStyle=i.parseUShort(),n.lowestRecPPEM=i.parseUShort(),n.fontDirectionHint=i.parseShort(),n.indexToLocFormat=i.parseShort(),n.glyphDataFormat=i.parseShort(),n},n.make=function(t){var e=Math.round((new Date).getTime()/1e3)+2082844800,n=e;return t.createdTimestamp&&(n=t.createdTimestamp+2082844800),new i.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}},{"../check":2,"../parse":10,"../table":13}],21:[function(t,e,n){var r=t("../parse"),i=t("../table");n.parse=function(t,e){var n={},i=new r.Parser(t,e);return n.version=i.parseVersion(),n.ascender=i.parseShort(),n.descender=i.parseShort(),n.lineGap=i.parseShort(),n.advanceWidthMax=i.parseUShort(),n.minLeftSideBearing=i.parseShort(),n.minRightSideBearing=i.parseShort(),n.xMaxExtent=i.parseShort(),n.caretSlopeRise=i.parseShort(),n.caretSlopeRun=i.parseShort(),n.caretOffset=i.parseShort(),i.relativeOffset+=8,n.metricDataFormat=i.parseShort(),n.numberOfHMetrics=i.parseUShort(),n},n.make=function(t){return new i.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}},{"../parse":10,"../table":13}],22:[function(t,e,n){var h=t("../parse"),s=t("../table");n.parse=function(t,e,n,i,r){for(var o,s,a=new h.Parser(t,e),u=0;u<i;u+=1){u<n&&(o=a.parseUShort(),s=a.parseShort());var l=r.get(u);l.advanceWidth=o,l.leftSideBearing=s}},n.make=function(t){for(var e=new s.Table("hmtx",[]),n=0;n<t.length;n+=1){var i=t.get(n),r=i.advanceWidth||0,o=i.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:r}),e.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:o})}return e}},{"../parse":10,"../table":13}],23:[function(t,e,n){var c=t("../check"),p=t("../parse");n.parse=function(t,e){var n={},i=new p.Parser(t,e),r=i.parseUShort();c.argument(0===r,"Unsupported kern table version."),i.skip("uShort",1);var o=i.parseUShort();c.argument(0===o,"Unsupported kern sub-table version."),i.skip("uShort",2);var s=i.parseUShort();i.skip("uShort",3);for(var a=0;a<s;a+=1){var u=i.parseUShort(),l=i.parseUShort(),h=i.parseShort();n[u+","+l]=h}return n}},{"../check":2,"../parse":10}],24:[function(t,e,n){var l=t("../parse");n.parse=function(t,e,n,i){for(var r=new l.Parser(t,e),o=i?r.parseUShort:r.parseULong,s=[],a=0;a<n+1;a+=1){var u=o.call(r);i&&(u*=2),s.push(u)}return s}},{"../parse":10}],25:[function(t,e,n){var c=t("../check"),p=t("../parse"),s=t("../table");n.make=function(t){for(var e=new s.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:t.length}]),n="",i=12+4*t.length,r=0;r<t.length;++r){var o=n.indexOf(t[r]);o<0&&(o=n.length,n+=t[r]),e.fields.push({name:"offset "+r,type:"USHORT",value:i+o}),e.fields.push({name:"length "+r,type:"USHORT",value:t[r].length})}return e.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),e},n.parse=function(t,e){var n=new p.Parser(t,e),i=n.parseULong();c.argument(1===i,"Unsupported ltag table version."),n.skip("uLong",1);for(var r=n.parseULong(),o=[],s=0;s<r;s++){for(var a="",u=e+n.parseUShort(),l=n.parseUShort(),h=u;h<u+l;++h)a+=String.fromCharCode(t.getInt8(h));o.push(a)}return o}},{"../check":2,"../parse":10,"../table":13}],26:[function(t,e,n){var r=t("../parse"),i=t("../table");n.parse=function(t,e){var n={},i=new r.Parser(t,e);return n.version=i.parseVersion(),n.numGlyphs=i.parseUShort(),1===n.version&&(n.maxPoints=i.parseUShort(),n.maxContours=i.parseUShort(),n.maxCompositePoints=i.parseUShort(),n.maxCompositeContours=i.parseUShort(),n.maxZones=i.parseUShort(),n.maxTwilightPoints=i.parseUShort(),n.maxStorage=i.parseUShort(),n.maxFunctionDefs=i.parseUShort(),n.maxInstructionDefs=i.parseUShort(),n.maxStackElements=i.parseUShort(),n.maxSizeOfInstructions=i.parseUShort(),n.maxComponentElements=i.parseUShort(),n.maxComponentDepth=i.parseUShort()),n},n.make=function(t){return new i.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}},{"../parse":10,"../table":13}],27:[function(t,e,n){var i=t("../types"),c=i.decode,p=t("../check"),f=t("../parse"),a=t("../table");n.parse=function(t,e){var n=new f.Parser(t,e),i=n.parseULong();p.argument(1===i,"Unsupported META table version."),n.parseULong(),n.parseULong();for(var r=n.parseULong(),o={},s=0;s<r;s++){var a=n.parseTag(),u=n.parseULong(),l=n.parseULong(),h=c.UTF8(t,e+u,l);o[a]=h}return o},n.make=function(t){var e=Object.keys(t).length,n="",i=16+12*e,r=new a.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:e}]);for(var o in t){var s=n.length;n+=t[o],r.fields.push({name:"tag "+o,type:"TAG",value:o}),r.fields.push({name:"offset "+o,type:"ULONG",value:i+s}),r.fields.push({name:"length "+o,type:"ULONG",value:t[o].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),r}},{"../check":2,"../parse":10,"../table":13,"../types":32}],28:[function(t,e,n){var i=t("../types"),b=i.decode,M=i.encode,x=t("../parse"),C=t("../table"),P=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],N={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},O={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},T={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function E(t,e,n){switch(t){case 0:if(65535===e)return"und";if(n)return n[e];break;case 1:return N[e];case 3:return T[e]}}var w="utf-16",r={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},o={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function R(t,e,n){switch(t){case 0:return w;case 1:return o[n]||r[e];case 3:if(1===e||10===e)return w}}function k(t){var e={};for(var n in t)e[t[n]]=parseInt(n);return e}function D(t,e,n,i,r,o){return new C.Record("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:o}])}function A(t,e){var n=function(t,e){var n=t.length,i=e.length-n+1;t:for(var r=0;r<i;r++)for(;r<i;r++){for(var o=0;o<n;o++)if(e[r+o]!==t[o])continue t;return r}return-1}(t,e);if(n<0){n=e.length;for(var i=0,r=t.length;i<r;++i)e.push(t[i])}return n}n.parse=function(t,e,n){for(var i={},r=new x.Parser(t,e),o=r.parseUShort(),s=r.parseUShort(),a=r.offset+r.parseUShort(),u=0;u<s;u++){var l,h=r.parseUShort(),c=r.parseUShort(),p=r.parseUShort(),f=r.parseUShort(),d=P[f]||f,g=r.parseUShort(),y=r.parseUShort(),_=E(h,p,n),m=R(h,c,p);if(void 0!==m&&void 0!==_&&(l=m===w?b.UTF16(t,a+y,g):b.MACSTRING(t,a+y,g,m))){var v=i[d];void 0===v&&(v=i[d]={}),v[_]=l}}return 1===o&&r.parseUShort(),i},n.make=function(t,e){var n,i=[],r={},o=k(P);for(var s in t){var a=o[s];if(void 0===a&&(a=s),n=parseInt(a),isNaN(n))throw new Error('Name table entry "'+s+'" does not exist, see nameTableNames for complete list.');r[n]=t[s],i.push(n)}for(var u=k(N),l=k(T),h=[],c=[],p=0;p<i.length;p++){n=i[p];var f=r[n];for(var d in f){var g=f[d],y=1,_=u[d],m=O[_],v=R(y,m,_),b=M.MACSTRING(g,v);void 0===b&&(y=0,(_=e.indexOf(d))<0&&(_=e.length,e.push(d)),m=4,b=M.UTF16(g));var x=A(b,c);h.push(D(y,m,_,n,b.length,x));var E=l[d];if(void 0!==E){var w=M.UTF16(g),I=A(w,c);h.push(D(3,1,E,n,w.length,I))}}}h.sort(function(t,e){return t.platformID-e.platformID||t.encodingID-e.encodingID||t.languageID-e.languageID||t.nameID-e.nameID});for(var L=new C.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:h.length},{name:"stringOffset",type:"USHORT",value:6+12*h.length}]),S=0;S<h.length;S++)L.fields.push({name:"record_"+S,type:"RECORD",value:h[S]});return L.fields.push({name:"strings",type:"LITERAL",value:c}),L}},{"../parse":10,"../table":13,"../types":32}],29:[function(t,e,n){var o=t("../parse"),i=t("../table"),r=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];n.unicodeRanges=r,n.getUnicodeRange=function(t){for(var e=0;e<r.length;e+=1){var n=r[e];if(t>=n.begin&&t<n.end)return e}return-1},n.parse=function(t,e){var n={},i=new o.Parser(t,e);n.version=i.parseUShort(),n.xAvgCharWidth=i.parseShort(),n.usWeightClass=i.parseUShort(),n.usWidthClass=i.parseUShort(),n.fsType=i.parseUShort(),n.ySubscriptXSize=i.parseShort(),n.ySubscriptYSize=i.parseShort(),n.ySubscriptXOffset=i.parseShort(),n.ySubscriptYOffset=i.parseShort(),n.ySuperscriptXSize=i.parseShort(),n.ySuperscriptYSize=i.parseShort(),n.ySuperscriptXOffset=i.parseShort(),n.ySuperscriptYOffset=i.parseShort(),n.yStrikeoutSize=i.parseShort(),n.yStrikeoutPosition=i.parseShort(),n.sFamilyClass=i.parseShort(),n.panose=[];for(var r=0;r<10;r++)n.panose[r]=i.parseByte();return n.ulUnicodeRange1=i.parseULong(),n.ulUnicodeRange2=i.parseULong(),n.ulUnicodeRange3=i.parseULong(),n.ulUnicodeRange4=i.parseULong(),n.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),n.fsSelection=i.parseUShort(),n.usFirstCharIndex=i.parseUShort(),n.usLastCharIndex=i.parseUShort(),n.sTypoAscender=i.parseShort(),n.sTypoDescender=i.parseShort(),n.sTypoLineGap=i.parseShort(),n.usWinAscent=i.parseUShort(),n.usWinDescent=i.parseUShort(),1<=n.version&&(n.ulCodePageRange1=i.parseULong(),n.ulCodePageRange2=i.parseULong()),2<=n.version&&(n.sxHeight=i.parseShort(),n.sCapHeight=i.parseShort(),n.usDefaultChar=i.parseUShort(),n.usBreakChar=i.parseUShort(),n.usMaxContent=i.parseUShort()),n},n.make=function(t){return new i.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)}},{"../parse":10,"../table":13}],30:[function(t,e,n){var s=t("../encoding"),a=t("../parse"),i=t("../table");n.parse=function(t,e){var n,i={},r=new a.Parser(t,e);switch(i.version=r.parseVersion(),i.italicAngle=r.parseFixed(),i.underlinePosition=r.parseShort(),i.underlineThickness=r.parseShort(),i.isFixedPitch=r.parseULong(),i.minMemType42=r.parseULong(),i.maxMemType42=r.parseULong(),i.minMemType1=r.parseULong(),i.maxMemType1=r.parseULong(),i.version){case 1:i.names=s.standardNames.slice();break;case 2:for(i.numberOfGlyphs=r.parseUShort(),i.glyphNameIndex=new Array(i.numberOfGlyphs),n=0;n<i.numberOfGlyphs;n++)i.glyphNameIndex[n]=r.parseUShort();for(i.names=[],n=0;n<i.numberOfGlyphs;n++)if(i.glyphNameIndex[n]>=s.standardNames.length){var o=r.parseChar();i.names.push(r.parseString(o))}break;case 2.5:for(i.numberOfGlyphs=r.parseUShort(),i.offset=new Array(i.numberOfGlyphs),n=0;n<i.numberOfGlyphs;n++)i.offset[n]=r.parseChar()}return i},n.make=function(){return new i.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},{"../encoding":4,"../parse":10,"../table":13}],31:[function(t,e,n){var h=t("../check"),c=t("../table"),z=t("./cmap"),V=t("./cff"),Y=t("./head"),H=t("./hhea"),X=t("./hmtx"),W=t("./ltag"),J=t("./maxp"),K=t("./name"),Z=t("./os2"),Q=t("./post"),$=t("./gsub"),tt=t("./meta");function p(t){return Math.log(t)/Math.log(2)|0}function et(t){for(;t.length%4!=0;)t.push(0);for(var e=0,n=0;n<t.length;n+=4)e+=(t[n]<<24)+(t[n+1]<<16)+(t[n+2]<<8)+t[n+3];return e%=Math.pow(2,32)}function f(t,e,n,i){return new c.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==i?i:0}])}function nt(t){var e=new c.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var n=Math.pow(2,p(e.numTables));e.searchRange=16*n,e.entrySelector=p(n),e.rangeShift=16*e.numTables-e.searchRange;for(var i=[],r=[],o=e.sizeOf()+f().sizeOf()*e.numTables;o%4!=0;)o+=1,r.push({name:"padding",type:"BYTE",value:0});for(var s=0;s<t.length;s+=1){var a=t[s];h.argument(4===a.tableName.length,"Table name"+a.tableName+" is invalid.");var u=a.sizeOf(),l=f(a.tableName,et(a.encode()),o,u);for(i.push({name:l.tag+" Table Record",type:"RECORD",value:l}),r.push({name:a.tableName+" table",type:"RECORD",value:a}),o+=u,h.argument(!isNaN(o),"Something went wrong calculating the offset.");o%4!=0;)o+=1,r.push({name:"padding",type:"BYTE",value:0})}return i.sort(function(t,e){return t.value.tag>e.value.tag?1:-1}),e.fields=e.fields.concat(i),e.fields=e.fields.concat(r),e}function it(t,e,n){for(var i=0;i<e.length;i+=1){var r=t.charToGlyphIndex(e[i]);if(0<r){var o=t.glyphs.get(r);return o.getMetrics()}}return n}function rt(t){for(var e=0,n=0;n<t.length;n+=1)e+=t[n];return e/t.length}n.computeCheckSum=et,n.make=nt,n.fontToTable=function(t){for(var e,n=[],i=[],r=[],o=[],s=[],a=[],u=[],l=0,h=0,c=0,p=0,f=0,d=0;d<t.glyphs.length;d+=1){var g=t.glyphs.get(d),y=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+d+"): advanceWidth is not a number.");(y<e||void 0===e)&&0<y&&(e=y),l<y&&(l=y);var _=Z.getUnicodeRange(y);if(_<32)h|=1<<_;else if(_<64)c|=1<<_-32;else if(_<96)p|=1<<_-64;else{if(!(_<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");f|=1<<_-96}if(".notdef"!==g.name){var m=g.getMetrics();n.push(m.xMin),i.push(m.yMin),r.push(m.xMax),o.push(m.yMax),a.push(m.leftSideBearing),u.push(m.rightSideBearing),s.push(g.advanceWidth)}}var v={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,s),advanceWidthAvg:rt(s),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,u)};v.ascender=t.ascender,v.descender=t.descender;var b=Y.make({flags:3,unitsPerEm:t.unitsPerEm,xMin:v.xMin,yMin:v.yMin,xMax:v.xMax,yMax:v.yMax,lowestRecPPEM:3,createdTimestamp:t.createdTimestamp}),x=H.make({ascender:v.ascender,descender:v.descender,advanceWidthMax:v.advanceWidthMax,minLeftSideBearing:v.minLeftSideBearing,minRightSideBearing:v.minRightSideBearing,xMaxExtent:v.maxLeftSideBearing+(v.xMax-v.xMin),numberOfHMetrics:t.glyphs.length}),E=J.make(t.glyphs.length),w=Z.make({xAvgCharWidth:Math.round(v.advanceWidthAvg),usWeightClass:t.tables.os2.usWeightClass,usWidthClass:t.tables.os2.usWidthClass,usFirstCharIndex:e,usLastCharIndex:l,ulUnicodeRange1:h,ulUnicodeRange2:c,ulUnicodeRange3:p,ulUnicodeRange4:f,fsSelection:t.tables.os2.fsSelection,sTypoAscender:v.ascender,sTypoDescender:v.descender,sTypoLineGap:0,usWinAscent:v.yMax,usWinDescent:Math.abs(v.yMin),ulCodePageRange1:1,sxHeight:it(t,"xyvw",{yMax:Math.round(v.ascender/2)}).yMax,sCapHeight:it(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",v).yMax,usDefaultChar:t.hasChar(" ")?32:0,usBreakChar:t.hasChar(" ")?32:0}),I=X.make(t.glyphs),L=z.make(t.glyphs),S=t.getEnglishName("fontFamily"),M=t.getEnglishName("fontSubfamily"),C=S+" "+M,P=t.getEnglishName("postScriptName");P||(P=S.replace(/\s/g,"")+"-"+M);var N={};for(var O in t.names)N[O]=t.names[O];N.uniqueID||(N.uniqueID={en:t.getEnglishName("manufacturer")+":"+C}),N.postScriptName||(N.postScriptName={en:P}),N.preferredFamily||(N.preferredFamily=t.names.fontFamily),N.preferredSubfamily||(N.preferredSubfamily=t.names.fontSubfamily);var T=[],R=K.make(N,T),k=0<T.length?W.make(T):void 0,D=Q.make(),A=V.make(t.glyphs,{version:t.getEnglishName("version"),fullName:C,familyName:S,weightName:M,postScriptName:P,unitsPerEm:t.unitsPerEm,fontBBox:[0,v.yMin,v.ascender,v.advanceWidthMax]}),F=t.metas&&0<Object.keys(t.metas).length?tt.make(t.metas):void 0,G=[b,x,E,w,R,L,D,A,I];k&&G.push(k),t.tables.gsub&&G.push($.make(t.tables.gsub)),F&&G.push(F);var B=nt(G),U=et(B.encode()),q=B.fields,j=!1;for(d=0;d<q.length;d+=1)if("head table"===q[d].name){q[d].value.checkSumAdjustment=2981146554-U,j=!0;break}if(j)return B;throw new Error("Could not find head table with checkSum to adjust.")}},{"../check":2,"../table":13,"./cff":14,"./cmap":15,"./gsub":19,"./head":20,"./hhea":21,"./hmtx":22,"./ltag":25,"./maxp":26,"./meta":27,"./name":28,"./os2":29,"./post":30}],32:[function(t,e,n){var p=t("./check"),i={},f={},a={};function r(t){return function(){return t}}f.BYTE=function(t){return p.argument(0<=t&&t<=255,"Byte value should be between 0 and 255."),[t]},a.BYTE=r(1),f.CHAR=function(t){return[t.charCodeAt(0)]},a.CHAR=r(1),f.CHARARRAY=function(t){for(var e=[],n=0;n<t.length;n+=1)e[n]=t.charCodeAt(n);return e},a.CHARARRAY=function(t){return t.length},f.USHORT=function(t){return[t>>8&255,255&t]},a.USHORT=r(2),f.SHORT=function(t){return 32768<=t&&(t=-(65536-t)),[t>>8&255,255&t]},a.SHORT=r(2),f.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},a.UINT24=r(3),f.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},a.ULONG=r(4),f.LONG=function(t){return 2147483648<=t&&(t=-(4294967296-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},a.LONG=r(4),f.FIXED=f.ULONG,a.FIXED=a.ULONG,f.FWORD=f.SHORT,a.FWORD=a.SHORT,f.UFWORD=f.USHORT,a.UFWORD=a.USHORT,f.LONGDATETIME=function(t){return[0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t]},a.LONGDATETIME=r(8),f.TAG=function(t){return p.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},a.TAG=r(4),f.Card8=f.BYTE,a.Card8=a.BYTE,f.Card16=f.USHORT,a.Card16=a.USHORT,f.OffSize=f.BYTE,a.OffSize=a.BYTE,f.SID=f.USHORT,a.SID=a.USHORT,f.NUMBER=function(t){return-107<=t&&t<=107?[t+139]:108<=t&&t<=1131?[247+((t-=108)>>8),255&t]:-1131<=t&&t<=-108?[251+((t=-t-108)>>8),255&t]:-32768<=t&&t<=32767?f.NUMBER16(t):f.NUMBER32(t)},a.NUMBER=function(t){return f.NUMBER(t).length},f.NUMBER16=function(t){return[28,t>>8&255,255&t]},a.NUMBER16=r(3),f.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},a.NUMBER32=r(5),f.REAL=function(t){var e=t.toString(),n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(n){var i=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));e=(Math.round(t*i)/i).toString()}var r,o,s="";for(r=0,o=e.length;r<o;r+=1){var a=e[r];s+="e"===a?"-"===e[++r]?"c":"b":"."===a?"a":"-"===a?"e":a}s+=1&s.length?"f":"ff";var u=[30];for(r=0,o=s.length;r<o;r+=2)u.push(parseInt(s.substr(r,2),16));return u},a.REAL=function(t){return f.REAL(t).length},f.NAME=f.CHARARRAY,a.NAME=a.CHARARRAY,f.STRING=f.CHARARRAY,a.STRING=a.CHARARRAY,i.UTF8=function(t,e,n){for(var i=[],r=n,o=0;o<r;o++,e+=1)i[o]=t.getUint8(e);return String.fromCharCode.apply(null,i)},i.UTF16=function(t,e,n){for(var i=[],r=n/2,o=0;o<r;o++,e+=2)i[o]=t.getUint16(e);return String.fromCharCode.apply(null,i)},f.UTF16=function(t){for(var e=[],n=0;n<t.length;n+=1){var i=t.charCodeAt(n);e[e.length]=i>>8&255,e[e.length]=255&i}return e},a.UTF16=function(t){return 2*t.length};var u={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};i.MACSTRING=function(t,e,n,i){var r=u[i];if(void 0!==r){for(var o="",s=0;s<n;s++){var a=t.getUint8(e+s);o+=a<=127?String.fromCharCode(a):r[127&a]}return o}};var l,h="function"==typeof WeakMap&&new WeakMap;f.MACSTRING=function(t,e){var n=function(t){if(!l)for(var e in l={},u)l[e]=new String(e);var n=l[t];if(void 0!==n){if(h){var i=h.get(n);if(void 0!==i)return i}var r=u[t];if(void 0!==r){for(var o={},s=0;s<r.length;s++)o[r.charCodeAt(s)]=s+128;return h&&h.set(n,o),o}}}(e);if(void 0!==n){for(var i=[],r=0;r<t.length;r++){var o=t.charCodeAt(r);if(128<=o&&void 0===(o=n[o]))return;i[r]=o}return i}},a.MACSTRING=function(t,e){var n=f.MACSTRING(t,e);return void 0!==n?n.length:0},f.INDEX=function(t){var e,n=1,i=[n],r=[];for(e=0;e<t.length;e+=1){var o=f.OBJECT(t[e]);Array.prototype.push.apply(r,o),n+=o.length,i.push(n)}if(0===r.length)return[0,0];var s=[],a=1+Math.floor(Math.log(n)/Math.log(2))/8|0,u=[void 0,f.BYTE,f.USHORT,f.UINT24,f.ULONG][a];for(e=0;e<i.length;e+=1){var l=u(i[e]);Array.prototype.push.apply(s,l)}return Array.prototype.concat(f.Card16(t.length),f.OffSize(a),s,r)},a.INDEX=function(t){return f.INDEX(t).length},f.DICT=function(t){for(var e=[],n=Object.keys(t),i=n.length,r=0;r<i;r+=1){var o=parseInt(n[r],0),s=t[o];e=(e=e.concat(f.OPERAND(s.value,s.type))).concat(f.OPERATOR(o))}return e},a.DICT=function(t){return f.DICT(t).length},f.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]},f.OPERAND=function(t,e){var n=[];if(Array.isArray(e))for(var i=0;i<e.length;i+=1)p.argument(t.length===e.length,"Not enough arguments given for type"+e),n=n.concat(f.OPERAND(t[i],e[i]));else if("SID"===e)n=n.concat(f.NUMBER(t));else if("offset"===e)n=n.concat(f.NUMBER32(t));else if("number"===e)n=n.concat(f.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);n=n.concat(f.REAL(t))}return n},f.OP=f.BYTE,a.OP=a.BYTE;var s="function"==typeof WeakMap&&new WeakMap;f.CHARSTRING=function(t){if(s){var e=s.get(t);if(void 0!==e)return e}for(var n=[],i=t.length,r=0;r<i;r+=1){var o=t[r];n=n.concat(f[o.type](o.value))}return s&&s.set(t,n),n},a.CHARSTRING=function(t){return f.CHARSTRING(t).length},f.OBJECT=function(t){var e=f[t.type];return p.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},a.OBJECT=function(t){var e=a[t.type];return p.argument(void 0!==e,"No sizeOf function for type "+t.type),e(t.value)},f.TABLE=function(t){var e,n=[],i=t.fields.length,r=[],o=[];for(e=0;e<i;e+=1){var s=t.fields[e],a=f[s.type];p.argument(void 0!==a,"No encoding function for field type "+s.type+" ("+s.name+")");var u=t[s.name];void 0===u&&(u=s.value);var l=a(u);"TABLE"===s.type?(o.push(n.length),n=n.concat([0,0]),r.push(l)):n=n.concat(l)}for(e=0;e<r.length;e+=1){var h=o[e],c=n.length;p.argument(c<65536,"Table "+t.tableName+" too big."),n[h]=c>>8,n[h+1]=255&c,n=n.concat(r[e])}return n},a.TABLE=function(t){for(var e=0,n=t.fields.length,i=0;i<n;i+=1){var r=t.fields[i],o=a[r.type];p.argument(void 0!==o,"No sizeOf function for field type "+r.type+" ("+r.name+")");var s=t[r.name];void 0===s&&(s=r.value),e+=o(s),"TABLE"===r.type&&(e+=2)}return e},f.RECORD=f.TABLE,a.RECORD=a.TABLE,f.LITERAL=function(t){return t},a.LITERAL=function(t){return t.length},n.decode=i,n.encode=f,n.sizeOf=a},{"./check":2}],33:[function(t,e,n){n.isBrowser=function(){return"undefined"!=typeof window},n.isNode=function(){return"undefined"==typeof window},n.nodeBufferToArrayBuffer=function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;++i)n[i]=t[i];return e},n.arrayBufferToNodeBuffer=function(t){for(var e=new Buffer(t.byteLength),n=new Uint8Array(t),i=0;i<e.length;++i)e[i]=n[i];return e},n.checkArgument=function(t,e){if(!t)throw e}},{}]},{},[9])(9)}),Kb={charCode:34,familyName:"ESRI Default Marker",glyphPaths:"",faceIndex:0},Zb=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Kb,t),e.class=kt,e}return d(n,Wb),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.charCode=t.char_code,this.options.familyName=t.font_file_name,this.options.glyphPaths=t.glyph_path,this.options.faceIndex=t.face_index}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.char_code=this.options.charCode,t.font_file_name=this.options.familyName,t.glyph_path=this.options.glyphPaths,t.face_index=this.options.faceIndex)}},{key:"getCharCode",value:function(){return this.options.charCode}},{key:"setCharCode",value:function(t){this.options.charCode=t}},{key:"drawPoint",value:function(t,e){if(t&&e&&this.isVisible()&&(this._fontPath||(this._fontPath=this._decodeGlyph()),this._fontPath)){var n=this.getSize(),i=this.getAngle(),r=this.getOffsetX(),o=this.getOffsetY();e.x+=r,e.y+=o,t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.translate(-e.x-n/2,-e.y-n/2);var s=this._getPath(this._fontPath.commands,e.x,e.y,n);this._drawPath(t,s);var a=this.getHalo();a&&a.hasHalo()&&this._drawHalo(t),t.fillStyle=this.getColor().getStrColor(),t.fill(),t.restore()}}},{key:"_decodeGlyph",value:function(){var t=null,e=this.options.glyphPaths;if(!e)return null;var n=atob(e),i=gt.char2buf(n);try{(t=new Jb.Path).unitsPerEm=256;var r=0,o=new DataView(i),s=o.getUint8(r);r++;for(var a=0;a<s;a++){var u=o.getUint8(r);r++;for(var l=0;l<u;l++){var h=o.getUint8(r);r++;var c=-1*o.getUint8(r);r++,0===l?t.moveTo(h,c):t.lineTo(h,c)}}}catch(t){throw Error(t)}return t}},{key:"_drawPath",value:function(t,e){t.beginPath();for(var n=e.commands,i=0;i<n.length;i+=1){var r=n[i];"M"===r.type?t.moveTo(r.x,r.y):"L"===r.type?t.lineTo(r.x,r.y):"C"===r.type?t.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):"Q"===r.type?t.quadraticCurveTo(r.x1,r.y1,r.x,r.y):"Z"===r.type&&t.closePath()}}},{key:"_getPath",value:function(t,e,n,i,r){e=void 0!==e?e:0,n=void 0!==n?n:0;for(var o=1/256*(i=void 0!==i?i:72),s=(r=void 0!==r?r:{xScale:1,yScale:1}).xScale*o,a=r.yScale*o,u=new Jb.Path,l=0;l<t.length;l+=1){var h=t[l];"M"===h.type?u.moveTo(e+h.x*s,n+-h.y*a):"L"===h.type?u.lineTo(e+h.x*s,n+-h.y*a):"Q"===h.type?u.quadraticCurveTo(e+h.x1*s,n+-h.y1*a,e+h.x*s,n+-h.y*a):"C"===h.type?u.curveTo(e+h.x1*s,n+-h.y1*a,e+h.x2*s,n+-h.y2*a,e+h.x*s,n+-h.y*a):"Z"===h.type&&u.closePath()}return u}}]),n}(),Qb={xOffset:0,yOffset:0,xInterval:0,yInterval:0,xScale:1,yScale:1,pattenAngle:0,imageUrl:""},$b=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(Qb,t),e.class=Xt,e}return d(n,Vi),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.xOffset=gt.poundToPixel(t.offset_x),this.options.yOffset=gt.poundToPixel(t.offset_y),this.options.xInterval=gt.poundToPixel(t.interval_x),this.options.yInterval=gt.poundToPixel(t.interval_y),this.options.xScale=t.scale_x,this.options.yScale=t.scale_y,this.options.pattenAngle=t.angle,this.options.imageUrl=t.image_url}},{key:"toJson",value:function(t){t&&(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.offset_x=gt.pixelToPound(this.options.xOffset),t.offset_y=gt.pixelToPound(this.options.yOffset),t.interval_x=gt.pixelToPound(this.options.xInterval),t.interval_y=gt.pixelToPound(this.options.yInterval),t.scale_x=this.options.xScale,t.scale_y=this.options.yScale,t.angle=this.options.pattenAngle,t.image_url=this.options.imageUrl)}},{key:"getOffsetX",value:function(){return this.options.xOffset}},{key:"setOffsetX",value:function(t){this.options.xOffset=t}},{key:"getOffsetY",value:function(){return this.options.yOffset}},{key:"setOffsetY",value:function(t){this.options.yOffset=t}},{key:"getIntervalX",value:function(){return this.options.xInterval}},{key:"setIntervalX",value:function(t){this.options.xInterval=t}},{key:"getIntervalY",value:function(){return this.options.yInterval}},{key:"setIntervalY",value:function(t){this.options.yInterval=t}},{key:"getScaleX",value:function(){return this.options.xScale}},{key:"setScaleX",value:function(t){this.options.xScale=t}},{key:"getScaleY",value:function(){return this.options.yScale}},{key:"setScaleY",value:function(t){this.options.yScale=t}},{key:"getPattenAngle",value:function(){return this.options.pattenAngle}},{key:"setPattenAngle",value:function(t){this.options.pattenAngle=t}},{key:"getImageUrl",value:function(){return this.options.imageUrl}},{key:"setImageUrl",value:function(t){this.options.imageUrl=t}},{key:"_drawGeometry",value:function(t,e){var n=this;if(t&&e&&this.isVisible())if(this._bitmap){var i=e.points,r=e.subCount,o=e.polyCount;if(o.length!==r)return;var s=0;t.beginPath();for(var a=null,u=0;u<r;u++){var l=o[u],h=i.slice(s,s+l);Si.drawPath(t,h),s+=l,a||(a=h[0])}this._fill(t,a);var c=this.getOutlineSymbol();this.hasOutline()&&c&&c.draw(t,[e])}else this._tempData||(this._tempData=[]),this._tempData.push({ctx:t,geometry:e}),this._loading||this._loadImg().then(function(){n._tempData&&0<n._tempData.length&&n._tempData.forEach(function(t){n._drawGeometry(t.ctx,t.geometry)})}).catch(function(){n._tempData=null})}},{key:"_loadImg",value:function(){var r=this;return this._loading=!0,new Promise(function(t,e){var n=r.getImageUrl();n||e();var i=new Image;i.onload=function(){r._bitmap=i,r._loading=!1,t()},i.onerror=function(){e()},i.src=n})}},{key:"_fill",value:function(t,e){var n=this._getFillPattern();if(n){var i=this.getOffsetX(),r=this.getOffsetY();t.save(),n=t.createPattern(n,"repeat"),t.fillStyle=n,t.translate(e.x-i,e.y-r),t.fill("evenodd"),t.setTransform(1,0,0,1,0,0),t.restore()}}},{key:"_getFillPattern",value:function(){if(this._fillPattern)return this._fillPattern;var t=this._bitmap;if(!t)return null;var e=this.getIntervalX(),n=this.getIntervalY(),i=this.getPattenAngle(),r=this.getScaleX(),o=this.getScaleY();r=r<=0?1:r,o=o<=0?1:o;var s=t.width*r,a=t.height*o;t=this._getScaleImg(t,s,a);var u=document.createElement("canvas"),l=s+e,h=a+n;u.width=l,u.height=h;var c=u.getContext("2d");c.rect(0,0,l-e,h-n),c.translate(s/2,a/2),c.rotate(i),c.translate(s/2,a/2);var p=c.createPattern(t,"repeat");return c.fillStyle=p,c.fill("evenodd"),this._fillPattern=u}},{key:"_getScaleImg",value:function(t,e,n){var i=document.createElement("canvas");return i.width=e,i.height=n,i.getContext("2d").drawImage(t,0,0,e,n),i}}]),n}(),tx={lineSymbol:null,lineInterval:8,lineOffset:0,lineAngle:45},ex=function(t){function n(t){h(this,n);var e=y(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.mergeOptions(tx,t),e.class=Ht,e}return d(n,Vi),c(n,[{key:"readJson",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"readJson",this).call(this,t),this.options.lineInterval=gt.poundToPixel(t.interval),this.options.lineOffset=gt.poundToPixel(t.offset),this.options.lineAngle=t.angle,t.line_symbol&&(this.options.lineSymbol=re.readFromJson(t.line_symbol))}},{key:"toJson",value:function(t){if(t)if(f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJson",this).call(this,t),t.interval=gt.pixelToPound(this.options.lineInterval),t.offset=gt.pixelToPound(this.options.lineOffset),t.angle=this.options.lineAngle,this.options.lineSymbol){var e={};this.options.lineSymbol.toJson(e),t.line_symbol=e}else t.line_symbol=null}},{key:"getLineSymbol",value:function(){return this.options.lineSymbol}},{key:"setLineSymbol",value:function(t){this.options.lineSymbol=t}},{key:"getLineInterval",value:function(){return this.options.lineInterval}},{key:"setLineInterval",value:function(t){this.options.lineInterval=t}},{key:"getLineOffset",value:function(){return this.options.lineOffset}},{key:"setLineOffset",value:function(t){this.options.lineOffset=t}},{key:"getLineAngle",value:function(){return this.options.lineAngle}},{key:"setLineAngle",value:function(t){this.options.lineAngle=t}},{key:"setColor",value:function(t){f(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"setColor",this).call(this,t),this.options.lineSymbol&&this.options.lineSymbol.setColor(t)}},{key:"_drawGeometry",value:function(t,e){if(t&&e&&this.isVisible()){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){var o=0;t.beginPath();for(var s=0;s<i;s++){var a=r[s],u=n.slice(o,o+a);Si.drawPath(t,u),o+=a}this._fill(t);var l=this.getOutlineSymbol();this.hasOutline()&&l&&l.draw(t,[e])}}}},{key:"_fill",value:function(t){var e=this.getLineAngle(),n=this._getFillPattern();n&&(t.save(),t.rotate(-1*e),n=t.createPattern(n,"repeat"),t.fillStyle=n,t.fill("evenodd"),t.restore())}},{key:"_getFillPattern",value:function(){var t=this.getLineSymbol();if(!t)return null;var e=t.getWidth(),n=this.lineInterval,i=document.createElement("canvas"),r=n,o=r;i.width=r,i.height=o;var s=i.getContext("2d"),a={x:0,y:e/2},u={x:r,y:e/2};return t.drawLine(s,[a,u]),i}}]),n}(),nx={},ix=function(t){function i(t){h(this,i);var e=y(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.mergeOptions(nx,t),e.class=jt,e.symbols=null,e}return d(i,Ni),c(i,[{key:"readJson",value:function(t){var n=this;(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"readJson",this).call(this,t),t.symbol_layer_list&&t.symbol_layer_list.length)&&t.symbol_layer_list.forEach(function(t){var e=re.readFromJson(t);e&&(n.symbols||(n.symbols=[]),n.symbols.push(e))})}},{key:"toJson",value:function(t){if(t)if(f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJson",this).call(this,t),this.symbols&&0<this.symbols.length){var n=[];this.symbols.forEach(function(t){if(t){var e={};t.toJson(e),n.push(e)}}),t.symbol_layer_list=n}else t.symbol_layer_list=null}},{key:"setColor",value:function(e){this.symbols&&0!==this.symbols.length&&(this.symbols.forEach(function(t){t&&!t.isLocked()&&t.setColor(e)}),f(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setColor",this).call(this,e))}},{key:"setWidth",value:function(t){if(this.symbols&&0!==this.symbols.length&&0!==t){var e=this.getWidth();if(0!==e){var n=t/e;this.symbols.forEach(function(t){t.setWidth(t.getWidth()*n)}),this.options.width=t}}}},{key:"getSymbols",value:function(){return this.symbols}},{key:"getSymbolLayer",value:function(t){return t<0||!this.symbols||this.symbols.length<=t?null:this.symbols[t]}},{key:"getSymbolLayerCount",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols.length:0}},{key:"draw",value:function(e,n){e&&n&&n.length&&this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.draw(e,n)})}},{key:"drawLine",value:function(e,n){!e||!n||n.length<2||this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.drawLine(e,n)})}}]),i}();re.readFromJson=function(t){if(!t||!t.class)return null;var e=null;switch(t.class){case Rt:e=new Ci;break;case kt:e=new Zb;break;case Dt:e=new Gb;break;case At:e=new bb;break;case Ft:e=new cb;break;case Gt:e=new Gi;break;case Bt:e=new kb;break;case Ut:e=new Hb;break;case qt:e=new Ab;break;case jt:e=new ix;break;case zt:e=new Hi;break;case Vt:e=new mb;break;case Yt:e=new Vb;break;case Ht:e=new ex;break;case Xt:e=new $b;break;case Wt:e=new fb;break;case Jt:e=new Bn}return e?(e.readJson(t),e):null},re.createDefaultSymbol=function(t){var e=null;switch(t){case Zt:e=new Ci;break;case Qt:e=new Gi;break;case $t:e=new Hi}return e};var rx=Object.freeze({Symbol:re,SimpleMarkerSymbol:Ci,PictureMarkerSymbol:Gb,ArrowMarkerSymbol:bb,CharMarkerSymbol:Zb,MultiLayerMarkerSymbol:cb,SimpleLineSymbol:Gi,CartoLineSymbol:kb,HashLineSymbol:Ab,MarkerLineSymbol:Hb,MultiLayerLineSymbol:ix,SimpleFillSymbol:Hi,PictureFillSymbol:$b,MarkerFillSymbol:Vb,LineFillSymbol:ex,GradientFillSymbol:mb,MultiLayerFillSymbol:fb,Geometry:_t,SimpleMarkerStyle:xi,Halo:Rn,RGBAColor:ne,TextSymbol:Bn}),ox=1,sx=2,ax=G.Evented.extend({options:{tolerance:4,style:{color:"#000000",weight:2,interactive:!1}},initialize:function(t,e){G.setOptions(this,e),this._map=t,this._enable=!1,this._feature=null,this._snapResult=null},enable:function(){this.disable(),this._enable=!0,this._map.on("mousemove",this._onMouseMove,this),this._map.on("moveend viewreset",this._onZoomEnd,this)},disable:function(){this._enable=!1,this._snapResult=null,this._map.off("mousemove",this._onMouseMove,this),this._clearRenderer()},_onZoomEnd:function(){this._snapResult=null,this._clearRenderer()},getSnapResult:function(){return this._snapResult},getSnapMapPoint:function(t,e,n){if(!t||!e)return null;n||(n=t.getProjInfo());var i=this._getMapZone(n),r=n.project(e),o=this._getSnapResultFromFeatures(r,[t],i),s=null;if(o){var a=o.points;if(1===a.length)s=a[0].clone();else if(2===a.length){var u=a[0],l=a[1],h=vt.getPointFoot(r.x,r.y,u.x,u.y,l.x,l.y);s=new G.Point(h.x,h.y)}}return s&&(o.snapPoint=s),o},getSnapNode:function(t,e,n,i){if(!t||!e)return null;n||(n=t.getProjInfo());var r=this._getMapZone(n,i),o=n.project(e),s=this._getSnapResultFromFeatures(o,[t],r,ox),a=null;if(s){var u=s.points;1===u.length&&(a=u[0].clone())}return a&&(s.snapPoint=a),s},_clearRenderer:function(){this._feature&&(this._map.removeLayer(this._feature),this._feature=null)},_onMouseMove:function(t){if(this._enable){var e=t.latlng,n=this._getSnapResult(e);this._snapResult=n,this._drawSnap(n)}},_drawSnap:function(t){if(this._clearRenderer(),t&&t.points&&t.points.length){var e=t.layerId,n=this._map.seManager.getLayerById(e);if(n&&n.getDataset()){var i=n.getDataset().getProjInfo(),r=t.points,o=[];r.forEach(function(t){o.push(i.unproject(t))}),1===o.length?this._feature=this._getCrossFeature(o[0]):this._feature=this._getPolylineFeature(o),this._map.addLayer(this._feature)}}},_getCrossFeature:function(t){var e=this._map.latLngToLayerPoint(t),n=new G.Point(e.x,e.y-5),i=new G.Point(e.x,e.y+5),r=new G.Point(e.x-5,e.y),o=new G.Point(e.x+5,e.y),s=this._map.layerPointToLatLng(n),a=this._map.layerPointToLatLng(i),u=this._map.layerPointToLatLng(r),l=this._map.layerPointToLatLng(o),h=new G.Polyline([s,a],this.options.style),c=new G.Polyline([u,l],this.options.style);return new G.LayerGroup([h,c],this.options.style)},_getPolylineFeature:function(t){return new G.Polyline(t,this.options.style)},_getSnapResult:function(t,e){var n=this._map.seManager.getVectorLayers(!0);if(!n||0===n.length)return null;for(var i=null,r=0;r<n.length;r++){var o=n[r];if(o&&o.getDataset()){var s=o.getDataset();if(s.hasFeatureData()){var a=s.getProjInfo(),u=this._getMapZone(a),l=a.project(t);if(i=this._getSnapResultFromFeatures(l,s.getFeatures(),u,e))return i.layerId=o.getID(),i}}}return i},bClickOnFeatures:function(t,e,n){if(!t||!e||0===e.length||!n)return!1;var i=n.getProjInfo(),r=this._getMapZone(i),o=i.project(t);return!!this._getSnapResultFromFeatures(o,e,r)},_getSnapResultFromFeatures:function(t,e,n,i){if(!t||!e||0===e.length)return null;i||(i=ox|sx);for(var r=e.length,o=null,s=0;s<r;s++){var a=e[s];if(a)switch(a.getType()){case xt.POINT:if(0==(i&ox))continue;var u=a.getMapPoints();if(!u||0===u.length)continue;for(var l=0;l<u.length;l++){var h=u[l];if(vt.isPointInPoint(h.x,h.y,t.x,t.y,n))return o={featureId:a.getID(),points:[h],pointIndex:l}}break;case xt.LINE:case xt.POLYGON:if(o=this._getSnapResultFromFeature(a,t,n,i))return o;break;case xt.MULTIPOLYGON:var c=a.getPolygons();if(!c||0===c.length)continue;for(var p=0;p<c.length;p++)if(o=this._getSnapResultFromFeature(c[p],t,n,i))return o.geoIndex=p,o}}return o},_getSnapResultFromFeature:function(t,e,n,i){var r=null;if(!t.getBounds().containsPoint(e))return null;for(var o=t.getMapPoints(),s=t.getPolyCount(),a=t.getSubCount(),u=t.getID(),l=0;l<a;l++)for(var h=s[l],c=0;c<h-1;c++){var p=c+0,f=o[p],d=o[p+1];if(f&&d){if(0<(i&ox)){if(vt.isPointInPoint(f.x,f.y,e.x,e.y,n))return r={featureId:u,points:[f],pointIndex:p,subIndex:l};if(vt.isPointInPoint(d.x,d.y,e.x,e.y,n))return r={featureId:u,points:[d],pointIndex:p+1,subIndex:l}}if(0<(i&sx)&&vt.isPointNearestOnLine(f.x,f.y,d.x,d.y,e.x,e.y,n))return r={featureId:u,points:[f,d],pointIndex:p,subIndex:l}}}return r},_getMapZone:function(t,e){e||(e=this.options.tolerance);var n=this._map.getCenter(),i=this._map.latLngToLayerPoint(n),r=new G.Point(i.x,i.y+this.options.tolerance),o=this._map.layerPointToLatLng(i),s=this._map.layerPointToLatLng(r);return s=t?(o=t.project(o),t.project(s)):(o=new G.Point(o.lng,o.lat),new G.Point(s.lng,s.lat)),Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2))}}),ux=G.Evented.extend({options:{maxEditCount:50},initialize:function(t,e){G.setOptions(this,e),this._map=t,this.renderer=this._createRenderer(),this._map.addLayer(this.renderer),this._snapHandler=new ax(this._map),this._editLayer=null,this._currentEditFeatures=null,this._geoIds=null},hasEditFeature:function(){return!(!this._geoIds||0===this._geoIds.length)},isOutMaxCount:function(){return!!(this._geoIds&&this._geoIds.length>this.options.maxEditCount)},getEditCount:function(){return this.hasEditFeature()?this._geoIds.length:0},getCurrentEditFeatures:function(){return this._currentEditFeatures},bClickOnEditFeatures:function(t){if(!this._editLayer||!this._currentEditFeatures||0===this._currentEditFeatures.length)return!1;var e=this._editLayer.getDataset();return e.getType()===ae.POLYGON?this._pointInEditPolygon(t):this._snapHandler.bClickOnFeatures(t,this._currentEditFeatures,e)},_pointInEditPolygon:function(t){if(!this._editLayer||!this._currentEditFeatures||0===this._currentEditFeatures.length)return!1;var e=this._editLayer.getDataset();if(e.getType()!==ae.POLYGON)return!1;for(var n=e.getProjInfo().project(t),i=Gv.point([n.x,n.y]),r=this._currentEditFeatures,o=0;o<r.length;o++){var s=r[o].toGeoJSON();if(Gv.booleanPointInPolygon(i,s))return!0}return!1},_createRenderer:function(){return new C({pane:zn})},snapEnable:function(){this._snapHandler.enable()},snapDisable:function(){this._snapHandler.disable()},getSnapHandler:function(){return this._snapHandler},clear:function(){this._currentEditFeatures=null,this._geoIds=null,this.clearRenderer()},setMaxEditCount:function(t){this.options.maxEditCount=t},finishEdit:function(){this.clear(),this.unlockAll(),this._editLayer=null,this.snapDisable(),this._map.seManager.setAction($n.PAN)},clearRenderer:function(){this.renderer.clear()},setGeoIds:function(t){var e=this;t!==this._geoIds?(this.clear(),(this._geoIds=t)&&0<t.length&&t.length<=this.options.maxEditCount&&this.requestGeos(t).then(function(t){e._currentEditFeatures=t,e.draw()})):this.draw()},unlockAll:function(){var t=this;return new Promise(function(e,n){t._editLayer&&t._editLayer.getDataset()&&st("unlockAll",{data:{dataset_list:[t._editLayer.getDataset().getID()]},success:function(t){t.status!==rt.SUCCESS?n(t.message):e()},error:function(){n()}})})},lock:function(i){var r=this;return i||(i=this._geoIds),new Promise(function(e,n){if(r._editLayer&&r._editLayer.getDataset()&&i&&0!==i.length){var t=r._editLayer.getDataset();st("lock",{data:{dataset_list:[{dataset_id:t.getID(),dataset_ver:t.getVersion(),feature_id_list:i}]},success:function(t){t.status!==rt.SUCCESS?n(pi):e()},error:function(){n(pi)}})}})},requestGeos:function(t){var a=this;return new Promise(function(r,o){if(a._editLayer&&a._editLayer.getDataset()&&t&&0!==t.length){var s=a._editLayer.getDataset();ht({data:{dataset_list:[{dataset_id:s.getID(),dataset_ver:s.getVersion(),layer_id:a._editLayer.getID(),feature_id_list:t,field_list:s.getFieldNames(),query_geo:!0}]},success:function(t){if(t.status!==rt.SUCCESS)o(t.message);else{var e=t.result.dataset_list;if(!e||0===e.length)return;var n=e[0],i=a._geoJsonToFeatures(n,s.getProjInfo());r(i)}},error:function(){o()}})}})},_geoJsonToFeatures:function(t,o){var s=this,e=t.feature_id_list,a=t.attr_list,u=t.field_list,l=t.geo_list,h=[];return e.forEach(function(t,e){var n=l[e],i=bt.createFeatureFromGeoJSON(n);if(i.setID(t),i.setProjInfo(o),a&&0<a.length){var r=s._getFeatureProperties(a,u,e);i.setProperties(r)}h.push(i)}),h},_getFeatureProperties:function(t,e,n){for(var i=e.length,r=n*i,o={},s=0;s<i;s++){var a=e[s],u=t[r];o[a]=u,r++}return o},draw:function(){if(this.clearRenderer(),this._editLayer&&this._currentEditFeatures&&0!==this._currentEditFeatures.length){var t=this.getCenter(this._currentEditFeatures);this._drawEditCenter(t);var e=this._map.seManager.getAction();e!==$n.ADD_NODE&&e!==$n.EDIT_NODE||this._drawNodes(this._currentEditFeatures[0])}},getCenter:function(t){return t||(t=this._currentEditFeatures),t&&0!==t.length?this._getEditBounds(t).getCenter():null},_getEditBounds:function(t){if(!t||0===t.length)return null;var n=null;return t.forEach(function(t){if(t){var e=t.getBounds();n?n.add(e):n=e}}),n},_drawEditCenter:function(t){if(this._editLayer&&this._editLayer.getDataset()){var e=this._editLayer.getDataset().getProjInfo().unproject(t),n=this._map.latLngToLayerPoint(e),i=this.renderer.ctx;this._getEditCenterStyle().drawPoint(i,n)}},_drawNodes:function(t){var e=this;if(t){var r=[];if(t.getType()===xt.MULTIPOLYGON)t.getPolygons().forEach(function(t){r.push(t.getPixelPoints(e._map,!0))});else r.push(t.getPixelPoints(this._map,!0));var o=this.renderer.ctx,s=this._getNodeStyle(),a=this._getNodeStyle(!0);r.forEach(function(n,i){n&&0!==n.length&&n.forEach(function(t,e){i===r.length-1&&e===n.length-1?a.drawPoint(o,t):s.drawPoint(o,t)})})}},_drawEditFeature:function(t){var e=this;if(t){var n=this.renderer.ctx,i=this._getEditNodeLineStyle(),r=[];if(t.getType()===xt.MULTIPOLYGON)t.getPolygons().forEach(function(t){r.push(t.toPixelGeometry(e._map,!0))});else r.push(t.toPixelGeometry(this._map,!0));i.draw(n,r)}},drawEditNodes:function(t){if(t){this.clearRenderer(),this._drawEditFeature(t);var e=this.getCenter([t]);this._drawEditCenter(e),this._drawNodes(t)}},_getEditCenterStyle:function(){return new Ci({simpleMarkerStyle:xi.SMSX,color:new ne(141,141,141,255),size:14})},_getNodeStyle:function(t){var e=new ne(0,128,0,255),n=8;return t&&(e=new ne(255,0,0,255),n=12),new Ci({simpleMarkerStyle:xi.SMSSquare,color:e,size:n})},_getEditNodeLineStyle:function(){return new Gi({width:2,color:new ne(255,0,255,255)})},setEditLayer:function(t){this.clear();var e=this._map.seManager,n=e.getLayerById(t);if(!n)return!1;this._editLayer=n;var i=e.getVectorServiceByLayerId(n.getID());if(i){var r=i.getEditFeatureIds();r&&0<r.length&&this.setGeoIds(r)}return!0},getEditLayer:function(){return this._editLayer},addFeatures:function(t){var n=this;if(t&&0!==t.length&&this._editLayer&&this._editLayer.getDataset()){var e=this._editLayer.getDataset(),i=e.getProjInfo(),r=[];t.forEach(function(t){r.push(t.transform(i).toGeoJSON())}),st("batchFeatures",{data:{dataset_list:[{dataset_id:e.getID(),dataset_ver:e.getVersion(),feature_create_list:r,feature_update_list:null,feature_delete_list:null}]},success:function(t){if(t.status===rt.SUCCESS){var e=t.result;n._updateDtsInfo(e)}else n.fire("editTip",{tip:fi})},error:function(){n.fire("editTip",{tip:fi})}})}},modifyFeatures:function(t){var n=this;if(t&&0!==t.length&&this._editLayer&&this._editLayer.getDataset()){var e=this._editLayer.getDataset(),i=[];t.forEach(function(t){var e=t.toGeoJSON();e.properties||(e.properties={}),e.properties.se_id=t.getID(),i.push(e)}),st("batchFeatures",{data:{dataset_list:[{dataset_id:e.getID(),dataset_ver:e.getVersion(),feature_create_list:null,feature_update_list:i,feature_delete_list:null}]},success:function(t){if(t.status===rt.SUCCESS){var e=t.result;n._updateDtsInfo(e),n.clear()}else n.fire("editTip",{tip:gi})},error:function(){n.fire("editTip",{tip:gi})}})}},clipPolygon:function(t){if(t&&this._currentEditFeatures&&0!==this._currentEditFeatures.length){var n=this._currentEditFeatures[0],e=t.transform(n.getProjInfo());try{var i=this._turfCut(n.toGeoJSON(),e.toGeoJSON());if(!i||1===i.length)return void this.fire("editTip",{tip:mi});var r=[];i.forEach(function(t){var e=bt.createFeatureFromGeoJSON(t);e.setID(n.getID()),e.setProjInfo(n.getProjInfo()),r.push(e)}),this.clipFeatures(r)}catch(t){this.fire("editTip",{tip:mi})}}},_turfCut:function(t,e){var n=Gv.point(e.geometry.coordinates[0]),i=Gv.point(e.geometry.coordinates[e.geometry.coordinates.length-1]);if(Gv.booleanPointInPolygon(n,t)||Gv.booleanPointInPolygon(i,t))return null;var r=Gv.buffer(e,.001,{units:"meters"}),o=Gv.difference(t,r);if(!o)return null;var s=[];return"Polygon"==o.geometry.type?s.push(Gv.polygon(o.geometry.coordinates)):o.geometry.coordinates.forEach(function(t){s.push(Gv.polygon(t))}),s},clipFeatures:function(t){var n=this;if(t&&0!==t.length&&this._editLayer&&this._editLayer.getDataset()){var e=this._editLayer.getDataset(),i=[],r=[];t.forEach(function(t,e){var n=t.toGeoJSON();0===e?(n.properties||(n.properties={}),n.properties.se_id=t.getID(),i.push(n)):r.push(n)}),st("batchFeatures",{data:{dataset_list:[{dataset_id:e.getID(),dataset_ver:e.getVersion(),feature_create_list:r,feature_update_list:i,feature_delete_list:null}]},success:function(t){if(t.status===rt.SUCCESS){var e=t.result;n._updateDtsInfo(e),n.clear()}else n.fire("editTip",{tip:yi})},error:function(){n.fire("editTip",{tip:yi})}})}},_updateDtsInfo:function(t){var s=this;t&&t.dataset_list&&0!==t.dataset_list.length?(t.dataset_list.forEach(function(t){if(t){var e=t.dataset_id,n=t.bbox,i=t.dataset_ver,r=new mt;r.readJson(n);var o=s._map.seManager.getLayersByDtId(e);if(!o||0===o.length)return;o.forEach(function(t){if(t&&t.getDataset()){var e=t.getDataset();e.setBounds(r),e.setVersion(i)}})}else s.fire("editTip",{tip:bi})}),this._map.seManager.refresh()):this.fire("editTip",{tip:bi})},deleteFeatures:function(){var n=this;if(!this._geoIds||0===this._geoIds.length)return this.fire("editTip",{tip:li}),!1;var t=this._editLayer.getDataset();return this.lock(this._geoIds).then(function(){st("batchFeatures",{data:{dataset_list:[{dataset_id:t.getID(),dataset_ver:t.getVersion(),feature_create_list:null,feature_update_list:null,feature_delete_list:n._geoIds}]},success:function(t){if(t.status===rt.SUCCESS){var e=t.result;n._updateDtsInfo(e),n._map.seManager.clearSelection(),n.clear()}else n.fire("editTip",{tip:di})},error:function(){n.fire("editTip",{tip:di})}})}).catch(function(t){n.fire("editTip",{tip:t})}),!0}}),lx=function(){function t(){h(this,t),this._db=null}return c(t,[{key:"getDB",value:function(){return this._db}},{key:"getVersion",value:function(){return this._db?this._db.version:1}},{key:"open",value:function(r,o){var s=this;return new Promise(function(e,t){o||(o={});var n=o.version||1,i=window.indexedDB.open(r,n);i.onerror=function(){t()},i.onsuccess=function(t){s._db=t.target.result,e()},i.onupgradeneeded=function(t){s._db=t.target.result,o.onupgradeneeded&&o.onupgradeneeded(t)}})}},{key:"deleteDB",value:function(i){return new Promise(function(t,e){var n=window.indexedDB.deleteDatabase(i);n.onerror=function(){e()},n.onsuccess=function(){t()}})}},{key:"createStores",value:function(n){var i=this;return new Promise(function(t,e){n&&0!==n.length?i._db?(i._db.close(),i.open(i._db.name,{version:i._db.version+1,onupgradeneeded:function(){n.forEach(function(t){var e=t.name,n=t.options;i._db.objectStoreNames.contains(e)||i._db.createObjectStore(e,n)}),t()}}).catch(function(){e()})):e():t()})}},{key:"deleteStores",value:function(n){var i=this;return new Promise(function(t,e){n&&0!==n.length?i._db?(i._db.close(),i.open(i._db.name,{version:i._db.version+1,onupgradeneeded:function(){n.forEach(function(t){i._db.objectStoreNames.contains(t)&&i._db.deleteObjectStore(t)}),t()}}).catch(function(){e()})):e():t()})}},{key:"addData",value:function(t,e){if(!this._db||!t||!e||0===e.length)return null;var r=this._db.transaction(t,"readwrite").objectStore(t),n=[];return e.forEach(function(i){var t=new Promise(function(t,e){var n=r.put(i);n.onsuccess=function(){t()},n.onerror=function(){e()}});n.push(t)}),Promise.all(n)}},{key:"getData",value:function(t,e){if(!(this._db&&t&&e&&0!==e.length&&this._db.objectStoreNames.contains(t)))return Promise.reject();var r=this._db.transaction(t,"readonly").objectStore(t),n=[];return e.forEach(function(i){var t=new Promise(function(e,t){var n=r.get(i);n.onsuccess=function(t){e(t.target.result)},n.onerror=function(){t()}});n.push(t)}),Promise.all(n)}},{key:"getAllKeys",value:function(i){var r=this;return new Promise(function(e,t){if(r._db&&r._db.objectStoreNames.contains(i)){var n=r._db.transaction(i,"readonly").objectStore(i).getAllKeys();n.onsuccess=function(t){e(t.target.result)},n.onerror=function(){t()}}else t()})}}]),t}(),hx=0,cx=1,px=2,fx=3,dx=4,gx=0,yx=1,_x=2,mx=3,vx=function t(e,n){h(this,t),this.key=e,this.subKey=0,this.level=-50,this.to=-50,this.type=n},bx=function(t,e){this.x=t||0,this.y=e||0};window.L&&window.L.Point&&(bx=window.L.Point);var xx=function(){function e(t){h(this,e),t||(t={}),this.left=t.left||0,this.bottom=t.bottom||0,this.right=t.right||0,this.top=t.top||0}return c(e,null,[{key:"pointsToSeRect",value:function(t){var r=new e;return t&&0!==t.length&&t.forEach(function(t,e){if(t){var n=t.x,i=t.y;r.top=0===e?(r.left=n,r.right=n,r.bottom=i):(r.left=Math.min(r.left,n),r.right=Math.max(r.right,n),r.bottom=Math.min(r.bottom,i),Math.max(r.top,i))}}),r}}]),c(e,[{key:"load",value:function(t){this.left=t.getFloat64(),this.top=t.getFloat64(),this.right=t.getFloat64(),this.bottom=t.getFloat64()}},{key:"isNull",value:function(){return this.left>this.right||this.bottom>this.top}},{key:"isIntersect",value:function(t){return!t.isNull()&&!this.isNull()&&(this.right>=t.left&&this.left<=t.right&&this.bottom<=t.top&&this.top>=t.bottom)}},{key:"mergeRect",value:function(t){t.isNull()||(this.isNull()?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):(this.left=Math.min(this.left,t.left),this.top=Math.max(this.top,t.top),this.right=Math.max(this.right,t.right),this.bottom=Math.min(this.bottom,t.bottom)))}},{key:"minX",value:function(){return this.left}},{key:"minY",value:function(){return this.bottom}},{key:"width",value:function(){return this.right-this.left}},{key:"height",value:function(){return this.top-this.bottom}}]),e}(),Ex=function(){function o(){h(this,o),this.key=0,this.level=0,this.bound=null,this.subNodes=[],this.minLevel=-50,this.pv_isNull=!1,this.bpv_isNull=!1}return c(o,[{key:"load",value:function(t,e){this.key=t.getInt32(),this.level=t.getInt8(),this.minLevel=t.getInt8();var n=t.getInt16();if(this.bound=new xx,this.bound.left=t.getFloat32(),this.bound.top=t.getFloat32(),this.bound.right=t.getFloat32(),this.bound.bottom=t.getFloat32(),e[this.key]=this,0<n){this.subNodes||(this.subNodes=[]);for(var i=0;i<n;i++){var r=new o;r.load(t,e),this.subNodes.push(r)}}}},{key:"query",value:function(t,e,n,i){if(!this.bound.isNull()&&this.bound.isIntersect(e)&&!(n<this.level+9)){if(n<this.level+12&&0<this.subNodes.length){var r=new vx(this.key,cx);t.push(r)}if(n>=this.level+9){var o=new vx(this.key,hx);t.push(o)}for(var s=this.subNodes?this.subNodes.length:0,a=0;a<s;a++){this.subNodes[a].query(t,e,n,i)}}}}]),o}(),wx=function t(){h(this,t),this.subKey=0,this.level=-50,this.bound=null,this.minLevel=-50,this.prtFeatures=[]},Ix=function t(e){h(this,t),e||(e={}),this.id=e.id||0,this.level=e.level||0,this.key=e.key||"",this.bound=e.bound||null,this.fieldValues=e.fieldValues||[],this.pointList=e.pointList||[],this.clockWise=e.clockWise||[]},Lx=function t(e){h(this,t),e||(e={}),this.geoId=e.geoId||0,this.subId=e.subId||0,this.bClockWise=!1!==e.bClockWise,this.ptArray=e.ptArray||[],this.bound=e.bound||null,this.ptIdx=e.ptIdx||new Array(2),this.fieldValues=e.fieldValues||[]},Sx=function t(){h(this,t),this.nodeLevel=-50,this.boundleLevel=-50,this.nodeFeatures=[],this.boundleFeatures=[]},Mx=function(){function t(){h(this,t),this.nBitLvl=30}return c(t,[{key:"getZoomInValue",value:function(t){return Math.pow(2,this.nBitLvl-t)}},{key:"getDiff",value:function(t){return this.getZoomInValue(this.nBitLvl+t)}},{key:"getScale",value:function(t){return this.getZoomInValue(this.nBitLvl-t)}}]),t}();function Cx(t){return t<=0?0:t===1/0?30:parseInt(Math.log(t)/Math.log(2))+(t<1?-1:0)}function Px(t){var e=Math.max(t.width(),t.height());return 0===e?30:Cx(1/e)}var Nx=function(){function n(t){h(this,n),this.name=t||"",this.nodeDataList={},this.rootIndex=new Ex,this.nodeIndexList={},this.prtNodeList={},this.dtType=gx,this.minLevel=0,this.maxLevel=0,this.dtBound=null,this.bitProg=new Mx,this.bits=[];for(var e=0;e<8;e++)this.bits[e]=1<<e;this.subItems=null,this.itemName="",this.fieldNames=null,this.fieldNamesByteLen=0,this.layerIds=[],this.dtId=-1,this.seIndexDB=null}return c(n,[{key:"clone",value:function(){var t=new n(this.name);t.rootIndex=vt.clone(this.rootIndex),t.nodeIndexList=vt.clone(this.nodeIndexList),t.prtNodeList=vt.clone(this.prtNodeList),t.dtType=this.dtType,t.minLevel=this.minLevel,t.maxLevel=this.maxLevel,t.dtBound=this.dtBound,t.dtId=this.dtId,t.seIndexDB=this.seIndexDB}},{key:"load",value:function(t){var e=new DataView(t),n=new Wn(e);if("SP02"!==n.getString(4))return!1;this.dtType=n.getInt32();n.getInt32();(this.nodeIndexList||(this.nodeIndexList={}),this.rootIndex.load(n,this.nodeIndexList),n.pos<n.size())&&("PART"===n.getString(4)&&this.load_seg_idx(n));return this.minLevel=parseInt(Px(this.rootIndex.bound)+9),this.maxLevel=parseInt(Cx(1e8)),this.minLevel>=this.maxLevel-9&&(this.minLevel=this.maxLevel-9),this.dtBound=this.rootIndex.bound,!0}},{key:"load_seg_idx",value:function(t){this.prtNodeList||(this.prtNodeList={});var e;for(e=t.size();t.pos<e;){if("SP02"!==t.getString(4))return!1;var n=t.getUint32(),i=this.get_vchar(t);if(0<i){for(var r={},o=0;o<i;o++){var s=this.get_vchar(t),a=t.getInt8(),u=new xx;u.left=t.getFloat32(),u.top=t.getFloat32(),u.right=t.getFloat32(),u.bottom=t.getFloat32();var l=new wx;l.subKey=s,l.bound=u,l.minLevel=a,r[s]=l}this.prtNodeList[n]=r}}return!0}},{key:"get_vchar",value:function(t){var e=void 0,n=t.getUint8();return n<2?0===n?e=t.getUint16():1===n&&(e=t.getUint32()):e=n-2,e}},{key:"getBits",value:function(t,e){for(var n=0,i=new Array(8*e),r=0;r<e;r++)for(var o=t.getUint8(),s=0;s<8;s++)i[n++]=!!(this.bits[s]&o);return i}},{key:"decode_data",value:function(t){for(var e=new DataView(t),n=new Wn(e),i=n.size();n.pos<i;){var r=n.getInt32(),o=n.getInt32(),s=n.pos,a=n.getString(4);if("SP02"!==a&&"SP01"!==a){console.log("decode error");break}for(;n.pos-s<o;){switch(n.getInt8()){case 0:this.decode_progress(n,r,o);break;case 1:this.decode_geo(n,r,o);break;case 32:this.decode_empty_node(n,r);break;case 48:this.deal_with_part_bits(n,r,o);break;case 49:this.deal_with_part_geo(n,r,o);break;default:n.pos=s,n.getBits(o+8)}}}}},{key:"decode_geo",value:function(t,e,n){var i=t.getInt8(),r=t.getInt32();this.nodeDataList[r]||(this.nodeDataList[r]=new Sx);var o=this.nodeDataList[r],s=this.nodeIndexList[r],a=0;if(i===hx){if(0===o.nodeFeatures.length&&(a=1),-50!==o.nodeLevel&&o.nodeLevel+a!==e)return void(t.pos+=n-10);if(-50===o.nodeLevel&&s.minLevel!==e)return void(t.pos+=n-10)}else if(i===cx){if(0===o.boundleFeatures.length&&(a=1),-50!==o.boundleLevel&&o.boundleLevel+a!==e)return void(t.pos+=n-10);if(-50===o.boundleLevel&&s.minLevel!==e)return void(t.pos+=n-10)}var u=0;t.getBool()&&(u=t.getUint32());var l=t.getInt32();if(0<l)if(this.fieldNames)t.pos+=this.fieldNamesByteLen;else{this.fieldNames=[];for(var h=t.pos,c=t.getUint8(),p=0;p<c;p++){var f=t.getUint8(),d=t.getString(f);d=d.toLowerCase(),this.fieldNames.push(d)}this.fieldNamesByteLen=t.pos-h}var g=new xx;g.load(t);var y=Px(g),_=(t.getInt32(),Cx(1e8));_<=y&&(y=_-1);for(var m=[],v=0;v<l;v++){for(var b=t.getInt32(),x=t.getUint8(),E=new Array(x),w=0;w<x;w++){var I=t.getUint8(),L=t.getString(I);E[w]=L}var S=!0;this.dtType===mx&&(S=t.getBool());var M=[];if(v<u)for(var C=y;C<e;C++)this.decode_PoiProData(t,C+1,this.bitProg,M);else{var P=1;this.dtType!==yx&&(P=this.get_vchar(t)),M=this.decodeGeometry(y,e,P,t,this.bitProg)}M.forEach(function(t){t.x+=g.minX(),t.y+=g.minY()});var N=xx.pointsToSeRect(M);if(0<v&&b===m[m.length-1].id)m[m.length-1].pointList.push(M),m[m.length-1].bound.mergeRect(N);else{var O=new Ix({id:b,bound:N,pointList:[M],fieldValues:E});m.push(O)}this.dtType===mx&&(m[m.length-1].clockWise||(m[m.length-1].clockWise=[]),m[m.length-1].clockWise.push(S))}var T=null;i===hx?(o.nodeLevel=e,o.nodeFeatures||(o.nodeFeatures=[]),T=o.nodeFeatures):i===cx&&(o.boundleLevel=e,o.boundleFeatures||(o.boundleFeatures=[]),T=o.boundleFeatures),m.forEach(function(t){t.level=e,T.push(t)}),this.seIndexDB&&this.saveToIndexDB(i,r,o)}},{key:"decode_progress",value:function(t,e,n){var i=t.getInt8(),r=t.getInt32();this.nodeDataList[r]||(this.nodeDataList[r]=new Sx);var o=this.nodeDataList[r],s=this.nodeIndexList[r];if(i===hx){if(-50!==o.nodeLevel&&o.nodeLevel+1!==e)return void(t.pos+=n-10);if(-50===o.nodeLevel&&s.minLevel!==e)return void(t.pos+=n-10)}else if(i===cx){if(-50!==o.boundleLevel&&o.boundleLevel+1!==e)return void(t.pos+=n-10);if(-50===o.boundleLevel&&s.minLevel!==e)return void(t.pos+=n-10)}var a=0;t.getBool()&&(a=t.getUint32());var u=t.getInt32(),l=t.pos,h=null;h=i===hx?(o.nodeLevel=e,o.nodeFeatures):(o.boundleLevel=e,o.boundleFeatures);for(var c=0,p=0,f=[],d=0;d<h.length;d++){var g=h[d];g.level=e;var y=g.pointList;g.bound=new xx;for(var _=0;_<y.length;_++){var m=y[_];if(++p<=a)this.decode_PoiProData(t,e,this.bitProg,m);else{if(0===f.length){var v=u-(t.pos-l);f=this.getBits(t,v)}for(var b=0;b<m.length;b++)f[c++]&&(m[b].x+=this.bitProg.getDiff(e)),f[c++]&&(m[b].y+=this.bitProg.getDiff(e))}var x=xx.pointsToSeRect(m);g.bound.mergeRect(x)}}this.seIndexDB&&this.saveToIndexDB(i,r,o)}},{key:"decode_empty_node",value:function(t,e){var n=t.getInt8(),i=t.getInt32(),r=this.nodeIndexList[i];r&&(n===hx?r.pv_isNull=!0:n===cx&&(r.bpv_isNull=!0)),this.nodeDataList[i]||(this.nodeDataList[i]=new Sx);var o=this.nodeDataList[i];n===hx?o.nodeLevel=e:n===cx&&(o.boundleLevel=e)}},{key:"deal_with_part_bits",value:function(t,e,n){var i=t.getInt8(),r=t.getUint32(),o=t.getUint32();if(!this.prtNodeList[r]||!this.prtNodeList[r][o])return console.log("decode_data error!"),void(t.pos+=n-14);var s=this.prtNodeList[r][o];s.prtFeatures||(s.prtFeatures=[]);var a=s.prtFeatures,u=this.bitProg;if(-50===s.level||s.level+1===e)if(-50!==s.level||s.minLevel===e){var l=0;t.getBool()&&(l=t.getUint32());for(var h=t.getUint32(),c=t.pos,p=0,f=0,d=[],g=a?a.length:0,y=0;y<g;y++){var _=a[y],m=_.ptArray;if(++p<=l)this.decode_PoiProData(t,e,u,m);else{if(0===d.length){var v=h-(t.pos-c);d=this.getBits(t,v)}for(var b=m?m.length:0,x=0;x<b;x++)d[f++]&&(m[x].x+=u.getDiff(e)),d[f++]&&(m[x].y+=u.getDiff(e))}_.bound=xx.pointsToSeRect(m)}s.level=e,this.seIndexDB&&this.saveToIndexDB(i,r,s)}else t.pos+=n-14;else t.pos+=n-14}},{key:"deal_with_part_geo",value:function(t,e,n){var i=t.getInt8(),r=t.getUint32(),o=t.getUint32();if(!this.prtNodeList[r]||!this.prtNodeList[r][o])return console.log("decode_data error!"),void(t.pos+=n-14);var s=this.prtNodeList[r][o];s.prtFeatures||(s.prtFeatures=[]);var a=s.prtFeatures,u=this.bitProg,l=0;if(0===a.length&&(l=1),-50===s.level||s.level+l===e)if(-50!==s.level||s.minLevel===e){var h=0;t.getBool()&&(h=t.getUint32());var c=t.getInt32();if(0<c)if(this.fieldNames)t.pos+=this.fieldNamesByteLen;else{this.fieldNames=[];for(var p=t.pos,f=t.getUint8(),d=0;d<f;d++){var g=t.getUint8(),y=t.getString(g);y=y.toLowerCase(),this.fieldNames.push(y)}this.fieldNamesByteLen=t.pos-p}var _=new xx;_.load(t);var m=Px(_),v=Cx(1e8);30<v&&(v=30),v<=m&&(m=v-1);t.getUint32();for(var b=0;b<c;b++){for(var x=t.getUint32(),E=t.getUint8(),w=new Array(E),I=0;I<E;I++){var L=t.getUint8(),S=t.getString(L);w[I]=S}for(var M=this.get_vchar(t),C=new Array(2),P=0;P<2;P++)C[P]=t.getUint32();var N;N=t.getBool();var O=[];if(b<h)for(var T=m;T<e;T++)this.decode_PoiProData(t,T+1,u,O);else{var R=1;this.dtType!==yx&&(R=this.get_vchar(t)),O=this.decodeGeometry(m,e,R,t,u)}O.forEach(function(t){t.x+=_.minX(),t.y+=_.minY()});var k=xx.pointsToSeRect(O),D=new Lx({geoId:x,subId:M,bClockWise:N,ptArray:O,bound:k,ptIdx:C,fieldValues:w});a.push(D)}s.level=e,this.seIndexDB&&this.saveToIndexDB(i,r,s)}else t.pos+=n-14;else t.pos+=n-14}},{key:"decode_PoiProData",value:function(t,e,n,i){var r=i.length,o=this.get_vchar(t);if(0===o)for(var s=0,a=parseInt((2*i.length+7)/8),u=this.getBits(t,a),l=0;l<i.length;l++)u[s++]&&(i[l].x+=n.getDiff(e)),u[s++]&&(i[l].y+=n.getDiff(e));else{var h=i.length+o,c=parseInt((h+7)/8),p=this.getBits(t,c);c=parseInt((2*h+7)/8);var f=this.getBits(t,c);if(0===i.length)for(var d=0;d<h;d++)i[d]=new bx(0,0);else{for(var g=new Array(h),y=0,_=0;_<h;_++)p[_]?g[_]=i[y-1]:g[_]=i[y++];for(var m=0;m<h;m++)i[m]=new bx(g[m].x,g[m].y)}for(var v=0,b=0;b<i.length;b++)try{f[v++]&&(i[b].x+=n.getDiff(e)),f[v++]&&(i[b].y+=n.getDiff(e))}catch(t){console.log(e,i[b],r,o)}}}},{key:"decodeGeometry",value:function(t,e,n,i,r){for(var o=parseInt((2*(n*(e-t))+7)/8),s=this.getBits(i,o),a=new Array(n),u=0,l=t;l<e;l++)for(var h=0;h<a.length;h++){a[h]||(a[h]=new bx(0,0));var c=a[h];s[u++]&&(c.x+=r.getDiff(l+1)),s[u++]&&(c.y+=r.getDiff(l+1))}return a}},{key:"decode_data_subItem",value:function(t,e){if(t){if(this.subItems||(this.subItems={}),!this.subItems[t]){var n=vt.clone(this);n.subItems=null,n.itemName=t,this.subItems[t]=n}this.subItems[t].decode_data(e)}else this.decode_data(e)}},{key:"getRequestLevel",value:function(t){var e=parseInt(Cx(2*t));return e<this.minLevel&&(e=this.minLevel),e}},{key:"request",value:function(t,e,n){null==n&&(n=!0);var i=[],r=this.getRequestLevel(e);r<this.minLevel&&(r=this.minLevel),this.rootIndex.query(i,t,r);for(var o=[],s=i.length,a=0;a<s;a++){var u=i[a],l=this.nodeIndexList[u.key];if(l){if(u.type===hx&&l.pv_isNull)continue;if(u.type===cx&&l.bpv_isNull)continue}if(u.type===dx&&0<Object.keys(this.prtNodeList).length){var h=this.prtNodeList[u.key];if(h){for(var c in h){var p=h[c],f=null;p.bound.isIntersect(t)&&r>p.level?((f=new vx(u.key,dx)).subKey=c,f.level=p.level,f.to=r):-50===p.level&&((f=new vx(u.key,dx)).subKey=c,f.to=-49),f&&(-50===f.level&&(f.level=p.minLevel-1),o.push(f))}continue}}var d=this.nodeDataList[u.key];d&&(u.type===hx?u.level=d.nodeLevel:u.type===cx&&(u.level=d.boundleLevel),u.level>=r&&n)||(-50===u.level&&(u.level=l.minLevel-1),o.push(u))}return o}},{key:"getBounds",value:function(){return this.dtBound}},{key:"queryBySubItems",value:function(t,e){var n=this.subItems,i=[];for(var r in n){n[r].query(t,e,i)}return i}},{key:"query",value:function(t,e,n){if(this.subItems&&0<Object.keys(this.subItems).length)return this.queryBySubItems(t,e);n||(n=[]);for(var i=this.request(t,e,!1),r=0;r<i.length;r++){var o=i[r],s=o.key,a=o.type,u=this.nodeDataList[s];if(u){var l=null;a===hx?l=u.nodeFeatures:a===cx&&(l=u.boundleFeatures);for(var h=l.length,c=0;c<h;c++){var p=l[c];p.bound.isIntersect(t)&&n.push(p)}}}return this.query_seg(t,e,i,n),n}},{key:"query_seg",value:function(t,e,n,i){if(n&&this.prtNodeList&&0!==Object.keys(this.prtNodeList).length)for(var r=0;r<n.length;r++){var o=n[r].key,s={},a={},u={},l=this.prtNodeList[o];for(var h in l)for(var c=l[h].prtFeatures,p=c?c.length:0,f=0;f<p;f++){var d=c[f],g=d.geoId,y=d.subId,_=d.ptIdx[0];if(s[y]=d.bClockWise,u[g]=s,a[g]||(a[g]={}),a[g][y]||(a[g][y]={}),a[g][y][_]){var m=a[g][y][_].ptIdx[1];d.ptIdx[1]>m&&(a[g][y][_]=d)}else a[g][y][_]=d}for(var v in a){v=parseInt(v);var b=new Ix,x=a[b.id_=v],E=!1,w=new xx;for(var I in x){var L=I,S=x[I];for(var M in S)S[M].bound.isIntersect(t)&&(E=!0),w.mergeRect(S[M].bound);b.clockWise.push(u[v][L]);var C=[],P=-1;for(var N in S)if(!(S[N].ptIdx[1]<P)&&0!==S[N].ptArray.length){var O=0;(O=P-S[N].ptIdx[0]+1)<0&&(O=0),P=S[N].ptIdx[1],2<=O&&(O=1),O>=S[N].ptArray.length&&(O=S[N].ptArray.length-1),C=C.concat(S[N].ptArray.slice(O))}b.pointList.push(C)}if(this.dtType===mx){if(!w.isIntersect(t))continue}else if(this.dtType===_x&&!E)continue;b.bound=w,i.push(b)}}}},{key:"getPackTypeString",value:function(t){switch(t){case hx:return"pv";case cx:return"bpv";case px:return"fld";case fx:return"bfd";case dx:return"ppv"}return""}},{key:"getPacks",value:function(t,e){var n=this.getRequestLevel(e),i=this.request(t,e);if(!i||0===i.length)return null;for(var r=i.length,o=[],s=0;s<r;s++){var a=i[s];if(a){var u=a.key,l=a.level,h=a.type,c=a.subKey,p=n;if(n<=l){var f=-50;if(h===dx)f=this.prtNodeList[u][c].minLevel;else f=this.nodeIndexList[u].minLevel;if(!(l<=f))continue;p=l+1}var d={type:this.getPackTypeString(h),key:u,from:l,to:p};h===dx&&(d.subKey=c),o.push(d)}}return o}},{key:"clearLocalData",value:function(t,e){if(this.subItems&&0<Object.keys(this.subItems).length)for(var n in this.subItems){var i=this.subItems[n];i&&i.clearLocalData(t,e)}else{if(!this.nodeDataList)return;var r=this.getRequestLevel(e);for(var o in this.nodeDataList){var s=this.nodeDataList[o];if(s){var a=this.nodeIndexList[o],u=a.bound;t.isIntersect(u)?(r<a.level+9&&delete this.nodeDataList[o],14<r&&s.boundleFeatures&&0<s.boundleFeatures.length&&(s.boundleFeatures=[],s.boundleLevel=-50)):delete this.nodeDataList[o]}}}}},{key:"saveToIndexDB",value:function(t,e,n){if(this.seIndexDB){var i="";this.itemName&&(i+="itemName_"+this.itemName+"_"),i+="nodeKey_"+e,t===dx&&(i+="_subKey_"+n.subKey);var r={key:i,packType:t,nodeKey:e,nodeData:n};this.seIndexDB.addData(this.dtId,[r]).catch(function(t){console.log(t)})}}},{key:"_getFromIndexDB",value:function(i,r){var o=this;return new Promise(function(t){if(o.seIndexDB){var e=o.request(i,r);if(e&&0!==e.length){var n=[];return e.forEach(function(t){if(t.type===dx){if(o.prtNodeList&&o.prtNodeList[t.key]&&o.prtNodeList[t.key][t.subKey])return}else if(o.nodeDataList&&o.nodeDataList[t.key])return;var e="";o.itemName&&(e+="itemName_"+o.itemName+"_"),e+="nodeKey_"+t.key,t.type===dx&&(e+="_subKey_"+t.subKey),n.push(e)}),n.length,void t()}t()}else t()})}},{key:"_translateBounds",value:function(t){t&&0!==t.length&&t.forEach(function(t){t.bound=new xx(t.bound)})}},{key:"getFromIndexDB",value:function(t,e){if(this.subItems&&0<Object.keys(this.subItems).length){var n=[];for(var i in this.subItems){var r=this.subItems[i];r&&n.push(r._getFromIndexDB(t,e))}return Promise.all(n)}return this._getFromIndexDB(t,e)}}]),n}(),Ox={useIndexDB:!1},Tx=function(){function e(t){h(this,e),this.options=vt.extend({},Ox,t),this.seIndexDB=null,this.options.useIndexDB&&this.initIndexDB(),this.fileDataList=[]}return c(e,[{key:"initIndexDB",value:function(){var e=this;this.seIndexDB=new lx;var t=$.serviceUrl+"/fileDataDB";this.seIndexDB.deleteDB(t).then(function(){e.seIndexDB.open(t)}).catch(function(t){e.seIndexDB=null,console.log(t)})}},{key:"getFileDatasetByName",value:function(t){if(!this.fileDataList||0===this.fileDataList.length)return null;for(var e=0;e<this.fileDataList.length;e++)if(this.fileDataList[e].name===t)return this.fileDataList[e];return null}},{key:"getFileDatasetByLayerId",value:function(t){if(!this.fileDataList||0===this.fileDataList.length)return null;for(var e=0;e<this.fileDataList.length;e++){var n=this.fileDataList[e];if(n.layerIds&&-1!==n.layerIds.indexOf(t))return n}return null}},{key:"getDtPVInfo",value:function(t){return new Promise(function(e,n){st("getDtPVInfo",{data:{name:t},success:function(t){t.status!==rt.SUCCESS&&n(t.message),e(t.result)},error:function(){n()}})})}},{key:"getDtsPVInfo",value:function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.getDtPVInfo(t))}),Promise.all(n)}},{key:"addLayers",value:function(c){var p=this;return new Promise(function(h,e){if(c&&0!==c.length){var r=[],o=[];c.forEach(function(t){var e=t.dataset_id,n=e;t.itemFilter&&(n+="_"+t.layer_id);var i=p.getFileDatasetByName(n);i?i.layerIds.push(t.layer_id):(t.bRequest=!0,-1===o.indexOf(e)&&(r.push({dataset_id:e,dataset_ver:t.pvVersion}),o.push(e)))}),0===r.length?h():p.requestDtsIndex(r).then(function(t){for(var e=new DataView(t),n=new Wn(e),i=e.byteLength,r=[];n.pos<i;){var o=n.getInt8(),s=n.getString(o),a=n.getInt8(),u=parseInt(n.getString(a)),l=n.getBits(u);p._createFileDt(c,s,l),r.push({name:s,options:{keyPath:"key"}})}p.seIndexDB&&0<r.length?p.seIndexDB.createStores(r).then(function(){h()}):h()}).catch(function(t){console.log(t),e()})}else h()})}},{key:"_createFileDt",value:function(t,n,e){var i=this,r=new Nx(n);r.seIndexDB=this.seIndexDB,r.dtId=n,r.load(e);var o=!1;this.fileDataList||(this.fileDataList=[]),t.forEach(function(t){if(t.bRequest&&t.dataset_id===n)if(t.itemFilter){var e=r.clone();e.name=n+"_"+t.layer_id,e.layerIds=[t.layer_id],i.fileDataList.push(e)}else r.layerIds.push(t.layer_id),o||(i.fileDataList.push(r),o=!0)})}},{key:"requestDtsIndex",value:function(n){return new Promise(function(e,t){st("queryPV",{data:{cmd:"getindex",dataset_list:n},dataType:"arraybuffer",success:function(t){e(t)},error:function(){t()}})})}},{key:"requestFileData",value:function(s,a,t){var u=this;return new Promise(function(n,e){if(t&&0!==t.length){var i=[],r=[];t.forEach(function(t){var e=t.dataset_id;t.itemFilter&&(e+="_"+t.layer_id),-1===i.indexOf(e)&&(t.name=e,r.push(t),i.push(e))});var o=(new Date).getTime();u._getFromIndexDB(s,a,r).then(function(){var t=(new Date).getTime();console.log("getFromIndexDB："+(t-o));var e=u._getRequestParam(s,a,r);u.requestDtsShapes(e).then(function(){n()})}).catch(function(t){e(t)})}else n()})}},{key:"_getFromIndexDB",value:function(i,r,t){var o=this;if(!t||0===t.length)return Promise.resolve();var s=[];return t.forEach(function(t){var e=t.name,n=o.getFileDatasetByName(e);n&&s.push(n.getFromIndexDB(i,r))}),Promise.all(s)}},{key:"_getRequestParam",value:function(l,h,t){var c=this,p=[];return t.forEach(function(t){var e=t.name,n=c.getFileDatasetByName(e);if(n)if(n.subItems&&0<Object.keys(n.subItems).length){var i=n.subItems;for(var r in i){var o=i[r].getPacks(l,h),s={dataset_id:t.dataset_id,dataset_ver:t.pvVersion,item:r,filter:t.itemFilter,layer_id:t.layer_id,data_list:o};s.data_list&&0<s.data_list.length&&p.push(s)}}else{var a=n.getPacks(l,h),u={dataset_id:t.dataset_id,dataset_ver:t.pvVersion,item:"",filter:t.itemFilter,layer_id:t.layer_id,data_list:a};u.data_list&&0<u.data_list.length&&p.push(u)}}),p}},{key:"requestDtsShapes",value:function(e){var f=this;return new Promise(function(p,t){e&&0!==e.length?st("queryPV",{data:{cmd:"getshapes",dataset_list:e},dataType:"arraybuffer",success:function(t){for(var e=new DataView(t),n=new Wn(e),i=n.getInt32(),r=0;r<i;r++){var o=n.getInt8(),s=(n.getString(o),n.getInt32()),a=n.getInt8(),u=n.getString(a),l=n.getInt32(),h=n.getBits(l),c=f.getFileDatasetByLayerId(s);c&&c.decode_data_subItem(u,h)}p()},error:function(){t()}}):p()})}},{key:"clearLocalData",value:function(e,n){(this.fileDataList||0!==this.fileDataList.length)&&this.fileDataList.forEach(function(t){t&&t.clearLocalData(e,n)})}},{key:"deleteFileDataByDtId",value:function(i){var r=this;return new Promise(function(t){if(i&&0!==i.length&&r.fileDataList&&0!==r.fileDataList.length){for(var e=r.fileDataList.length-1;0<=e;e--){var n=r.fileDataList[e].dtId;-1!==i.indexOf(n)&&r.fileDataList.splice(e,1)}r.seIndexDB?r.seIndexDB.deleteStores(i).then(function(){t()}):t()}else t()})}}]),e}(),Rx=ub.extend({initialize:function(t){ub.prototype.initialize.call(this,t),this._hasRequestIndex=!1},onAdd:function(t){t.addLayer(this.renderer),t.addLayer(this._seSelectionLayer);var e=this.getLayers(!0);this.addToFileData(e)},onRemove:function(){ub.prototype.onRemove.call(this)},addToFileData:function(t){var e=this;if(t&&0!==t.length){for(var n=t.length,i=[],r=0;r<n;r++){var o=t[r];if(o&&o.getDataset()){var s=o.getDataset(),a={dataset_id:s.getID(),dataset_ver:s.getVersion(),pvVersion:s.getPvVersion(),layer_id:o.getID(),itemFilter:o.getItemFilter()};i.push(a)}}this._map.seManager.getFileDataManager().addLayers(i).then(function(){e._hasRequestIndex=!0,e.update()}).catch(function(t){console.log(t)})}},requestData:function(){var r=this;if(this._hasRequestIndex)if(this._clearDtData(),this._layers&&0!==this._layers.length){for(var t=this._map.getSize(),e=this._map.getBounds(),o=t.x/(e.getEast()-e.getWest()),n=this._layers.length,s=[],i=this._map.getScale(),a=0;a<n;a++){var u=this._layers[a];u&&u.getRequestObj(s,i)}if(0!==s.length){var l=new xx({left:e.getWest(),right:e.getEast(),bottom:e.getSouth(),top:e.getNorth()}),h=this._map.seManager.getFileDataManager(),c=(new Date).getTime();h.requestFileData(l,o,s).then(function(){var t=(new Date).getTime();r._updateData(l,o,s);var e=(new Date).getTime();r._avoid();var n=(new Date).getTime();r.draw();var i=(new Date).getTime();h.clearLocalData(l,o),console.log("请求解析数据："+(t-c)),console.log("同步数据："+(e-t)),console.log("避让："+(n-e)),console.log("绘制："+(i-n)),console.log("总时间："+(i-c))}).catch(function(t){console.log(t)})}else this.clearRenderer()}else this.clearRenderer()},_updateData:function(s,a,t){var u=this;if(t&&0!==t.length){var l=this._map.seManager.getFileDataManager(),h={};t.forEach(function(t){var e=t.dataset_id;t.itemFilter&&(e+="_"+t.layer_id),h[e]||(h[e]=[]),h[e].push(t.layer_id)});var e=function(t){var e=l.getFileDatasetByName(t);if(!e)return"continue";var n=h[t],i=u.getLayerById(n[0]).getDataset(),r=e.query(s,a),o=u._fileDataToFeatures(r,e.dtType,e.fieldNames,i);if(!o||0===o.length)return{v:void 0};n.forEach(function(t,e){var n=!0;0===e&&(n=!1),u.getLayerById(t).updateFileData(o,n)})};for(var n in h){var i=e(n);switch(i){case"continue":continue;default:if("object"===(void 0===i?"undefined":g(i)))return i.v}}}},_fileDataToFeatures:function(t,n,i,r){var o=this;if(!t||0===t.length)return null;var s=[];return t.forEach(function(t){var e=o._featureObjToFeature(t,n,i);e&&(e.setProjInfo(r.getProjInfo()),s.push(e))}),s},_featureObjToFeature:function(t,n,e){var i=null,r=t.fieldValues,o={};if(e&&0<e.length&&r&&e.length===r.length)for(var s=r.length,a=0;a<s;a++){var u=e[a],l=r[a];o[u]=l}var h=t.pointList,c=t.clockWise,p=t.id,f=[],d=null;switch(h.forEach(function(t,e){(!d||n===mx&&c[e])&&(d={mapPoints:[],polyCount:[],subCount:0,id:p,properties:o},f.push(d)),d.polyCount.push(t.length),d.subCount++,t.forEach(function(t){d.mapPoints.push(t)})}),n){case yx:i=new Et(f[0]);break;case _x:i=new wt(f[0]);break;case mx:if(1===f.length)i=new It(f[0]);else{var g=[];f.forEach(function(t){g.push(new It(t))}),(i=new Lt({id:p,properties:o})).setPolygons(g)}}return i},refresh:function(){var e=this,t=this.getLayers(!0);if(t&&0!==t.length){var s={},i=[];t.forEach(function(t){if(t&&t.getDataset()){var e=t.getDataset(),n=e.getID();s[n]?s[n].layers.push(t):(s[n]={layers:[t],pvVersion:e.getPvVersion()},i.push(n))}});var n=this._map.seManager,a=n.getFileDataManager();n.getDtInfos(i,{success:function(t){if(t&&0!==t.length){var r=[],o=[];t.forEach(function(t){var e=t.data_id,n=t.pv_info.pv_version,i=s[e];i.pvVersion!==n&&(o.push(e),i.layers.forEach(function(t){t.getDataset().setPvVersion(n),r.push(t)}))}),0<o.length?a.deleteFileDataByDtId(o).then(function(){e.addToFileData(r)}).catch(function(t){console.log(t)}):e.update()}}})}else this.update()}}),kx=G.Evented.extend({options:{serviceUrl:"",token:"",selectSetting:{tolerance:6,color:new ne(0,255,255,255),bQueryAll:!1,highlightColor:new ne(0,128,0,255)}},initialize:function(t,e){if(G.setOptions(this,e),!t)throw new Error("init SeManager error");this._map=t,tt({serviceUrl:(this._map.seManager=this).options.serviceUrl,token:this.options.token}),this.config=$,this._initPanes(),this._actionManager=new qv(this._map),this._vectorServices=null,this._activeVectorService=null,this._editManager=new ux(this._map),this._identifyHighlightLayer=new lb,this._map.addLayer(this._identifyHighlightLayer),this._fileDataManager=new Tx},_initPanes:function(){var t=this._map.createPane(Un);this._map.createPane(qn,t),this._map.createPane(jn,t),this._map.createPane(zn,t),this._map.createPane(Vn,t)},setSelectSetting:function(t){this.options.selectSetting=t},getSelectSetting:function(){return this.options.selectSetting},setActiveVectorService:function(t){this._activeVectorService=t},getActiveVectorService:function(){var t=this._activeVectorService;if(!t){var e=this.getVectorServiceList();e&&0<e.length?t=e[0]:(t=new ub,this._map.addLayer(t),this._vectorServices=[t])}return t},hasVectorService:function(t){return!!this.getVectorServiceById(t)},addVectorService:function(n,i){var r=this;i||(i={});var o=null,e=function(t){i.error&&i.error(t)};this.getVectorServiceById(n)?e("服务已存在"):new Promise(function(t,e){r._requestMapContent(n,{success:t,error:e})}).then(function(t){var n=t.dataset_list;return o=t,new Promise(function(t,e){r.getDtInfos(n,{success:t,error:e})})}).then(function(t){if(t){o.dataset_list=t;var e=null;if((e=i.isPV?new Rx:new ub).readJson(o),r._map.addLayer(e),r._vectorServices||(r._vectorServices=[]),r._vectorServices.unshift(e),i.bfitBounds){var n=e.getLatLngBounds();n&&r._map.fitBounds(n)}i.success&&i.success(e)}}).catch(function(t){e(t)})},_requestMapContent:function(t,e){t&&(e=e||{},st("getMap",{data:{id:t},success:function(t){t.status!==rt.SUCCESS?e.error&&e.error("getMapContent error"):e.success&&e.success(t.result)},error:function(){e.error&&e.error("getMapContent error")}}))},getDtInfos:function(t,e){t&&0!==t.length?st("datasetInfo",{data:{dataset_ids:t},success:function(t){t.status!==rt.SUCCESS?e.error&&e.error("getDtInfos error"):e.success&&e.success(t.result.item)},error:function(){e.error&&e.error("getDtInfos error")}}):e.success&&e.success([])},getVectorServiceById:function(t){if(!this._vectorServices||0===this._vectorServices.length)return null;for(var e=this._vectorServices.length,n=0;n<e;n++){var i=this._vectorServices[n];if(i&&i.id===t)return i}return null},getVectorServiceByLayerId:function(t){if(!this._vectorServices||0===this._vectorServices.length)return null;for(var e=this._vectorServices.length,n=0;n<e;n++){var i=this._vectorServices[n];if(i)if(i.getLayerById(t))return i}return null},removeVectorService:function(t){var e=this.getVectorServiceById(t);if(e){var n=this._vectorServices.indexOf(e);-1!==n&&(this._map.removeLayer(e),this._vectorServices.splice(n,1))}},removeAllVectorService:function(){var e=this;this._vectorServices&&0!==this._vectorServices.length&&(this._vectorServices.forEach(function(t){e._map.removeLayer(t)}),this._vectorServices=null)},getVectorServiceList:function(){if(!this._vectorServices||0===this._vectorServices.length)return null;var t=this._vectorServices.slice(0);return 2<=t.length&&t.sort(function(t,e){return e.getZIndex()-t.getZIndex()}),t},addDtData:function(n,i){var r=this;return!(!n||0===n.length)&&(i=i||{},new Promise(function(t,e){r.getDtInfos(n,{success:t,error:e})}).then(function(t){if(t&&t.length){var s=!1,a=r.getActiveVectorService();a.getLayers()&&0!==a.getLayers().length||(s=!0);var u=null;if(t.forEach(function(t){var e=new Kn;e.readJson(t);var n=new Qn;n.name=e.name,n.label=e.label,n.dataset=e,n.renderStyle=de.createDefault(e.getType());var i=e.getBounds();if(s&&i.isValid()){var r=i.toLatLngBounds(e.getProjInfo()),o=mt.createFromLatLngBounds(r);u?u.add(o):u=o}a.addLayer(n)}),s&&u){var e=u.toLatLngBounds();r._map.fitBounds(e)}a.update(),i.success&&i.success()}}).catch(function(t){i.error&&i.error(t)}),!0)},saveVectorService:function(e,n){if(!e)return!1;n=n||{};var t=!1;(e.isNew()||n.bAsNewService)&&(t=!0);var i=e.toJson();return st(t?"saveMap":(i.id=e.id,"updateMap"),{data:i,success:function(t){t.status===rt.SUCCESS?(e.id=t.result.data_id,n.success&&n.success("saveVectorService success")):n.error&&n.error("saveVectorService error")},error:function(){n.error&&n.error("saveVectorService error")}}),!0},clearSelection:function(){this._vectorServices&&0!==this._vectorServices.length&&this._vectorServices.forEach(function(t){t&&t.clearSelection()})},refresh:function(){this._map.setView(this._map.getCenter(),this._map.getZoom())},getLayerById:function(t){if(!this._vectorServices||0===this._vectorServices.length)return null;for(var e=this._vectorServices.length,n=0;n<e;n++){var i=this._vectorServices[n];if(i){var r=i.getLayerById(t);if(r)return r}}return null},getVectorLayers:function(n){var t=this.getVectorServiceList();if(!t||0===t.length)return null;var i=[];return t.forEach(function(t){if(t){var e=t.getLayers(n);e&&0<e.length&&(i=i.concat(e))}}),i},drawSelection:function(){this._vectorServices&&0!==this._vectorServices.length&&this._vectorServices.forEach(function(t){t.drawSelection()})},getSelections:function(){var t=this.getVectorServiceList();if(!t||0===t.length)return null;var n=[];return t.forEach(function(t){if(t){var e=t.getSelections();e&&0<e.length&&(n=n.concat(e))}}),n},setAction:function(t,e){this._actionManager.setAction(t,e)},getAction:function(){return this._actionManager.getAction()},showIdentifyFeatures:function(t){t&&0!==t.length&&this._identifyHighlightLayer.setFeatures(t)},removeLayer:function(t){var e=this.getVectorServiceByLayerId(t);return!!e&&e.removeLayer(t)},getEditManager:function(){return this._editManager},setEditLayer:function(t){return this._editManager.setEditLayer(t)},getLayersByDtId:function(n){var t=this._vectorServices;if(!t||0===t.length)return null;var i=[];return t.forEach(function(t){if(t){var e=t.getLayersByDtId(n);e&&0<e.length&&(i=i.concat(e))}}),i},getFileDataManager:function(){return this._fileDataManager}});var Dx=Object.freeze({createBuffer:function(t,e,n){return Gv.buffer(t,e,n)}}),Ax=1,Fx=2,Gx=3,Bx=4,Ux=5,qx=6,jx=7,zx=8,Vx=9,Yx=10,Hx=11,Xx=12,Wx=13,Jx=14,Kx=15,Zx=16,Qx=G.Control.extend({options:{position:"topright",className:"",tipsCallBack:null,barList:[{name:Ax,title:"绘制点",fontClass:"icon-drawPoint",showTypes:[ae.POINT]},{name:Fx,title:"绘制线",fontClass:"icon-drawLine",showTypes:[ae.LINE]},{name:Gx,title:"绘制面",fontClass:"icon-drawPolygon",showTypes:[ae.POLYGON]},{name:Bx,title:"手绘线",fontClass:"icon-handDraw",showTypes:[ae.LINE]},{name:Ux,title:"手绘面",fontClass:"icon-handDraw",showTypes:[ae.POLYGON]},{name:qx,title:"绘制矩形",fontClass:"icon-drawRect",showTypes:[ae.LINE,ae.POLYGON]},{name:jx,title:"绘制圆",fontClass:"icon-drawCricle",showTypes:[ae.LINE,ae.POLYGON]},{name:zx,title:"绘制椭圆",fontClass:"icon-drawEllipse",showTypes:[ae.LINE,ae.POLYGON]},{name:Vx,title:"移动图元",fontClass:"icon-move",showTypes:[ae.POINT,ae.LINE,ae.POLYGON]},{name:Yx,title:"旋转图元",fontClass:"icon-rotate",showTypes:[ae.LINE,ae.POLYGON]},{name:Hx,title:"增加节点",fontClass:"icon-addGraphic",showTypes:[ae.LINE,ae.POLYGON]},{name:Xx,title:"修改节点",fontClass:"icon-editGraphic",showTypes:[ae.LINE,ae.POLYGON]},{name:Wx,title:"分割线",fontClass:"clipLine",showTypes:[ae.LINE]},{name:Jx,title:"分割面",fontClass:"clipPolygon",showTypes:[ae.POLYGON]},{name:Kx,title:"删除图元",fontClass:"icon-deleteGraphic",showTypes:[ae.POINT,ae.LINE,ae.POLYGON]},{name:Zx,title:"结束编辑",fontClass:"icon-finishEdit",showTypes:[ae.POINT,ae.LINE,ae.POLYGON]}]},onAdd:function(){var t="seEditControl "+this.options.className,e=G.DomUtil.create("div",t+" leaflet-bar");return this._container=e,this._container.style.display="none",this._map.seManager.getEditManager().on("editTip",this.tipsCallBack,this),e},onRemove:function(){this._map.seManager.getEditManager().off("editTip",this.tipsCallBack,this),G.Control.prototype.onRemove.call(this)},tipsCallBack:function(t){var e=t.tip;this.options.tipsCallBack&&this.options.tipsCallBack(e)},setEditLayer:function(t){if(!t||!this._map)return!1;var e=this._map.seManager.setEditLayer(t);return e&&this.show(),e},show:function(){var i=this;if(this._map){this._container.innerHTML="";var t=this._map.seManager.getEditManager().getEditLayer();if(t&&t.getDataset()){this._container.style.display="block";var r=t.getDataset().getType();this.options.barList.forEach(function(e){var t=e.showTypes;if(t&&-1!==t.indexOf(r)){var n=document.createElement("span");n.id="se-bar-"+e.name,n.className=e.fontClass+" se-bar-foot",n.title=e.title,G.DomEvent.on(n,"mousedown dblclick",G.DomEvent.stopPropagation).on(n,"click",G.DomEvent.stopPropagation).on(n,"click",G.DomEvent.stop).on(n,"click",function(t){i.barClick(t,e)}),i._container.appendChild(n)}})}else this.tipsCallBack(ai)}},hide:function(){this._container.innerHTML="",this._container.style.display="none"},barClick:function(t,e){var n=this._map.seManager,i=n.getEditManager(),r=i.getEditLayer();if(r&&r.getDataset()){var o=r.getDataset();switch(e.name){case Ax:n.setAction($n.CREATE_POINT);break;case Fx:n.setAction($n.CREATE_POLYLINE);break;case Bx:n.setAction($n.CREATE_HAND_LINE);break;case Gx:n.setAction($n.CREATE_POLYGON);break;case Ux:n.setAction($n.CREATE_HAND_POLYGON);break;case qx:o.getType()===ae.LINE?n.setAction($n.CREATE_RECT):o.getType()===ae.POLYGON&&n.setAction($n.CREATE_FILL_RECT);break;case jx:o.getType()===ae.LINE?n.setAction($n.CREATE_CIRCLE):o.getType()===ae.POLYGON&&n.setAction($n.CREATE_FILL_CIRCLE);break;case zx:o.getType()===ae.LINE?n.setAction($n.CREATE_ELLIPSE):o.getType()===ae.POLYGON&&n.setAction($n.CREATE_FILL_ELLIPSE);break;case Kx:i.deleteFeatures();break;case Hx:n.setAction($n.ADD_NODE);break;case Xx:n.setAction($n.EDIT_NODE);break;case Wx:n.setAction($n.CLIP_LINE);break;case Jx:n.setAction($n.CLIP_POLYGON);break;case Yx:n.setAction($n.ROTATE);break;case Vx:n.setAction($n.MOVE);break;case Zx:i.finishEdit(),this.hide()}}}}),$x={Ajax:dt,SE:Object.freeze({SeAction:$n,SeManager:kx,LayerType:Zn,DatasetType:ae,QueryType:at,DataType:Yn,FeatureType:xt,RenderStyleType:ge,UtilTool:vt,SeFeature:bt,SeSelection:oi,SeAnalysis:Dx,SeEditControl:Qx,SeTempLayer:Xi}),SymbolLib:rx};window.L=G.extend({},G,Q,$x)});
